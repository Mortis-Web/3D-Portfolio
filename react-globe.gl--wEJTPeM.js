import{r as li,R as UE,y as Fh,g as ht,t as gn,V as we,A as fg,D as vs,H as hn,I as Bo,J as ts,K as yb,L as Qs,q as dg,N as BA,U as Zr,W as fs,X as Ii,Y as xo,Z as _b,$ as vo,a0 as GE,a1 as Ly,a2 as VE,a3 as zE,a4 as wr,a5 as Tl,v as Ft,a6 as jE,a7 as Ih,a8 as Tn,a9 as Do,aa as qs,ab as Li,ac as $E,ad as hr,ae as $u,af as fi,ag as M0,ah as cl,ai as ki,aj as HE,ak as vb,al as WE,am as pg,an as bb,ao as QE,ap as XE,aq as YE,ar as KE,as as ZE,at as JE,au as eR,av as tR,O as mg,aw as Oy,ax as Ls,x as Gn,ay as gg,P as oA,az as nR,aA as rR,aB as qi,aC as Xr,aD as To,aE as Ln,aF as wo,aG as So,aH as Hu,aI as Ps,aJ as ho,aK as xb,Q as Ml,aL as iR,aM as yg,aN as _g,aO as gp,aP as vg,s as bg,aQ as hl,aR as ct,aS as DA,i as xg,aT as Yl,aU as sR,aV as Tg,aW as vr,aX as kh,aY as wg,aZ as qh,a_ as ga,a$ as yp,b0 as aA,b1 as Tb,b2 as Bi,b3 as wb,b4 as Sb,b5 as Eb,b6 as Rb,b7 as Nb,b8 as Sg,b9 as Cb,ba as Mb,bb as Fy,bc as Pl,bd as ui,be as oR,bf as Pb,bg as Bb,bh as Db,bi as Lb,bj as Ob,bk as Fb,bl as Ib,bm as kb,bn as qb,bo as Ub,bp as Gb,bq as Vb,br as aR,bs as lR,bt as uR,bu as Bl,bv as P0,bw as B0,bx as D0,by as zb,bz as jb,bA as $b,bB as Hb,bC as Wb,bD as Qb,bE as Xb,bF as Yb,bG as AR,bH as cR,bI as Kb,bJ as Zb,bK as Wu,bL as Qu,bM as fl,bN as hR,bO as Eg,bP as Rg,bQ as Ng,bR as ca,bS as Cg,bT as Mg,bU as o0,bV as a0,bW as l0,bX as u0,bY as Iy,bZ as ky,b_ as qy,b$ as Uy,c0 as _p,c1 as vp,c2 as bp,c3 as xp,c4 as Tp,c5 as wp,c6 as Sp,c7 as Ep,c8 as Rp,c9 as Np,ca as Cp,cb as Mp,cc as Pp,cd as Bp,ce as Dp,cf as Lp,cg as Op,ch as Fp,ci as Ip,cj as kp,ck as qp,cl as Up,cm as fR,cn as Jb,co as dR,cp as pR,cq as mR,cr as gR,cs as yR,ct as Uh,cu as _R,cv as ex,cw as vR,cx as bR,cy as xR,cz as TR,cA as wR,cB as SR,cC as ER,cD as RR,cE as NR,cF as CR,cG as MR,cH as PR,cI as BR,cJ as DR,cK as LR,cL as OR,cM as FR,cN as IR,cO as kR,cP as qR,cQ as UR,cR as GR,cS as VR,cT as zR,cU as tx,cV as jR,cW as $R,cX as HR,cY as WR,cZ as Dl,c_ as nx,c$ as QR,E as lA,d0 as XR,d1 as Pg,d2 as YR,d3 as KR,S as Bg,d4 as A0,d5 as rx,d6 as L0,d7 as O0,d8 as Gy,d9 as ZR,da as F0,db as JR,dc as ix,dd as eN,de as tN,df as nN,dg as rN,a as Gh,dh as Ll,di as c0,dj as Dg,dk as h0,dl as iN,dm as sN,dn as oN,dp as Lg,dq as aN,dr as sx,ds as ox,dt as lN,du as uN,dv as AN,dw as cu,dx as Og,M as di,T as dl,f as Vy,h as cN,dy as hN,dz as ax,b as mi,dA as fN,dB as dN,dC as P}from"./index--lCWL60v.js";function pN(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function mN(n,e,t){return e=wN(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zy(n,e){return _N(n)||pN(n,e)||lx(n,e)||xN()}function gN(n){return yN(n)||vN(n)||lx(n)||bN()}function yN(n){if(Array.isArray(n))return Gp(n)}function _N(n){if(Array.isArray(n))return n}function vN(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function lx(n,e){if(n){if(typeof n=="string")return Gp(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gp(n,e)}}function Gp(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function bN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TN(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wN(n){var e=TN(n,"string");return typeof e=="symbol"?e:String(e)}var SN=function(e,t){var r=new Set(t);return Object.assign.apply(Object,[{}].concat(gN(Object.entries(e).filter(function(i){var s=zy(i,1),o=s[0];return!r.has(o)}).map(function(i){var s=zy(i,2),o=s[0],a=s[1];return mN({},o,a)}))))};function Vp(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function EN(n){if(Array.isArray(n))return n}function RN(n){if(Array.isArray(n))return Vp(n)}function NN(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function CN(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function MN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BN(n,e){return EN(n)||CN(n,e)||ux(n,e)||MN()}function jy(n){return RN(n)||NN(n)||ux(n)||PN()}function ux(n,e){if(n){if(typeof n=="string")return Vp(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Vp(n,e):void 0}}function DN(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.wrapperElementType,r=t===void 0?"div":t,i=e.nodeMapper,s=i===void 0?function(p){return p}:i,o=e.methodNames,a=o===void 0?[]:o,c=e.initPropNames,f=c===void 0?[]:c;return li.forwardRef(function(p,g){var v=li.useRef(),x=li.useMemo(function(){var R=Object.fromEntries(f.filter(function(C){return p.hasOwnProperty(C)}).map(function(C){return[C,p[C]]}));return n(R)},[]);$y(function(){x(s(v.current))},li.useLayoutEffect),$y(function(){return x._destructor instanceof Function?x._destructor:void 0});var T=li.useCallback(function(R){for(var C=arguments.length,B=new Array(C>1?C-1:0),D=1;D<C;D++)B[D-1]=arguments[D];return x[R]instanceof Function?x[R].apply(x,B):void 0},[x]),S=li.useRef({});return Object.keys(SN(p,[].concat(jy(a),jy(f)))).filter(function(R){return S.current[R]!==p[R]}).forEach(function(R){return T(R,p[R])}),S.current=p,li.useImperativeHandle(g,function(){return Object.fromEntries(a.map(function(R){return[R,function(){for(var C=arguments.length,B=new Array(C),D=0;D<C;D++)B[D]=arguments[D];return T.apply(void 0,[R].concat(B))}]}))},[T]),UE.createElement(r,{ref:v})})}function $y(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:li.useEffect,t=li.useRef(),r=li.useRef(!1),i=li.useRef(!1),s=li.useState(0),o=BN(s,2);o[0];var a=o[1];r.current&&(i.current=!0),e(function(){return r.current||(t.current=n(),r.current=!0),a(function(c){return c+1}),function(){i.current&&t.current&&t.current()}},[])}class LN extends Fh{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new ht(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const za=new we,Hy=new gn,Wy=new gn,Qy=new we,Xy=new we;class ON{constructor(e={}){const t=this;let r,i,s,o;const a={objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.getSize=function(){return{width:r,height:i}},this.render=function(T,S){T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld(),S.parent===null&&S.matrixWorldAutoUpdate===!0&&S.updateMatrixWorld(),Hy.copy(S.matrixWorldInverse),Wy.multiplyMatrices(S.projectionMatrix,Hy),p(T,T,S),x(T)},this.setSize=function(T,S){r=T,i=S,s=r/2,o=i/2,c.style.width=T+"px",c.style.height=S+"px"};function f(T){T.isCSS2DObject&&(T.element.style.display="none");for(let S=0,R=T.children.length;S<R;S++)f(T.children[S])}function p(T,S,R){if(T.visible===!1){f(T);return}if(T.isCSS2DObject){za.setFromMatrixPosition(T.matrixWorld),za.applyMatrix4(Wy);const C=za.z>=-1&&za.z<=1&&T.layers.test(R.layers)===!0,B=T.element;B.style.display=C===!0?"":"none",C===!0&&(T.onBeforeRender(t,S,R),B.style.transform="translate("+-100*T.center.x+"%,"+-100*T.center.y+"%)translate("+(za.x*s+s)+"px,"+(-za.y*o+o)+"px)",B.parentNode!==c&&c.appendChild(B),T.onAfterRender(t,S,R));const D={distanceToCameraSquared:g(R,T)};a.objects.set(T,D)}for(let C=0,B=T.children.length;C<B;C++)p(T.children[C],S,R)}function g(T,S){return Qy.setFromMatrixPosition(T.matrixWorld),Xy.setFromMatrixPosition(S.matrixWorld),Qy.distanceToSquared(Xy)}function v(T){const S=[];return T.traverseVisible(function(R){R.isCSS2DObject&&S.push(R)}),S}function x(T){const S=v(T).sort(function(C,B){if(C.renderOrder!==B.renderOrder)return B.renderOrder-C.renderOrder;const D=a.objects.get(C).distanceToCameraSquared,F=a.objects.get(B).distanceToCameraSquared;return D-F}),R=S.length;for(let C=0,B=S.length;C<B;C++)S[C].element.style.zIndex=R-C}}}function zp(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var FN=typeof global=="object"&&global&&global.Object===Object&&global,IN=typeof self=="object"&&self&&self.Object===Object&&self,Ax=FN||IN||Function("return this")(),cd=function(){return Ax.Date.now()},kN=/\s/;function qN(n){for(var e=n.length;e--&&kN.test(n.charAt(e)););return e}var UN=/^\s+/;function GN(n){return n&&n.slice(0,qN(n)+1).replace(UN,"")}var I0=Ax.Symbol,cx=Object.prototype,VN=cx.hasOwnProperty,zN=cx.toString,hu=I0?I0.toStringTag:void 0;function jN(n){var e=VN.call(n,hu),t=n[hu];try{n[hu]=void 0;var r=!0}catch{}var i=zN.call(n);return r&&(e?n[hu]=t:delete n[hu]),i}var $N=Object.prototype,HN=$N.toString;function WN(n){return HN.call(n)}var QN="[object Null]",XN="[object Undefined]",Yy=I0?I0.toStringTag:void 0;function YN(n){return n==null?n===void 0?XN:QN:Yy&&Yy in Object(n)?jN(n):WN(n)}function KN(n){return n!=null&&typeof n=="object"}var ZN="[object Symbol]";function JN(n){return typeof n=="symbol"||KN(n)&&YN(n)==ZN}var Ky=NaN,eC=/^[-+]0x[0-9a-f]+$/i,tC=/^0b[01]+$/i,nC=/^0o[0-7]+$/i,rC=parseInt;function Zy(n){if(typeof n=="number")return n;if(JN(n))return Ky;if(zp(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=zp(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=GN(n);var t=tC.test(n);return t||nC.test(n)?rC(n.slice(2),t?2:8):eC.test(n)?Ky:+n}var iC="Expected a function",sC=Math.max,oC=Math.min;function aC(n,e,t){var r,i,s,o,a,c,f=0,p=!1,g=!1,v=!0;if(typeof n!="function")throw new TypeError(iC);e=Zy(e)||0,zp(t)&&(p=!!t.leading,g="maxWait"in t,s=g?sC(Zy(t.maxWait)||0,e):s,v="trailing"in t?!!t.trailing:v);function x(q){var k=r,G=i;return r=i=void 0,f=q,o=n.apply(G,k),o}function T(q){return f=q,a=setTimeout(C,e),p?x(q):o}function S(q){var k=q-c,G=q-f,j=e-k;return g?oC(j,s-G):j}function R(q){var k=q-c,G=q-f;return c===void 0||k>=e||k<0||g&&G>=s}function C(){var q=cd();if(R(q))return B(q);a=setTimeout(C,S(q))}function B(q){return a=void 0,v&&r?x(q):(r=i=void 0,o)}function D(){a!==void 0&&clearTimeout(a),f=0,r=c=i=a=void 0}function F(){return a===void 0?o:B(cd())}function I(){var q=cd(),k=R(q);if(r=arguments,i=this,c=q,k){if(a===void 0)return T(c);if(g)return clearTimeout(a),a=setTimeout(C,e),x(c)}return a===void 0&&(a=setTimeout(C,e)),o}return I.cancel=D,I.flush=F,I}function Jy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function lC(n){if(Array.isArray(n))return n}function uC(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function AC(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function cC(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function hC(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fC(n,e){return lC(n)||cC(n,e)||dC(n,e)||hC()}function dC(n,e){if(n){if(typeof n=="string")return Jy(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Jy(n,e):void 0}}var pC=AC(function n(e,t){var r=t.default,i=r===void 0?null:r,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,c=a===void 0?function(f,p){}:a;uC(this,n),this.name=e,this.defaultVal=i,this.triggerUpdate=o,this.onChange=c});function Vn(n){var e=n.stateInit,t=e===void 0?function(){return{}}:e,r=n.props,i=r===void 0?{}:r,s=n.methods,o=s===void 0?{}:s,a=n.aliases,c=a===void 0?{}:a,f=n.init,p=f===void 0?function(){}:f,g=n.update,v=g===void 0?function(){}:g,x=Object.keys(i).map(function(T){return new pC(T,i[T])});return function T(){for(var S=arguments.length,R=new Array(S),C=0;C<S;C++)R[C]=arguments[C];var B=!!(this instanceof T&&this.constructor),D=B?R.shift():void 0,F=R[0],I=F===void 0?{}:F,q=Object.assign({},t instanceof Function?t(I):t,{initialised:!1}),k={};function G(Q){return j(Q,I),ee(),G}var j=function(Y,Z){p.call(G,Y,q,Z),q.initialised=!0},ee=aC(function(){q.initialised&&(v.call(G,q,k),k={})},1);return x.forEach(function(Q){G[Q.name]=Y(Q);function Y(Z){var oe=Z.name,K=Z.triggerUpdate,ae=K===void 0?!1:K,he=Z.onChange,be=he===void 0?function(ke,Xe){}:he,ye=Z.defaultVal,Be=ye===void 0?null:ye;return function(ke){var Xe=q[oe];if(!arguments.length)return Xe;var Qe=ke===void 0?Be:ke;return q[oe]=Qe,be.call(G,Qe,q,Xe),!k.hasOwnProperty(oe)&&(k[oe]=Xe),ae&&ee(),G}}}),Object.keys(o).forEach(function(Q){G[Q]=function(){for(var Y,Z=arguments.length,oe=new Array(Z),K=0;K<Z;K++)oe[K]=arguments[K];return(Y=o[Q]).call.apply(Y,[G,q].concat(oe))}}),Object.entries(c).forEach(function(Q){var Y=fC(Q,2),Z=Y[0],oe=Y[1];return G[Z]=G[oe]}),G.resetProps=function(){return x.forEach(function(Q){G[Q.name](Q.defaultVal)}),G},G.resetProps(),q._rerender=ee,B&&D&&G(D),G}}var On=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-On.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?On.Bounce.In(n*2)*.5:On.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),Fu=function(){return performance.now()},Vh=(function(){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i=0,s=t;i<s.length;i++){var o=s[i];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,i=e;r<i.length;r++){var s=i[r];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},n.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},n.prototype.update=function(e,t){e===void 0&&(e=Fu()),t===void 0&&(t=!0);var r=Object.keys(this._tweens);if(r.length!==0)for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++){var s=this._tweens[r[i]],o=!t;s&&s.update(e,o)===!1&&!t&&this.remove(s)}r=Object.keys(this._tweensAddedDuringUpdate)}},n})(),jp={Linear:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),s=jp.Utils.Linear;return e<0?s(n[0],n[1],r):e>1?s(n[t],n[t-1],t-r):s(n[i],n[i+1>t?t:i+1],r-i)},Utils:{Linear:function(n,e,t){return(e-n)*t+n}}},hx=(function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n})(),$p=new Vh,dr=(function(){function n(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=On.Linear.None,this._interpolationFunction=jp.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=hx.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=$p,$p.add(this))}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=Fu()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var s in this._valuesEnd)i[s]=this._valuesEnd[s];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,r,i,s){for(var o in r){var a=e[o],c=Array.isArray(a),f=c?"array":typeof a,p=!c&&Array.isArray(r[o]);if(!(f==="undefined"||f==="function")){if(p){var g=r[o];if(g.length===0)continue;for(var v=[a],x=0,T=g.length;x<T;x+=1){var S=this._handleRelativeValue(a,g[x]);if(isNaN(S)){p=!1;break}v.push(S)}p&&(r[o]=v)}if((f==="object"||c)&&a&&!p){t[o]=c?[]:{};var R=a;for(var C in R)t[o][C]=R[C];i[o]=c?[]:{};var g=r[o];if(!this._isDynamic){var B={};for(var C in g)B[C]=g[C];r[o]=g=B}this._setupProperties(R,t[o],g,i[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),c||(t[o]*=1),p?i[o]=r[o].slice().reverse():i[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},n.prototype.pause=function(e){return e===void 0&&(e=Fu()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},n.prototype.resume=function(e){return e===void 0&&(e=Fu()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e?(e.add(this),this):this},n.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=On.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=jp.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r=this,i;if(e===void 0&&(e=Fu()),t===void 0&&(t=n.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),c=this._duration+this._repeat*a,f=function(){if(r._duration===0||o>c)return 1;var S=Math.trunc(o/a),R=o-S*a,C=Math.min(R/r._duration,1);return C===0&&o===r._duration?1:C},p=f(),g=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,g),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||o>=this._duration)if(this._repeat>0){var v=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=v);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*v,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var x=0,T=this._chainedTweens.length;x<T;x++)this._chainedTweens[x].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,r,i){for(var s in r)if(t[s]!==void 0){var o=t[s]||0,a=r[s],c=Array.isArray(e[s]),f=Array.isArray(a),p=!c&&f;p?e[s]=this._interpolationFunction(a,i):typeof a=="object"&&a?this._updateProperties(e[s],o,a,i):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*i))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];typeof r=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n.autoStartOnUpdate=!1,n})();hx.nextId;var ds=$p;ds.getAll.bind(ds);ds.removeAll.bind(ds);ds.add.bind(ds);ds.remove.bind(ds);ds.update.bind(ds);function mC(n){const e=+this._x.call(null,n),t=+this._y.call(null,n),r=+this._z.call(null,n);return fx(this.cover(e,t,r),e,t,r,n)}function fx(n,e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r))return n;var s,o=n._root,a={data:i},c=n._x0,f=n._y0,p=n._z0,g=n._x1,v=n._y1,x=n._z1,T,S,R,C,B,D,F,I,q,k,G;if(!o)return n._root=a,n;for(;o.length;)if((F=e>=(T=(c+g)/2))?c=T:g=T,(I=t>=(S=(f+v)/2))?f=S:v=S,(q=r>=(R=(p+x)/2))?p=R:x=R,s=o,!(o=o[k=q<<2|I<<1|F]))return s[k]=a,n;if(C=+n._x.call(null,o.data),B=+n._y.call(null,o.data),D=+n._z.call(null,o.data),e===C&&t===B&&r===D)return a.next=o,s?s[k]=a:n._root=a,n;do s=s?s[k]=new Array(8):n._root=new Array(8),(F=e>=(T=(c+g)/2))?c=T:g=T,(I=t>=(S=(f+v)/2))?f=S:v=S,(q=r>=(R=(p+x)/2))?p=R:x=R;while((k=q<<2|I<<1|F)===(G=(D>=R)<<2|(B>=S)<<1|C>=T));return s[G]=o,s[k]=a,n}function gC(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e),r=new Float64Array(e),i=new Float64Array(e);let s=1/0,o=1/0,a=1/0,c=-1/0,f=-1/0,p=-1/0;for(let g=0,v,x,T,S;g<e;++g)isNaN(x=+this._x.call(null,v=n[g]))||isNaN(T=+this._y.call(null,v))||isNaN(S=+this._z.call(null,v))||(t[g]=x,r[g]=T,i[g]=S,x<s&&(s=x),x>c&&(c=x),T<o&&(o=T),T>f&&(f=T),S<a&&(a=S),S>p&&(p=S));if(s>c||o>f||a>p)return this;this.cover(s,o,a).cover(c,f,p);for(let g=0;g<e;++g)fx(this,t[g],r[g],i[g],n[g]);return this}function yC(n,e,t){if(isNaN(n=+n)||isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,i=this._y0,s=this._z0,o=this._x1,a=this._y1,c=this._z1;if(isNaN(r))o=(r=Math.floor(n))+1,a=(i=Math.floor(e))+1,c=(s=Math.floor(t))+1;else{for(var f=o-r||1,p=this._root,g,v;r>n||n>=o||i>e||e>=a||s>t||t>=c;)switch(v=(t<s)<<2|(e<i)<<1|n<r,g=new Array(8),g[v]=p,p=g,f*=2,v){case 0:o=r+f,a=i+f,c=s+f;break;case 1:r=o-f,a=i+f,c=s+f;break;case 2:o=r+f,i=a-f,c=s+f;break;case 3:r=o-f,i=a-f,c=s+f;break;case 4:o=r+f,a=i+f,s=c-f;break;case 5:r=o-f,a=i+f,s=c-f;break;case 6:o=r+f,i=a-f,s=c-f;break;case 7:r=o-f,i=a-f,s=c-f;break}this._root&&this._root.length&&(this._root=p)}return this._x0=r,this._y0=i,this._z0=s,this._x1=o,this._y1=a,this._z1=c,this}function _C(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function vC(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function en(n,e,t,r,i,s,o){this.node=n,this.x0=e,this.y0=t,this.z0=r,this.x1=i,this.y1=s,this.z1=o}function bC(n,e,t,r){var i,s=this._x0,o=this._y0,a=this._z0,c,f,p,g,v,x,T=this._x1,S=this._y1,R=this._z1,C=[],B=this._root,D,F;for(B&&C.push(new en(B,s,o,a,T,S,R)),r==null?r=1/0:(s=n-r,o=e-r,a=t-r,T=n+r,S=e+r,R=t+r,r*=r);D=C.pop();)if(!(!(B=D.node)||(c=D.x0)>T||(f=D.y0)>S||(p=D.z0)>R||(g=D.x1)<s||(v=D.y1)<o||(x=D.z1)<a))if(B.length){var I=(c+g)/2,q=(f+v)/2,k=(p+x)/2;C.push(new en(B[7],I,q,k,g,v,x),new en(B[6],c,q,k,I,v,x),new en(B[5],I,f,k,g,q,x),new en(B[4],c,f,k,I,q,x),new en(B[3],I,q,p,g,v,k),new en(B[2],c,q,p,I,v,k),new en(B[1],I,f,p,g,q,k),new en(B[0],c,f,p,I,q,k)),(F=(t>=k)<<2|(e>=q)<<1|n>=I)&&(D=C[C.length-1],C[C.length-1]=C[C.length-1-F],C[C.length-1-F]=D)}else{var G=n-+this._x.call(null,B.data),j=e-+this._y.call(null,B.data),ee=t-+this._z.call(null,B.data),Q=G*G+j*j+ee*ee;if(Q<r){var Y=Math.sqrt(r=Q);s=n-Y,o=e-Y,a=t-Y,T=n+Y,S=e+Y,R=t+Y,i=B.data}}return i}const xC=(n,e,t,r,i,s)=>Math.sqrt((n-r)**2+(e-i)**2+(t-s)**2);function TC(n,e,t,r){const i=[],s=n-r,o=e-r,a=t-r,c=n+r,f=e+r,p=t+r;return this.visit((g,v,x,T,S,R,C)=>{if(!g.length)do{const B=g.data;xC(n,e,t,this._x(B),this._y(B),this._z(B))<=r&&i.push(B)}while(g=g.next);return v>c||x>f||T>p||S<s||R<o||C<a}),i}function wC(n){if(isNaN(v=+this._x.call(null,n))||isNaN(x=+this._y.call(null,n))||isNaN(T=+this._z.call(null,n)))return this;var e,t=this._root,r,i,s,o=this._x0,a=this._y0,c=this._z0,f=this._x1,p=this._y1,g=this._z1,v,x,T,S,R,C,B,D,F,I,q;if(!t)return this;if(t.length)for(;;){if((B=v>=(S=(o+f)/2))?o=S:f=S,(D=x>=(R=(a+p)/2))?a=R:p=R,(F=T>=(C=(c+g)/2))?c=C:g=C,e=t,!(t=t[I=F<<2|D<<1|B]))return this;if(!t.length)break;(e[I+1&7]||e[I+2&7]||e[I+3&7]||e[I+4&7]||e[I+5&7]||e[I+6&7]||e[I+7&7])&&(r=e,q=I)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[I]=s:delete e[I],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[q]=t:this._root=t),this):(this._root=s,this)}function SC(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function EC(){return this._root}function RC(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function NC(n){var e=[],t,r=this._root,i,s,o,a,c,f,p;for(r&&e.push(new en(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!n(r=t.node,s=t.x0,o=t.y0,a=t.z0,c=t.x1,f=t.y1,p=t.z1)&&r.length){var g=(s+c)/2,v=(o+f)/2,x=(a+p)/2;(i=r[7])&&e.push(new en(i,g,v,x,c,f,p)),(i=r[6])&&e.push(new en(i,s,v,x,g,f,p)),(i=r[5])&&e.push(new en(i,g,o,x,c,v,p)),(i=r[4])&&e.push(new en(i,s,o,x,g,v,p)),(i=r[3])&&e.push(new en(i,g,v,a,c,f,x)),(i=r[2])&&e.push(new en(i,s,v,a,g,f,x)),(i=r[1])&&e.push(new en(i,g,o,a,c,v,x)),(i=r[0])&&e.push(new en(i,s,o,a,g,v,x))}return this}function CC(n){var e=[],t=[],r;for(this._root&&e.push(new en(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=e.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,c=r.z0,f=r.x1,p=r.y1,g=r.z1,v=(o+f)/2,x=(a+p)/2,T=(c+g)/2;(s=i[0])&&e.push(new en(s,o,a,c,v,x,T)),(s=i[1])&&e.push(new en(s,v,a,c,f,x,T)),(s=i[2])&&e.push(new en(s,o,x,c,v,p,T)),(s=i[3])&&e.push(new en(s,v,x,c,f,p,T)),(s=i[4])&&e.push(new en(s,o,a,T,v,x,g)),(s=i[5])&&e.push(new en(s,v,a,T,f,x,g)),(s=i[6])&&e.push(new en(s,o,x,T,v,p,g)),(s=i[7])&&e.push(new en(s,v,x,T,f,p,g))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function MC(n){return n[0]}function PC(n){return arguments.length?(this._x=n,this):this._x}function BC(n){return n[1]}function DC(n){return arguments.length?(this._y=n,this):this._y}function LC(n){return n[2]}function OC(n){return arguments.length?(this._z=n,this):this._z}function dx(n,e,t,r){var i=new Fg(e??MC,t??BC,r??LC,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?i:i.addAll(n)}function Fg(n,e,t,r,i,s,o,a,c){this._x=n,this._y=e,this._z=t,this._x0=r,this._y0=i,this._z0=s,this._x1=o,this._y1=a,this._z1=c,this._root=void 0}function e_(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var rr=dx.prototype=Fg.prototype;rr.copy=function(){var n=new Fg(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=e_(e),n;for(t=[{source:e,target:n._root=new Array(8)}];e=t.pop();)for(var i=0;i<8;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(8)}):e.target[i]=e_(r));return n};rr.add=mC;rr.addAll=gC;rr.cover=yC;rr.data=_C;rr.extent=vC;rr.find=bC;rr.findAllWithinRadius=TC;rr.remove=wC;rr.removeAll=SC;rr.root=EC;rr.size=RC;rr.visit=NC;rr.visitAfter=CC;rr.x=PC;rr.y=DC;rr.z=OC;function f0(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function FC(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function px(n){let e,t,r;n.length!==2?(e=f0,t=(a,c)=>f0(n(a),c),r=(a,c)=>n(a)-c):(e=n===f0||n===FC?n:IC,t=n,r=n);function i(a,c,f=0,p=a.length){if(f<p){if(e(c,c)!==0)return p;do{const g=f+p>>>1;t(a[g],c)<0?f=g+1:p=g}while(f<p)}return f}function s(a,c,f=0,p=a.length){if(f<p){if(e(c,c)!==0)return p;do{const g=f+p>>>1;t(a[g],c)<=0?f=g+1:p=g}while(f<p)}return f}function o(a,c,f=0,p=a.length){const g=i(a,c,f,p-1);return g>f&&r(a[g-1],c)>-r(a[g],c)?g-1:g}return{left:i,center:o,right:s}}function IC(){return 0}function kC(n){return n===null?NaN:+n}const qC=px(f0),mx=qC.right;px(kC).center;function k0(n,e){let t,r;if(e===void 0)for(const i of n)i!=null&&(t===void 0?i>=i&&(t=r=i):(t>i&&(t=i),r<i&&(r=i)));else{let i=-1;for(let s of n)(s=e(s,++i,n))!=null&&(t===void 0?s>=s&&(t=r=s):(t>s&&(t=s),r<s&&(r=s)))}return[t,r]}class Os{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=t[i],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[r++]=a),e=o}return t[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let t=this._n,r,i,s,o=0;if(t>0){for(o=e[--t];t>0&&(r=o,i=e[--t],o=r+i,s=i-(o-r),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}const UC=Math.sqrt(50),GC=Math.sqrt(10),VC=Math.sqrt(2);function q0(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=UC?10:s>=GC?5:s>=VC?2:1;let a,c,f;return i<0?(f=Math.pow(10,-i)/o,a=Math.round(n*f),c=Math.round(e*f),a/f<n&&++a,c/f>e&&--c,f=-f):(f=Math.pow(10,i)*o,a=Math.round(n/f),c=Math.round(e/f),a*f<n&&++a,c*f>e&&--c),c<a&&.5<=t&&t<2?q0(n,e,t*2):[a,c,f]}function zC(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const r=e<n,[i,s,o]=r?q0(e,n,t):q0(n,e,t);if(!(s>=i))return[];const a=s-i+1,c=new Array(a);if(r)if(o<0)for(let f=0;f<a;++f)c[f]=(s-f)/-o;else for(let f=0;f<a;++f)c[f]=(s-f)*o;else if(o<0)for(let f=0;f<a;++f)c[f]=(i+f)/-o;else for(let f=0;f<a;++f)c[f]=(i+f)*o;return c}function Hp(n,e,t){return e=+e,n=+n,t=+t,q0(n,e,t)[2]}function jC(n,e,t){e=+e,n=+n,t=+t;const r=e<n,i=r?Hp(e,n,t):Hp(n,e,t);return(r?-1:1)*(i<0?1/-i:i)}function $C(n,e){let t;for(const r of n)r!=null&&(t<r||t===void 0&&r>=r)&&(t=r);return t}function HC(n,e){let t=0,r=0;if(e===void 0)for(let i of n)i!=null&&(i=+i)>=i&&(++t,r+=i);else{let i=-1;for(let s of n)(s=e(s,++i,n))!=null&&(s=+s)>=s&&(++t,r+=s)}if(t)return r/t}function*WC(n){for(const e of n)yield*e}function uA(n){return Array.from(WC(n))}function pl(n,e,t){n=+n,e=+e,t=(i=arguments.length)<2?(e=n,n=0,1):i<3?1:+t;for(var r=-1,i=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(i);++r<i;)s[r]=n+r*t;return s}function QC(n,e){let t=0;for(let r of n)(r=+r)&&(t+=r);return t}function gx(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function Ig(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function yx(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function LA(){}var AA=.7,U0=1/AA,wl="\\s*([+-]?\\d+)\\s*",cA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",os="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XC=/^#([0-9a-f]{3,8})$/,YC=new RegExp(`^rgb\\(${wl},${wl},${wl}\\)$`),KC=new RegExp(`^rgb\\(${os},${os},${os}\\)$`),ZC=new RegExp(`^rgba\\(${wl},${wl},${wl},${cA}\\)$`),JC=new RegExp(`^rgba\\(${os},${os},${os},${cA}\\)$`),e9=new RegExp(`^hsl\\(${cA},${os},${os}\\)$`),t9=new RegExp(`^hsla\\(${cA},${os},${os},${cA}\\)$`),t_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ig(LA,wa,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:n_,formatHex:n_,formatHex8:n9,formatHsl:r9,formatRgb:r_,toString:r_});function n_(){return this.rgb().formatHex()}function n9(){return this.rgb().formatHex8()}function r9(){return _x(this).formatHsl()}function r_(){return this.rgb().formatRgb()}function wa(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=XC.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?i_(e):t===3?new Pr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?uc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?uc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=YC.exec(n))?new Pr(e[1],e[2],e[3],1):(e=KC.exec(n))?new Pr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ZC.exec(n))?uc(e[1],e[2],e[3],e[4]):(e=JC.exec(n))?uc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=e9.exec(n))?a_(e[1],e[2]/100,e[3]/100,1):(e=t9.exec(n))?a_(e[1],e[2]/100,e[3]/100,e[4]):t_.hasOwnProperty(n)?i_(t_[n]):n==="transparent"?new Pr(NaN,NaN,NaN,0):null}function i_(n){return new Pr(n>>16&255,n>>8&255,n&255,1)}function uc(n,e,t,r){return r<=0&&(n=e=t=NaN),new Pr(n,e,t,r)}function i9(n){return n instanceof LA||(n=wa(n)),n?(n=n.rgb(),new Pr(n.r,n.g,n.b,n.opacity)):new Pr}function Wp(n,e,t,r){return arguments.length===1?i9(n):new Pr(n,e,t,r??1)}function Pr(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}Ig(Pr,Wp,yx(LA,{brighter(n){return n=n==null?U0:Math.pow(U0,n),new Pr(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?AA:Math.pow(AA,n),new Pr(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Pr(ya(this.r),ya(this.g),ya(this.b),G0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s_,formatHex:s_,formatHex8:s9,formatRgb:o_,toString:o_}));function s_(){return`#${ha(this.r)}${ha(this.g)}${ha(this.b)}`}function s9(){return`#${ha(this.r)}${ha(this.g)}${ha(this.b)}${ha((isNaN(this.opacity)?1:this.opacity)*255)}`}function o_(){const n=G0(this.opacity);return`${n===1?"rgb(":"rgba("}${ya(this.r)}, ${ya(this.g)}, ${ya(this.b)}${n===1?")":`, ${n})`}`}function G0(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function ya(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function ha(n){return n=ya(n),(n<16?"0":"")+n.toString(16)}function a_(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Di(n,e,t,r)}function _x(n){if(n instanceof Di)return new Di(n.h,n.s,n.l,n.opacity);if(n instanceof LA||(n=wa(n)),!n)return new Di;if(n instanceof Di)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),s=Math.max(e,t,r),o=NaN,a=s-i,c=(s+i)/2;return a?(e===s?o=(t-r)/a+(t<r)*6:t===s?o=(r-e)/a+2:o=(e-t)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new Di(o,a,c,n.opacity)}function o9(n,e,t,r){return arguments.length===1?_x(n):new Di(n,e,t,r??1)}function Di(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}Ig(Di,o9,yx(LA,{brighter(n){return n=n==null?U0:Math.pow(U0,n),new Di(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?AA:Math.pow(AA,n),new Di(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new Pr(hd(n>=240?n-240:n+120,i,r),hd(n,i,r),hd(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new Di(l_(this.h),Ac(this.s),Ac(this.l),G0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=G0(this.opacity);return`${n===1?"hsl(":"hsla("}${l_(this.h)}, ${Ac(this.s)*100}%, ${Ac(this.l)*100}%${n===1?")":`, ${n})`}`}}));function l_(n){return n=(n||0)%360,n<0?n+360:n}function Ac(n){return Math.max(0,Math.min(1,n||0))}function hd(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const kg=n=>()=>n;function a9(n,e){return function(t){return n+t*e}}function l9(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function u9(n){return(n=+n)==1?vx:function(e,t){return t-e?l9(e,t,n):kg(isNaN(e)?t:e)}}function vx(n,e){var t=e-n;return t?a9(n,t):kg(isNaN(n)?e:n)}const u_=(function n(e){var t=u9(e);function r(i,s){var o=t((i=Wp(i)).r,(s=Wp(s)).r),a=t(i.g,s.g),c=t(i.b,s.b),f=vx(i.opacity,s.opacity);return function(p){return i.r=o(p),i.g=a(p),i.b=c(p),i.opacity=f(p),i+""}}return r.gamma=n,r})(1);function bx(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,r=e.slice(),i;return function(s){for(i=0;i<t;++i)r[i]=n[i]*(1-s)+e[i]*s;return r}}function xx(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function A9(n,e){return(xx(e)?bx:Tx)(n,e)}function Tx(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0,i=new Array(r),s=new Array(t),o;for(o=0;o<r;++o)i[o]=qg(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function c9(n,e){var t=new Date;return n=+n,e=+e,function(r){return t.setTime(n*(1-r)+e*r),t}}function hA(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function h9(n,e){var t={},r={},i;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in n?t[i]=qg(n[i],e[i]):r[i]=e[i];return function(s){for(i in t)r[i]=t[i](s);return r}}var Qp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fd=new RegExp(Qp.source,"g");function f9(n){return function(){return n}}function d9(n){return function(e){return n(e)+""}}function p9(n,e){var t=Qp.lastIndex=fd.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(n=n+"",e=e+"";(r=Qp.exec(n))&&(i=fd.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:hA(r,i)})),t=fd.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?d9(c[0].x):f9(e):(e=c.length,function(f){for(var p=0,g;p<e;++p)a[(g=c[p]).i]=g.x(f);return a.join("")})}function qg(n,e){var t=typeof e,r;return e==null||t==="boolean"?kg(e):(t==="number"?hA:t==="string"?(r=wa(e))?(e=r,u_):p9:e instanceof wa?u_:e instanceof Date?c9:xx(e)?bx:Array.isArray(e)?Tx:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?h9:hA)(n,e)}function m9(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function g9(n){return function(){return n}}function y9(n){return+n}var A_=[0,1];function ml(n){return n}function Xp(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:g9(isNaN(e)?NaN:.5)}function _9(n,e){var t;return n>e&&(t=n,n=e,e=t),function(r){return Math.max(n,Math.min(e,r))}}function v9(n,e,t){var r=n[0],i=n[1],s=e[0],o=e[1];return i<r?(r=Xp(i,r),s=t(o,s)):(r=Xp(r,i),s=t(s,o)),function(a){return s(r(a))}}function b9(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Xp(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var c=mx(n,a,1,r)-1;return s[c](i[c](a))}}function x9(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function T9(){var n=A_,e=A_,t=qg,r,i,s,o=ml,a,c,f;function p(){var v=Math.min(n.length,e.length);return o!==ml&&(o=_9(n[0],n[v-1])),a=v>2?b9:v9,c=f=null,g}function g(v){return v==null||isNaN(v=+v)?s:(c||(c=a(n.map(r),e,t)))(r(o(v)))}return g.invert=function(v){return o(i((f||(f=a(e,n.map(r),hA)))(v)))},g.domain=function(v){return arguments.length?(n=Array.from(v,y9),p()):n.slice()},g.range=function(v){return arguments.length?(e=Array.from(v),p()):e.slice()},g.rangeRound=function(v){return e=Array.from(v),t=m9,p()},g.clamp=function(v){return arguments.length?(o=v?!0:ml,p()):o!==ml},g.interpolate=function(v){return arguments.length?(t=v,p()):t},g.unknown=function(v){return arguments.length?(s=v,g):s},function(v,x){return r=v,i=x,p()}}function w9(){return T9()(ml,ml)}function S9(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function V0(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function Ol(n){return n=V0(Math.abs(n)),n?n[1]:NaN}function E9(n,e){return function(t,r){for(var i=t.length,s=[],o=0,a=n[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),s.push(t.substring(i-=a,i+a)),!((c+=a+1)>r));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function R9(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var N9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function z0(n){if(!(e=N9.exec(n)))throw new Error("invalid format: "+n);var e;return new Ug({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}z0.prototype=Ug.prototype;function Ug(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Ug.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function C9(n){e:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var wx;function M9(n,e){var t=V0(n,e);if(!t)return n+"";var r=t[0],i=t[1],s=i-(wx=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+V0(n,Math.max(0,e+s-1))[0]}function c_(n,e){var t=V0(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const h_={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:S9,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>c_(n*100,e),r:c_,s:M9,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function f_(n){return n}var d_=Array.prototype.map,p_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function P9(n){var e=n.grouping===void 0||n.thousands===void 0?f_:E9(d_.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?f_:R9(d_.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",c=n.nan===void 0?"NaN":n.nan+"";function f(g){g=z0(g);var v=g.fill,x=g.align,T=g.sign,S=g.symbol,R=g.zero,C=g.width,B=g.comma,D=g.precision,F=g.trim,I=g.type;I==="n"?(B=!0,I="g"):h_[I]||(D===void 0&&(D=12),F=!0,I="g"),(R||v==="0"&&x==="=")&&(R=!0,v="0",x="=");var q=S==="$"?t:S==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():"",k=S==="$"?r:/[%p]/.test(I)?o:"",G=h_[I],j=/[defgprs%]/.test(I);D=D===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,D)):Math.max(0,Math.min(20,D));function ee(Q){var Y=q,Z=k,oe,K,ae;if(I==="c")Z=G(Q)+Z,Q="";else{Q=+Q;var he=Q<0||1/Q<0;if(Q=isNaN(Q)?c:G(Math.abs(Q),D),F&&(Q=C9(Q)),he&&+Q==0&&T!=="+"&&(he=!1),Y=(he?T==="("?T:a:T==="-"||T==="("?"":T)+Y,Z=(I==="s"?p_[8+wx/3]:"")+Z+(he&&T==="("?")":""),j){for(oe=-1,K=Q.length;++oe<K;)if(ae=Q.charCodeAt(oe),48>ae||ae>57){Z=(ae===46?i+Q.slice(oe+1):Q.slice(oe))+Z,Q=Q.slice(0,oe);break}}}B&&!R&&(Q=e(Q,1/0));var be=Y.length+Q.length+Z.length,ye=be<C?new Array(C-be+1).join(v):"";switch(B&&R&&(Q=e(ye+Q,ye.length?C-Z.length:1/0),ye=""),x){case"<":Q=Y+Q+Z+ye;break;case"=":Q=Y+ye+Q+Z;break;case"^":Q=ye.slice(0,be=ye.length>>1)+Y+Q+Z+ye.slice(be);break;default:Q=ye+Y+Q+Z;break}return s(Q)}return ee.toString=function(){return g+""},ee}function p(g,v){var x=f((g=z0(g),g.type="f",g)),T=Math.max(-8,Math.min(8,Math.floor(Ol(v)/3)))*3,S=Math.pow(10,-T),R=p_[8+T/3];return function(C){return x(S*C)+R}}return{format:f,formatPrefix:p}}var cc,Sx,Ex;B9({thousands:",",grouping:[3],currency:["$",""]});function B9(n){return cc=P9(n),Sx=cc.format,Ex=cc.formatPrefix,cc}function D9(n){return Math.max(0,-Ol(Math.abs(n)))}function L9(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ol(e)/3)))*3-Ol(Math.abs(n)))}function O9(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,Ol(e)-Ol(n))+1}function F9(n,e,t,r){var i=jC(n,e,t),s;switch(r=z0(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return r.precision==null&&!isNaN(s=L9(i,o))&&(r.precision=s),Ex(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=O9(i,Math.max(Math.abs(n),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=D9(i))&&(r.precision=s-(r.type==="%")*2);break}}return Sx(r)}function Rx(n){var e=n.domain;return n.ticks=function(t){var r=e();return zC(r[0],r[r.length-1],t??10)},n.tickFormat=function(t,r){var i=e();return F9(i[0],i[i.length-1],t??10,r)},n.nice=function(t){t==null&&(t=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],c,f,p=10;for(a<o&&(f=o,o=a,a=f,f=i,i=s,s=f);p-- >0;){if(f=Hp(o,a,t),f===c)return r[i]=o,r[s]=a,e(r);if(f>0)o=Math.floor(o/f)*f,a=Math.ceil(a/f)*f;else if(f<0)o=Math.ceil(o*f)/f,a=Math.floor(a*f)/f;else break;c=f}return n},n}function Us(){var n=w9();return n.copy=function(){return x9(n,Us())},gx.apply(n,arguments),Rx(n)}function Nx(){var n=0,e=1,t=1,r=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[mx(r,c,0,t)]:s}function a(){var c=-1;for(r=new Array(t);++c<t;)r[c]=((c+1)*e-(c-t)*n)/(t+1);return o}return o.domain=function(c){return arguments.length?([n,e]=c,n=+n,e=+e,a()):[n,e]},o.range=function(c){return arguments.length?(t=(i=Array.from(c)).length-1,a()):i.slice()},o.invertExtent=function(c){var f=i.indexOf(c);return f<0?[NaN,NaN]:f<1?[n,r[0]]:f>=t?[r[t-1],e]:[r[f-1],r[f]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Nx().domain([n,e]).range(i).unknown(s)},gx.apply(Rx(o),arguments)}var Tt=1e-6,j0=1e-12,Ct=Math.PI,Br=Ct/2,$0=Ct/4,Yr=Ct*2,xn=180/Ct,ut=Ct/180,Zt=Math.abs,Gg=Math.atan,gi=Math.atan2,ft=Math.cos,hc=Math.ceil,I9=Math.exp,Yp=Math.hypot,k9=Math.log,it=Math.sin,q9=Math.sign||function(n){return n>0?1:n<0?-1:0},Gs=Math.sqrt,U9=Math.tan;function G9(n){return n>1?0:n<-1?Ct:Math.acos(n)}function Vs(n){return n>1?Br:n<-1?-Br:Math.asin(n)}function m_(n){return(n=it(n/2))*n}function Ar(){}function H0(n,e){n&&y_.hasOwnProperty(n.type)&&y_[n.type](n,e)}var g_={Feature:function(n,e){H0(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,r=-1,i=t.length;++r<i;)H0(t[r].geometry,e)}},y_={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)n=t[r],e.point(n[0],n[1],n[2])},LineString:function(n,e){Kp(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)Kp(t[r],e,0)},Polygon:function(n,e){__(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)__(t[r],e)},GeometryCollection:function(n,e){for(var t=n.geometries,r=-1,i=t.length;++r<i;)H0(t[r],e)}};function Kp(n,e,t){var r=-1,i=n.length-t,s;for(e.lineStart();++r<i;)s=n[r],e.point(s[0],s[1],s[2]);e.lineEnd()}function __(n,e){var t=-1,r=n.length;for(e.polygonStart();++t<r;)Kp(n[t],e,1);e.polygonEnd()}function zh(n,e){n&&g_.hasOwnProperty(n.type)?g_[n.type](n,e):H0(n,e)}var W0=new Os,v_=new Os,Cx,Mx,Zp,Jp,em,zs={point:Ar,lineStart:Ar,lineEnd:Ar,polygonStart:function(){W0=new Os,zs.lineStart=V9,zs.lineEnd=z9},polygonEnd:function(){var n=+W0;v_.add(n<0?Yr+n:n),this.lineStart=this.lineEnd=this.point=Ar},sphere:function(){v_.add(Yr)}};function V9(){zs.point=j9}function z9(){Px(Cx,Mx)}function j9(n,e){zs.point=Px,Cx=n,Mx=e,n*=ut,e*=ut,Zp=n,Jp=ft(e=e/2+$0),em=it(e)}function Px(n,e){n*=ut,e*=ut,e=e/2+$0;var t=n-Zp,r=t>=0?1:-1,i=r*t,s=ft(e),o=it(e),a=em*o,c=Jp*s+a*ft(i),f=a*r*it(i);W0.add(gi(f,c)),Zp=n,Jp=s,em=o}function Q0(n){return[gi(n[1],n[0]),Vs(n[2])]}function Sa(n){var e=n[0],t=n[1],r=ft(t);return[r*ft(e),r*it(e),it(t)]}function fc(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Fl(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function dd(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function dc(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function X0(n){var e=Gs(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}var mn,Mr,vn,Wr,ia,Bx,Dx,Sl,Xu,fo,js,Ns={point:tm,lineStart:b_,lineEnd:x_,polygonStart:function(){Ns.point=Ox,Ns.lineStart=$9,Ns.lineEnd=H9,Xu=new Os,zs.polygonStart()},polygonEnd:function(){zs.polygonEnd(),Ns.point=tm,Ns.lineStart=b_,Ns.lineEnd=x_,W0<0?(mn=-(vn=180),Mr=-(Wr=90)):Xu>Tt?Wr=90:Xu<-Tt&&(Mr=-90),js[0]=mn,js[1]=vn},sphere:function(){mn=-(vn=180),Mr=-(Wr=90)}};function tm(n,e){fo.push(js=[mn=n,vn=n]),e<Mr&&(Mr=e),e>Wr&&(Wr=e)}function Lx(n,e){var t=Sa([n*ut,e*ut]);if(Sl){var r=Fl(Sl,t),i=[r[1],-r[0],0],s=Fl(i,r);X0(s),s=Q0(s);var o=n-ia,a=o>0?1:-1,c=s[0]*xn*a,f,p=Zt(o)>180;p^(a*ia<c&&c<a*n)?(f=s[1]*xn,f>Wr&&(Wr=f)):(c=(c+360)%360-180,p^(a*ia<c&&c<a*n)?(f=-s[1]*xn,f<Mr&&(Mr=f)):(e<Mr&&(Mr=e),e>Wr&&(Wr=e))),p?n<ia?jr(mn,n)>jr(mn,vn)&&(vn=n):jr(n,vn)>jr(mn,vn)&&(mn=n):vn>=mn?(n<mn&&(mn=n),n>vn&&(vn=n)):n>ia?jr(mn,n)>jr(mn,vn)&&(vn=n):jr(n,vn)>jr(mn,vn)&&(mn=n)}else fo.push(js=[mn=n,vn=n]);e<Mr&&(Mr=e),e>Wr&&(Wr=e),Sl=t,ia=n}function b_(){Ns.point=Lx}function x_(){js[0]=mn,js[1]=vn,Ns.point=tm,Sl=null}function Ox(n,e){if(Sl){var t=n-ia;Xu.add(Zt(t)>180?t+(t>0?360:-360):t)}else Bx=n,Dx=e;zs.point(n,e),Lx(n,e)}function $9(){zs.lineStart()}function H9(){Ox(Bx,Dx),zs.lineEnd(),Zt(Xu)>Tt&&(mn=-(vn=180)),js[0]=mn,js[1]=vn,Sl=null}function jr(n,e){return(e-=n)<0?e+360:e}function W9(n,e){return n[0]-e[0]}function T_(n,e){return n[0]<=n[1]?n[0]<=e&&e<=n[1]:e<n[0]||n[1]<e}function Fx(n){var e,t,r,i,s,o,a;if(Wr=vn=-(mn=Mr=1/0),fo=[],zh(n,Ns),t=fo.length){for(fo.sort(W9),e=1,r=fo[0],s=[r];e<t;++e)i=fo[e],T_(r,i[0])||T_(r,i[1])?(jr(r[0],i[1])>jr(r[0],r[1])&&(r[1]=i[1]),jr(i[0],r[1])>jr(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(o=-1/0,t=s.length-1,e=0,r=s[t];e<=t;r=i,++e)i=s[e],(a=jr(r[1],i[0]))>o&&(o=a,mn=i[0],vn=r[1])}return fo=js=null,mn===1/0||Mr===1/0?[[NaN,NaN],[NaN,NaN]]:[[mn,Mr],[vn,Wr]]}var Iu,Y0,K0,Z0,J0,eh,th,nh,nm,rm,im,Ix,kx,br,xr,Tr,Oi={sphere:Ar,point:Vg,lineStart:w_,lineEnd:S_,polygonStart:function(){Oi.lineStart=Y9,Oi.lineEnd=K9},polygonEnd:function(){Oi.lineStart=w_,Oi.lineEnd=S_}};function Vg(n,e){n*=ut,e*=ut;var t=ft(e);OA(t*ft(n),t*it(n),it(e))}function OA(n,e,t){++Iu,K0+=(n-K0)/Iu,Z0+=(e-Z0)/Iu,J0+=(t-J0)/Iu}function w_(){Oi.point=Q9}function Q9(n,e){n*=ut,e*=ut;var t=ft(e);br=t*ft(n),xr=t*it(n),Tr=it(e),Oi.point=X9,OA(br,xr,Tr)}function X9(n,e){n*=ut,e*=ut;var t=ft(e),r=t*ft(n),i=t*it(n),s=it(e),o=gi(Gs((o=xr*s-Tr*i)*o+(o=Tr*r-br*s)*o+(o=br*i-xr*r)*o),br*r+xr*i+Tr*s);Y0+=o,eh+=o*(br+(br=r)),th+=o*(xr+(xr=i)),nh+=o*(Tr+(Tr=s)),OA(br,xr,Tr)}function S_(){Oi.point=Vg}function Y9(){Oi.point=Z9}function K9(){qx(Ix,kx),Oi.point=Vg}function Z9(n,e){Ix=n,kx=e,n*=ut,e*=ut,Oi.point=qx;var t=ft(e);br=t*ft(n),xr=t*it(n),Tr=it(e),OA(br,xr,Tr)}function qx(n,e){n*=ut,e*=ut;var t=ft(e),r=t*ft(n),i=t*it(n),s=it(e),o=xr*s-Tr*i,a=Tr*r-br*s,c=br*i-xr*r,f=Yp(o,a,c),p=Vs(f),g=f&&-p/f;nm.add(g*o),rm.add(g*a),im.add(g*c),Y0+=p,eh+=p*(br+(br=r)),th+=p*(xr+(xr=i)),nh+=p*(Tr+(Tr=s)),OA(br,xr,Tr)}function E_(n){Iu=Y0=K0=Z0=J0=eh=th=nh=0,nm=new Os,rm=new Os,im=new Os,zh(n,Oi);var e=+nm,t=+rm,r=+im,i=Yp(e,t,r);return i<j0&&(e=eh,t=th,r=nh,Y0<Tt&&(e=K0,t=Z0,r=J0),i=Yp(e,t,r),i<j0)?[NaN,NaN]:[gi(t,e)*xn,Vs(r/i)*xn]}function sm(n,e){function t(r,i){return r=n(r,i),e(r[0],r[1])}return n.invert&&e.invert&&(t.invert=function(r,i){return r=e.invert(r,i),r&&n.invert(r[0],r[1])}),t}function om(n,e){return Zt(n)>Ct&&(n-=Math.round(n/Yr)*Yr),[n,e]}om.invert=om;function Ux(n,e,t){return(n%=Yr)?e||t?sm(N_(n),C_(e,t)):N_(n):e||t?C_(e,t):om}function R_(n){return function(e,t){return e+=n,Zt(e)>Ct&&(e-=Math.round(e/Yr)*Yr),[e,t]}}function N_(n){var e=R_(n);return e.invert=R_(-n),e}function C_(n,e){var t=ft(n),r=it(n),i=ft(e),s=it(e);function o(a,c){var f=ft(c),p=ft(a)*f,g=it(a)*f,v=it(c),x=v*t+p*r;return[gi(g*i-x*s,p*t-v*r),Vs(x*i+g*s)]}return o.invert=function(a,c){var f=ft(c),p=ft(a)*f,g=it(a)*f,v=it(c),x=v*i-g*s;return[gi(g*i+v*s,p*t+x*r),Vs(x*t-p*r)]},o}function J9(n){n=Ux(n[0]*ut,n[1]*ut,n.length>2?n[2]*ut:0);function e(t){return t=n(t[0]*ut,t[1]*ut),t[0]*=xn,t[1]*=xn,t}return e.invert=function(t){return t=n.invert(t[0]*ut,t[1]*ut),t[0]*=xn,t[1]*=xn,t},e}function eM(n,e,t,r,i,s){if(t){var o=ft(e),a=it(e),c=r*t;i==null?(i=e+r*Yr,s=e-c/2):(i=M_(o,i),s=M_(o,s),(r>0?i<s:i>s)&&(i+=r*Yr));for(var f,p=i;r>0?p>s:p<s;p-=c)f=Q0([o,-a*ft(p),-a*it(p)]),n.point(f[0],f[1])}}function M_(n,e){e=Sa(e),e[0]-=n,X0(e);var t=G9(-e[1]);return((-e[2]<0?-t:t)+Yr-Tt)%Yr}function Gx(){var n=[],e;return{point:function(t,r,i){e.push([t,r,i])},lineStart:function(){n.push(e=[])},lineEnd:Ar,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function d0(n,e){return Zt(n[0]-e[0])<Tt&&Zt(n[1]-e[1])<Tt}function pc(n,e,t,r){this.x=n,this.z=e,this.o=t,this.e=r,this.v=!1,this.n=this.p=null}function Vx(n,e,t,r,i){var s=[],o=[],a,c;if(n.forEach(function(T){if(!((S=T.length-1)<=0)){var S,R=T[0],C=T[S],B;if(d0(R,C)){if(!R[2]&&!C[2]){for(i.lineStart(),a=0;a<S;++a)i.point((R=T[a])[0],R[1]);i.lineEnd();return}C[0]+=2*Tt}s.push(B=new pc(R,T,null,!0)),o.push(B.o=new pc(R,null,B,!1)),s.push(B=new pc(C,T,null,!1)),o.push(B.o=new pc(C,null,B,!0))}}),!!s.length){for(o.sort(e),P_(s),P_(o),a=0,c=o.length;a<c;++a)o[a].e=t=!t;for(var f=s[0],p,g;;){for(var v=f,x=!0;v.v;)if((v=v.n)===f)return;p=v.z,i.lineStart();do{if(v.v=v.o.v=!0,v.e){if(x)for(a=0,c=p.length;a<c;++a)i.point((g=p[a])[0],g[1]);else r(v.x,v.n.x,1,i);v=v.n}else{if(x)for(p=v.p.z,a=p.length-1;a>=0;--a)i.point((g=p[a])[0],g[1]);else r(v.x,v.p.x,-1,i);v=v.p}v=v.o,p=v.z,x=!x}while(!v.v);i.lineEnd()}}}function P_(n){if(e=n.length){for(var e,t=0,r=n[0],i;++t<e;)r.n=i=n[t],i.p=r,r=i;r.n=i=n[0],i.p=r}}function pd(n){return Zt(n[0])<=Ct?n[0]:q9(n[0])*((Zt(n[0])+Ct)%Yr-Ct)}function zx(n,e){var t=pd(e),r=e[1],i=it(r),s=[it(t),-ft(t),0],o=0,a=0,c=new Os;i===1?r=Br+Tt:i===-1&&(r=-Br-Tt);for(var f=0,p=n.length;f<p;++f)if(v=(g=n[f]).length)for(var g,v,x=g[v-1],T=pd(x),S=x[1]/2+$0,R=it(S),C=ft(S),B=0;B<v;++B,T=F,R=q,C=k,x=D){var D=g[B],F=pd(D),I=D[1]/2+$0,q=it(I),k=ft(I),G=F-T,j=G>=0?1:-1,ee=j*G,Q=ee>Ct,Y=R*q;if(c.add(gi(Y*j*it(ee),C*k+Y*ft(ee))),o+=Q?G+j*Yr:G,Q^T>=t^F>=t){var Z=Fl(Sa(x),Sa(D));X0(Z);var oe=Fl(s,Z);X0(oe);var K=(Q^G>=0?-1:1)*Vs(oe[2]);(r>K||r===K&&(Z[0]||Z[1]))&&(a+=Q^G>=0?1:-1)}}return(o<-Tt||o<Tt&&c<-j0)^a&1}function jx(n,e,t,r){return function(i){var s=e(i),o=Gx(),a=e(o),c=!1,f,p,g,v={point:x,lineStart:S,lineEnd:R,polygonStart:function(){v.point=C,v.lineStart=B,v.lineEnd=D,p=[],f=[]},polygonEnd:function(){v.point=x,v.lineStart=S,v.lineEnd=R,p=uA(p);var F=zx(f,r);p.length?(c||(i.polygonStart(),c=!0),Vx(p,nM,F,t,i)):F&&(c||(i.polygonStart(),c=!0),i.lineStart(),t(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),p=f=null},sphere:function(){i.polygonStart(),i.lineStart(),t(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function x(F,I){n(F,I)&&i.point(F,I)}function T(F,I){s.point(F,I)}function S(){v.point=T,s.lineStart()}function R(){v.point=x,s.lineEnd()}function C(F,I){g.push([F,I]),a.point(F,I)}function B(){a.lineStart(),g=[]}function D(){C(g[0][0],g[0][1]),a.lineEnd();var F=a.clean(),I=o.result(),q,k=I.length,G,j,ee;if(g.pop(),f.push(g),g=null,!!k){if(F&1){if(j=I[0],(G=j.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),q=0;q<G;++q)i.point((ee=j[q])[0],ee[1]);i.lineEnd()}return}k>1&&F&2&&I.push(I.pop().concat(I.shift())),p.push(I.filter(tM))}}return v}}function tM(n){return n.length>1}function nM(n,e){return((n=n.x)[0]<0?n[1]-Br-Tt:Br-n[1])-((e=e.x)[0]<0?e[1]-Br-Tt:Br-e[1])}const B_=jx(function(){return!0},rM,sM,[-Ct,-Br]);function rM(n){var e=NaN,t=NaN,r=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(s,o){var a=s>0?Ct:-Ct,c=Zt(s-e);Zt(c-Ct)<Tt?(n.point(e,t=(t+o)/2>0?Br:-Br),n.point(r,t),n.lineEnd(),n.lineStart(),n.point(a,t),n.point(s,t),i=0):r!==a&&c>=Ct&&(Zt(e-r)<Tt&&(e-=r*Tt),Zt(s-a)<Tt&&(s-=a*Tt),t=iM(e,t,s,o),n.point(r,t),n.lineEnd(),n.lineStart(),n.point(a,t),i=0),n.point(e=s,t=o),r=a},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-i}}}function iM(n,e,t,r){var i,s,o=it(n-t);return Zt(o)>Tt?Gg((it(e)*(s=ft(r))*it(t)-it(r)*(i=ft(e))*it(n))/(i*s*o)):(e+r)/2}function sM(n,e,t,r){var i;if(n==null)i=t*Br,r.point(-Ct,i),r.point(0,i),r.point(Ct,i),r.point(Ct,0),r.point(Ct,-i),r.point(0,-i),r.point(-Ct,-i),r.point(-Ct,0),r.point(-Ct,i);else if(Zt(n[0]-e[0])>Tt){var s=n[0]<e[0]?Ct:-Ct;i=t*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(e[0],e[1])}function oM(n){var e=ft(n),t=2*ut,r=e>0,i=Zt(e)>Tt;function s(p,g,v,x){eM(x,n,t,v,p,g)}function o(p,g){return ft(p)*ft(g)>e}function a(p){var g,v,x,T,S;return{lineStart:function(){T=x=!1,S=1},point:function(R,C){var B=[R,C],D,F=o(R,C),I=r?F?0:f(R,C):F?f(R+(R<0?Ct:-Ct),C):0;if(!g&&(T=x=F)&&p.lineStart(),F!==x&&(D=c(g,B),(!D||d0(g,D)||d0(B,D))&&(B[2]=1)),F!==x)S=0,F?(p.lineStart(),D=c(B,g),p.point(D[0],D[1])):(D=c(g,B),p.point(D[0],D[1],2),p.lineEnd()),g=D;else if(i&&g&&r^F){var q;!(I&v)&&(q=c(B,g,!0))&&(S=0,r?(p.lineStart(),p.point(q[0][0],q[0][1]),p.point(q[1][0],q[1][1]),p.lineEnd()):(p.point(q[1][0],q[1][1]),p.lineEnd(),p.lineStart(),p.point(q[0][0],q[0][1],3)))}F&&(!g||!d0(g,B))&&p.point(B[0],B[1]),g=B,x=F,v=I},lineEnd:function(){x&&p.lineEnd(),g=null},clean:function(){return S|(T&&x)<<1}}}function c(p,g,v){var x=Sa(p),T=Sa(g),S=[1,0,0],R=Fl(x,T),C=fc(R,R),B=R[0],D=C-B*B;if(!D)return!v&&p;var F=e*C/D,I=-e*B/D,q=Fl(S,R),k=dc(S,F),G=dc(R,I);dd(k,G);var j=q,ee=fc(k,j),Q=fc(j,j),Y=ee*ee-Q*(fc(k,k)-1);if(!(Y<0)){var Z=Gs(Y),oe=dc(j,(-ee-Z)/Q);if(dd(oe,k),oe=Q0(oe),!v)return oe;var K=p[0],ae=g[0],he=p[1],be=g[1],ye;ae<K&&(ye=K,K=ae,ae=ye);var Be=ae-K,ke=Zt(Be-Ct)<Tt,Xe=ke||Be<Tt;if(!ke&&be<he&&(ye=he,he=be,be=ye),Xe?ke?he+be>0^oe[1]<(Zt(oe[0]-K)<Tt?he:be):he<=oe[1]&&oe[1]<=be:Be>Ct^(K<=oe[0]&&oe[0]<=ae)){var Qe=dc(j,(-ee+Z)/Q);return dd(Qe,k),[oe,Q0(Qe)]}}}function f(p,g){var v=r?n:Ct-n,x=0;return p<-v?x|=1:p>v&&(x|=2),g<-v?x|=4:g>v&&(x|=8),x}return jx(o,a,s,r?[0,-n]:[-Ct,n-Ct])}function aM(n,e,t,r,i,s){var o=n[0],a=n[1],c=e[0],f=e[1],p=0,g=1,v=c-o,x=f-a,T;if(T=t-o,!(!v&&T>0)){if(T/=v,v<0){if(T<p)return;T<g&&(g=T)}else if(v>0){if(T>g)return;T>p&&(p=T)}if(T=i-o,!(!v&&T<0)){if(T/=v,v<0){if(T>g)return;T>p&&(p=T)}else if(v>0){if(T<p)return;T<g&&(g=T)}if(T=r-a,!(!x&&T>0)){if(T/=x,x<0){if(T<p)return;T<g&&(g=T)}else if(x>0){if(T>g)return;T>p&&(p=T)}if(T=s-a,!(!x&&T<0)){if(T/=x,x<0){if(T>g)return;T>p&&(p=T)}else if(x>0){if(T<p)return;T<g&&(g=T)}return p>0&&(n[0]=o+p*v,n[1]=a+p*x),g<1&&(e[0]=o+g*v,e[1]=a+g*x),!0}}}}}var ku=1e9,mc=-ku;function lM(n,e,t,r){function i(f,p){return n<=f&&f<=t&&e<=p&&p<=r}function s(f,p,g,v){var x=0,T=0;if(f==null||(x=o(f,g))!==(T=o(p,g))||c(f,p)<0^g>0)do v.point(x===0||x===3?n:t,x>1?r:e);while((x=(x+g+4)%4)!==T);else v.point(p[0],p[1])}function o(f,p){return Zt(f[0]-n)<Tt?p>0?0:3:Zt(f[0]-t)<Tt?p>0?2:1:Zt(f[1]-e)<Tt?p>0?1:0:p>0?3:2}function a(f,p){return c(f.x,p.x)}function c(f,p){var g=o(f,1),v=o(p,1);return g!==v?g-v:g===0?p[1]-f[1]:g===1?f[0]-p[0]:g===2?f[1]-p[1]:p[0]-f[0]}return function(f){var p=f,g=Gx(),v,x,T,S,R,C,B,D,F,I,q,k={point:G,lineStart:Y,lineEnd:Z,polygonStart:ee,polygonEnd:Q};function G(K,ae){i(K,ae)&&p.point(K,ae)}function j(){for(var K=0,ae=0,he=x.length;ae<he;++ae)for(var be=x[ae],ye=1,Be=be.length,ke=be[0],Xe,Qe,Dt=ke[0],pt=ke[1];ye<Be;++ye)Xe=Dt,Qe=pt,ke=be[ye],Dt=ke[0],pt=ke[1],Qe<=r?pt>r&&(Dt-Xe)*(r-Qe)>(pt-Qe)*(n-Xe)&&++K:pt<=r&&(Dt-Xe)*(r-Qe)<(pt-Qe)*(n-Xe)&&--K;return K}function ee(){p=g,v=[],x=[],q=!0}function Q(){var K=j(),ae=q&&K,he=(v=uA(v)).length;(ae||he)&&(f.polygonStart(),ae&&(f.lineStart(),s(null,null,1,f),f.lineEnd()),he&&Vx(v,a,K,s,f),f.polygonEnd()),p=f,v=x=T=null}function Y(){k.point=oe,x&&x.push(T=[]),I=!0,F=!1,B=D=NaN}function Z(){v&&(oe(S,R),C&&F&&g.rejoin(),v.push(g.result())),k.point=G,F&&p.lineEnd()}function oe(K,ae){var he=i(K,ae);if(x&&T.push([K,ae]),I)S=K,R=ae,C=he,I=!1,he&&(p.lineStart(),p.point(K,ae));else if(he&&F)p.point(K,ae);else{var be=[B=Math.max(mc,Math.min(ku,B)),D=Math.max(mc,Math.min(ku,D))],ye=[K=Math.max(mc,Math.min(ku,K)),ae=Math.max(mc,Math.min(ku,ae))];aM(be,ye,n,e,t,r)?(F||(p.lineStart(),p.point(be[0],be[1])),p.point(ye[0],ye[1]),he||p.lineEnd(),q=!1):he&&(p.lineStart(),p.point(K,ae),q=!1)}B=K,D=ae,F=he}return k}}var am,lm,p0,m0,Il={sphere:Ar,point:Ar,lineStart:uM,lineEnd:Ar,polygonStart:Ar,polygonEnd:Ar};function uM(){Il.point=cM,Il.lineEnd=AM}function AM(){Il.point=Il.lineEnd=Ar}function cM(n,e){n*=ut,e*=ut,lm=n,p0=it(e),m0=ft(e),Il.point=hM}function hM(n,e){n*=ut,e*=ut;var t=it(e),r=ft(e),i=Zt(n-lm),s=ft(i),o=it(i),a=r*o,c=m0*t-p0*r*s,f=p0*t+m0*r*s;am.add(gi(Gs(a*a+c*c),f)),lm=n,p0=t,m0=r}function fM(n){return am=new Os,zh(n,Il),+am}var um=[null,null],dM={type:"LineString",coordinates:um};function No(n,e){return um[0]=n,um[1]=e,fM(dM)}var D_={Feature:function(n,e){return rh(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,r=-1,i=t.length;++r<i;)if(rh(t[r].geometry,e))return!0;return!1}},L_={Sphere:function(){return!0},Point:function(n,e){return O_(n.coordinates,e)},MultiPoint:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)if(O_(t[r],e))return!0;return!1},LineString:function(n,e){return F_(n.coordinates,e)},MultiLineString:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)if(F_(t[r],e))return!0;return!1},Polygon:function(n,e){return I_(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)if(I_(t[r],e))return!0;return!1},GeometryCollection:function(n,e){for(var t=n.geometries,r=-1,i=t.length;++r<i;)if(rh(t[r],e))return!0;return!1}};function rh(n,e){return n&&L_.hasOwnProperty(n.type)?L_[n.type](n,e):!1}function O_(n,e){return No(n,e)===0}function F_(n,e){for(var t,r,i,s=0,o=n.length;s<o;s++){if(r=No(n[s],e),r===0||s>0&&(i=No(n[s],n[s-1]),i>0&&t<=i&&r<=i&&(t+r-i)*(1-Math.pow((t-r)/i,2))<j0*i))return!0;t=r}return!1}function I_(n,e){return!!zx(n.map(pM),$x(e))}function pM(n){return n=n.map($x),n.pop(),n}function $x(n){return[n[0]*ut,n[1]*ut]}function mM(n,e){return(n&&D_.hasOwnProperty(n.type)?D_[n.type]:rh)(n,e)}function k_(n,e,t){var r=pl(n,e-Tt,t).concat(e);return function(i){return r.map(function(s){return[i,s]})}}function q_(n,e,t){var r=pl(n,e-Tt,t).concat(e);return function(i){return r.map(function(s){return[s,i]})}}function gM(){var n,e,t,r,i,s,o,a,c=10,f=c,p=90,g=360,v,x,T,S,R=2.5;function C(){return{type:"MultiLineString",coordinates:B()}}function B(){return pl(hc(r/p)*p,t,p).map(T).concat(pl(hc(a/g)*g,o,g).map(S)).concat(pl(hc(e/c)*c,n,c).filter(function(D){return Zt(D%p)>Tt}).map(v)).concat(pl(hc(s/f)*f,i,f).filter(function(D){return Zt(D%g)>Tt}).map(x))}return C.lines=function(){return B().map(function(D){return{type:"LineString",coordinates:D}})},C.outline=function(){return{type:"Polygon",coordinates:[T(r).concat(S(o).slice(1),T(t).reverse().slice(1),S(a).reverse().slice(1))]}},C.extent=function(D){return arguments.length?C.extentMajor(D).extentMinor(D):C.extentMinor()},C.extentMajor=function(D){return arguments.length?(r=+D[0][0],t=+D[1][0],a=+D[0][1],o=+D[1][1],r>t&&(D=r,r=t,t=D),a>o&&(D=a,a=o,o=D),C.precision(R)):[[r,a],[t,o]]},C.extentMinor=function(D){return arguments.length?(e=+D[0][0],n=+D[1][0],s=+D[0][1],i=+D[1][1],e>n&&(D=e,e=n,n=D),s>i&&(D=s,s=i,i=D),C.precision(R)):[[e,s],[n,i]]},C.step=function(D){return arguments.length?C.stepMajor(D).stepMinor(D):C.stepMinor()},C.stepMajor=function(D){return arguments.length?(p=+D[0],g=+D[1],C):[p,g]},C.stepMinor=function(D){return arguments.length?(c=+D[0],f=+D[1],C):[c,f]},C.precision=function(D){return arguments.length?(R=+D,v=k_(s,i,90),x=q_(e,n,R),T=k_(a,o,90),S=q_(r,t,R),C):R},C.extentMajor([[-180,-90+Tt],[180,90-Tt]]).extentMinor([[-180,-80-Tt],[180,80+Tt]])}function yM(){return gM()()}function zg(n,e){var t=n[0]*ut,r=n[1]*ut,i=e[0]*ut,s=e[1]*ut,o=ft(r),a=it(r),c=ft(s),f=it(s),p=o*ft(t),g=o*it(t),v=c*ft(i),x=c*it(i),T=2*Vs(Gs(m_(s-r)+o*c*m_(i-t))),S=it(T),R=T?function(C){var B=it(C*=T)/S,D=it(T-C)/S,F=D*p+B*v,I=D*g+B*x,q=D*a+B*f;return[gi(I,F)*xn,gi(q,Gs(F*F+I*I))*xn]}:function(){return[t*xn,r*xn]};return R.distance=T,R}const U_=n=>n;var kl=1/0,ih=kl,fA=-kl,sh=fA,G_={point:_M,lineStart:Ar,lineEnd:Ar,polygonStart:Ar,polygonEnd:Ar,result:function(){var n=[[kl,ih],[fA,sh]];return fA=sh=-(ih=kl=1/0),n}};function _M(n,e){n<kl&&(kl=n),n>fA&&(fA=n),e<ih&&(ih=e),e>sh&&(sh=e)}function jg(n){return function(e){var t=new Am;for(var r in n)t[r]=n[r];return t.stream=e,t}}function Am(){}Am.prototype={constructor:Am,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function $g(n,e,t){var r=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),r!=null&&n.clipExtent(null),zh(t,n.stream(G_)),e(G_.result()),r!=null&&n.clipExtent(r),n}function Hx(n,e,t){return $g(n,function(r){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+e[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+e[0][1]+(s-o*(r[1][1]+r[0][1]))/2;n.scale(150*o).translate([a,c])},t)}function vM(n,e,t){return Hx(n,[[0,0],e],t)}function bM(n,e,t){return $g(n,function(r){var i=+e,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];n.scale(150*s).translate([o,a])},t)}function xM(n,e,t){return $g(n,function(r){var i=+e,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;n.scale(150*s).translate([o,a])},t)}var V_=16,TM=ft(30*ut);function z_(n,e){return+e?SM(n,e):wM(n)}function wM(n){return jg({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function SM(n,e){function t(r,i,s,o,a,c,f,p,g,v,x,T,S,R){var C=f-r,B=p-i,D=C*C+B*B;if(D>4*e&&S--){var F=o+v,I=a+x,q=c+T,k=Gs(F*F+I*I+q*q),G=Vs(q/=k),j=Zt(Zt(q)-1)<Tt||Zt(s-g)<Tt?(s+g)/2:gi(I,F),ee=n(j,G),Q=ee[0],Y=ee[1],Z=Q-r,oe=Y-i,K=B*Z-C*oe;(K*K/D>e||Zt((C*Z+B*oe)/D-.5)>.3||o*v+a*x+c*T<TM)&&(t(r,i,s,o,a,c,Q,Y,j,F/=k,I/=k,q,S,R),R.point(Q,Y),t(Q,Y,j,F,I,q,f,p,g,v,x,T,S,R))}}return function(r){var i,s,o,a,c,f,p,g,v,x,T,S,R={point:C,lineStart:B,lineEnd:F,polygonStart:function(){r.polygonStart(),R.lineStart=I},polygonEnd:function(){r.polygonEnd(),R.lineStart=B}};function C(G,j){G=n(G,j),r.point(G[0],G[1])}function B(){g=NaN,R.point=D,r.lineStart()}function D(G,j){var ee=Sa([G,j]),Q=n(G,j);t(g,v,p,x,T,S,g=Q[0],v=Q[1],p=G,x=ee[0],T=ee[1],S=ee[2],V_,r),r.point(g,v)}function F(){R.point=C,r.lineEnd()}function I(){B(),R.point=q,R.lineEnd=k}function q(G,j){D(i=G,j),s=g,o=v,a=x,c=T,f=S,R.point=D}function k(){t(g,v,p,x,T,S,s,o,i,a,c,f,V_,r),R.lineEnd=F,F()}return R}}var EM=jg({point:function(n,e){this.stream.point(n*ut,e*ut)}});function RM(n){return jg({point:function(e,t){var r=n(e,t);return this.stream.point(r[0],r[1])}})}function NM(n,e,t,r,i){function s(o,a){return o*=r,a*=i,[e+n*o,t-n*a]}return s.invert=function(o,a){return[(o-e)/n*r,(t-a)/n*i]},s}function j_(n,e,t,r,i,s){if(!s)return NM(n,e,t,r,i);var o=ft(s),a=it(s),c=o*n,f=a*n,p=o/n,g=a/n,v=(a*t-o*e)/n,x=(a*e+o*t)/n;function T(S,R){return S*=r,R*=i,[c*S-f*R+e,t-f*S-c*R]}return T.invert=function(S,R){return[r*(p*S-g*R+v),i*(x-g*S-p*R)]},T}function CM(n){return MM(function(){return n})()}function MM(n){var e,t=150,r=480,i=250,s=0,o=0,a=0,c=0,f=0,p,g=0,v=1,x=1,T=null,S=B_,R=null,C,B,D,F=U_,I=.5,q,k,G,j,ee;function Q(K){return G(K[0]*ut,K[1]*ut)}function Y(K){return K=G.invert(K[0],K[1]),K&&[K[0]*xn,K[1]*xn]}Q.stream=function(K){return j&&ee===K?j:j=EM(RM(p)(S(q(F(ee=K)))))},Q.preclip=function(K){return arguments.length?(S=K,T=void 0,oe()):S},Q.postclip=function(K){return arguments.length?(F=K,R=C=B=D=null,oe()):F},Q.clipAngle=function(K){return arguments.length?(S=+K?oM(T=K*ut):(T=null,B_),oe()):T*xn},Q.clipExtent=function(K){return arguments.length?(F=K==null?(R=C=B=D=null,U_):lM(R=+K[0][0],C=+K[0][1],B=+K[1][0],D=+K[1][1]),oe()):R==null?null:[[R,C],[B,D]]},Q.scale=function(K){return arguments.length?(t=+K,Z()):t},Q.translate=function(K){return arguments.length?(r=+K[0],i=+K[1],Z()):[r,i]},Q.center=function(K){return arguments.length?(s=K[0]%360*ut,o=K[1]%360*ut,Z()):[s*xn,o*xn]},Q.rotate=function(K){return arguments.length?(a=K[0]%360*ut,c=K[1]%360*ut,f=K.length>2?K[2]%360*ut:0,Z()):[a*xn,c*xn,f*xn]},Q.angle=function(K){return arguments.length?(g=K%360*ut,Z()):g*xn},Q.reflectX=function(K){return arguments.length?(v=K?-1:1,Z()):v<0},Q.reflectY=function(K){return arguments.length?(x=K?-1:1,Z()):x<0},Q.precision=function(K){return arguments.length?(q=z_(k,I=K*K),oe()):Gs(I)},Q.fitExtent=function(K,ae){return Hx(Q,K,ae)},Q.fitSize=function(K,ae){return vM(Q,K,ae)},Q.fitWidth=function(K,ae){return bM(Q,K,ae)},Q.fitHeight=function(K,ae){return xM(Q,K,ae)};function Z(){var K=j_(t,0,0,v,x,g).apply(null,e(s,o)),ae=j_(t,r-K[0],i-K[1],v,x,g);return p=Ux(a,c,f),k=sm(e,ae),G=sm(p,k),q=z_(k,I),oe()}function oe(){return j=ee=null,Q}return function(){return e=n.apply(this,arguments),Q.invert=e.invert&&Y,Z()}}function PM(n){return function(e,t){var r=Gs(e*e+t*t),i=n(r),s=it(i),o=ft(i);return[gi(e*s,r*o),Vs(r&&t*s/r)]}}function Hg(n,e){return[n,k9(U9((Br+e)/2))]}Hg.invert=function(n,e){return[n,2*Gg(I9(e))-Br]};function Wx(n,e){var t=ft(e),r=1+ft(n)*t;return[t*it(n)/r,it(e)/r]}Wx.invert=PM(function(n){return 2*Gg(n)});function BM(){return CM(Wx).scale(250).clipAngle(142)}function cm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function DM(n){if(Array.isArray(n))return n}function LM(n){if(Array.isArray(n))return cm(n)}function Yu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function OM(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function FM(n,e,t){return e=oh(e),HM(n,Xx()?Reflect.construct(e,[],oh(n).constructor):e.apply(n,t))}function Qx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IM(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(n,e){return n.get(Yu(n,e))}function oo(n,e,t){Qx(n,e),e.set(n,t)}function ao(n,e,t){return n.set(Yu(n,e),t),t}function kM(n,e){Qx(n,e),e.add(n)}function qM(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Kx(r.key),r)}}function UM(n,e,t){return qM(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function ja(n,e,t){return(e=Kx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oh(n){return oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oh(n)}function GM(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&hm(n,e)}function Xx(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xx=function(){return!!n})()}function VM(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function zM(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function jM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $M(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HM(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OM(n)}function hm(n,e){return hm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},hm(n,e)}function g0(n,e){return DM(n)||zM(n,e)||Zx(n,e)||jM()}function Yx(n){return LM(n)||VM(n)||Zx(n)||$M()}function WM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function Kx(n){var e=WM(n,"string");return typeof e=="symbol"?e:e+""}function Zx(n,e){if(n){if(typeof n=="string")return cm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cm(n,e):void 0}}var Jx=function(e){e instanceof Array?e.forEach(Jx):(e.map&&e.map.dispose(),e.dispose())},e4=function(e){e.geometry&&e.geometry.dispose(),e.material&&Jx(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(e4)},$_=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),e4(t)}};function t4(n,e,t){var r=(90-n)*Math.PI/180,i=(90-e)*Math.PI/180;return{x:t*Math.sin(r)*Math.cos(i),y:t*Math.cos(r),z:t*Math.sin(r)*Math.sin(i)}}function QM(n){var e=n.x,t=n.y,r=n.z,i=Math.sqrt(e*e+t*t+r*r),s=Math.acos(t/i),o=Math.atan2(r,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),r:i}}function Wo(n){return n*Math.PI/180}var n4=function(e){return 1-(Hg(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},md=function(e){return Math.max(0,Math.min(1,n4(e)))},H_=function(e){return .5-Hg.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},XM=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=Us().domain([1,0]).range([t,r]).clamp(!0),s=Us().domain([md(t),md(r)]).range([1,0]).clamp(!0),o=function(g){return s(md(i(g)))},a=e.array,c=0,f=a.length;c<f;c+=2)a[c+1]=o(a[c+1]);e.needsUpdate=!0},W_=function(e,t,r,i){var s=Math.pow(2,e),o=Math.max(0,Math.min(s-1,Math.floor((r+180)*s/360))),a=(90-i)/180;t&&(a=Math.max(0,Math.min(1,n4(a))));var c=Math.floor(a*s);return[o,c]},fm=function(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=[],c=Math.pow(2,e),f=360/c,p=180/c,g=s===void 0?c-1:s,v=o===void 0?c-1:o,x=r,T=Math.min(c-1,g);x<=T;x++)for(var S=i,R=Math.min(c-1,v);S<=R;S++){var C=S,B=p;if(t){C=S===0?S:H_(S/c)*c;var D=S+1===c?S+1:H_((S+1)/c)*c;B=(D-C)*180/c}var F=-180+(x+.5)*f,I=90-(C*180/c+B/2),q=B;a.push({x,y:S,lng:F,lat:I,latLen:q})}return a},YM=6,KM=7,ZM=3,JM=90,Ji=new WeakMap,mo=new WeakMap,gd=new WeakMap,gc=new WeakMap,si=new WeakMap,ah=new WeakMap,El=new WeakMap,Qo=new WeakMap,yc=new WeakSet,eP=(function(n){function e(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.tileUrl,o=i.minLevel,a=o===void 0?0:o,c=i.maxLevel,f=c===void 0?17:c,p=i.mercatorProjection,g=p===void 0?!0:p;return IM(this,e),r=FM(this,e),kM(r,yc),oo(r,Ji,void 0),oo(r,mo,void 0),oo(r,gd,void 0),oo(r,gc,void 0),oo(r,si,{}),oo(r,ah,void 0),oo(r,El,void 0),oo(r,Qo,void 0),ja(r,"minLevel",void 0),ja(r,"maxLevel",void 0),ja(r,"thresholds",Yx(new Array(30)).map(function(v,x){return 8/Math.pow(2,x)})),ja(r,"curvatureResolution",5),ja(r,"tileMargin",0),ja(r,"clearTiles",function(){Object.values(bt(si,r)).forEach(function(v){v.forEach(function(x){x.obj&&(r.remove(x.obj),$_(x.obj),delete x.obj)})}),ao(si,r,{})}),ao(Ji,r,t),r.tileUrl=s,ao(mo,r,g),r.minLevel=a,r.maxLevel=f,r.level=0,r.add(ao(Qo,r,new hn(new Bo(bt(Ji,r)*.99,180,90),new ts({color:0})))),bt(Qo,r).visible=!1,bt(Qo,r).material.polygonOffset=!0,bt(Qo,r).material.polygonOffsetUnits=3,bt(Qo,r).material.polygonOffsetFactor=1,r}return GM(e,n),UM(e,[{key:"tileUrl",get:function(){return bt(gd,this)},set:function(r){ao(gd,this,r),this.updatePov(bt(El,this))}},{key:"level",get:function(){return bt(gc,this)},set:function(r){var i=this;bt(si,this)[r]||Yu(yc,this,tP).call(this,r);var s=bt(gc,this);if(ao(gc,this,r),!(r===s||s===void 0)){if(bt(Qo,this).visible=r>0,bt(si,this)[r].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!0)}),s<r&&bt(si,this)[s].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!1)}),s>r)for(var o=r+1;o<=s;o++)bt(si,this)[o]&&bt(si,this)[o].forEach(function(a){a.obj&&(i.remove(a.obj),$_(a.obj),delete a.obj)});Yu(yc,this,Q_).call(this)}}},{key:"updatePov",value:function(r){var i=this;if(!(!r||!(r instanceof fg))){ao(El,this,r);var s;if(ao(ah,this,function(p){if(!p.hullPnts){var g=360/Math.pow(2,i.level),v=p.lng,x=p.lat,T=p.latLen,S=v-g/2,R=v+g/2,C=x-T/2,B=x+T/2;p.hullPnts=[[x,v],[C,S],[B,S],[C,R],[B,R]].map(function(D){var F=g0(D,2),I=F[0],q=F[1];return t4(I,q,bt(Ji,i))}).map(function(D){var F=D.x,I=D.y,q=D.z;return new we(F,I,q)})}return s||(s=new yb,r.updateMatrix(),r.updateMatrixWorld(),s.setFromProjectionMatrix(new gn().multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse))),p.hullPnts.some(function(D){return s.containsPoint(D.clone().applyMatrix4(i.matrixWorld))})}),this.tileUrl){var o=r.position.clone(),a=o.distanceTo(this.getWorldPosition(new we)),c=(a-bt(Ji,this))/bt(Ji,this),f=this.thresholds.findIndex(function(p){return p&&p<=c});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,f<0?this.thresholds.length:f)),Yu(yc,this,Q_).call(this)}}}}])})(vs);function tP(n){var e=this;if(n>KM){bt(si,this)[n]=[];return}var t=bt(si,this)[n]=fm(n,bt(mo,this));t.forEach(function(r){return r.centroid=t4(r.lat,r.lng,bt(Ji,e))}),t.octree=dx().x(function(r){return r.centroid.x}).y(function(r){return r.centroid.y}).z(function(r){return r.centroid.z}).addAll(t)}function Q_(){var n=this;if(!(!this.tileUrl||this.level===void 0||!bt(si,this).hasOwnProperty(this.level))&&!(!bt(ah,this)&&this.level>YM)){var e=bt(si,this)[this.level];if(bt(El,this)){var t=this.worldToLocal(bt(El,this).position.clone());if(e.octree){var r,i=this.worldToLocal(bt(El,this).position.clone()),s=(i.length()-bt(Ji,this))*ZM;e=(r=e.octree).findAllWithinRadius.apply(r,Yx(i).concat([s]))}else{var o=QM(t),a=(o.r/bt(Ji,this)-1)*JM,c=a/Math.cos(Wo(o.lat)),f=[o.lng-c,o.lng+c],p=[o.lat+a,o.lat-a],g=W_(this.level,bt(mo,this),f[0],p[0]),v=g0(g,2),x=v[0],T=v[1],S=W_(this.level,bt(mo,this),f[1],p[1]),R=g0(S,2),C=R[0],B=R[1];!e.record&&(e.record={});var D=e.record;if(!D.hasOwnProperty("".concat(Math.round((x+C)/2),"_").concat(Math.round((T+B)/2))))e=fm(this.level,bt(mo,this),x,T,C,B).map(function(G){var j="".concat(G.x,"_").concat(G.y);return D.hasOwnProperty(j)?D[j]:(D[j]=G,e.push(G),G)});else{for(var F=[],I=x;I<=C;I++)for(var q=T;q<=B;q++){var k="".concat(I,"_").concat(q);D.hasOwnProperty(k)||(D[k]=fm(this.level,bt(mo,this),I,q,I,q)[0],e.push(D[k])),F.push(D[k])}e=F}}}e.filter(function(G){return!G.obj}).filter(bt(ah,this)||function(){return!0}).forEach(function(G){var j=G.x,ee=G.y,Q=G.lng,Y=G.lat,Z=G.latLen,oe=360/Math.pow(2,n.level);if(!G.obj){var K=oe*(1-n.tileMargin),ae=Z*(1-n.tileMargin),he=Wo(Q),be=Wo(-Y),ye=new hn(new Bo(bt(Ji,n),Math.ceil(K/n.curvatureResolution),Math.ceil(ae/n.curvatureResolution),Wo(90-K/2)+he,Wo(K),Wo(90-ae/2)+be,Wo(ae)),new Qs);if(bt(mo,n)){var Be=[Y+Z/2,Y-Z/2].map(function(Dt){return .5-Dt/180}),ke=g0(Be,2),Xe=ke[0],Qe=ke[1];XM(ye.geometry.attributes.uv,Xe,Qe)}G.obj=ye}G.loading||(G.loading=!0,new dg().load(n.tileUrl(j,ee,n.level),function(Dt){var pt=G.obj;pt&&(Dt.colorSpace=BA,pt.material.map=Dt,pt.material.color=null,pt.material.needsUpdate=!0,n.add(pt)),G.loading=!1}))})}}function nP(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=r4(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,f;if(r&&(s=aP(n,e,s,t)),n.length>80*t){a=n[0],c=n[1];let p=a,g=c;for(let v=t;v<i;v+=t){const x=n[v],T=n[v+1];x<a&&(a=x),T<c&&(c=T),x>p&&(p=x),T>g&&(g=T)}f=Math.max(p-a,g-c),f=f!==0?32767/f:0}return dA(s,o,t,a,c,f,0),o}function r4(n,e,t,r,i){let s;if(i===yP(n,e,t,r)>0)for(let o=e;o<t;o+=r)s=X_(o/r|0,n[o],n[o+1],s);else for(let o=t-r;o>=e;o-=r)s=X_(o/r|0,n[o],n[o+1],s);return s&&ql(s,s.next)&&(mA(s),s=s.next),s}function Ea(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(ql(t,t.next)||yn(t.prev,t,t.next)===0)){if(mA(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function dA(n,e,t,r,i,s,o){if(!n)return;!o&&s&&hP(n,r,i,s);let a=n;for(;n.prev!==n.next;){const c=n.prev,f=n.next;if(s?iP(n,r,i,s):rP(n)){e.push(c.i,n.i,f.i),mA(n),n=f.next,a=f.next;continue}if(n=f,n===a){o?o===1?(n=sP(Ea(n),e),dA(n,e,t,r,i,s,2)):o===2&&oP(n,e,t,r,i,s):dA(Ea(n),e,t,r,i,s,1);break}}}function rP(n){const e=n.prev,t=n,r=n.next;if(yn(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,c=t.y,f=r.y,p=Math.min(i,s,o),g=Math.min(a,c,f),v=Math.max(i,s,o),x=Math.max(a,c,f);let T=r.next;for(;T!==e;){if(T.x>=p&&T.x<=v&&T.y>=g&&T.y<=x&&qu(i,a,s,c,o,f,T.x,T.y)&&yn(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function iP(n,e,t,r){const i=n.prev,s=n,o=n.next;if(yn(i,s,o)>=0)return!1;const a=i.x,c=s.x,f=o.x,p=i.y,g=s.y,v=o.y,x=Math.min(a,c,f),T=Math.min(p,g,v),S=Math.max(a,c,f),R=Math.max(p,g,v),C=dm(x,T,e,t,r),B=dm(S,R,e,t,r);let D=n.prevZ,F=n.nextZ;for(;D&&D.z>=C&&F&&F.z<=B;){if(D.x>=x&&D.x<=S&&D.y>=T&&D.y<=R&&D!==i&&D!==o&&qu(a,p,c,g,f,v,D.x,D.y)&&yn(D.prev,D,D.next)>=0||(D=D.prevZ,F.x>=x&&F.x<=S&&F.y>=T&&F.y<=R&&F!==i&&F!==o&&qu(a,p,c,g,f,v,F.x,F.y)&&yn(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;D&&D.z>=C;){if(D.x>=x&&D.x<=S&&D.y>=T&&D.y<=R&&D!==i&&D!==o&&qu(a,p,c,g,f,v,D.x,D.y)&&yn(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;F&&F.z<=B;){if(F.x>=x&&F.x<=S&&F.y>=T&&F.y<=R&&F!==i&&F!==o&&qu(a,p,c,g,f,v,F.x,F.y)&&yn(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function sP(n,e){let t=n;do{const r=t.prev,i=t.next.next;!ql(r,i)&&s4(r,t,t.next,i)&&pA(r,i)&&pA(i,r)&&(e.push(r.i,t.i,i.i),mA(t),mA(t.next),t=n=i),t=t.next}while(t!==n);return Ea(t)}function oP(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&pP(o,a)){let c=o4(o,a);o=Ea(o,o.next),c=Ea(c,c.next),dA(o,e,t,r,i,s,0),dA(c,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function aP(n,e,t,r){const i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*r,c=s<o-1?e[s+1]*r:n.length,f=r4(n,a,c,r,!1);f===f.next&&(f.steiner=!0),i.push(dP(f))}i.sort(lP);for(let s=0;s<i.length;s++)t=uP(i[s],t);return t}function lP(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=r-i}return t}function uP(n,e){const t=AP(n,e);if(!t)return e;const r=o4(t,n);return Ea(r,r.next),Ea(t,t.next)}function AP(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,o;if(ql(n,t))return t;do{if(ql(n,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const g=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=r&&g>s&&(s=g,o=t.x<t.next.x?t:t.next,g===r))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,c=o.x,f=o.y;let p=1/0;t=o;do{if(r>=t.x&&t.x>=c&&r!==t.x&&i4(i<f?r:s,i,c,f,i<f?s:r,i,t.x,t.y)){const g=Math.abs(i-t.y)/(r-t.x);pA(t,n)&&(g<p||g===p&&(t.x>o.x||t.x===o.x&&cP(o,t)))&&(o=t,p=g)}t=t.next}while(t!==a);return o}function cP(n,e){return yn(n.prev,n,e.prev)<0&&yn(e.next,n,n.next)<0}function hP(n,e,t,r){let i=n;do i.z===0&&(i.z=dm(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,fP(i)}function fP(n){let e,t=1;do{let r=n,i;n=null;let s=null;for(e=0;r;){e++;let o=r,a=0;for(let f=0;f<t&&(a++,o=o.nextZ,!!o);f++);let c=t;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||r.z<=o.z)?(i=r,r=r.nextZ,a--):(i=o,o=o.nextZ,c--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=o}s.nextZ=null,t*=2}while(e>1);return n}function dm(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function dP(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function i4(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function qu(n,e,t,r,i,s,o,a){return!(n===o&&e===a)&&i4(n,e,t,r,i,s,o,a)}function pP(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!mP(n,e)&&(pA(n,e)&&pA(e,n)&&gP(n,e)&&(yn(n.prev,n,e.prev)||yn(n,e.prev,e))||ql(n,e)&&yn(n.prev,n,n.next)>0&&yn(e.prev,e,e.next)>0)}function yn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ql(n,e){return n.x===e.x&&n.y===e.y}function s4(n,e,t,r){const i=vc(yn(n,e,t)),s=vc(yn(n,e,r)),o=vc(yn(t,r,n)),a=vc(yn(t,r,e));return!!(i!==s&&o!==a||i===0&&_c(n,t,e)||s===0&&_c(n,r,e)||o===0&&_c(t,n,r)||a===0&&_c(t,e,r))}function _c(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function vc(n){return n>0?1:n<0?-1:0}function mP(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&s4(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function pA(n,e){return yn(n.prev,n,n.next)<0?yn(n,e,n.next)>=0&&yn(n,n.prev,e)>=0:yn(n,e,n.prev)<0||yn(n,n.next,e)<0}function gP(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function o4(n,e){const t=pm(n.i,n.x,n.y),r=pm(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function X_(n,e,t,r){const i=pm(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function mA(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function pm(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yP(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}function lh(n){const e=[],t=[],r=n[0][0].length;let i=0,s=0;for(const o of n){for(const a of o)for(let c=0;c<r;c++)e.push(a[c]);s&&(i+=s,t.push(i)),s=o.length}return{vertices:e,holes:t,dimensions:r}}function mm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function _P(n){if(Array.isArray(n))return n}function vP(n){if(Array.isArray(n))return mm(n)}function bP(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function xP(n,e,t){return e=uh(e),PP(n,a4()?Reflect.construct(e,[],uh(n).constructor):e.apply(n,t))}function TP(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function wP(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function SP(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Wg(n))||e){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return o=c.done,c},e:function(c){a=!0,s=c},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function uh(n){return uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uh(n)}function EP(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&gm(n,e)}function a4(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a4=function(){return!!n})()}function RP(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function NP(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function CP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PP(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bP(n)}function gm(n,e){return gm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},gm(n,e)}function fu(n,e){return _P(n)||NP(n,e)||Wg(n,e)||CP()}function BP(n){return vP(n)||RP(n)||Wg(n)||MP()}function Wg(n,e){if(n){if(typeof n=="string")return mm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?mm(n,e):void 0}}var Y_=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=[],i=null;return e.forEach(function(s){if(i){var o=No(s,i)*180/Math.PI;if(o>t)for(var a=zg(i,s),c=i.length>2||s.length>2?hA(i[2]||0,s[2]||0):null,f=c?function(v){return[].concat(BP(a(v)),[c(v)])}:a,p=1/Math.ceil(o/t),g=p;g<1;)r.push(f(g)),g+=p}r.push(i=s)}),r},ym=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:Zr,Float32BufferAttribute:fs},DP=new ym.BufferGeometry().setAttribute?"setAttribute":"addAttribute",l4=(function(n){function e(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;TP(this,e),r=xP(this,e),r.type="GeoJsonGeometry",r.parameters={geoJson:t,radius:i,resolution:s};var o=({Point:p,MultiPoint:g,LineString:v,MultiLineString:x,Polygon:T,MultiPolygon:S}[t.type]||function(){return[]})(t.coordinates,i),a=[],c=[],f=0;o.forEach(function(R){var C=a.length;du({indices:a,vertices:c},R),r.addGroup(C,a.length-C,f++)}),a.length&&r.setIndex(a),c.length&&r[DP]("position",new ym.Float32BufferAttribute(c,3));function p(R,C){var B=yd(R[1],R[0],C+(R[2]||0)),D=[];return[{vertices:B,indices:D}]}function g(R,C){var B={vertices:[],indices:[]};return R.map(function(D){return p(D,C)}).forEach(function(D){var F=fu(D,1),I=F[0];du(B,I)}),[B]}function v(R,C){for(var B=Y_(R,s).map(function(G){var j=fu(G,3),ee=j[0],Q=j[1],Y=j[2],Z=Y===void 0?0:Y;return yd(Q,ee,C+Z)}),D=lh([B]),F=D.vertices,I=Math.round(F.length/3),q=[],k=1;k<I;k++)q.push(k-1,k);return[{vertices:F,indices:q}]}function x(R,C){var B={vertices:[],indices:[]};return R.map(function(D){return v(D,C)}).forEach(function(D){var F=fu(D,1),I=F[0];du(B,I)}),[B]}function T(R,C){for(var B=R.map(function(K){return Y_(K,s).map(function(ae){var he=fu(ae,3),be=he[0],ye=he[1],Be=he[2],ke=Be===void 0?0:Be;return yd(ye,be,C+ke)})}),D=lh(B),F=D.vertices,I=D.holes,q=I[0]||1/0,k=F.slice(0,q*3),G=F.slice(q*3),j=new Set(I),ee=Math.round(F.length/3),Q=[],Y=[],Z=1;Z<ee;Z++)j.has(Z)||(Z<q?Q.push(Z-1,Z):Y.push(Z-1-q,Z-q));var oe=[{indices:Q,vertices:k}];return I.length&&oe.push({indices:Y,vertices:G}),oe}function S(R,C){var B={vertices:[],indices:[]},D={vertices:[],indices:[]};R.map(function(I){return T(I,C)}).forEach(function(I){var q=fu(I,2),k=q[0],G=q[1];du(B,k),G&&du(D,G)});var F=[B];return D.vertices.length&&F.push(D),F}return r}return EP(e,n),wP(e)})(ym.BufferGeometry);function du(n,e){var t=Math.round(n.vertices.length/3);K_(n.vertices,e.vertices),K_(n.indices,e.indices.map(function(r){return r+t}))}function K_(n,e){var t=SP(e),r;try{for(t.s();!(r=t.n()).done;){var i=r.value;n.push(i)}}catch(s){t.e(s)}finally{t.f()}}function yd(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=(90-n)*Math.PI/180,i=(90-e)*Math.PI/180;return[t*Math.sin(r)*Math.cos(i),t*Math.cos(r),t*Math.sin(r)*Math.sin(i)]}function LP(n,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!n.hasAttribute("position")||!n.hasAttribute("normal")||!n.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function r(o){if(o.normalized||o.isInterleavedBufferAttribute){const a=new Float32Array(o.count*o.itemSize);for(let c=0,f=0;c<o.count;c++)a[f++]=o.getX(c),a[f++]=o.getY(c),o.itemSize>2&&(a[f++]=o.getZ(c));return a}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const i=n.index?n.toNonIndexed():n,s=e.generateTangents(r(i.attributes.position),r(i.attributes.normal),r(i.attributes.uv));if(t)for(let o=3;o<s.length;o+=4)s[o]*=-1;return i.setAttribute("tangent",new Ii(s,4)),n!==i&&n.copy(i),n}function OP(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),i=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,c=new Zr;let f=0;for(let p=0;p<n.length;++p){const g=n[p];let v=0;if(t!==(g.index!==null))return null;for(const x in g.attributes){if(!r.has(x))return null;s[x]===void 0&&(s[x]=[]),s[x].push(g.attributes[x]),v++}if(v!==r.size||a!==g.morphTargetsRelative)return null;for(const x in g.morphAttributes){if(!i.has(x))return null;o[x]===void 0&&(o[x]=[]),o[x].push(g.morphAttributes[x])}if(e){let x;if(t)x=g.index.count;else if(g.attributes.position!==void 0)x=g.attributes.position.count;else return null;c.addGroup(f,x,p),f+=x}}if(t){let p=0;const g=[];for(let v=0;v<n.length;++v){const x=n[v].index;for(let T=0;T<x.count;++T)g.push(x.getX(T)+p);p+=n[v].attributes.position.count}c.setIndex(g)}for(const p in s){const g=_m(s[p]);if(!g)return null;c.setAttribute(p,g)}for(const p in o){const g=o[p][0].length;if(g===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[p]=[];for(let v=0;v<g;++v){const x=[];for(let S=0;S<o[p].length;++S)x.push(o[p][S][v]);const T=_m(x);if(!T)return null;c.morphAttributes[p].push(T)}}return c}function _m(n){let e,t,r,i=-1,s=0;for(let f=0;f<n.length;++f){const p=n[f];if(e===void 0&&(e=p.array.constructor),e!==p.array.constructor||(t===void 0&&(t=p.itemSize),t!==p.itemSize)||(r===void 0&&(r=p.normalized),r!==p.normalized)||(i===-1&&(i=p.gpuType),i!==p.gpuType))return null;s+=p.count*t}const o=new e(s),a=new Ii(o,t,r);let c=0;for(let f=0;f<n.length;++f){const p=n[f];if(p.isInterleavedBufferAttribute){const g=c/t;for(let v=0,x=p.count;v<x;v++)for(let T=0;T<t;T++){const S=p.getComponent(v,T);a.setComponent(v+g,T,S)}}else o.set(p.array,c);c+=p.count*t}return i!==void 0&&(a.gpuType=i),a}function FP(n){return n.isInstancedInterleavedBufferAttribute||n.isInterleavedBufferAttribute?Ah(n):n.isInstancedBufferAttribute?new xo().copy(n):new Ii().copy(n)}function IP(n){let e,t=0,r=0;for(let f=0,p=n.length;f<p;++f){const g=n[f];if(e===void 0&&(e=g.array.constructor),e!==g.array.constructor)return null;t+=g.array.length,r+=g.itemSize}const i=new _b(new e(t),r);let s=0;const o=[],a=["getX","getY","getZ","getW"],c=["setX","setY","setZ","setW"];for(let f=0,p=n.length;f<p;f++){const g=n[f],v=g.itemSize,x=g.count,T=new vo(i,v,s,g.normalized);o.push(T),s+=v;for(let S=0;S<x;S++)for(let R=0;R<v;R++)T[c[R]](S,g[a[R]](S))}return o}function Ah(n){const e=n.data.array.constructor,t=n.count,r=n.itemSize,i=n.normalized,s=new e(t*r);let o;n.isInstancedInterleavedBufferAttribute?o=new xo(s,r,i,n.meshPerAttribute):o=new Ii(s,r,i);for(let a=0;a<t;a++)o.setX(a,n.getX(a)),r>=2&&o.setY(a,n.getY(a)),r>=3&&o.setZ(a,n.getZ(a)),r>=4&&o.setW(a,n.getW(a));return o}function kP(n){const e=n.attributes,t=n.morphTargets,r=new Map;for(const i in e){const s=e[i];s.isInterleavedBufferAttribute&&(r.has(s)||r.set(s,Ah(s)),e[i]=r.get(s))}for(const i in t){const s=t[i];s.isInterleavedBufferAttribute&&(r.has(s)||r.set(s,Ah(s)),t[i]=r.get(s))}}function qP(n){let e=0;for(const r in n.attributes){const i=n.getAttribute(r);e+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const t=n.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function UP(n,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},r=n.getIndex(),i=n.getAttribute("position"),s=r?r.count:i.count;let o=0;const a=Object.keys(n.attributes),c={},f={},p=[],g=["getX","getY","getZ","getW"],v=["setX","setY","setZ","setW"];for(let B=0,D=a.length;B<D;B++){const F=a[B],I=n.attributes[F];c[F]=new I.constructor(new I.array.constructor(I.count*I.itemSize),I.itemSize,I.normalized);const q=n.morphAttributes[F];q&&(f[F]||(f[F]=[]),q.forEach((k,G)=>{const j=new k.array.constructor(k.count*k.itemSize);f[F][G]=new k.constructor(j,k.itemSize,k.normalized)}))}const x=e*.5,T=Math.log10(1/e),S=Math.pow(10,T),R=x*S;for(let B=0;B<s;B++){const D=r?r.getX(B):B;let F="";for(let I=0,q=a.length;I<q;I++){const k=a[I],G=n.getAttribute(k),j=G.itemSize;for(let ee=0;ee<j;ee++)F+=`${~~(G[g[ee]](D)*S+R)},`}if(F in t)p.push(t[F]);else{for(let I=0,q=a.length;I<q;I++){const k=a[I],G=n.getAttribute(k),j=n.morphAttributes[k],ee=G.itemSize,Q=c[k],Y=f[k];for(let Z=0;Z<ee;Z++){const oe=g[Z],K=v[Z];if(Q[K](o,G[oe](D)),j)for(let ae=0,he=j.length;ae<he;ae++)Y[ae][K](o,j[ae][oe](D))}}t[F]=o,p.push(o),o++}}const C=n.clone();for(const B in n.attributes){const D=c[B];if(C.setAttribute(B,new D.constructor(D.array.slice(0,o*D.itemSize),D.itemSize,D.normalized)),B in f)for(let F=0;F<f[B].length;F++){const I=f[B][F];C.morphAttributes[B][F]=new I.constructor(I.array.slice(0,o*I.itemSize),I.itemSize,I.normalized)}}return C.setIndex(p),C}function GP(n,e){if(e===GE)return n;if(e===Ly||e===VE){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}else return n}const r=t.count-2,i=[];if(e===Ly)for(let o=1;o<=r;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3;const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return n}function VP(n){const e=new we,t=new we,r=new we,i=new we,s=new we,o=new we,a=new we,c=new we,f=new we;function p(ye,Be,ke,Xe,Qe,Dt,pt,Pt){e.fromBufferAttribute(Be,Qe),t.fromBufferAttribute(Be,Dt),r.fromBufferAttribute(Be,pt);const zt=ye.morphTargetInfluences;if(ke&&zt){a.set(0,0,0),c.set(0,0,0),f.set(0,0,0);for(let Nn=0,In=ke.length;Nn<In;Nn++){const dn=zt[Nn],pn=ke[Nn];dn!==0&&(i.fromBufferAttribute(pn,Qe),s.fromBufferAttribute(pn,Dt),o.fromBufferAttribute(pn,pt),Xe?(a.addScaledVector(i,dn),c.addScaledVector(s,dn),f.addScaledVector(o,dn)):(a.addScaledVector(i.sub(e),dn),c.addScaledVector(s.sub(t),dn),f.addScaledVector(o.sub(r),dn)))}e.add(a),t.add(c),r.add(f)}ye.isSkinnedMesh&&(ye.applyBoneTransform(Qe,e),ye.applyBoneTransform(Dt,t),ye.applyBoneTransform(pt,r)),Pt[Qe*3+0]=e.x,Pt[Qe*3+1]=e.y,Pt[Qe*3+2]=e.z,Pt[Dt*3+0]=t.x,Pt[Dt*3+1]=t.y,Pt[Dt*3+2]=t.z,Pt[pt*3+0]=r.x,Pt[pt*3+1]=r.y,Pt[pt*3+2]=r.z}const g=n.geometry,v=n.material;let x,T,S;const R=g.index,C=g.attributes.position,B=g.morphAttributes.position,D=g.morphTargetsRelative,F=g.attributes.normal,I=g.morphAttributes.position,q=g.groups,k=g.drawRange;let G,j,ee,Q,Y,Z,oe;const K=new Float32Array(C.count*C.itemSize),ae=new Float32Array(F.count*F.itemSize);if(R!==null)if(Array.isArray(v))for(G=0,ee=q.length;G<ee;G++)for(Y=q[G],Z=Math.max(Y.start,k.start),oe=Math.min(Y.start+Y.count,k.start+k.count),j=Z,Q=oe;j<Q;j+=3)x=R.getX(j),T=R.getX(j+1),S=R.getX(j+2),p(n,C,B,D,x,T,S,K),p(n,F,I,D,x,T,S,ae);else for(Z=Math.max(0,k.start),oe=Math.min(R.count,k.start+k.count),G=Z,ee=oe;G<ee;G+=3)x=R.getX(G),T=R.getX(G+1),S=R.getX(G+2),p(n,C,B,D,x,T,S,K),p(n,F,I,D,x,T,S,ae);else if(Array.isArray(v))for(G=0,ee=q.length;G<ee;G++)for(Y=q[G],Z=Math.max(Y.start,k.start),oe=Math.min(Y.start+Y.count,k.start+k.count),j=Z,Q=oe;j<Q;j+=3)x=j,T=j+1,S=j+2,p(n,C,B,D,x,T,S,K),p(n,F,I,D,x,T,S,ae);else for(Z=Math.max(0,k.start),oe=Math.min(C.count,k.start+k.count),G=Z,ee=oe;G<ee;G+=3)x=G,T=G+1,S=G+2,p(n,C,B,D,x,T,S,K),p(n,F,I,D,x,T,S,ae);const he=new fs(K,3),be=new fs(ae,3);return{positionAttribute:C,normalAttribute:F,morphedPositionAttribute:he,morphedNormalAttribute:be}}function zP(n){if(n.groups.length===0)return n;let e=n.groups;if(e=e.sort((o,a)=>o.materialIndex!==a.materialIndex?o.materialIndex-a.materialIndex:o.start-a.start),n.getIndex()===null){const o=n.getAttribute("position"),a=[];for(let c=0;c<o.count;c+=3)a.push(c,c+1,c+2);n.setIndex(a)}const t=n.getIndex(),r=[];for(let o=0;o<e.length;o++){const a=e[o],c=a.start,f=c+a.count;for(let p=c;p<f;p++)r.push(t.getX(p))}n.dispose(),n.setIndex(r);let i=0;for(let o=0;o<e.length;o++){const a=e[o];a.start=i,i+=a.count}let s=e[0];n.groups=[s];for(let o=1;o<e.length;o++){const a=e[o];s.materialIndex===a.materialIndex?s.count+=a.count:(s=a,n.groups.push(s))}return n}function jP(n,e=Math.PI/3){const t=Math.cos(e),r=(1+1e-10)*100,i=[new we,new we,new we],s=new we,o=new we,a=new we,c=new we;function f(S){const R=~~(S.x*r),C=~~(S.y*r),B=~~(S.z*r);return`${R},${C},${B}`}const p=n.index?n.toNonIndexed():n,g=p.attributes.position,v={};for(let S=0,R=g.count/3;S<R;S++){const C=3*S,B=i[0].fromBufferAttribute(g,C+0),D=i[1].fromBufferAttribute(g,C+1),F=i[2].fromBufferAttribute(g,C+2);s.subVectors(F,D),o.subVectors(B,D);const I=new we().crossVectors(s,o).normalize();for(let q=0;q<3;q++){const k=i[q],G=f(k);G in v||(v[G]=[]),v[G].push(I)}}const x=new Float32Array(g.count*3),T=new Ii(x,3,!1);for(let S=0,R=g.count/3;S<R;S++){const C=3*S,B=i[0].fromBufferAttribute(g,C+0),D=i[1].fromBufferAttribute(g,C+1),F=i[2].fromBufferAttribute(g,C+2);s.subVectors(F,D),o.subVectors(B,D),a.crossVectors(s,o).normalize();for(let I=0;I<3;I++){const q=i[I],k=f(q),G=v[k];c.set(0,0,0);for(let j=0,ee=G.length;j<ee;j++){const Q=G[j];a.dot(Q)>t&&c.add(Q)}c.normalize(),T.setXYZ(C+I,c.x,c.y,c.z)}}return p.setAttribute("normal",T),p}const Qg=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:LP,computeMorphedAttributes:VP,deepCloneAttribute:FP,deinterleaveAttribute:Ah,deinterleaveGeometry:kP,estimateBytesUsed:qP,interleaveAttributes:IP,mergeAttributes:_m,mergeGeometries:OP,mergeGroups:zP,mergeVertices:UP,toCreasedNormals:jP,toTrianglesDrawMode:GP},Symbol.toStringTag,{value:"Module"}));var ve=(function(n){return typeof n=="function"?n:typeof n=="string"?function(e){return e[n]}:function(e){return n}});function ch(n){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(n)}var $P=/^\s+/,HP=/\s+$/;function He(n,e){if(n=n||"",e=e||{},n instanceof He)return n;if(!(this instanceof He))return new He(n,e);var t=WP(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}He.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,r,i,s,o,a;return t=e.r/255,r=e.g/255,i=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),i<=.03928?a=i/12.92:a=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=u4(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=J_(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=J_(this._r,this._g,this._b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+i+"%)":"hsva("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=Z_(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Z_(this._r,this._g,this._b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+i+"%)":"hsla("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return ev(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return KP(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(An(this._r,255)*100)+"%",g:Math.round(An(this._g,255)*100)+"%",b:Math.round(An(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(An(this._r,255)*100)+"%, "+Math.round(An(this._g,255)*100)+"%, "+Math.round(An(this._b,255)*100)+"%)":"rgba("+Math.round(An(this._r,255)*100)+"%, "+Math.round(An(this._g,255)*100)+"%, "+Math.round(An(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:uB[ev(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+tv(this._r,this._g,this._b,this._a),r=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var s=He(e);r="#"+tv(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,i=this._a<1&&this._a>=0,s=!t&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return He(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(tB,arguments)},brighten:function(){return this._applyModification(nB,arguments)},darken:function(){return this._applyModification(rB,arguments)},desaturate:function(){return this._applyModification(ZP,arguments)},saturate:function(){return this._applyModification(JP,arguments)},greyscale:function(){return this._applyModification(eB,arguments)},spin:function(){return this._applyModification(iB,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(aB,arguments)},complement:function(){return this._applyCombination(sB,arguments)},monochromatic:function(){return this._applyCombination(lB,arguments)},splitcomplement:function(){return this._applyCombination(oB,arguments)},triad:function(){return this._applyCombination(nv,[3])},tetrad:function(){return this._applyCombination(nv,[4])}};He.fromRatio=function(n,e){if(ch(n)=="object"){var t={};for(var r in n)n.hasOwnProperty(r)&&(r==="a"?t[r]=n[r]:t[r]=Uu(n[r]));n=t}return He(n,e)};function WP(n){var e={r:0,g:0,b:0},t=1,r=null,i=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=fB(n)),ch(n)=="object"&&(Es(n.r)&&Es(n.g)&&Es(n.b)?(e=QP(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):Es(n.h)&&Es(n.s)&&Es(n.v)?(r=Uu(n.s),i=Uu(n.v),e=YP(n.h,r,i),o=!0,a="hsv"):Es(n.h)&&Es(n.s)&&Es(n.l)&&(r=Uu(n.s),s=Uu(n.l),e=XP(n.h,r,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=u4(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function QP(n,e,t){return{r:An(n,255)*255,g:An(e,255)*255,b:An(t,255)*255}}function Z_(n,e,t){n=An(n,255),e=An(e,255),t=An(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),s,o,a=(r+i)/2;if(r==i)s=o=0;else{var c=r-i;switch(o=a>.5?c/(2-r-i):c/(r+i),r){case n:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-n)/c+2;break;case t:s=(n-e)/c+4;break}s/=6}return{h:s,s:o,l:a}}function XP(n,e,t){var r,i,s;n=An(n,360),e=An(e,100),t=An(t,100);function o(f,p,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?f+(p-f)*6*g:g<1/2?p:g<2/3?f+(p-f)*(2/3-g)*6:f}if(e===0)r=i=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=o(c,a,n+1/3),i=o(c,a,n),s=o(c,a,n-1/3)}return{r:r*255,g:i*255,b:s*255}}function J_(n,e,t){n=An(n,255),e=An(e,255),t=An(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),s,o,a=r,c=r-i;if(o=r===0?0:c/r,r==i)s=0;else{switch(r){case n:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-n)/c+2;break;case t:s=(n-e)/c+4;break}s/=6}return{h:s,s:o,v:a}}function YP(n,e,t){n=An(n,360)*6,e=An(e,100),t=An(t,100);var r=Math.floor(n),i=n-r,s=t*(1-e),o=t*(1-i*e),a=t*(1-(1-i)*e),c=r%6,f=[t,o,s,s,a,t][c],p=[a,t,t,o,s,s][c],g=[s,s,a,t,t,o][c];return{r:f*255,g:p*255,b:g*255}}function ev(n,e,t,r){var i=[Fi(Math.round(n).toString(16)),Fi(Math.round(e).toString(16)),Fi(Math.round(t).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function KP(n,e,t,r,i){var s=[Fi(Math.round(n).toString(16)),Fi(Math.round(e).toString(16)),Fi(Math.round(t).toString(16)),Fi(A4(r))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function tv(n,e,t,r){var i=[Fi(A4(r)),Fi(Math.round(n).toString(16)),Fi(Math.round(e).toString(16)),Fi(Math.round(t).toString(16))];return i.join("")}He.equals=function(n,e){return!n||!e?!1:He(n).toRgbString()==He(e).toRgbString()};He.random=function(){return He.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function ZP(n,e){e=e===0?0:e||10;var t=He(n).toHsl();return t.s-=e/100,t.s=jh(t.s),He(t)}function JP(n,e){e=e===0?0:e||10;var t=He(n).toHsl();return t.s+=e/100,t.s=jh(t.s),He(t)}function eB(n){return He(n).desaturate(100)}function tB(n,e){e=e===0?0:e||10;var t=He(n).toHsl();return t.l+=e/100,t.l=jh(t.l),He(t)}function nB(n,e){e=e===0?0:e||10;var t=He(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),He(t)}function rB(n,e){e=e===0?0:e||10;var t=He(n).toHsl();return t.l-=e/100,t.l=jh(t.l),He(t)}function iB(n,e){var t=He(n).toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,He(t)}function sB(n){var e=He(n).toHsl();return e.h=(e.h+180)%360,He(e)}function nv(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=He(n).toHsl(),r=[He(n)],i=360/e,s=1;s<e;s++)r.push(He({h:(t.h+s*i)%360,s:t.s,l:t.l}));return r}function oB(n){var e=He(n).toHsl(),t=e.h;return[He(n),He({h:(t+72)%360,s:e.s,l:e.l}),He({h:(t+216)%360,s:e.s,l:e.l})]}function aB(n,e,t){e=e||6,t=t||30;var r=He(n).toHsl(),i=360/t,s=[He(n)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,s.push(He(r));return s}function lB(n,e){e=e||6;for(var t=He(n).toHsv(),r=t.h,i=t.s,s=t.v,o=[],a=1/e;e--;)o.push(He({h:r,s:i,v:s})),s=(s+a)%1;return o}He.mix=function(n,e,t){t=t===0?0:t||50;var r=He(n).toRgb(),i=He(e).toRgb(),s=t/100,o={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return He(o)};He.readability=function(n,e){var t=He(n),r=He(e);return(Math.max(t.getLuminance(),r.getLuminance())+.05)/(Math.min(t.getLuminance(),r.getLuminance())+.05)};He.isReadable=function(n,e,t){var r=He.readability(n,e),i,s;switch(s=!1,i=dB(t),i.level+i.size){case"AAsmall":case"AAAlarge":s=r>=4.5;break;case"AAlarge":s=r>=3;break;case"AAAsmall":s=r>=7;break}return s};He.mostReadable=function(n,e,t){var r=null,i=0,s,o,a,c;t=t||{},o=t.includeFallbackColors,a=t.level,c=t.size;for(var f=0;f<e.length;f++)s=He.readability(n,e[f]),s>i&&(i=s,r=He(e[f]));return He.isReadable(n,r,{level:a,size:c})||!o?r:(t.includeFallbackColors=!1,He.mostReadable(n,["#fff","#000"],t))};var vm=He.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},uB=He.hexNames=AB(vm);function AB(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function u4(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function An(n,e){cB(n)&&(n="100%");var t=hB(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function jh(n){return Math.min(1,Math.max(0,n))}function Vr(n){return parseInt(n,16)}function cB(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function hB(n){return typeof n=="string"&&n.indexOf("%")!=-1}function Fi(n){return n.length==1?"0"+n:""+n}function Uu(n){return n<=1&&(n=n*100+"%"),n}function A4(n){return Math.round(parseFloat(n)*255).toString(16)}function rv(n){return Vr(n)/255}var Mi=(function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Es(n){return!!Mi.CSS_UNIT.exec(n)}function fB(n){n=n.replace($P,"").replace(HP,"").toLowerCase();var e=!1;if(vm[n])n=vm[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=Mi.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=Mi.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=Mi.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=Mi.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=Mi.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=Mi.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=Mi.hex8.exec(n))?{r:Vr(t[1]),g:Vr(t[2]),b:Vr(t[3]),a:rv(t[4]),format:e?"name":"hex8"}:(t=Mi.hex6.exec(n))?{r:Vr(t[1]),g:Vr(t[2]),b:Vr(t[3]),format:e?"name":"hex"}:(t=Mi.hex4.exec(n))?{r:Vr(t[1]+""+t[1]),g:Vr(t[2]+""+t[2]),b:Vr(t[3]+""+t[3]),a:rv(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=Mi.hex3.exec(n))?{r:Vr(t[1]+""+t[1]),g:Vr(t[2]+""+t[2]),b:Vr(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function dB(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function bm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function pB(n){if(Array.isArray(n))return n}function mB(n){if(Array.isArray(n))return bm(n)}function c4(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function gB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yB(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function ar(n,e){return n.get(c4(n,e))}function $a(n,e,t){gB(n,e),e.set(n,t)}function bc(n,e,t){return n.set(c4(n,e),t),t}function _B(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,NB(r.key),r)}}function vB(n,e,t){return e&&_B(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function bB(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function xB(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function TB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SB(n,e){return pB(n)||xB(n,e)||h4(n,e)||TB()}function EB(n){return mB(n)||bB(n)||h4(n)||wB()}function RB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function NB(n){var e=RB(n,"string");return typeof e=="symbol"?e:e+""}function h4(n,e){if(n){if(typeof n=="string")return bm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?bm(n,e):void 0}}var Ha=new WeakMap,pu=new WeakMap,Wa=new WeakMap,_d=new WeakMap,vd=new WeakMap,bd=new WeakMap,CB=(function(){function n(){yB(this,n),$a(this,Ha,new Map),$a(this,pu,new Map),$a(this,Wa,function(e){return e}),$a(this,_d,function(){return{}}),$a(this,vd,function(){}),$a(this,bd,function(){})}return vB(n,[{key:"getObj",value:function(t){return ar(Ha,this).get(ar(Wa,this).call(this,t))}},{key:"getData",value:function(t){return ar(pu,this).get(t)}},{key:"entries",value:function(){return EB(ar(pu,this).entries()).map(function(t){var r=SB(t,2),i=r[0],s=r[1];return[s,i]})}},{key:"id",value:function(t){return bc(Wa,this,ve(t)),this}},{key:"onCreateObj",value:function(t){return bc(_d,this,t),this}},{key:"onUpdateObj",value:function(t){return bc(vd,this,t),this}},{key:"onRemoveObj",value:function(t){return bc(bd,this,t),this}},{key:"digest",value:function(t){var r=this;t.filter(function(s){return!ar(Ha,r).has(ar(Wa,r).call(r,s))}).forEach(function(s){var o=ar(_d,r).call(r,s);ar(Ha,r).set(ar(Wa,r).call(r,s),o),ar(pu,r).set(o,s)});var i=new Map(t.map(function(s){return[ar(Wa,r).call(r,s),s]}));return ar(Ha,this).forEach(function(s,o){i.has(o)?ar(vd,r).call(r,s,i.get(o)):(ar(bd,r).call(r,s,o),ar(Ha,r).delete(o),ar(pu,r).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])})(),y0={exports:{}},MB=y0.exports,iv;function PB(){return iv||(iv=1,(function(n,e){(function(t,r){n.exports=r()})(MB,function(){return(function(t){function r(s){if(i[s])return i[s].exports;var o=i[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var i={};return r.m=t,r.c=i,r.p="",r(0)})([function(t,r,i){var s=i(1),o=(function(){function a(c,f,p){c===void 0&&(c=NaN),f===void 0&&(f=NaN),p===void 0&&(p=!1),this._minFPS=f,this._maxFPS=c,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,p||this.resume()}return a.prototype.updateOnce=function(c){c(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(c){this._timeScale!==c&&(this._timeScale=c)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var c=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return c.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(c,f){f===void 0&&(f=!0),this._currentTick++,this._currentTime+=c,this._tickDeltaTime=c,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),f&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a})();Object.defineProperty(r,"__esModule",{value:!0}),r.default=o},function(t,r,i){(function(s,o){t.exports=o()})(this,function(){return(function(s){function o(c){if(a[c])return a[c].exports;var f=a[c]={exports:{},id:c,loaded:!1};return s[c].call(f.exports,f,f.exports,o),f.loaded=!0,f.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)})([function(s,o){var a=(function(){function c(){this.functions=[]}return c.prototype.add=function(f){return this.functions.indexOf(f)===-1&&(this.functions.push(f),!0)},c.prototype.remove=function(f){var p=this.functions.indexOf(f);return p>-1&&(this.functions.splice(p,1),!0)},c.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},c.prototype.dispatch=function(){for(var f=[],p=0;p<arguments.length;p++)f[p]=arguments[p];var g=this.functions.concat();g.forEach(function(v){v.apply(void 0,f)})},Object.defineProperty(c.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),c})();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})})(y0)),y0.exports}var BB=PB();const Ul=zE(BB),Fs=11102230246251565e-32,lr=134217729,DB=(3+8*Fs)*Fs;function xd(n,e,t,r,i){let s,o,a,c,f=e[0],p=r[0],g=0,v=0;p>f==p>-f?(s=f,f=e[++g]):(s=p,p=r[++v]);let x=0;if(g<n&&v<t)for(p>f==p>-f?(o=f+s,a=s-(o-f),f=e[++g]):(o=p+s,a=s-(o-p),p=r[++v]),s=o,a!==0&&(i[x++]=a);g<n&&v<t;)p>f==p>-f?(o=s+f,c=o-s,a=s-(o-c)+(f-c),f=e[++g]):(o=s+p,c=o-s,a=s-(o-c)+(p-c),p=r[++v]),s=o,a!==0&&(i[x++]=a);for(;g<n;)o=s+f,c=o-s,a=s-(o-c)+(f-c),f=e[++g],s=o,a!==0&&(i[x++]=a);for(;v<t;)o=s+p,c=o-s,a=s-(o-c)+(p-c),p=r[++v],s=o,a!==0&&(i[x++]=a);return(s!==0||x===0)&&(i[x++]=s),x}function LB(n,e){let t=e[0];for(let r=1;r<n;r++)t+=e[r];return t}function FA(n){return new Float64Array(n)}const OB=(3+16*Fs)*Fs,FB=(2+12*Fs)*Fs,IB=(9+64*Fs)*Fs*Fs,Qa=FA(4),sv=FA(8),ov=FA(12),av=FA(16),yr=FA(4);function kB(n,e,t,r,i,s,o){let a,c,f,p,g,v,x,T,S,R,C,B,D,F,I,q,k,G;const j=n-i,ee=t-i,Q=e-s,Y=r-s;F=j*Y,v=lr*j,x=v-(v-j),T=j-x,v=lr*Y,S=v-(v-Y),R=Y-S,I=T*R-(F-x*S-T*S-x*R),q=Q*ee,v=lr*Q,x=v-(v-Q),T=Q-x,v=lr*ee,S=v-(v-ee),R=ee-S,k=T*R-(q-x*S-T*S-x*R),C=I-k,g=I-C,Qa[0]=I-(C+g)+(g-k),B=F+C,g=B-F,D=F-(B-g)+(C-g),C=D-q,g=D-C,Qa[1]=D-(C+g)+(g-q),G=B+C,g=G-B,Qa[2]=B-(G-g)+(C-g),Qa[3]=G;let Z=LB(4,Qa),oe=FB*o;if(Z>=oe||-Z>=oe||(g=n-j,a=n-(j+g)+(g-i),g=t-ee,f=t-(ee+g)+(g-i),g=e-Q,c=e-(Q+g)+(g-s),g=r-Y,p=r-(Y+g)+(g-s),a===0&&c===0&&f===0&&p===0)||(oe=IB*o+DB*Math.abs(Z),Z+=j*p+Y*a-(Q*f+ee*c),Z>=oe||-Z>=oe))return Z;F=a*Y,v=lr*a,x=v-(v-a),T=a-x,v=lr*Y,S=v-(v-Y),R=Y-S,I=T*R-(F-x*S-T*S-x*R),q=c*ee,v=lr*c,x=v-(v-c),T=c-x,v=lr*ee,S=v-(v-ee),R=ee-S,k=T*R-(q-x*S-T*S-x*R),C=I-k,g=I-C,yr[0]=I-(C+g)+(g-k),B=F+C,g=B-F,D=F-(B-g)+(C-g),C=D-q,g=D-C,yr[1]=D-(C+g)+(g-q),G=B+C,g=G-B,yr[2]=B-(G-g)+(C-g),yr[3]=G;const K=xd(4,Qa,4,yr,sv);F=j*p,v=lr*j,x=v-(v-j),T=j-x,v=lr*p,S=v-(v-p),R=p-S,I=T*R-(F-x*S-T*S-x*R),q=Q*f,v=lr*Q,x=v-(v-Q),T=Q-x,v=lr*f,S=v-(v-f),R=f-S,k=T*R-(q-x*S-T*S-x*R),C=I-k,g=I-C,yr[0]=I-(C+g)+(g-k),B=F+C,g=B-F,D=F-(B-g)+(C-g),C=D-q,g=D-C,yr[1]=D-(C+g)+(g-q),G=B+C,g=G-B,yr[2]=B-(G-g)+(C-g),yr[3]=G;const ae=xd(K,sv,4,yr,ov);F=a*p,v=lr*a,x=v-(v-a),T=a-x,v=lr*p,S=v-(v-p),R=p-S,I=T*R-(F-x*S-T*S-x*R),q=c*f,v=lr*c,x=v-(v-c),T=c-x,v=lr*f,S=v-(v-f),R=f-S,k=T*R-(q-x*S-T*S-x*R),C=I-k,g=I-C,yr[0]=I-(C+g)+(g-k),B=F+C,g=B-F,D=F-(B-g)+(C-g),C=D-q,g=D-C,yr[1]=D-(C+g)+(g-q),G=B+C,g=G-B,yr[2]=B-(G-g)+(C-g),yr[3]=G;const he=xd(ae,ov,4,yr,av);return av[he-1]}function Gu(n,e,t,r,i,s){const o=(e-s)*(t-i),a=(n-i)*(r-s),c=o-a,f=Math.abs(o+a);return Math.abs(c)>=OB*f?c:-kB(n,e,t,r,i,s,f)}const lv=Math.pow(2,-52),xc=new Uint32Array(512);class gA{static from(e,t=zB,r=jB){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=r(a)}return new gA(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*t-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:r,_hullTri:i,_hullHash:s}=this,o=e.length>>1;let a=1/0,c=1/0,f=-1/0,p=-1/0;for(let j=0;j<o;j++){const ee=e[2*j],Q=e[2*j+1];ee<a&&(a=ee),Q<c&&(c=Q),ee>f&&(f=ee),Q>p&&(p=Q),this._ids[j]=j}const g=(a+f)/2,v=(c+p)/2;let x,T,S;for(let j=0,ee=1/0;j<o;j++){const Q=Td(g,v,e[2*j],e[2*j+1]);Q<ee&&(x=j,ee=Q)}const R=e[2*x],C=e[2*x+1];for(let j=0,ee=1/0;j<o;j++){if(j===x)continue;const Q=Td(R,C,e[2*j],e[2*j+1]);Q<ee&&Q>0&&(T=j,ee=Q)}let B=e[2*T],D=e[2*T+1],F=1/0;for(let j=0;j<o;j++){if(j===x||j===T)continue;const ee=GB(R,C,B,D,e[2*j],e[2*j+1]);ee<F&&(S=j,F=ee)}let I=e[2*S],q=e[2*S+1];if(F===1/0){for(let Q=0;Q<o;Q++)this._dists[Q]=e[2*Q]-e[0]||e[2*Q+1]-e[1];gl(this._ids,this._dists,0,o-1);const j=new Uint32Array(o);let ee=0;for(let Q=0,Y=-1/0;Q<o;Q++){const Z=this._ids[Q],oe=this._dists[Z];oe>Y&&(j[ee++]=Z,Y=oe)}this.hull=j.subarray(0,ee),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Gu(R,C,B,D,I,q)<0){const j=T,ee=B,Q=D;T=S,B=I,D=q,S=j,I=ee,q=Q}const k=VB(R,C,B,D,I,q);this._cx=k.x,this._cy=k.y;for(let j=0;j<o;j++)this._dists[j]=Td(e[2*j],e[2*j+1],k.x,k.y);gl(this._ids,this._dists,0,o-1),this._hullStart=x;let G=3;r[x]=t[S]=T,r[T]=t[x]=S,r[S]=t[T]=x,i[x]=0,i[T]=1,i[S]=2,s.fill(-1),s[this._hashKey(R,C)]=x,s[this._hashKey(B,D)]=T,s[this._hashKey(I,q)]=S,this.trianglesLen=0,this._addTriangle(x,T,S,-1,-1,-1);for(let j=0,ee,Q;j<this._ids.length;j++){const Y=this._ids[j],Z=e[2*Y],oe=e[2*Y+1];if(j>0&&Math.abs(Z-ee)<=lv&&Math.abs(oe-Q)<=lv||(ee=Z,Q=oe,Y===x||Y===T||Y===S))continue;let K=0;for(let Be=0,ke=this._hashKey(Z,oe);Be<this._hashSize&&(K=s[(ke+Be)%this._hashSize],!(K!==-1&&K!==r[K]));Be++);K=t[K];let ae=K,he;for(;he=r[ae],Gu(Z,oe,e[2*ae],e[2*ae+1],e[2*he],e[2*he+1])>=0;)if(ae=he,ae===K){ae=-1;break}if(ae===-1)continue;let be=this._addTriangle(ae,Y,r[ae],-1,-1,i[ae]);i[Y]=this._legalize(be+2),i[ae]=be,G++;let ye=r[ae];for(;he=r[ye],Gu(Z,oe,e[2*ye],e[2*ye+1],e[2*he],e[2*he+1])<0;)be=this._addTriangle(ye,Y,he,i[Y],-1,i[ye]),i[Y]=this._legalize(be+2),r[ye]=ye,G--,ye=he;if(ae===K)for(;he=t[ae],Gu(Z,oe,e[2*he],e[2*he+1],e[2*ae],e[2*ae+1])<0;)be=this._addTriangle(he,Y,ae,-1,i[ae],i[he]),this._legalize(be+2),i[he]=be,r[ae]=ae,G--,ae=he;this._hullStart=t[Y]=ae,r[ae]=t[ye]=Y,r[Y]=ye,s[this._hashKey(Z,oe)]=Y,s[this._hashKey(e[2*ae],e[2*ae+1])]=ae}this.hull=new Uint32Array(G);for(let j=0,ee=this._hullStart;j<G;j++)this.hull[j]=ee,ee=r[ee];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(qB(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:r,coords:i}=this;let s=0,o=0;for(;;){const a=r[e],c=e-e%3;if(o=c+(e+2)%3,a===-1){if(s===0)break;e=xc[--s];continue}const f=a-a%3,p=c+(e+1)%3,g=f+(a+2)%3,v=t[o],x=t[e],T=t[p],S=t[g];if(UB(i[2*v],i[2*v+1],i[2*x],i[2*x+1],i[2*T],i[2*T+1],i[2*S],i[2*S+1])){t[e]=S,t[a]=v;const C=r[g];if(C===-1){let D=this._hullStart;do{if(this._hullTri[D]===g){this._hullTri[D]=e;break}D=this._hullPrev[D]}while(D!==this._hullStart)}this._link(e,C),this._link(a,r[o]),this._link(o,g);const B=f+(a+1)%3;s<xc.length&&(xc[s++]=B)}else{if(s===0)break;e=xc[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,r,i,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function qB(n,e){const t=n/(Math.abs(n)+Math.abs(e));return(e>0?3-t:1+t)/4}function Td(n,e,t,r){const i=n-t,s=e-r;return i*i+s*s}function UB(n,e,t,r,i,s,o,a){const c=n-o,f=e-a,p=t-o,g=r-a,v=i-o,x=s-a,T=c*c+f*f,S=p*p+g*g,R=v*v+x*x;return c*(g*R-S*x)-f*(p*R-S*v)+T*(p*x-g*v)<0}function GB(n,e,t,r,i,s){const o=t-n,a=r-e,c=i-n,f=s-e,p=o*o+a*a,g=c*c+f*f,v=.5/(o*f-a*c),x=(f*p-a*g)*v,T=(o*g-c*p)*v;return x*x+T*T}function VB(n,e,t,r,i,s){const o=t-n,a=r-e,c=i-n,f=s-e,p=o*o+a*a,g=c*c+f*f,v=.5/(o*f-a*c),x=n+(f*p-a*g)*v,T=e+(o*g-c*p)*v;return{x,y:T}}function gl(n,e,t,r){if(r-t<=20)for(let i=t+1;i<=r;i++){const s=n[i],o=e[s];let a=i-1;for(;a>=t&&e[n[a]]>o;)n[a+1]=n[a--];n[a+1]=s}else{const i=t+r>>1;let s=t+1,o=r;mu(n,i,s),e[n[t]]>e[n[r]]&&mu(n,t,r),e[n[s]]>e[n[r]]&&mu(n,s,r),e[n[t]]>e[n[s]]&&mu(n,t,s);const a=n[s],c=e[a];for(;;){do s++;while(e[n[s]]<c);do o--;while(e[n[o]]>c);if(o<s)break;mu(n,s,o)}n[t+1]=n[o],n[o]=a,r-s+1>=o-t?(gl(n,e,s,r),gl(n,e,t,o-1)):(gl(n,e,t,o-1),gl(n,e,s,r))}}function mu(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function zB(n){return n[0]}function jB(n){return n[1]}function $B(n,e){var t,r,i=0,s,o,a,c,f,p,g,v=n[0],x=n[1],T=e.length;for(t=0;t<T;t++){r=0;var S=e[t],R=S.length-1;if(p=S[0],p[0]!==S[R][0]&&p[1]!==S[R][1])throw new Error("First and last coordinates in a ring must be the same");for(o=p[0]-v,a=p[1]-x,r;r<R;r++){if(g=S[r+1],c=g[0]-v,f=g[1]-x,a===0&&f===0){if(c<=0&&o>=0||o<=0&&c>=0)return 0}else if(f>=0&&a<=0||f<=0&&a>=0){if(s=Gu(o,c,a,f,0,0),s===0)return 0;(s>0&&f>0&&a<=0||s<0&&f<=0&&a>0)&&i++}p=g,a=f,o=c}}return i%2!==0}function HB(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function WB(n){return n.type==="Feature"?n.geometry:n}function QB(n,e,t={}){if(!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");const r=HB(n),i=WB(e),s=i.type,o=e.bbox;let a=i.coordinates;if(o&&XB(r,o)===!1)return!1;s==="Polygon"&&(a=[a]);let c=!1;for(var f=0;f<a.length;++f){const p=$B(r,a[f]);if(p===0)return!t.ignoreBoundary;p&&(c=!0)}return c}function XB(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}var YB=QB;const uv=1e-6;class fa{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,r){e=+e,t=+t,r=+r;const i=e+r,s=t;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>uv||Math.abs(this._y1-s)>uv)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${e-r},${t}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(e,t,r,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class xm{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class KB{constructor(e,[t,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(t=+t))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=t,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:r},vectors:i}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let S=0,R=0,C=r.length,B,D;S<C;S+=3,R+=2){const F=r[S]*2,I=r[S+1]*2,q=r[S+2]*2,k=e[F],G=e[F+1],j=e[I],ee=e[I+1],Q=e[q],Y=e[q+1],Z=j-k,oe=ee-G,K=Q-k,ae=Y-G,he=(Z*ae-oe*K)*2;if(Math.abs(he)<1e-9){if(s===void 0){s=o=0;for(const ye of t)s+=e[ye*2],o+=e[ye*2+1];s/=t.length,o/=t.length}const be=1e9*Math.sign((s-k)*ae-(o-G)*K);B=(k+Q)/2-be*ae,D=(G+Y)/2+be*K}else{const be=1/he,ye=Z*Z+oe*oe,Be=K*K+ae*ae;B=k+(ae*ye-oe*Be)*be,D=G+(Z*Be-K*ye)*be}a[R]=B,a[R+1]=D}let c=t[t.length-1],f,p=c*4,g,v=e[2*c],x,T=e[2*c+1];i.fill(0);for(let S=0;S<t.length;++S)c=t[S],f=p,g=v,x=T,p=c*4,v=e[2*c],T=e[2*c+1],i[f+2]=i[p]=x-T,i[f+3]=i[p+1]=v-g}render(e){const t=e==null?e=new fa:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let p=0,g=r.length;p<g;++p){const v=r[p];if(v<p)continue;const x=Math.floor(p/3)*2,T=Math.floor(v/3)*2,S=o[x],R=o[x+1],C=o[T],B=o[T+1];this._renderSegment(S,R,C,B,e)}let c,f=s[s.length-1];for(let p=0;p<s.length;++p){c=f,f=s[p];const g=Math.floor(i[f]/3)*2,v=o[g],x=o[g+1],T=c*4,S=this._project(v,x,a[T+2],a[T+3]);S&&this._renderSegment(v,x,S[0],S[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new fa:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const r=t==null?t=new fa:void 0,i=this._clip(e);if(i===null||!i.length)return;t.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&t.lineTo(i[o],i[o+1]);return t.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,r=e.length/2;t<r;++t){const i=this.cellPolygon(t);i&&(i.index=t,yield i)}}cellPolygon(e){const t=new xm;return this.renderCell(e,t),t.value()}_renderSegment(e,t,r,i,s){let o;const a=this._regioncode(e,t),c=this._regioncode(r,i);a===0&&c===0?(s.moveTo(e,t),s.lineTo(r,i)):(o=this._clipSegment(e,t,r,i,a,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,r){return t=+t,t!==t||(r=+r,r!==r)?!1:this.delaunay._step(e,t,r)===e}*neighbors(e){const t=this._clip(e);if(t)for(const r of this.delaunay.neighbors(e)){const i=this._clip(r);if(i){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,c=i.length;a<c;a+=2)if(t[s]===i[a]&&t[s+1]===i[a+1]&&t[(s+2)%o]===i[(a+c-2)%c]&&t[(s+3)%o]===i[(a+c-1)%c]){yield r;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,o=r[e];if(o===-1)return null;const a=[];let c=o;do{const f=Math.floor(c/3);if(a.push(t[f*2],t[f*2+1]),c=c%3===2?c-2:c+1,s[c]!==e)break;c=i[c]}while(c!==o&&c!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:r}=this,i=e*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(e,t,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(e,t))}_clipFinite(e,t){const r=t.length;let i=null,s,o,a=t[r-2],c=t[r-1],f,p=this._regioncode(a,c),g,v=0;for(let x=0;x<r;x+=2)if(s=a,o=c,a=t[x],c=t[x+1],f=p,p=this._regioncode(a,c),f===0&&p===0)g=v,v=0,i?i.push(a,c):i=[a,c];else{let T,S,R,C,B;if(f===0){if((T=this._clipSegment(s,o,a,c,f,p))===null)continue;[S,R,C,B]=T}else{if((T=this._clipSegment(a,c,s,o,p,f))===null)continue;[C,B,S,R]=T,g=v,v=this._edgecode(S,R),g&&v&&this._edge(e,g,v,i,i.length),i?i.push(S,R):i=[S,R]}g=v,v=this._edgecode(C,B),g&&v&&this._edge(e,g,v,i,i.length),i?i.push(C,B):i=[C,B]}if(i)g=v,v=this._edgecode(i[0],i[1]),g&&v&&this._edge(e,g,v,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,t,r,i,s,o){const a=s<o;for(a&&([e,t,r,i,s,o]=[r,i,e,t,o,s]);;){if(s===0&&o===0)return a?[r,i,e,t]:[e,t,r,i];if(s&o)return null;let c,f,p=s||o;p&8?(c=e+(r-e)*(this.ymax-t)/(i-t),f=this.ymax):p&4?(c=e+(r-e)*(this.ymin-t)/(i-t),f=this.ymin):p&2?(f=t+(i-t)*(this.xmax-e)/(r-e),c=this.xmax):(f=t+(i-t)*(this.xmin-e)/(r-e),c=this.xmin),s?(e=c,t=f,s=this._regioncode(e,t)):(r=c,i=f,o=this._regioncode(r,i))}}_clipInfinite(e,t,r,i,s,o){let a=Array.from(t),c;if((c=this._project(a[0],a[1],r,i))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(c[0],c[1]),a=this._clipFinite(e,a))for(let f=0,p=a.length,g,v=this._edgecode(a[p-2],a[p-1]);f<p;f+=2)g=v,v=this._edgecode(a[f],a[f+1]),g&&v&&(f=this._edge(e,g,v,a,f),p=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,r,i,s){for(;t!==r;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(i[s]!==o||i[s+1]!==a)&&this.contains(e,o,a)&&(i.splice(s,0,o,a),s+=2)}return s}_project(e,t,r,i){let s=1/0,o,a,c;if(i<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/i)<s&&(c=this.ymin,a=e+(s=o)*r)}else if(i>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/i)<s&&(c=this.ymax,a=e+(s=o)*r)}if(r>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/r)<s&&(a=this.xmax,c=t+(s=o)*i)}else if(r<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/r)<s&&(a=this.xmin,c=t+(s=o)*i)}return[a,c]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const r=(t+2)%e.length,i=(t+4)%e.length;(e[t]===e[r]&&e[r]===e[i]||e[t+1]===e[r+1]&&e[r+1]===e[i+1])&&(e.splice(r,2),t-=2)}e.length||(e=null)}return e}}const ZB=2*Math.PI,Xa=Math.pow;function JB(n){return n[0]}function eD(n){return n[1]}function tD(n){const{triangles:e,coords:t}=n;for(let r=0;r<e.length;r+=3){const i=2*e[r],s=2*e[r+1],o=2*e[r+2];if((t[o]-t[i])*(t[s+1]-t[i+1])-(t[s]-t[i])*(t[o+1]-t[i+1])>1e-10)return!1}return!0}function nD(n,e,t){return[n+Math.sin(n+e)*t,e+Math.cos(n-e)*t]}class Xg{static from(e,t=JB,r=eD,i){return new Xg("length"in e?rD(e,t,r,i):Float64Array.from(iD(e,t,r,i)))}constructor(e){this._delaunator=new gA(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&tD(e)){this.collinear=Int32Array.from({length:t.length/2},(v,x)=>x).sort((v,x)=>t[2*v]-t[2*x]||t[2*v+1]-t[2*x+1]);const c=this.collinear[0],f=this.collinear[this.collinear.length-1],p=[t[2*c],t[2*c+1],t[2*f],t[2*f+1]],g=1e-8*Math.hypot(p[3]-p[1],p[2]-p[0]);for(let v=0,x=t.length/2;v<x;++v){const T=nD(t[2*v],t[2*v+1],g);t[2*v]=T[0],t[2*v+1]=T[1]}this._delaunator=new gA(t)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,f=r.length;c<f;++c){const p=s[c%3===2?c-2:c+1];(r[c]===-1||o[p]===-1)&&(o[p]=c)}for(let c=0,f=i.length;c<f;++c)a[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],o[i[0]]=1,i.length===2&&(o[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new KB(this,e)}*neighbors(e){const{inedges:t,hull:r,_hullIndex:i,halfedges:s,triangles:o,collinear:a}=this;if(a){const g=a.indexOf(e);g>0&&(yield a[g-1]),g<a.length-1&&(yield a[g+1]);return}const c=t[e];if(c===-1)return;let f=c,p=-1;do{if(yield p=o[f],f=f%3===2?f-2:f+1,o[f]!==e)return;if(f=s[f],f===-1){const g=r[(i[e]+1)%r.length];g!==p&&(yield g);return}}while(f!==c)}find(e,t,r=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const i=r;let s;for(;(s=this._step(r,e,t))>=0&&s!==r&&s!==i;)r=s;return s}_step(e,t,r){const{inedges:i,hull:s,_hullIndex:o,halfedges:a,triangles:c,points:f}=this;if(i[e]===-1||!f.length)return(e+1)%(f.length>>1);let p=e,g=Xa(t-f[e*2],2)+Xa(r-f[e*2+1],2);const v=i[e];let x=v;do{let T=c[x];const S=Xa(t-f[T*2],2)+Xa(r-f[T*2+1],2);if(S<g&&(g=S,p=T),x=x%3===2?x-2:x+1,c[x]!==e)break;if(x=a[x],x===-1){if(x=s[(o[e]+1)%s.length],x!==T&&Xa(t-f[x*2],2)+Xa(r-f[x*2+1],2)<g)return x;break}}while(x!==v);return p}render(e){const t=e==null?e=new fa:void 0,{points:r,halfedges:i,triangles:s}=this;for(let o=0,a=i.length;o<a;++o){const c=i[o];if(c<o)continue;const f=s[o]*2,p=s[c]*2;e.moveTo(r[f],r[f+1]),e.lineTo(r[p],r[p+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const r=e==null?e=new fa:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const a=i[s],c=i[s+1];e.moveTo(a+t,c),e.arc(a,c,t,0,ZB)}return r&&r.value()}renderHull(e){const t=e==null?e=new fa:void 0,{hull:r,points:i}=this,s=r[0]*2,o=r.length;e.moveTo(i[s],i[s+1]);for(let a=1;a<o;++a){const c=2*r[a];e.lineTo(i[c],i[c+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new xm;return this.renderHull(e),e.value()}renderTriangle(e,t){const r=t==null?t=new fa:void 0,{points:i,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,c=s[e+2]*2;return t.moveTo(i[o],i[o+1]),t.lineTo(i[a],i[a+1]),t.lineTo(i[c],i[c+1]),t.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,r=e.length/3;t<r;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new xm;return this.renderTriangle(e,t),t.value()}}function rD(n,e,t,r){const i=n.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const a=n[o];s[o*2]=e.call(r,a,o,n),s[o*2+1]=t.call(r,a,o,n)}return s}function*iD(n,e,t,r){let i=0;for(const s of n)yield e.call(r,s,i,n),yield t.call(r,s,i,n),++i}const Yg=Math.PI,Av=Yg/2,cv=180/Yg,hv=Yg/180,sD=Math.atan2,fv=Math.cos,oD=Math.max,aD=Math.min,dv=Math.sin,lD=Math.sign||function(n){return n>0?1:n<0?-1:0},f4=Math.sqrt;function uD(n){return n>1?Av:n<-1?-Av:Math.asin(n)}function d4(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function $r(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function hh(n,e){return[n[0]+e[0],n[1]+e[1],n[2]+e[2]]}function fh(n){var e=f4(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return[n[0]/e,n[1]/e,n[2]/e]}function Kg(n){return[sD(n[1],n[0])*cv,uD(oD(-1,aD(1,n[2])))*cv]}function as(n){const e=n[0]*hv,t=n[1]*hv,r=fv(t);return[r*fv(e),r*dv(e),dv(t)]}function Zg(n){return n=n.map(e=>as(e)),d4(n[0],$r(n[2],n[1]))}function AD(n){const e=hD(n),t=dD(e),r=fD(t,n),i=mD(t,n.length),s=cD(i,n),o=pD(t,n),{polygons:a,centers:c}=gD(o,t,n),f=yD(a),p=vD(t,n),g=_D(r,t);return{delaunay:e,edges:r,triangles:t,centers:c,neighbors:i,polygons:a,mesh:f,hull:p,urquhart:g,find:s}}function cD(n,e){function t(r,i){let s=r[0]-i[0],o=r[1]-i[1],a=r[2]-i[2];return s*s+o*o+a*a}return function(i,s,o){o===void 0&&(o=0);let a,c,f=o;const p=as([i,s]);do a=o,o=null,c=t(p,as(e[a])),n[a].forEach(g=>{let v=t(p,as(e[g]));if(v<c){c=v,o=g,f=g;return}});while(o!==null);return f}}function hD(n){if(n.length<2)return{};let e=0;for(;isNaN(n[e][0]+n[e][1])&&e++<n.length;);const t=J9(n[e]),r=BM().translate([0,0]).scale(1).rotate(t.invert([180,0]));n=n.map(r);const i=[];let s=1;for(let g=0,v=n.length;g<v;g++){let x=n[g][0]**2+n[g][1]**2;!isFinite(x)||x>1e32?i.push(g):x>s&&(s=x)}const o=1e6*f4(s);i.forEach(g=>n[g]=[o,0]),n.push([0,o]),n.push([-o,0]),n.push([0,-o]);const a=Xg.from(n);a.projection=r;const{triangles:c,halfedges:f,inedges:p}=a;for(let g=0,v=f.length;g<v;g++)if(f[g]<0){const x=g%3==2?g-2:g+1,T=g%3==0?g+2:g-1,S=f[x],R=f[T];f[S]=R,f[R]=S,f[x]=f[T]=-1,c[g]=c[x]=c[T]=e,p[c[S]]=S%3==0?S+2:S-1,p[c[R]]=R%3==0?R+2:R-1,g+=2-g%3}else c[g]>n.length-3-1&&(c[g]=e);return a}function fD(n,e){const t=new Set;return e.length===2?[[0,1]]:(n.forEach(r=>{if(r[0]!==r[1]&&!(Zg(r.map(i=>e[i]))<0))for(let i=0,s;i<3;i++)s=(i+1)%3,t.add(k0([r[i],r[s]]).join("-"))}),Array.from(t,r=>r.split("-").map(Number)))}function dD(n){const{triangles:e}=n;if(!e)return[];const t=[];for(let r=0,i=e.length/3;r<i;r++){const s=e[3*r],o=e[3*r+1],a=e[3*r+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function pD(n,e){return n.map(t=>{const r=t.map(s=>e[s]).map(as),i=hh(hh($r(r[1],r[0]),$r(r[2],r[1])),$r(r[0],r[2]));return Kg(fh(i))})}function mD(n,e){const t=[];return n.forEach(r=>{for(let i=0;i<3;i++){const s=r[i],o=r[(i+1)%3];t[s]=t[s]||[],t[s].push(o)}}),n.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function gD(n,e,t){const r=[],i=n.slice();if(e.length===0){if(t.length<2)return{polygons:r,centers:i};if(t.length===2){const a=as(t[0]),c=as(t[1]),f=fh(hh(a,c)),p=fh($r(a,c)),g=$r(f,p),v=[f,$r(f,g),$r($r(f,g),g),$r($r($r(f,g),g),g)].map(Kg).map(o);return r.push(v),r.push(v.slice().reverse()),{polygons:r,centers:i}}}e.forEach((a,c)=>{for(let f=0;f<3;f++){const p=a[f],g=a[(f+1)%3],v=a[(f+2)%3];r[p]=r[p]||[],r[p].push([g,v,c,[p,g,v]])}});const s=r.map(a=>{const c=[a[0][2]];let f=a[0][1];for(let p=1;p<a.length;p++)for(let g=0;g<a.length;g++)if(a[g][0]==f){f=a[g][1],c.push(a[g][2]);break}if(c.length>2)return c;if(c.length==2){const p=pv(t[a[0][3][0]],t[a[0][3][1]],i[c[0]]),g=pv(t[a[0][3][2]],t[a[0][3][0]],i[c[0]]),v=o(p),x=o(g);return[c[0],x,c[1],v]}});function o(a){let c=-1;return i.slice(e.length,1/0).forEach((f,p)=>{f[0]===a[0]&&f[1]===a[1]&&(c=p+e.length)}),c<0&&(c=i.length,i.push(a)),c}return{polygons:s,centers:i}}function pv(n,e,t){n=as(n),e=as(e),t=as(t);const r=lD(d4($r(e,n),t));return Kg(fh(hh(n,e)).map(i=>r*i))}function yD(n){const e=[];return n.forEach(t=>{if(!t)return;let r=t[t.length-1];for(let i of t)i>r&&e.push([r,i]),r=i}),e}function _D(n,e){return function(t){const r=new Map,i=new Map;return n.forEach((s,o)=>{const a=s.join("-");r.set(a,t[o]),i.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let c=0;c<3;c++){let f=k0([s[c],s[(c+1)%3]]).join("-");r.get(f)>o&&(o=r.get(f),a=f)}i.set(a,!1)}),n.map(s=>i.get(s.join("-")))}}function vD(n,e){const t=new Set,r=[];n.map(a=>{if(!(Zg(a.map(c=>e[c>e.length?0:c]))>1e-12))for(let c=0;c<3;c++){let f=[a[c],a[(c+1)%3]],p=`${f[0]}-${f[1]}`;t.has(p)?t.delete(p):t.add(`${f[1]}-${f[0]}`)}});const i=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),i.set(a[0],a[1]),s=a[0]}),s===void 0)return r;let o=s;do{r.push(o);let a=i.get(o);i.set(o,-1),o=a}while(o>-1&&o!==s);return r}function bD(n){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const r=e._data.map(i=>[e._vx(i),e._vy(i),i]).filter(i=>isFinite(i[0]+i[1]));e.points=r.map(i=>[i[0],i[1]]),e.valid=r.map(i=>i[2]),e.delaunay=AD(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return E_(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return E_(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const r={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((i,s)=>r.features.push({type:"Feature",geometry:i?{type:"Polygon",coordinates:[[...i,i[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&r.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),r},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((r,i)=>(r=r.map(s=>e.points[s]),r.center=e.delaunay.centers[i],r)).filter(r=>Zg(r)>0).map(r=>({type:"Feature",properties:{circumcenter:r.center},geometry:{type:"Polygon",coordinates:[[...r,r[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const r=e.delaunay.edges.map(s=>No(e.points[s[0]],e.points[s[1]])),i=e.delaunay.urquhart(r);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:r[o],urquhart:!!i[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(r=>[e.points[r[0]],e.points[r[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:r,polygons:i}=e.delaunay,s=[];for(const o of i)if(o)for(let a=o.length,c=o[a-1],f=o[0],p=0;p<a;c=f,f=o[++p])f>c&&s.push([r[c],r[f]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,r,i){if(e._found=e.delaunay.find(t,r,e._found),!i||No([t,r],e.points[e._found])<i)return e._found},e.hull=function(t){t!==void 0&&e(t);const r=e.delaunay.hull,i=e.points;return r.length===0?null:{type:"Polygon",coordinates:[[...r.map(s=>i[s]),i[r[0]]]]}},n?e(n):e}function Tm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function xD(n){if(Array.isArray(n))return n}function TD(n){if(Array.isArray(n))return Tm(n)}function wD(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function SD(n,e,t){return e=dh(e),DD(n,p4()?Reflect.construct(e,[],dh(n).constructor):e.apply(n,t))}function ED(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function RD(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function dh(n){return dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dh(n)}function ND(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&wm(n,e)}function p4(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p4=function(){return!!n})()}function CD(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function MD(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function PD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DD(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wD(n)}function wm(n,e){return wm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},wm(n,e)}function es(n,e){return xD(n)||MD(n,e)||m4(n,e)||PD()}function wd(n){return TD(n)||CD(n)||m4(n)||BD()}function m4(n,e){if(n){if(typeof n=="string")return Tm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Tm(n,e):void 0}}function LD(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.resolution,r=t===void 0?1/0:t,i=OD(n,r),s=uA(i),o=FD(n,r),a=[].concat(wd(s),wd(o)),c={type:"Polygon",coordinates:n},f=Fx(c),p=es(f,2),g=es(p[0],2),v=g[0],x=g[1],T=es(p[1],2),S=T[0],R=T[1],C=v>S||R>=89||x<=-89,B=[];if(C){var D=bD(a).triangles(),F=new Map(a.map(function(he,be){var ye=es(he,2),Be=ye[0],ke=ye[1];return["".concat(Be,"-").concat(ke),be]}));D.features.forEach(function(he){var be,ye=he.geometry.coordinates[0].slice(0,3).reverse(),Be=[];if(ye.forEach(function(Xe){var Qe=es(Xe,2),Dt=Qe[0],pt=Qe[1],Pt="".concat(Dt,"-").concat(pt);F.has(Pt)&&Be.push(F.get(Pt))}),Be.length===3){if(Be.some(function(Xe){return Xe<s.length})){var ke=he.properties.circumcenter;if(!Sm(ke,c,C))return}(be=B).push.apply(be,Be)}})}else if(o.length)for(var j=gA.from(a),ee=function(be){var ye,Be=[2,1,0].map(function(Qe){return j.triangles[be+Qe]}),ke=Be.map(function(Qe){return a[Qe]});if(Be.some(function(Qe){return Qe<s.length})){var Xe=[0,1].map(function(Qe){return HC(ke,function(Dt){return Dt[Qe]})});if(!Sm(Xe,c,C))return 1}(ye=B).push.apply(ye,wd(Be))},Q=0,Y=j.triangles.length;Q<Y;Q+=3)ee(Q);else{var I=lh(i),q=I.vertices,k=I.holes,G=k===void 0?[]:k;B=nP(q,G,2)}var Z=Us(k0(a,function(he){return he[0]}),[0,1]),oe=Us(k0(a,function(he){return he[1]}),[0,1]),K=a.map(function(he){var be=es(he,2),ye=be[0],Be=be[1];return[Z(ye),oe(Be)]}),ae={points:a,indices:B,uvs:K};return{contour:i,triangles:ae}}function OD(n,e){return n.map(function(t){var r=[],i;return t.forEach(function(s){if(i){var o=No(s,i)*180/Math.PI;if(o>e)for(var a=zg(i,s),c=1/Math.ceil(o/e),f=c;f<1;)r.push(a(f)),f+=c}r.push(i=s)}),r})}function FD(n,e){var t={type:"Polygon",coordinates:n},r=Fx(t),i=es(r,2),s=es(i[0],2),o=s[0],a=s[1],c=es(i[1],2),f=c[0],p=c[1];if(Math.min(Math.abs(f-o),Math.abs(p-a))<e)return[];var g=o>f||p>=89||a<=-89;return ID(e,{minLng:o,maxLng:f,minLat:a,maxLat:p}).filter(function(v){return Sm(v,t,g)})}function ID(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.minLng,r=e.maxLng,i=e.minLat,s=e.maxLat,o=Math.round(Math.pow(360/n,2)/Math.PI),a=(1+Math.sqrt(5))/2,c=function(C){return C/a*360%360-180},f=function(C){return Math.acos(2*C/o-1)/Math.PI*180-90},p=function(C){return o*(Math.cos((C+90)*Math.PI/180)+1)/2},g=[s!==void 0?Math.ceil(p(s)):0,i!==void 0?Math.floor(p(i)):o-1],v=t===void 0&&r===void 0?function(){return!0}:t===void 0?function(R){return R<=r}:r===void 0?function(R){return R>=t}:r>=t?function(R){return R>=t&&R<=r}:function(R){return R>=t||R<=r},x=[],T=g[0];T<=g[1];T++){var S=c(T);v(S)&&x.push([S,f(T)])}return x}function Sm(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?mM(e,n):YB(n,e)}var _0=window.THREE?window.THREE:{BufferGeometry:Zr,Float32BufferAttribute:fs},mv=new _0.BufferGeometry().setAttribute?"setAttribute":"addAttribute",Jg=(function(n){function e(t,r,i,s,o,a,c){var f;ED(this,e),f=SD(this,e),f.type="ConicPolygonGeometry",f.parameters={polygonGeoJson:t,bottomHeight:r,topHeight:i,closedBottom:s,closedTop:o,includeSides:a,curvatureResolution:c},r=r||0,i=i||1,s=s!==void 0?s:!0,o=o!==void 0?o:!0,a=a!==void 0?a:!0,c=c||5;var p=LD(t,{resolution:c}),g=p.contour,v=p.triangles,x=uA(v.uvs),T=[],S=[],R=[],C=0,B=function(k){var G=Math.round(T.length/3),j=R.length;T=T.concat(k.vertices),S=S.concat(k.uvs),R=R.concat(G?k.indices.map(function(ee){return ee+G}):k.indices),f.addGroup(j,R.length-j,C++)};a&&B(F()),s&&B(I(r,!1)),o&&B(I(i,!0)),f.setIndex(R),f[mv]("position",new _0.Float32BufferAttribute(T,3)),f[mv]("uv",new _0.Float32BufferAttribute(S,2)),f.computeVertexNormals();function D(q,k){var G=typeof k=="function"?k:function(){return k},j=q.map(function(ee){return ee.map(function(Q){var Y=es(Q,2),Z=Y[0],oe=Y[1];return kD(oe,Z,G(Z,oe))})});return lh(j)}function F(){for(var q=D(g,r),k=q.vertices,G=q.holes,j=D(g,i),ee=j.vertices,Q=uA([ee,k]),Y=Math.round(ee.length/3),Z=new Set(G),oe=0,K=[],ae=0;ae<Y;ae++){var he=ae+1;if(he===Y)he=oe;else if(Z.has(he)){var be=he;he=oe,oe=be}K.push(ae,ae+Y,he+Y),K.push(he+Y,he,ae)}for(var ye=[],Be=1;Be>=0;Be--)for(var ke=0;ke<Y;ke+=1)ye.push(ke/(Y-1),Be);return{indices:K,vertices:Q,uvs:ye}}function I(q){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:k?v.indices:v.indices.slice().reverse(),vertices:D([v.points],q).vertices,uvs:x}}return f}return ND(e,n),RD(e)})(_0.BufferGeometry);function kD(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=(90-n)*Math.PI/180,i=(90-e)*Math.PI/180;return[t*Math.sin(r)*Math.cos(i),t*Math.cos(r),t*Math.sin(r)*Math.sin(i)]}function Em(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function qD(n){if(Array.isArray(n))return n}function UD(n){if(Array.isArray(n))return Em(n)}function GD(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function VD(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function zD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $D(n,e){if(n==null)return{};var t,r,i=HD(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function HD(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.includes(r))continue;t[r]=n[r]}return t}function WD(n,e){return qD(n)||VD(n,e)||g4(n,e)||zD()}function QD(n){return UD(n)||GD(n)||g4(n)||jD()}function XD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function YD(n){var e=XD(n,"string");return typeof e=="symbol"?e:e+""}function g4(n,e){if(n){if(typeof n=="string")return Em(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Em(n,e):void 0}}var KD=(function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=n.reduce(function(a,c){var f=a,p=c;return i.forEach(function(g,v){var x=g.keyAccessor,T=g.isProp,S;if(T){var R=p,C=R[x],B=$D(R,[x].map(YD));S=C,p=B}else S=x(p,v);v+1<i.length?(f.hasOwnProperty(S)||(f[S]={}),f=f[S]):t?(f.hasOwnProperty(S)||(f[S]=[]),f[S].push(p)):f[S]=p}),a},{});t instanceof Function&&(function a(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;f===i.length?Object.keys(c).forEach(function(p){return c[p]=t(c[p])}):Object.values(c).forEach(function(p){return a(p,f+1)})})(s);var o=s;return r&&(o=[],(function a(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];f.length===i.length?o.push({keys:f,vals:c}):Object.entries(c).forEach(function(p){var g=WD(p,2),v=g[0],x=g[1];return a(x,[].concat(QD(f),[v]))})})(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o}),St=(function(n){n=n||{};var e=typeof n<"u"?n:{},t={},r;for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);var i="";function s(fe){return e.locateFile?e.locateFile(fe,i):i+fe}var o;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",o=function(_e,Le,Te){var u=new XMLHttpRequest;u.open("GET",_e,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status==200||u.status==0&&u.response){Le(u.response);return}var Et=Of(_e);if(Et){Le(Et.buffer);return}Te()},u.onerror=Te,u.send(null)};var a=e.print||(()=>{}).bind(console),c=e.printErr||(()=>{}).bind(console);for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);t=null,e.arguments&&e.arguments;var f=0,p=function(fe){f=fe},g=function(){return f},v=8;function x(fe,_e,Le,Te){switch(Le=Le||"i8",Le.charAt(Le.length-1)==="*"&&(Le="i32"),Le){case"i1":Y[fe>>0]=_e;break;case"i8":Y[fe>>0]=_e;break;case"i16":oe[fe>>1]=_e;break;case"i32":K[fe>>2]=_e;break;case"i64":Lf=[_e>>>0,(Da=_e,+kn(Da)>=1?Da>0?(Go(+Ks(Da/4294967296),4294967295)|0)>>>0:~~+qr((Da-+(~~Da>>>0))/4294967296)>>>0:0)],K[fe>>2]=Lf[0],K[fe+4>>2]=Lf[1];break;case"float":ae[fe>>2]=_e;break;case"double":he[fe>>3]=_e;break;default:La("invalid type for setValue: "+Le)}}function T(fe,_e,Le){switch(_e=_e||"i8",_e.charAt(_e.length-1)==="*"&&(_e="i32"),_e){case"i1":return Y[fe>>0];case"i8":return Y[fe>>0];case"i16":return oe[fe>>1];case"i32":return K[fe>>2];case"i64":return K[fe>>2];case"float":return ae[fe>>2];case"double":return he[fe>>3];default:La("invalid type for getValue: "+_e)}return null}var S=!1;function R(fe,_e){fe||La("Assertion failed: "+_e)}function C(fe){var _e=e["_"+fe];return R(_e,"Cannot call unknown function "+fe+", make sure it is exported"),_e}function B(fe,_e,Le,Te,u){var L={string:function(gt){var ti=0;if(gt!=null&&gt!==0){var JA=(gt.length<<2)+1;ti=I2(JA),G(gt,ti,JA)}return ti},array:function(gt){var ti=I2(gt.length);return j(gt,ti),ti}};function Et(gt){return _e==="string"?q(gt):_e==="boolean"?!!gt:gt}var kt=C(fe),jn=[],mt=0;if(Te)for(var Rt=0;Rt<Te.length;Rt++){var Js=L[Le[Rt]];Js?(mt===0&&(mt=$7()),jn[Rt]=Js(Te[Rt])):jn[Rt]=Te[Rt]}var Bt=kt.apply(null,jn);return Bt=Et(Bt),mt!==0&&j7(mt),Bt}function D(fe,_e,Le,Te){Le=Le||[];var u=Le.every(function(Et){return Et==="number"}),L=_e!=="string";return L&&u&&!Te?C(fe):function(){return B(fe,_e,Le,arguments)}}var F=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function I(fe,_e,Le){for(var Te=_e+Le,u=_e;fe[u]&&!(u>=Te);)++u;if(u-_e>16&&fe.subarray&&F)return F.decode(fe.subarray(_e,u));for(var L="";_e<u;){var Et=fe[_e++];if(!(Et&128)){L+=String.fromCharCode(Et);continue}var kt=fe[_e++]&63;if((Et&224)==192){L+=String.fromCharCode((Et&31)<<6|kt);continue}var jn=fe[_e++]&63;if((Et&240)==224?Et=(Et&15)<<12|kt<<6|jn:Et=(Et&7)<<18|kt<<12|jn<<6|fe[_e++]&63,Et<65536)L+=String.fromCharCode(Et);else{var mt=Et-65536;L+=String.fromCharCode(55296|mt>>10,56320|mt&1023)}}return L}function q(fe,_e){return fe?I(Z,fe,_e):""}function k(fe,_e,Le,Te){if(!(Te>0))return 0;for(var u=Le,L=Le+Te-1,Et=0;Et<fe.length;++Et){var kt=fe.charCodeAt(Et);if(kt>=55296&&kt<=57343){var jn=fe.charCodeAt(++Et);kt=65536+((kt&1023)<<10)|jn&1023}if(kt<=127){if(Le>=L)break;_e[Le++]=kt}else if(kt<=2047){if(Le+1>=L)break;_e[Le++]=192|kt>>6,_e[Le++]=128|kt&63}else if(kt<=65535){if(Le+2>=L)break;_e[Le++]=224|kt>>12,_e[Le++]=128|kt>>6&63,_e[Le++]=128|kt&63}else{if(Le+3>=L)break;_e[Le++]=240|kt>>18,_e[Le++]=128|kt>>12&63,_e[Le++]=128|kt>>6&63,_e[Le++]=128|kt&63}}return _e[Le]=0,Le-u}function G(fe,_e,Le){return k(fe,Z,_e,Le)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function j(fe,_e){Y.set(fe,_e)}function ee(fe,_e){return fe%_e>0&&(fe+=_e-fe%_e),fe}var Q,Y,Z,oe,K,ae,he;function be(fe){Q=fe,e.HEAP8=Y=new Int8Array(fe),e.HEAP16=oe=new Int16Array(fe),e.HEAP32=K=new Int32Array(fe),e.HEAPU8=Z=new Uint8Array(fe),e.HEAPU16=new Uint16Array(fe),e.HEAPU32=new Uint32Array(fe),e.HEAPF32=ae=new Float32Array(fe),e.HEAPF64=he=new Float64Array(fe)}var ye=5271520,Be=28608,ke=e.TOTAL_MEMORY||33554432;e.buffer?Q=e.buffer:Q=new ArrayBuffer(ke),ke=Q.byteLength,be(Q),K[Be>>2]=ye;function Xe(fe){for(;fe.length>0;){var _e=fe.shift();if(typeof _e=="function"){_e();continue}var Le=_e.func;typeof Le=="number"?_e.arg===void 0?e.dynCall_v(Le):e.dynCall_vi(Le,_e.arg):Le(_e.arg===void 0?null:_e.arg)}}var Qe=[],Dt=[],pt=[],Pt=[];function zt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)pn(e.preRun.shift());Xe(Qe)}function Nn(){Xe(Dt)}function In(){Xe(pt)}function dn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Cn(e.postRun.shift());Xe(Pt)}function pn(fe){Qe.unshift(fe)}function Cn(fe){Pt.unshift(fe)}var kn=Math.abs,qr=Math.ceil,Ks=Math.floor,Go=Math.min,ei=0,Si=null;function M7(fe){ei++,e.monitorRunDependencies&&e.monitorRunDependencies(ei)}function P7(fe){if(ei--,e.monitorRunDependencies&&e.monitorRunDependencies(ei),ei==0&&Si){var _e=Si;Si=null,_e()}}e.preloadedImages={},e.preloadedAudios={};var Zs=null,Df="data:application/octet-stream;base64,";function O2(fe){return String.prototype.startsWith?fe.startsWith(Df):fe.indexOf(Df)===0}var Da,Lf;Zs="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var B7=28624;function D7(fe,_e,Le,Te){La("Assertion failed: "+q(fe)+", at: "+[_e?q(_e):"unknown filename",Le,Te?q(Te):"unknown function"])}function F2(){return Y.length}function L7(fe,_e,Le){Z.set(Z.subarray(_e,_e+Le),fe)}function O7(fe){return e.___errno_location&&(K[e.___errno_location()>>2]=fe),fe}function F7(fe){La("OOM")}function I7(fe){try{var _e=new ArrayBuffer(fe);return _e.byteLength!=fe?void 0:(new Int8Array(_e).set(Y),z7(_e),be(_e),1)}catch{}}function k7(fe){var _e=F2(),Le=16777216,Te=2147483648-Le;if(fe>Te)return!1;for(var u=16777216,L=Math.max(_e,u);L<fe;)L<=536870912?L=ee(2*L,Le):L=Math.min(ee((3*L+2147483648)/4,Le),Te);var Et=I7(L);return!!Et}var q7=typeof atob=="function"?atob:function(fe){var _e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Le="",Te,u,L,Et,kt,jn,mt,Rt=0;fe=fe.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Et=_e.indexOf(fe.charAt(Rt++)),kt=_e.indexOf(fe.charAt(Rt++)),jn=_e.indexOf(fe.charAt(Rt++)),mt=_e.indexOf(fe.charAt(Rt++)),Te=Et<<2|kt>>4,u=(kt&15)<<4|jn>>2,L=(jn&3)<<6|mt,Le=Le+String.fromCharCode(Te),jn!==64&&(Le=Le+String.fromCharCode(u)),mt!==64&&(Le=Le+String.fromCharCode(L));while(Rt<fe.length);return Le};function U7(fe){try{for(var _e=q7(fe),Le=new Uint8Array(_e.length),Te=0;Te<_e.length;++Te)Le[Te]=_e.charCodeAt(Te);return Le}catch{throw new Error("Converting base64 string to bytes failed.")}}function Of(fe){if(O2(fe))return U7(fe.slice(Df.length))}var G7={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},V7={b:p,c:g,d:D7,e:O7,f:F2,g:L7,h:k7,i:F7,o:B7,p:Be},Se=(function(fe,_e,Le){"almost asm";var Te=new fe.Int8Array(Le),u=new fe.Int32Array(Le);new fe.Uint8Array(Le),new fe.Float32Array(Le);var L=new fe.Float64Array(Le),Et=_e.o|0,kt=_e.p|0,jn=fe.Math.floor,mt=fe.Math.abs,Rt=fe.Math.sqrt,Js=fe.Math.pow,Bt=fe.Math.cos,gt=fe.Math.sin,ti=fe.Math.tan,JA=fe.Math.acos,H7=fe.Math.asin,kf=fe.Math.atan,ni=fe.Math.atan2,Oa=fe.Math.ceil,Vi=fe.Math.imul,qf=fe.Math.min,W7=fe.Math.max,ws=fe.Math.clz32,at=_e.b,V=_e.c,et=_e.d,G2=_e.e,Q7=_e.f,X7=_e.g,Y7=_e.h,K7=_e.i,O=28640;function Z7(l){return Te=new Int8Array(l),u=new Int32Array(l),L=new Float64Array(l),Le=l,!0}function J7(l){l=l|0;var A=0;return A=O,O=O+l|0,O=O+15&-16,A|0}function eS(){return O|0}function tS(l){l=l|0,O=l}function nS(l,A){l=l|0,O=l}function rS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;return(l|0)<0?(A=2,A|0):(l|0)>13780509?(A=ic(15,A)|0,A|0):(h=((l|0)<0)<<31>>31,m=Hn(l|0,h|0,3,0)|0,d=V()|0,h=je(l|0,h|0,1,0)|0,h=Hn(m|0,d|0,h|0,V()|0)|0,h=je(h|0,V()|0,1,0)|0,l=V()|0,u[A>>2]=h,u[A+4>>2]=l,A=0,A|0)}function V2(l,A,h,d){return l=l|0,A=A|0,h=h|0,d=d|0,z2(l,A,h,d,0)|0}function z2(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0;if(w=O,O=O+16|0,_=w,!(j2(l,A,h,d,m)|0))return d=0,O=w,d|0;do if((h|0)>=0){if((h|0)>13780509){if(y=ic(15,_)|0,y|0)break;b=_,_=u[b>>2]|0,b=u[b+4>>2]|0}else y=((h|0)<0)<<31>>31,E=Hn(h|0,y|0,3,0)|0,b=V()|0,y=je(h|0,y|0,1,0)|0,y=Hn(E|0,b|0,y|0,V()|0)|0,y=je(y|0,V()|0,1,0)|0,b=V()|0,u[_>>2]=y,u[_+4>>2]=b,_=y;if(io(d|0,0,_<<3|0)|0,m|0){io(m|0,0,_<<2|0)|0,y=zi(l,A,h,d,m,_,b,0)|0;break}y=Rr(_,4)|0,y?(E=zi(l,A,h,d,y,_,b,0)|0,$e(y),y=E):y=13}else y=2;while(!1);return E=y,O=w,E|0}function j2(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0;if(te=O,O=O+16|0,H=te,W=te+8|0,$=H,u[$>>2]=l,u[$+4>>2]=A,(h|0)<0)return W=2,O=te,W|0;if(y=d,u[y>>2]=l,u[y+4>>2]=A,y=(m|0)!=0,y&&(u[m>>2]=0),Qt(l,A)|0)return W=9,O=te,W|0;u[W>>2]=0;e:do if((h|0)>=1)if(y)for(M=1,E=0,U=0,$=1,y=l;;){if(!(E|U)){if(y=$n(y,A,4,W,H)|0,y|0)break e;if(A=H,y=u[A>>2]|0,A=u[A+4>>2]|0,Qt(y,A)|0){y=9;break e}}if(y=$n(y,A,u[26800+(U<<2)>>2]|0,W,H)|0,y|0)break e;if(A=H,y=u[A>>2]|0,A=u[A+4>>2]|0,l=d+(M<<3)|0,u[l>>2]=y,u[l+4>>2]=A,u[m+(M<<2)>>2]=$,l=E+1|0,_=(l|0)==($|0),b=U+1|0,w=(b|0)==6,Qt(y,A)|0){y=9;break e}if($=$+(w&_&1)|0,($|0)>(h|0)){y=0;break}else M=M+1|0,E=_?0:l,U=_?w?0:b:U}else for(M=1,E=0,U=0,$=1,y=l;;){if(!(E|U)){if(y=$n(y,A,4,W,H)|0,y|0)break e;if(A=H,y=u[A>>2]|0,A=u[A+4>>2]|0,Qt(y,A)|0){y=9;break e}}if(y=$n(y,A,u[26800+(U<<2)>>2]|0,W,H)|0,y|0)break e;if(A=H,y=u[A>>2]|0,A=u[A+4>>2]|0,l=d+(M<<3)|0,u[l>>2]=y,u[l+4>>2]=A,l=E+1|0,_=(l|0)==($|0),b=U+1|0,w=(b|0)==6,Qt(y,A)|0){y=9;break e}if($=$+(w&_&1)|0,($|0)>(h|0)){y=0;break}else M=M+1|0,E=_?0:l,U=_?w?0:b:U}else y=0;while(!1);return W=y,O=te,W|0}function zi(l,A,h,d,m,y,_,b){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0,_=_|0,b=b|0;var w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0;if(te=O,O=O+16|0,H=te+8|0,W=te,w=Ga(l|0,A|0,y|0,_|0)|0,M=V()|0,U=d+(w<<3)|0,se=U,ce=u[se>>2]|0,se=u[se+4>>2]|0,E=(ce|0)==(l|0)&(se|0)==(A|0),!((ce|0)==0&(se|0)==0|E))do w=je(w|0,M|0,1,0)|0,w=Ua(w|0,V()|0,y|0,_|0)|0,M=V()|0,U=d+(w<<3)|0,ce=U,se=u[ce>>2]|0,ce=u[ce+4>>2]|0,E=(se|0)==(l|0)&(ce|0)==(A|0);while(!((se|0)==0&(ce|0)==0|E));if(w=m+(w<<2)|0,E&&(u[w>>2]|0)<=(b|0)||(ce=U,u[ce>>2]=l,u[ce+4>>2]=A,u[w>>2]=b,(b|0)>=(h|0)))return ce=0,O=te,ce|0;switch(E=b+1|0,u[H>>2]=0,w=$n(l,A,2,H,W)|0,w|0){case 9:{$=9;break}case 0:{w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w||($=9);break}}e:do if(($|0)==9){switch(u[H>>2]=0,w=$n(l,A,3,H,W)|0,w|0){case 9:break;case 0:{if(w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w|0)break e;break}default:break e}switch(u[H>>2]=0,w=$n(l,A,1,H,W)|0,w|0){case 9:break;case 0:{if(w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w|0)break e;break}default:break e}switch(u[H>>2]=0,w=$n(l,A,5,H,W)|0,w|0){case 9:break;case 0:{if(w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w|0)break e;break}default:break e}switch(u[H>>2]=0,w=$n(l,A,4,H,W)|0,w|0){case 9:break;case 0:{if(w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w|0)break e;break}default:break e}switch(u[H>>2]=0,w=$n(l,A,6,H,W)|0,w|0){case 9:break;case 0:{if(w=W,w=zi(u[w>>2]|0,u[w+4>>2]|0,h,d,m,y,_,E)|0,w|0)break e;break}default:break e}return ce=0,O=te,ce|0}while(!1);return ce=w,O=te,ce|0}function $n(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0;if(h>>>0>6)return m=1,m|0;if(U=(u[d>>2]|0)%6|0,u[d>>2]=U,(U|0)>0){y=0;do h=jo(h)|0,y=y+1|0;while((y|0)<(u[d>>2]|0))}if(U=xe(l|0,A|0,45)|0,V()|0,M=U&127,M>>>0>121)return m=5,m|0;w=Er(l,A)|0,y=xe(l|0,A|0,52)|0,V()|0,y=y&15;e:do if(!y)E=8;else{for(;;){if(_=(15-y|0)*3|0,b=xe(l|0,A|0,_|0)|0,V()|0,b=b&7,(b|0)==7){A=5;break}if(W=(ri(y)|0)==0,y=y+-1|0,$=Ce(7,0,_|0)|0,A=A&~(V()|0),H=Ce(u[(W?432:16)+(b*28|0)+(h<<2)>>2]|0,0,_|0)|0,_=V()|0,h=u[(W?640:224)+(b*28|0)+(h<<2)>>2]|0,l=H|l&~$,A=_|A,!h){h=0;break e}if(!y){E=8;break e}}return A|0}while(!1);(E|0)==8&&(W=u[848+(M*28|0)+(h<<2)>>2]|0,H=Ce(W|0,0,45)|0,l=H|l,A=V()|0|A&-1040385,h=u[4272+(M*28|0)+(h<<2)>>2]|0,(W&127|0)==127&&(W=Ce(u[848+(M*28|0)+20>>2]|0,0,45)|0,A=V()|0|A&-1040385,h=u[4272+(M*28|0)+20>>2]|0,l=$o(W|l,A)|0,A=V()|0,u[d>>2]=(u[d>>2]|0)+1)),b=xe(l|0,A|0,45)|0,V()|0,b=b&127;e:do if(rn(b)|0){t:do if((Er(l,A)|0)==1){if((M|0)!=(b|0))if(Q2(b,u[7696+(M*28|0)>>2]|0)|0){l=ed(l,A)|0,_=1,A=V()|0;break}else et(27795,26864,533,26872);switch(w|0){case 3:{l=$o(l,A)|0,A=V()|0,u[d>>2]=(u[d>>2]|0)+1,_=0;break t}case 5:{l=ed(l,A)|0,A=V()|0,u[d>>2]=(u[d>>2]|0)+5,_=0;break t}case 0:return W=9,W|0;default:return W=1,W|0}}else _=0;while(!1);if((h|0)>0){y=0;do l=Jf(l,A)|0,A=V()|0,y=y+1|0;while((y|0)!=(h|0))}if((M|0)!=(b|0)){if(!(Gf(b)|0)){if((_|0)!=0|(Er(l,A)|0)!=5)break;u[d>>2]=(u[d>>2]|0)+1;break}switch(U&127){case 8:case 118:break e}(Er(l,A)|0)!=3&&(u[d>>2]=(u[d>>2]|0)+1)}}else if((h|0)>0){y=0;do l=$o(l,A)|0,A=V()|0,y=y+1|0;while((y|0)!=(h|0))}while(!1);return u[d>>2]=((u[d>>2]|0)+h|0)%6|0,W=m,u[W>>2]=l,u[W+4>>2]=A,W=0,W|0}function iS(l,A,h,d){return l=l|0,A=A|0,h=h|0,d=d|0,$2(l,A,h,d)|0?(io(d|0,0,h*48|0)|0,d=sS(l,A,h,d)|0,d|0):(d=0,d|0)}function $2(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0;if(W=O,O=O+16|0,$=W,H=W+8|0,U=$,u[U>>2]=l,u[U+4>>2]=A,(h|0)<0)return H=2,O=W,H|0;if(!h)return H=d,u[H>>2]=l,u[H+4>>2]=A,H=0,O=W,H|0;u[H>>2]=0;e:do if(Qt(l,A)|0)l=9;else{m=0,U=l;do{if(l=$n(U,A,4,H,$)|0,l|0)break e;if(A=$,U=u[A>>2]|0,A=u[A+4>>2]|0,m=m+1|0,Qt(U,A)|0){l=9;break e}}while((m|0)<(h|0));M=d,u[M>>2]=U,u[M+4>>2]=A,M=h+-1|0,E=0,l=1;do{if(m=26800+(E<<2)|0,(E|0)==5)for(_=u[m>>2]|0,y=0,m=l;;){if(l=$,l=$n(u[l>>2]|0,u[l+4>>2]|0,_,H,$)|0,l|0)break e;if((y|0)!=(M|0))if(w=$,b=u[w>>2]|0,w=u[w+4>>2]|0,l=d+(m<<3)|0,u[l>>2]=b,u[l+4>>2]=w,!(Qt(b,w)|0))l=m+1|0;else{l=9;break e}else l=m;if(y=y+1|0,(y|0)>=(h|0))break;m=l}else for(_=$,w=u[m>>2]|0,b=0,m=l,y=u[_>>2]|0,_=u[_+4>>2]|0;;){if(l=$n(y,_,w,H,$)|0,l|0)break e;if(_=$,y=u[_>>2]|0,_=u[_+4>>2]|0,l=d+(m<<3)|0,u[l>>2]=y,u[l+4>>2]=_,l=m+1|0,Qt(y,_)|0){l=9;break e}if(b=b+1|0,(b|0)>=(h|0))break;m=l}E=E+1|0}while(E>>>0<6);l=$,l=(U|0)==(u[l>>2]|0)&&(A|0)==(u[l+4>>2]|0)?0:9}while(!1);return H=l,O=W,H|0}function sS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;if(U=O,O=O+16|0,_=U,!h)return u[d>>2]=l,u[d+4>>2]=A,d=0,O=U,d|0;do if((h|0)>=0){if((h|0)>13780509){if(m=ic(15,_)|0,m|0)break;y=_,m=u[y>>2]|0,y=u[y+4>>2]|0}else m=((h|0)<0)<<31>>31,M=Hn(h|0,m|0,3,0)|0,y=V()|0,m=je(h|0,m|0,1,0)|0,m=Hn(M|0,y|0,m|0,V()|0)|0,m=je(m|0,V()|0,1,0)|0,y=V()|0,M=_,u[M>>2]=m,u[M+4>>2]=y;if(E=Rr(m,8)|0,!E)m=13;else{if(M=Rr(m,4)|0,!M){$e(E),m=13;break}if(m=zi(l,A,h,E,M,m,y,0)|0,m|0){$e(E),$e(M);break}if(A=u[_>>2]|0,_=u[_+4>>2]|0,(_|0)>0|(_|0)==0&A>>>0>0){m=0,b=0,w=0;do l=E+(b<<3)|0,y=u[l>>2]|0,l=u[l+4>>2]|0,!((y|0)==0&(l|0)==0)&&(u[M+(b<<2)>>2]|0)==(h|0)&&($=d+(m<<3)|0,u[$>>2]=y,u[$+4>>2]=l,m=m+1|0),b=je(b|0,w|0,1,0)|0,w=V()|0;while((w|0)<(_|0)|(w|0)==(_|0)&b>>>0<A>>>0)}$e(E),$e(M),m=0}}else m=2;while(!1);return $=m,O=U,$|0}function Uf(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0;for(b=O,O=O+16|0,y=b,_=b+8|0,m=(Qt(l,A)|0)==0,m=m?1:2;;){if(u[_>>2]=0,E=($n(l,A,m,_,y)|0)==0,w=y,E&((u[w>>2]|0)==(h|0)?(u[w+4>>2]|0)==(d|0):0)){l=4;break}if(m=m+1|0,m>>>0>=7){m=7,l=4;break}}return(l|0)==4?(O=b,m|0):0}function oS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0;if(b=O,O=O+48|0,m=b+16|0,y=b+8|0,_=b,h=uu(h)|0,h|0)return _=h,O=b,_|0;if(E=l,w=u[E+4>>2]|0,h=y,u[h>>2]=u[E>>2],u[h+4>>2]=w,_y(y,m),h=Z2(m,A,_)|0,!h){if(A=u[y>>2]|0,y=u[l+8>>2]|0,(y|0)>0){m=u[l+12>>2]|0,h=0;do A=(u[m+(h<<3)>>2]|0)+A|0,h=h+1|0;while((h|0)<(y|0))}h=_,m=u[h>>2]|0,h=u[h+4>>2]|0,y=((A|0)<0)<<31>>31,(h|0)<(y|0)|(h|0)==(y|0)&m>>>0<A>>>0?(h=_,u[h>>2]=A,u[h+4>>2]=y,h=y):A=m,w=je(A|0,h|0,12,0)|0,E=V()|0,h=_,u[h>>2]=w,u[h+4>>2]=E,h=d,u[h>>2]=w,u[h+4>>2]=E,h=0}return E=h,O=b,E|0}function H2(l,A,h,d,m,y,_){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0,_=_|0;var b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0,ze=0,Ee=0,dt=0,jt=0,At=0,$t=0,gr=0,Dy=0;if(jt=O,O=O+64|0,Ze=jt+48|0,ze=jt+32|0,Ee=jt+24|0,Re=jt+8|0,Ve=jt,w=u[l>>2]|0,(w|0)<=0)return dt=0,O=jt,dt|0;for(Fe=l+4|0,st=Ze+8|0,lt=ze+8|0,yt=Re+8|0,b=0,le=0;;){E=u[Fe>>2]|0,Ae=E+(le<<4)|0,u[Ze>>2]=u[Ae>>2],u[Ze+4>>2]=u[Ae+4>>2],u[Ze+8>>2]=u[Ae+8>>2],u[Ze+12>>2]=u[Ae+12>>2],(le|0)==(w+-1|0)?(u[ze>>2]=u[E>>2],u[ze+4>>2]=u[E+4>>2],u[ze+8>>2]=u[E+8>>2],u[ze+12>>2]=u[E+12>>2]):(Ae=E+(le+1<<4)|0,u[ze>>2]=u[Ae>>2],u[ze+4>>2]=u[Ae+4>>2],u[ze+8>>2]=u[Ae+8>>2],u[ze+12>>2]=u[Ae+12>>2]),w=yS(Ze,ze,d,Ee)|0;e:do if(w)E=0,b=w;else if(w=Ee,E=u[w>>2]|0,w=u[w+4>>2]|0,(w|0)>0|(w|0)==0&E>>>0>0){ce=0,Ae=0;t:for(;;){if($t=1/(+(E>>>0)+4294967296*+(w|0)),Dy=+L[Ze>>3],w=Kn(E|0,w|0,ce|0,Ae|0)|0,gr=+(w>>>0)+4294967296*+(V()|0),At=+(ce>>>0)+4294967296*+(Ae|0),L[Re>>3]=$t*(Dy*gr)+$t*(+L[ze>>3]*At),L[yt>>3]=$t*(+L[st>>3]*gr)+$t*(+L[lt>>3]*At),w=td(Re,d,Ve)|0,w|0){b=w;break}se=Ve,te=u[se>>2]|0,se=u[se+4>>2]|0,$=Ga(te|0,se|0,A|0,h|0)|0,M=V()|0,w=_+($<<3)|0,U=w,E=u[U>>2]|0,U=u[U+4>>2]|0;n:do if((E|0)==0&(U|0)==0)ne=w,dt=16;else for(H=0,W=0;;){if((H|0)>(h|0)|(H|0)==(h|0)&W>>>0>A>>>0){b=1;break t}if((E|0)==(te|0)&(U|0)==(se|0))break n;if(w=je($|0,M|0,1,0)|0,$=Ua(w|0,V()|0,A|0,h|0)|0,M=V()|0,W=je(W|0,H|0,1,0)|0,H=V()|0,w=_+($<<3)|0,U=w,E=u[U>>2]|0,U=u[U+4>>2]|0,(E|0)==0&(U|0)==0){ne=w,dt=16;break}}while(!1);if((dt|0)==16&&(dt=0,!((te|0)==0&(se|0)==0))&&(W=ne,u[W>>2]=te,u[W+4>>2]=se,W=y+(u[m>>2]<<3)|0,u[W>>2]=te,u[W+4>>2]=se,W=m,W=je(u[W>>2]|0,u[W+4>>2]|0,1,0)|0,te=V()|0,se=m,u[se>>2]=W,u[se+4>>2]=te),ce=je(ce|0,Ae|0,1,0)|0,Ae=V()|0,w=Ee,E=u[w>>2]|0,w=u[w+4>>2]|0,!((w|0)>(Ae|0)|(w|0)==(Ae|0)&E>>>0>ce>>>0)){E=1;break e}}E=0}else E=1;while(!1);if(le=le+1|0,!E){dt=21;break}if(w=u[l>>2]|0,(le|0)>=(w|0)){b=0,dt=21;break}}return(dt|0)==21?(O=jt,b|0):0}function aS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0,ze=0,Ee=0,dt=0,jt=0,At=0,$t=0,gr=0;if(gr=O,O=O+112|0,dt=gr+80|0,w=gr+72|0,jt=gr,At=gr+56|0,m=uu(h)|0,m|0)return $t=m,O=gr,$t|0;if(E=l+8|0,$t=ji((u[E>>2]<<5)+32|0)|0,!$t)return $t=13,O=gr,$t|0;if(ld(l,$t),m=uu(h)|0,!m){if(ze=l,Ee=u[ze+4>>2]|0,m=w,u[m>>2]=u[ze>>2],u[m+4>>2]=Ee,_y(w,dt),m=Z2(dt,A,jt)|0,m)ze=0,Ee=0;else{if(m=u[w>>2]|0,y=u[E>>2]|0,(y|0)>0){_=u[l+12>>2]|0,h=0;do m=(u[_+(h<<3)>>2]|0)+m|0,h=h+1|0;while((h|0)!=(y|0));h=m}else h=m;m=jt,y=u[m>>2]|0,m=u[m+4>>2]|0,_=((h|0)<0)<<31>>31,(m|0)<(_|0)|(m|0)==(_|0)&y>>>0<h>>>0?(m=jt,u[m>>2]=h,u[m+4>>2]=_,m=_):h=y,ze=je(h|0,m|0,12,0)|0,Ee=V()|0,m=jt,u[m>>2]=ze,u[m+4>>2]=Ee,m=0}if(!m){if(h=Rr(ze,8)|0,!h)return $e($t),$t=13,O=gr,$t|0;if(b=Rr(ze,8)|0,!b)return $e($t),$e(h),$t=13,O=gr,$t|0;yt=dt,u[yt>>2]=0,u[yt+4>>2]=0,yt=l,Ze=u[yt+4>>2]|0,m=w,u[m>>2]=u[yt>>2],u[m+4>>2]=Ze,m=H2(w,ze,Ee,A,dt,h,b)|0;e:do if(m)$e(h),$e(b),$e($t);else{t:do if((u[E>>2]|0)>0){for(_=l+12|0,y=0;m=H2((u[_>>2]|0)+(y<<3)|0,ze,Ee,A,dt,h,b)|0,y=y+1|0,!(m|0);)if((y|0)>=(u[E>>2]|0))break t;$e(h),$e(b),$e($t);break e}while(!1);(Ee|0)>0|(Ee|0)==0&ze>>>0>0&&io(b|0,0,ze<<3|0)|0,Ze=dt,yt=u[Ze+4>>2]|0;t:do if((yt|0)>0|(yt|0)==0&(u[Ze>>2]|0)>>>0>0){Fe=h,st=b,lt=h,yt=b,Ze=h,m=h,ne=h,Re=b,Ve=b,h=b;n:for(;;){for(se=0,ce=0,Ae=0,le=0,y=0,_=0;;){b=jt,w=b+56|0;do u[b>>2]=0,b=b+4|0;while((b|0)<(w|0));if(A=Fe+(se<<3)|0,E=u[A>>2]|0,A=u[A+4>>2]|0,j2(E,A,1,jt,0)|0){b=jt,w=b+56|0;do u[b>>2]=0,b=b+4|0;while((b|0)<(w|0));b=Rr(7,4)|0,b|0&&(zi(E,A,1,jt,b,7,0,0)|0,$e(b))}for(te=0;;){W=jt+(te<<3)|0,H=u[W>>2]|0,W=u[W+4>>2]|0;r:do if((H|0)==0&(W|0)==0)b=y,w=_;else{if(M=Ga(H|0,W|0,ze|0,Ee|0)|0,E=V()|0,b=d+(M<<3)|0,A=b,w=u[A>>2]|0,A=u[A+4>>2]|0,!((w|0)==0&(A|0)==0)){U=0,$=0;do{if((U|0)>(Ee|0)|(U|0)==(Ee|0)&$>>>0>ze>>>0)break n;if((w|0)==(H|0)&(A|0)==(W|0)){b=y,w=_;break r}b=je(M|0,E|0,1,0)|0,M=Ua(b|0,V()|0,ze|0,Ee|0)|0,E=V()|0,$=je($|0,U|0,1,0)|0,U=V()|0,b=d+(M<<3)|0,A=b,w=u[A>>2]|0,A=u[A+4>>2]|0}while(!((w|0)==0&(A|0)==0))}if((H|0)==0&(W|0)==0){b=y,w=_;break}Ho(H,W,At)|0,ud(l,$t,At)|0&&($=je(y|0,_|0,1,0)|0,_=V()|0,U=b,u[U>>2]=H,u[U+4>>2]=W,y=st+(y<<3)|0,u[y>>2]=H,u[y+4>>2]=W,y=$),b=y,w=_}while(!1);if(te=te+1|0,te>>>0>=7)break;y=b,_=w}if(se=je(se|0,ce|0,1,0)|0,ce=V()|0,Ae=je(Ae|0,le|0,1,0)|0,le=V()|0,_=dt,y=u[_>>2]|0,_=u[_+4>>2]|0,(le|0)<(_|0)|(le|0)==(_|0)&Ae>>>0<y>>>0)y=b,_=w;else break}if((_|0)>0|(_|0)==0&y>>>0>0){y=0,_=0;do le=Fe+(y<<3)|0,u[le>>2]=0,u[le+4>>2]=0,y=je(y|0,_|0,1,0)|0,_=V()|0,le=dt,Ae=u[le+4>>2]|0;while((_|0)<(Ae|0)|((_|0)==(Ae|0)?y>>>0<(u[le>>2]|0)>>>0:0))}if(le=dt,u[le>>2]=b,u[le+4>>2]=w,(w|0)>0|(w|0)==0&b>>>0>0)te=h,se=Ve,ce=Ze,Ae=Re,le=st,h=ne,Ve=m,Re=lt,ne=te,m=se,Ze=yt,yt=ce,lt=Ae,st=Fe,Fe=le;else break t}$e(lt),$e(yt),$e($t),m=1;break e}else m=b;while(!1);$e($t),$e(h),$e(m),m=0}while(!1);return $t=m,O=gr,$t|0}}return $e($t),$t=m,O=gr,$t|0}function lS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(M=O,O=O+176|0,w=M,(A|0)<1)return wy(h,0,0),E=0,O=M,E|0;for(b=l,b=xe(u[b>>2]|0,u[b+4>>2]|0,52)|0,V()|0,wy(h,(A|0)>6?A:6,b&15),b=0;d=l+(b<<3)|0,d=ka(u[d>>2]|0,u[d+4>>2]|0,w)|0,!(d|0);){if(d=u[w>>2]|0,(d|0)>0){_=0;do y=w+8+(_<<4)|0,_=_+1|0,d=w+8+(((_|0)%(d|0)|0)<<4)|0,m=FE(h,d,y)|0,m?Ry(h,m)|0:OE(h,y,d)|0,d=u[w>>2]|0;while((_|0)<(d|0))}if(b=b+1|0,(b|0)>=(A|0)){d=0,E=13;break}}return(E|0)==13?(O=M,d|0):(Sy(h),E=d,O=M,E|0)}function uS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;if(y=O,O=O+32|0,d=y,m=y+16|0,l=lS(l,A,m)|0,l|0)return h=l,O=y,h|0;if(u[h>>2]=0,u[h+4>>2]=0,u[h+8>>2]=0,l=Ey(m)|0,l|0)do{A=AE(h)|0;do cE(A,l)|0,_=l+16|0,u[d>>2]=u[_>>2],u[d+4>>2]=u[_+4>>2],u[d+8>>2]=u[_+8>>2],u[d+12>>2]=u[_+12>>2],Ry(m,l)|0,l=IE(m,d)|0;while((l|0)!=0);l=Ey(m)|0}while((l|0)!=0);return Sy(m),l=hE(h)|0,l?(py(h),_=l,O=y,_|0):(_=0,O=y,_|0)}function rn(l){return l=l|0,l>>>0>121?(l=0,l|0):(l=u[7696+(l*28|0)+16>>2]|0,l|0)}function Gf(l){return l=l|0,(l|0)==4|(l|0)==117|0}function W2(l){return l=l|0,u[11120+((u[l>>2]|0)*216|0)+((u[l+4>>2]|0)*72|0)+((u[l+8>>2]|0)*24|0)+(u[l+12>>2]<<3)>>2]|0}function AS(l){return l=l|0,u[11120+((u[l>>2]|0)*216|0)+((u[l+4>>2]|0)*72|0)+((u[l+8>>2]|0)*24|0)+(u[l+12>>2]<<3)+4>>2]|0}function cS(l,A){l=l|0,A=A|0,l=7696+(l*28|0)|0,u[A>>2]=u[l>>2],u[A+4>>2]=u[l+4>>2],u[A+8>>2]=u[l+8>>2],u[A+12>>2]=u[l+12>>2]}function hS(l,A){l=l|0,A=A|0;var h=0,d=0;if(A>>>0>20)return A=-1,A|0;do if((u[11120+(A*216|0)>>2]|0)!=(l|0))if((u[11120+(A*216|0)+8>>2]|0)!=(l|0))if((u[11120+(A*216|0)+16>>2]|0)!=(l|0))if((u[11120+(A*216|0)+24>>2]|0)!=(l|0))if((u[11120+(A*216|0)+32>>2]|0)!=(l|0))if((u[11120+(A*216|0)+40>>2]|0)!=(l|0))if((u[11120+(A*216|0)+48>>2]|0)!=(l|0))if((u[11120+(A*216|0)+56>>2]|0)!=(l|0))if((u[11120+(A*216|0)+64>>2]|0)!=(l|0))if((u[11120+(A*216|0)+72>>2]|0)!=(l|0))if((u[11120+(A*216|0)+80>>2]|0)!=(l|0))if((u[11120+(A*216|0)+88>>2]|0)!=(l|0))if((u[11120+(A*216|0)+96>>2]|0)!=(l|0))if((u[11120+(A*216|0)+104>>2]|0)!=(l|0))if((u[11120+(A*216|0)+112>>2]|0)!=(l|0))if((u[11120+(A*216|0)+120>>2]|0)!=(l|0))if((u[11120+(A*216|0)+128>>2]|0)!=(l|0))if((u[11120+(A*216|0)+136>>2]|0)==(l|0))l=2,h=1,d=2;else{if((u[11120+(A*216|0)+144>>2]|0)==(l|0)){l=0,h=2,d=0;break}if((u[11120+(A*216|0)+152>>2]|0)==(l|0)){l=0,h=2,d=1;break}if((u[11120+(A*216|0)+160>>2]|0)==(l|0)){l=0,h=2,d=2;break}if((u[11120+(A*216|0)+168>>2]|0)==(l|0)){l=1,h=2,d=0;break}if((u[11120+(A*216|0)+176>>2]|0)==(l|0)){l=1,h=2,d=1;break}if((u[11120+(A*216|0)+184>>2]|0)==(l|0)){l=1,h=2,d=2;break}if((u[11120+(A*216|0)+192>>2]|0)==(l|0)){l=2,h=2,d=0;break}if((u[11120+(A*216|0)+200>>2]|0)==(l|0)){l=2,h=2,d=1;break}if((u[11120+(A*216|0)+208>>2]|0)==(l|0)){l=2,h=2,d=2;break}else l=-1;return l|0}else l=2,h=1,d=1;else l=2,h=1,d=0;else l=1,h=1,d=2;else l=1,h=1,d=1;else l=1,h=1,d=0;else l=0,h=1,d=2;else l=0,h=1,d=1;else l=0,h=1,d=0;else l=2,h=0,d=2;else l=2,h=0,d=1;else l=2,h=0,d=0;else l=1,h=0,d=2;else l=1,h=0,d=1;else l=1,h=0,d=0;else l=0,h=0,d=2;else l=0,h=0,d=1;else l=0,h=0,d=0;while(!1);return A=u[11120+(A*216|0)+(h*72|0)+(l*24|0)+(d<<3)+4>>2]|0,A|0}function Q2(l,A){return l=l|0,A=A|0,(u[7696+(l*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(u[7696+(l*28|0)+24>>2]|0)==(A|0),A|0)}function Vf(l,A){return l=l|0,A=A|0,u[848+(l*28|0)+(A<<2)>>2]|0}function zf(l,A){return l=l|0,A=A|0,(u[848+(l*28|0)>>2]|0)==(A|0)?(A=0,A|0):(u[848+(l*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(u[848+(l*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(u[848+(l*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(u[848+(l*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(u[848+(l*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((u[848+(l*28|0)+24>>2]|0)==(A|0)?6:7)|0}function fS(){return 122}function dS(l){l=l|0;var A=0,h=0,d=0;A=0;do Ce(A|0,0,45)|0,d=V()|0|134225919,h=l+(A<<3)|0,u[h>>2]=-1,u[h+4>>2]=d,A=A+1|0;while((A|0)!=122);return 0}function pS(l){l=l|0;var A=0,h=0,d=0;return d=+L[l+16>>3],h=+L[l+24>>3],A=d-h,+(d<h?A+6.283185307179586:A)}function X2(l){return l=l|0,+L[l+16>>3]<+L[l+24>>3]|0}function mS(l){return l=l|0,+(+L[l>>3]-+L[l+8>>3])}function jf(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;return h=+L[A>>3],!(h>=+L[l+8>>3])||!(h<=+L[l>>3])?(A=0,A|0):(d=+L[l+16>>3],h=+L[l+24>>3],m=+L[A+8>>3],A=m>=h,l=m<=d&1,d<h?A&&(l=1):A||(l=0),A=(l|0)!=0,A|0)}function $f(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;return+L[l>>3]<+L[A+8>>3]||+L[l+8>>3]>+L[A>>3]?(d=0,d|0):(y=+L[l+16>>3],h=l+24|0,M=+L[h>>3],_=y<M,d=A+16|0,E=+L[d>>3],m=A+24|0,w=+L[m>>3],b=E<w,A=M-E<w-y,l=_?b|A?1:2:0,A=b?_?1:A?2:1:0,y=+Ur(y,l),y<+Ur(+L[m>>3],A)||(M=+Ur(+L[h>>3],l),M>+Ur(+L[d>>3],A))?(b=0,b|0):(b=1,b|0))}function gS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0;y=+L[l+16>>3],w=+L[l+24>>3],l=y<w,b=+L[A+16>>3],_=+L[A+24>>3],m=b<_,A=w-b<_-y,u[h>>2]=l?m|A?1:2:0,u[d>>2]=m?l?1:A?2:1:0}function Y2(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;return+L[l>>3]<+L[A>>3]||+L[l+8>>3]>+L[A+8>>3]?(d=0,d|0):(d=l+16|0,w=+L[d>>3],y=+L[l+24>>3],_=w<y,h=A+16|0,M=+L[h>>3],m=A+24|0,E=+L[m>>3],b=M<E,A=y-M<E-w,l=_?b|A?1:2:0,A=b?_?1:A?2:1:0,y=+Ur(y,l),y<=+Ur(+L[m>>3],A)?(M=+Ur(+L[d>>3],l),b=M>=+Ur(+L[h>>3],A),b|0):(b=0,b|0))}function K2(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0;m=O,O=O+176|0,d=m,u[d>>2]=4,b=+L[A>>3],L[d+8>>3]=b,y=+L[A+16>>3],L[d+16>>3]=y,L[d+24>>3]=b,b=+L[A+24>>3],L[d+32>>3]=b,_=+L[A+8>>3],L[d+40>>3]=_,L[d+48>>3]=b,L[d+56>>3]=_,L[d+64>>3]=y,A=d+72|0,h=A+96|0;do u[A>>2]=0,A=A+4|0;while((A|0)<(h|0));Va(l|0,d|0,168)|0,O=m}function Z2(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0;W=O,O=O+288|0,M=W+264|0,U=W+96|0,E=W,b=E,w=b+96|0;do u[b>>2]=0,b=b+4|0;while((b|0)<(w|0));return A=rd(A,E)|0,A|0?(H=A,O=W,H|0):(w=E,E=u[w>>2]|0,w=u[w+4>>2]|0,Ho(E,w,M)|0,ka(E,w,U)|0,_=+au(M,U+8|0),L[M>>3]=+L[l>>3],w=M+8|0,L[w>>3]=+L[l+16>>3],L[U>>3]=+L[l+8>>3],E=U+8|0,L[E>>3]=+L[l+24>>3],m=+au(M,U),se=+L[w>>3]-+L[E>>3],y=+mt(+se),te=+L[M>>3]-+L[U>>3],d=+mt(+te),!(se==0|te==0)&&(se=+Py(+y,+d),se=+Oa(+(m*m/+ac(+(se/+ac(+y,+d)),3)/(_*(_*2.59807621135)*.8))),L[Et>>3]=se,$=~~se>>>0,H=+mt(se)>=1?se>0?~~+qf(+jn(se/4294967296),4294967295)>>>0:~~+Oa((se-+(~~se>>>0))/4294967296)>>>0:0,(u[Et+4>>2]&2146435072|0)!=2146435072)?(U=($|0)==0&(H|0)==0,A=h,u[A>>2]=U?1:$,u[A+4>>2]=U?0:H,A=0):A=1,H=A,O=W,H|0)}function yS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0;E=O,O=O+288|0,_=E+264|0,b=E+96|0,w=E,m=w,y=m+96|0;do u[m>>2]=0,m=m+4|0;while((m|0)<(y|0));return h=rd(h,w)|0,h|0?(d=h,O=E,d|0):(h=w,m=u[h>>2]|0,h=u[h+4>>2]|0,Ho(m,h,_)|0,ka(m,h,b)|0,M=+au(_,b+8|0),M=+Oa(+(+au(l,A)/(M*2))),L[Et>>3]=M,h=~~M>>>0,m=+mt(M)>=1?M>0?~~+qf(+jn(M/4294967296),4294967295)>>>0:~~+Oa((M-+(~~M>>>0))/4294967296)>>>0:0,(u[Et+4>>2]&2146435072|0)==2146435072?(d=1,O=E,d|0):(w=(h|0)==0&(m|0)==0,u[d>>2]=w?1:h,u[d+4>>2]=w?0:m,d=0,O=E,d|0))}function _S(l,A){l=l|0,A=+A;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;y=l+16|0,_=+L[y>>3],h=l+24|0,m=+L[h>>3],d=_-m,d=_<m?d+6.283185307179586:d,E=+L[l>>3],b=l+8|0,w=+L[b>>3],M=E-w,d=(d*A-d)*.5,A=(M*A-M)*.5,E=E+A,L[l>>3]=E>1.5707963267948966?1.5707963267948966:E,A=w-A,L[b>>3]=A<-1.5707963267948966?-1.5707963267948966:A,A=_+d,A=A>3.141592653589793?A+-6.283185307179586:A,L[y>>3]=A<-3.141592653589793?A+6.283185307179586:A,A=m-d,A=A>3.141592653589793?A+-6.283185307179586:A,L[h>>3]=A<-3.141592653589793?A+6.283185307179586:A}function vS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0,u[l>>2]=A,u[l+4>>2]=h,u[l+8>>2]=d}function bS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;U=A+8|0,u[U>>2]=0,w=+L[l>>3],_=+mt(+w),E=+L[l+8>>3],b=+mt(+E)*1.1547005383792515,_=_+b*.5,h=~~_,l=~~b,_=_-+(h|0),b=b-+(l|0);do if(_<.5)if(_<.3333333333333333)if(u[A>>2]=h,b<(_+1)*.5){u[A+4>>2]=l;break}else{l=l+1|0,u[A+4>>2]=l;break}else if($=1-_,l=(!(b<$)&1)+l|0,u[A+4>>2]=l,$<=b&b<_*2){h=h+1|0,u[A>>2]=h;break}else{u[A>>2]=h;break}else{if(!(_<.6666666666666666))if(h=h+1|0,u[A>>2]=h,b<_*.5){u[A+4>>2]=l;break}else{l=l+1|0,u[A+4>>2]=l;break}if(b<1-_){if(u[A+4>>2]=l,_*2+-1<b){u[A>>2]=h;break}}else l=l+1|0,u[A+4>>2]=l;h=h+1|0,u[A>>2]=h}while(!1);do if(w<0)if(l&1){M=(l+1|0)/2|0,M=Kn(h|0,((h|0)<0)<<31>>31|0,M|0,((M|0)<0)<<31>>31|0)|0,h=~~(+(h|0)-((+(M>>>0)+4294967296*+(V()|0))*2+1)),u[A>>2]=h;break}else{M=(l|0)/2|0,M=Kn(h|0,((h|0)<0)<<31>>31|0,M|0,((M|0)<0)<<31>>31|0)|0,h=~~(+(h|0)-(+(M>>>0)+4294967296*+(V()|0))*2),u[A>>2]=h;break}while(!1);M=A+4|0,E<0&&(h=h-((l<<1|1|0)/2|0)|0,u[A>>2]=h,l=0-l|0,u[M>>2]=l),d=l-h|0,(h|0)<0?(m=0-h|0,u[M>>2]=d,u[U>>2]=m,u[A>>2]=0,l=d,h=0):m=0,(l|0)<0&&(h=h-l|0,u[A>>2]=h,m=m-l|0,u[U>>2]=m,u[M>>2]=0,l=0),y=h-m|0,d=l-m|0,(m|0)<0&&(u[A>>2]=y,u[M>>2]=d,u[U>>2]=0,l=d,h=y,m=0),d=(l|0)<(h|0)?l:h,d=(m|0)<(d|0)?m:d,!((d|0)<=0)&&(u[A>>2]=h-d,u[M>>2]=l-d,u[U>>2]=m-d)}function or(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0;A=u[l>>2]|0,_=l+4|0,h=u[_>>2]|0,(A|0)<0&&(h=h-A|0,u[_>>2]=h,y=l+8|0,u[y>>2]=(u[y>>2]|0)-A,u[l>>2]=0,A=0),(h|0)<0?(A=A-h|0,u[l>>2]=A,y=l+8|0,m=(u[y>>2]|0)-h|0,u[y>>2]=m,u[_>>2]=0,h=0):(m=l+8|0,y=m,m=u[m>>2]|0),(m|0)<0&&(A=A-m|0,u[l>>2]=A,h=h-m|0,u[_>>2]=h,u[y>>2]=0,m=0),d=(h|0)<(A|0)?h:A,d=(m|0)<(d|0)?m:d,!((d|0)<=0)&&(u[l>>2]=A-d,u[_>>2]=h-d,u[y>>2]=m-d)}function Vo(l,A){l=l|0,A=A|0;var h=0,d=0;d=u[l+8>>2]|0,h=+((u[l+4>>2]|0)-d|0),L[A>>3]=+((u[l>>2]|0)-d|0)-h*.5,L[A+8>>3]=h*.8660254037844386}function mr(l,A,h){l=l|0,A=A|0,h=h|0,u[h>>2]=(u[A>>2]|0)+(u[l>>2]|0),u[h+4>>2]=(u[A+4>>2]|0)+(u[l+4>>2]|0),u[h+8>>2]=(u[A+8>>2]|0)+(u[l+8>>2]|0)}function Hf(l,A,h){l=l|0,A=A|0,h=h|0,u[h>>2]=(u[l>>2]|0)-(u[A>>2]|0),u[h+4>>2]=(u[l+4>>2]|0)-(u[A+4>>2]|0),u[h+8>>2]=(u[l+8>>2]|0)-(u[A+8>>2]|0)}function J2(l,A){l=l|0,A=A|0;var h=0,d=0;h=Vi(u[l>>2]|0,A)|0,u[l>>2]=h,h=l+4|0,d=Vi(u[h>>2]|0,A)|0,u[h>>2]=d,l=l+8|0,A=Vi(u[l>>2]|0,A)|0,u[l>>2]=A}function ec(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;_=u[l>>2]|0,b=(_|0)<0,d=(u[l+4>>2]|0)-(b?_:0)|0,y=(d|0)<0,m=(y?0-d|0:0)+((u[l+8>>2]|0)-(b?_:0))|0,h=(m|0)<0,l=h?0:m,A=(y?0:d)-(h?m:0)|0,m=(b?0:_)-(y?d:0)-(h?m:0)|0,h=(A|0)<(m|0)?A:m,h=(l|0)<(h|0)?l:h,d=(h|0)>0,l=l-(d?h:0)|0,A=A-(d?h:0)|0;e:do switch(m-(d?h:0)|0){case 0:switch(A|0){case 0:return b=(l|0)==0?0:(l|0)==1?1:7,b|0;case 1:return b=(l|0)==0?2:(l|0)==1?3:7,b|0;default:break e}case 1:switch(A|0){case 0:return b=(l|0)==0?4:(l|0)==1?5:7,b|0;case 1:{if(!l)l=6;else break e;return l|0}default:break e}}while(!1);return b=7,b|0}function xS(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0;if(w=l+8|0,_=u[w>>2]|0,b=(u[l>>2]|0)-_|0,E=l+4|0,_=(u[E>>2]|0)-_|0,b>>>0>715827881|_>>>0>715827881){if(d=(b|0)>0,m=2147483647-b|0,y=-2147483648-b|0,(d?(m|0)<(b|0):(y|0)>(b|0))||(h=b<<1,d?(2147483647-h|0)<(b|0):(-2147483648-h|0)>(b|0))||((_|0)>0?(2147483647-_|0)<(_|0):(-2147483648-_|0)>(_|0))||(A=b*3|0,h=_<<1,(d?(m|0)<(h|0):(y|0)>(h|0))||((b|0)>-1?(A|-2147483648|0)>=(_|0):(A^-2147483648|0)<(_|0))))return E=1,E|0}else h=_<<1,A=b*3|0;return d=no(+(A-_|0)*.14285714285714285)|0,u[l>>2]=d,m=no(+(h+b|0)*.14285714285714285)|0,u[E>>2]=m,u[w>>2]=0,h=(m|0)<(d|0),A=h?d:m,h=h?m:d,(h|0)<0&&(((h|0)==-2147483648||((A|0)>0?(2147483647-A|0)<(h|0):(-2147483648-A|0)>(h|0)))&&et(27795,26892,354,26903),((A|0)>-1?(A|-2147483648|0)>=(h|0):(A^-2147483648|0)<(h|0))&&et(27795,26892,354,26903)),A=m-d|0,(d|0)<0?(h=0-d|0,u[E>>2]=A,u[w>>2]=h,u[l>>2]=0,d=0):(A=m,h=0),(A|0)<0&&(d=d-A|0,u[l>>2]=d,h=h-A|0,u[w>>2]=h,u[E>>2]=0,A=0),y=d-h|0,m=A-h|0,(h|0)<0?(u[l>>2]=y,u[E>>2]=m,u[w>>2]=0,A=m,m=y,h=0):m=d,d=(A|0)<(m|0)?A:m,d=(h|0)<(d|0)?h:d,(d|0)<=0?(E=0,E|0):(u[l>>2]=m-d,u[E>>2]=A-d,u[w>>2]=h-d,E=0,E|0)}function TS(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0;if(_=l+8|0,m=u[_>>2]|0,y=(u[l>>2]|0)-m|0,b=l+4|0,m=(u[b>>2]|0)-m|0,y>>>0>715827881|m>>>0>715827881){if(h=(y|0)>0,(h?(2147483647-y|0)<(y|0):(-2147483648-y|0)>(y|0))||(A=y<<1,d=(m|0)>0,d?(2147483647-m|0)<(m|0):(-2147483648-m|0)>(m|0)))return b=1,b|0;if(w=m<<1,(d?(2147483647-w|0)<(m|0):(-2147483648-w|0)>(m|0))||(h?(2147483647-A|0)<(m|0):(-2147483648-A|0)>(m|0))||(h=m*3|0,(m|0)>-1?(h|-2147483648|0)>=(y|0):(h^-2147483648|0)<(y|0)))return w=1,w|0}else h=m*3|0,A=y<<1;return d=no(+(A+m|0)*.14285714285714285)|0,u[l>>2]=d,m=no(+(h-y|0)*.14285714285714285)|0,u[b>>2]=m,u[_>>2]=0,h=(m|0)<(d|0),A=h?d:m,h=h?m:d,(h|0)<0&&(((h|0)==-2147483648||((A|0)>0?(2147483647-A|0)<(h|0):(-2147483648-A|0)>(h|0)))&&et(27795,26892,402,26917),((A|0)>-1?(A|-2147483648|0)>=(h|0):(A^-2147483648|0)<(h|0))&&et(27795,26892,402,26917)),A=m-d|0,(d|0)<0?(h=0-d|0,u[b>>2]=A,u[_>>2]=h,u[l>>2]=0,d=0):(A=m,h=0),(A|0)<0&&(d=d-A|0,u[l>>2]=d,h=h-A|0,u[_>>2]=h,u[b>>2]=0,A=0),y=d-h|0,m=A-h|0,(h|0)<0?(u[l>>2]=y,u[b>>2]=m,u[_>>2]=0,A=m,m=y,h=0):m=d,d=(A|0)<(m|0)?A:m,d=(h|0)<(d|0)?h:d,(d|0)<=0?(w=0,w|0):(u[l>>2]=m-d,u[b>>2]=A-d,u[_>>2]=h-d,w=0,w|0)}function wS(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;_=l+8|0,h=u[_>>2]|0,A=(u[l>>2]|0)-h|0,b=l+4|0,h=(u[b>>2]|0)-h|0,d=no(+((A*3|0)-h|0)*.14285714285714285)|0,u[l>>2]=d,A=no(+((h<<1)+A|0)*.14285714285714285)|0,u[b>>2]=A,u[_>>2]=0,h=A-d|0,(d|0)<0?(y=0-d|0,u[b>>2]=h,u[_>>2]=y,u[l>>2]=0,A=h,d=0,h=y):h=0,(A|0)<0&&(d=d-A|0,u[l>>2]=d,h=h-A|0,u[_>>2]=h,u[b>>2]=0,A=0),y=d-h|0,m=A-h|0,(h|0)<0?(u[l>>2]=y,u[b>>2]=m,u[_>>2]=0,A=m,m=y,h=0):m=d,d=(A|0)<(m|0)?A:m,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(u[l>>2]=m-d,u[b>>2]=A-d,u[_>>2]=h-d)}function ey(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;_=l+8|0,h=u[_>>2]|0,A=(u[l>>2]|0)-h|0,b=l+4|0,h=(u[b>>2]|0)-h|0,d=no(+((A<<1)+h|0)*.14285714285714285)|0,u[l>>2]=d,A=no(+((h*3|0)-A|0)*.14285714285714285)|0,u[b>>2]=A,u[_>>2]=0,h=A-d|0,(d|0)<0?(y=0-d|0,u[b>>2]=h,u[_>>2]=y,u[l>>2]=0,A=h,d=0,h=y):h=0,(A|0)<0&&(d=d-A|0,u[l>>2]=d,h=h-A|0,u[_>>2]=h,u[b>>2]=0,A=0),y=d-h|0,m=A-h|0,(h|0)<0?(u[l>>2]=y,u[b>>2]=m,u[_>>2]=0,A=m,m=y,h=0):m=d,d=(A|0)<(m|0)?A:m,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(u[l>>2]=m-d,u[b>>2]=A-d,u[_>>2]=h-d)}function tc(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;A=u[l>>2]|0,_=l+4|0,h=u[_>>2]|0,b=l+8|0,d=u[b>>2]|0,m=h+(A*3|0)|0,u[l>>2]=m,h=d+(h*3|0)|0,u[_>>2]=h,A=(d*3|0)+A|0,u[b>>2]=A,d=h-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=d,u[b>>2]=A,u[l>>2]=0,h=d,d=0):d=m,(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=d-A|0,m=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=m,u[b>>2]=0,d=y,A=0):m=h,h=(m|0)<(d|0)?m:d,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=d-h,u[_>>2]=m-h,u[b>>2]=A-h)}function zo(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;m=u[l>>2]|0,_=l+4|0,A=u[_>>2]|0,b=l+8|0,h=u[b>>2]|0,d=(A*3|0)+m|0,m=h+(m*3|0)|0,u[l>>2]=m,u[_>>2]=d,A=(h*3|0)+A|0,u[b>>2]=A,h=d-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=h,u[b>>2]=A,u[l>>2]=0,m=0):h=d,(h|0)<0&&(m=m-h|0,u[l>>2]=m,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=m-A|0,d=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=d,u[b>>2]=0,m=y,A=0):d=h,h=(d|0)<(m|0)?d:m,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=m-h,u[_>>2]=d-h,u[b>>2]=A-h)}function ty(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0;(A+-1|0)>>>0>=6||(m=(u[15440+(A*12|0)>>2]|0)+(u[l>>2]|0)|0,u[l>>2]=m,b=l+4|0,d=(u[15440+(A*12|0)+4>>2]|0)+(u[b>>2]|0)|0,u[b>>2]=d,_=l+8|0,A=(u[15440+(A*12|0)+8>>2]|0)+(u[_>>2]|0)|0,u[_>>2]=A,h=d-m|0,(m|0)<0?(A=A-m|0,u[b>>2]=h,u[_>>2]=A,u[l>>2]=0,d=0):(h=d,d=m),(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[_>>2]=A,u[b>>2]=0,h=0),y=d-A|0,m=h-A|0,(A|0)<0?(u[l>>2]=y,u[b>>2]=m,u[_>>2]=0,d=y,A=0):m=h,h=(m|0)<(d|0)?m:d,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=d-h,u[b>>2]=m-h,u[_>>2]=A-h))}function ny(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;m=u[l>>2]|0,_=l+4|0,A=u[_>>2]|0,b=l+8|0,h=u[b>>2]|0,d=A+m|0,m=h+m|0,u[l>>2]=m,u[_>>2]=d,A=h+A|0,u[b>>2]=A,h=d-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=h,u[b>>2]=A,u[l>>2]=0,d=0):(h=d,d=m),(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=d-A|0,m=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=m,u[b>>2]=0,d=y,A=0):m=h,h=(m|0)<(d|0)?m:d,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=d-h,u[_>>2]=m-h,u[b>>2]=A-h)}function nc(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;A=u[l>>2]|0,_=l+4|0,d=u[_>>2]|0,b=l+8|0,h=u[b>>2]|0,m=d+A|0,u[l>>2]=m,d=h+d|0,u[_>>2]=d,A=h+A|0,u[b>>2]=A,h=d-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=h,u[b>>2]=A,u[l>>2]=0,d=0):(h=d,d=m),(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=d-A|0,m=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=m,u[b>>2]=0,d=y,A=0):m=h,h=(m|0)<(d|0)?m:d,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=d-h,u[_>>2]=m-h,u[b>>2]=A-h)}function jo(l){switch(l=l|0,l|0){case 1:{l=5;break}case 5:{l=4;break}case 4:{l=6;break}case 6:{l=2;break}case 2:{l=3;break}case 3:{l=1;break}}return l|0}function eo(l){switch(l=l|0,l|0){case 1:{l=3;break}case 3:{l=2;break}case 2:{l=6;break}case 6:{l=4;break}case 4:{l=5;break}case 5:{l=1;break}}return l|0}function ry(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;A=u[l>>2]|0,_=l+4|0,h=u[_>>2]|0,b=l+8|0,d=u[b>>2]|0,m=h+(A<<1)|0,u[l>>2]=m,h=d+(h<<1)|0,u[_>>2]=h,A=(d<<1)+A|0,u[b>>2]=A,d=h-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=d,u[b>>2]=A,u[l>>2]=0,h=d,d=0):d=m,(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=d-A|0,m=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=m,u[b>>2]=0,d=y,A=0):m=h,h=(m|0)<(d|0)?m:d,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=d-h,u[_>>2]=m-h,u[b>>2]=A-h)}function iy(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;m=u[l>>2]|0,_=l+4|0,A=u[_>>2]|0,b=l+8|0,h=u[b>>2]|0,d=(A<<1)+m|0,m=h+(m<<1)|0,u[l>>2]=m,u[_>>2]=d,A=(h<<1)+A|0,u[b>>2]=A,h=d-m|0,(m|0)<0?(A=A-m|0,u[_>>2]=h,u[b>>2]=A,u[l>>2]=0,m=0):h=d,(h|0)<0&&(m=m-h|0,u[l>>2]=m,A=A-h|0,u[b>>2]=A,u[_>>2]=0,h=0),y=m-A|0,d=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=d,u[b>>2]=0,m=y,A=0):d=h,h=(d|0)<(m|0)?d:m,h=(A|0)<(h|0)?A:h,!((h|0)<=0)&&(u[l>>2]=m-h,u[_>>2]=d-h,u[b>>2]=A-h)}function Wf(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0;return _=(u[l>>2]|0)-(u[A>>2]|0)|0,b=(_|0)<0,d=(u[l+4>>2]|0)-(u[A+4>>2]|0)-(b?_:0)|0,y=(d|0)<0,m=(b?0-_|0:0)+(u[l+8>>2]|0)-(u[A+8>>2]|0)+(y?0-d|0:0)|0,l=(m|0)<0,A=l?0:m,h=(y?0:d)-(l?m:0)|0,m=(b?0:_)-(y?d:0)-(l?m:0)|0,l=(h|0)<(m|0)?h:m,l=(A|0)<(l|0)?A:l,d=(l|0)>0,A=A-(d?l:0)|0,h=h-(d?l:0)|0,l=m-(d?l:0)|0,l=(l|0)>-1?l:0-l|0,h=(h|0)>-1?h:0-h|0,A=(A|0)>-1?A:0-A|0,A=(h|0)>(A|0)?h:A,((l|0)>(A|0)?l:A)|0}function SS(l,A){l=l|0,A=A|0;var h=0;h=u[l+8>>2]|0,u[A>>2]=(u[l>>2]|0)-h,u[A+4>>2]=(u[l+4>>2]|0)-h}function ES(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0;return d=u[l>>2]|0,u[A>>2]=d,m=u[l+4>>2]|0,_=A+4|0,u[_>>2]=m,b=A+8|0,u[b>>2]=0,h=(m|0)<(d|0),l=h?d:m,h=h?m:d,(h|0)<0&&((h|0)==-2147483648||((l|0)>0?(2147483647-l|0)<(h|0):(-2147483648-l|0)>(h|0))||((l|0)>-1?(l|-2147483648|0)>=(h|0):(l^-2147483648|0)<(h|0)))?(A=1,A|0):(l=m-d|0,(d|0)<0?(h=0-d|0,u[_>>2]=l,u[b>>2]=h,u[A>>2]=0,d=0):(l=m,h=0),(l|0)<0&&(d=d-l|0,u[A>>2]=d,h=h-l|0,u[b>>2]=h,u[_>>2]=0,l=0),y=d-h|0,m=l-h|0,(h|0)<0?(u[A>>2]=y,u[_>>2]=m,u[b>>2]=0,l=m,m=y,h=0):m=d,d=(l|0)<(m|0)?l:m,d=(h|0)<(d|0)?h:d,(d|0)<=0?(A=0,A|0):(u[A>>2]=m-d,u[_>>2]=l-d,u[b>>2]=h-d,A=0,A|0))}function sy(l){l=l|0;var A=0,h=0,d=0,m=0;A=l+8|0,m=u[A>>2]|0,h=m-(u[l>>2]|0)|0,u[l>>2]=h,d=l+4|0,l=(u[d>>2]|0)-m|0,u[d>>2]=l,u[A>>2]=0-(l+h)}function RS(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;h=u[l>>2]|0,A=0-h|0,u[l>>2]=A,_=l+8|0,u[_>>2]=0,b=l+4|0,d=u[b>>2]|0,m=d+h|0,(h|0)>0?(u[b>>2]=m,u[_>>2]=h,u[l>>2]=0,A=0,d=m):h=0,(d|0)<0?(y=A-d|0,u[l>>2]=y,h=h-d|0,u[_>>2]=h,u[b>>2]=0,m=y-h|0,A=0-h|0,(h|0)<0?(u[l>>2]=m,u[b>>2]=A,u[_>>2]=0,d=A,h=0):(d=0,m=y)):m=A,A=(d|0)<(m|0)?d:m,A=(h|0)<(A|0)?h:A,!((A|0)<=0)&&(u[l>>2]=m-A,u[b>>2]=d-A,u[_>>2]=h-A)}function NS(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0;if(U=O,O=O+64|0,M=U,b=U+56|0,!(!0&(A&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return m=5,O=U,m|0;if((l|0)==(h|0)&(A|0)==(d|0))return u[m>>2]=0,m=0,O=U,m|0;if(_=xe(l|0,A|0,52)|0,V()|0,_=_&15,E=xe(h|0,d|0,52)|0,V()|0,(_|0)!=(E&15|0))return m=12,O=U,m|0;if(y=_+-1|0,_>>>0>1){Zf(l,A,y,M)|0,Zf(h,d,y,b)|0,E=M,w=u[E>>2]|0,E=u[E+4>>2]|0;e:do if((w|0)==(u[b>>2]|0)&&(E|0)==(u[b+4>>2]|0)){_=(_^15)*3|0,y=xe(l|0,A|0,_|0)|0,V()|0,y=y&7,_=xe(h|0,d|0,_|0)|0,V()|0,_=_&7;do if((y|0)==0|(_|0)==0)u[m>>2]=1,y=0;else if((y|0)==7)y=5;else{if((y|0)==1|(_|0)==1&&Qt(w,E)|0){y=5;break}if((u[15536+(y<<2)>>2]|0)!=(_|0)&&(u[15568+(y<<2)>>2]|0)!=(_|0))break e;u[m>>2]=1,y=0}while(!1);return m=y,O=U,m|0}while(!1)}y=M,_=y+56|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(_|0));return V2(l,A,1,M)|0,A=M,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0))&&(A=M+8|0,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0)))&&(A=M+16|0,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0)))&&(A=M+24|0,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0)))&&(A=M+32|0,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0)))&&(A=M+40|0,!((u[A>>2]|0)==(h|0)&&(u[A+4>>2]|0)==(d|0)))?(y=M+48|0,y=((u[y>>2]|0)==(h|0)?(u[y+4>>2]|0)==(d|0):0)&1):y=1,u[m>>2]=y,m=0,O=U,m|0}function CS(l,A,h,d,m){return l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,h=Uf(l,A,h,d)|0,(h|0)==7?(m=11,m|0):(d=Ce(h|0,0,56)|0,A=A&-2130706433|(V()|0)|268435456,u[m>>2]=l|d,u[m+4>>2]=A,m=0,m|0)}function MS(l,A,h){return l=l|0,A=A|0,h=h|0,!0&(A&2013265920|0)==268435456?(u[h>>2]=l,u[h+4>>2]=A&-2130706433|134217728,h=0,h|0):(h=6,h|0)}function PS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;return m=O,O=O+16|0,d=m,u[d>>2]=0,!0&(A&2013265920|0)==268435456?(y=xe(l|0,A|0,56)|0,V()|0,d=$n(l,A&-2130706433|134217728,y&7,d,h)|0,O=m,d|0):(d=6,O=m,d|0)}function BS(l,A){l=l|0,A=A|0;var h=0;switch(h=xe(l|0,A|0,56)|0,V()|0,h&7){case 0:case 7:return h=0,h|0}return h=A&-2130706433|134217728,!(!0&(A&2013265920|0)==268435456)||!0&(A&117440512|0)==16777216&(Qt(l,h)|0)!=0?(h=0,h|0):(h=Yf(l,h)|0,h|0)}function DS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;return m=O,O=O+16|0,d=m,!0&(A&2013265920|0)==268435456?(y=A&-2130706433|134217728,_=h,u[_>>2]=l,u[_+4>>2]=y,u[d>>2]=0,A=xe(l|0,A|0,56)|0,V()|0,d=$n(l,y,A&7,d,h+8|0)|0,O=m,d|0):(d=6,O=m,d|0)}function LS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0;return m=(Qt(l,A)|0)==0,A=A&-2130706433,d=h,u[d>>2]=m?l:0,u[d+4>>2]=m?A|285212672:0,d=h+8|0,u[d>>2]=l,u[d+4>>2]=A|301989888,d=h+16|0,u[d>>2]=l,u[d+4>>2]=A|318767104,d=h+24|0,u[d>>2]=l,u[d+4>>2]=A|335544320,d=h+32|0,u[d>>2]=l,u[d+4>>2]=A|352321536,h=h+40|0,u[h>>2]=l,u[h+4>>2]=A|369098752,0}function rc(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;return _=O,O=O+16|0,m=_,y=A&-2130706433|134217728,!0&(A&2013265920|0)==268435456?(d=xe(l|0,A|0,56)|0,V()|0,d=PE(l,y,d&7)|0,(d|0)==-1?(u[h>>2]=0,y=6,O=_,y|0):(Ia(l,y,m)|0&&et(27795,26932,282,26947),A=xe(l|0,A|0,52)|0,V()|0,A=A&15,Qt(l,y)|0?Qf(m,A,d,2,h):Xf(m,A,d,2,h),y=0,O=_,y|0)):(y=6,O=_,y|0)}function OS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0;d=O,O=O+16|0,m=d,FS(l,A,h,m),bS(m,h+4|0),O=d}function FS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0;if(b=O,O=O+16|0,w=b,IS(l,h,w),y=+JA(+(1-+L[w>>3]*.5)),y<1e-16){u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,u[d+12>>2]=0,O=b;return}if(w=u[h>>2]|0,m=+L[15920+(w*24|0)>>3],m=+ou(m-+ou(+eE(15600+(w<<4)|0,l))),ri(A)|0?_=+ou(m+-.3334731722518321):_=m,m=+ti(+y)*2.618033988749896,(A|0)>0){l=0;do m=m*2.6457513110645907,l=l+1|0;while((l|0)!=(A|0))}y=+Bt(+_)*m,L[d>>3]=y,_=+gt(+_)*m,L[d+8>>3]=_,O=b}function IS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;if(y=O,O=O+32|0,m=y,ME(l,m),u[A>>2]=0,L[h>>3]=5,d=+Bn(16400,m),d<+L[h>>3]&&(u[A>>2]=0,L[h>>3]=d),d=+Bn(16424,m),d<+L[h>>3]&&(u[A>>2]=1,L[h>>3]=d),d=+Bn(16448,m),d<+L[h>>3]&&(u[A>>2]=2,L[h>>3]=d),d=+Bn(16472,m),d<+L[h>>3]&&(u[A>>2]=3,L[h>>3]=d),d=+Bn(16496,m),d<+L[h>>3]&&(u[A>>2]=4,L[h>>3]=d),d=+Bn(16520,m),d<+L[h>>3]&&(u[A>>2]=5,L[h>>3]=d),d=+Bn(16544,m),d<+L[h>>3]&&(u[A>>2]=6,L[h>>3]=d),d=+Bn(16568,m),d<+L[h>>3]&&(u[A>>2]=7,L[h>>3]=d),d=+Bn(16592,m),d<+L[h>>3]&&(u[A>>2]=8,L[h>>3]=d),d=+Bn(16616,m),d<+L[h>>3]&&(u[A>>2]=9,L[h>>3]=d),d=+Bn(16640,m),d<+L[h>>3]&&(u[A>>2]=10,L[h>>3]=d),d=+Bn(16664,m),d<+L[h>>3]&&(u[A>>2]=11,L[h>>3]=d),d=+Bn(16688,m),d<+L[h>>3]&&(u[A>>2]=12,L[h>>3]=d),d=+Bn(16712,m),d<+L[h>>3]&&(u[A>>2]=13,L[h>>3]=d),d=+Bn(16736,m),d<+L[h>>3]&&(u[A>>2]=14,L[h>>3]=d),d=+Bn(16760,m),d<+L[h>>3]&&(u[A>>2]=15,L[h>>3]=d),d=+Bn(16784,m),d<+L[h>>3]&&(u[A>>2]=16,L[h>>3]=d),d=+Bn(16808,m),d<+L[h>>3]&&(u[A>>2]=17,L[h>>3]=d),d=+Bn(16832,m),d<+L[h>>3]&&(u[A>>2]=18,L[h>>3]=d),d=+Bn(16856,m),!(d<+L[h>>3])){O=y;return}u[A>>2]=19,L[h>>3]=d,O=y}function iu(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0;if(y=+CE(l),y<1e-16){A=15600+(A<<4)|0,u[m>>2]=u[A>>2],u[m+4>>2]=u[A+4>>2],u[m+8>>2]=u[A+8>>2],u[m+12>>2]=u[A+12>>2];return}if(_=+ni(+ +L[l+8>>3],+ +L[l>>3]),(h|0)>0){l=0;do y=y*.37796447300922725,l=l+1|0;while((l|0)!=(h|0))}b=y*.3333333333333333,d?(h=(ri(h)|0)==0,y=+kf(+((h?b:b*.37796447300922725)*.381966011250105))):(y=+kf(+(y*.381966011250105)),ri(h)|0&&(_=+ou(_+.3334731722518321))),tE(15600+(A<<4)|0,+ou(+L[15920+(A*24|0)>>3]-_),y,m)}function kS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0;d=O,O=O+16|0,m=d,Vo(l+4|0,m),iu(m,u[l>>2]|0,A,0,h),O=d}function Qf(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0,ze=0,Ee=0,dt=0,jt=0,At=0;if(dt=O,O=O+272|0,y=dt+256|0,Ae=dt+240|0,Ze=dt,ze=dt+224|0,Ee=dt+208|0,le=dt+176|0,ne=dt+160|0,Re=dt+192|0,Ve=dt+144|0,Fe=dt+128|0,st=dt+112|0,lt=dt+96|0,yt=dt+80|0,u[y>>2]=A,u[Ae>>2]=u[l>>2],u[Ae+4>>2]=u[l+4>>2],u[Ae+8>>2]=u[l+8>>2],u[Ae+12>>2]=u[l+12>>2],oy(Ae,y,Ze),u[m>>2]=0,Ae=d+h+((d|0)==5&1)|0,(Ae|0)<=(h|0)){O=dt;return}w=u[y>>2]|0,E=ze+4|0,M=le+4|0,U=h+5|0,$=16880+(w<<2)|0,H=16960+(w<<2)|0,W=Fe+8|0,te=st+8|0,se=lt+8|0,ce=Ee+4|0,b=h;e:for(;;){_=Ze+(((b|0)%5|0)<<4)|0,u[Ee>>2]=u[_>>2],u[Ee+4>>2]=u[_+4>>2],u[Ee+8>>2]=u[_+8>>2],u[Ee+12>>2]=u[_+12>>2];do;while((Fa(Ee,w,0,1)|0)==2);if((b|0)>(h|0)&(ri(A)|0)!=0){if(u[le>>2]=u[Ee>>2],u[le+4>>2]=u[Ee+4>>2],u[le+8>>2]=u[Ee+8>>2],u[le+12>>2]=u[Ee+12>>2],Vo(E,ne),d=u[le>>2]|0,y=u[17040+(d*80|0)+(u[ze>>2]<<2)>>2]|0,u[le>>2]=u[18640+(d*80|0)+(y*20|0)>>2],_=u[18640+(d*80|0)+(y*20|0)+16>>2]|0,(_|0)>0){l=0;do ny(M),l=l+1|0;while((l|0)<(_|0))}switch(_=18640+(d*80|0)+(y*20|0)+4|0,u[Re>>2]=u[_>>2],u[Re+4>>2]=u[_+4>>2],u[Re+8>>2]=u[_+8>>2],J2(Re,(u[$>>2]|0)*3|0),mr(M,Re,M),or(M),Vo(M,Ve),jt=+(u[H>>2]|0),L[Fe>>3]=jt*3,L[W>>3]=0,At=jt*-1.5,L[st>>3]=At,L[te>>3]=jt*2.598076211353316,L[lt>>3]=At,L[se>>3]=jt*-2.598076211353316,u[17040+((u[le>>2]|0)*80|0)+(u[Ee>>2]<<2)>>2]|0){case 1:{l=st,d=Fe;break}case 3:{l=lt,d=st;break}case 2:{l=Fe,d=lt;break}default:{l=12;break e}}xy(ne,Ve,d,l,yt),iu(yt,u[le>>2]|0,w,1,m+8+(u[m>>2]<<4)|0),u[m>>2]=(u[m>>2]|0)+1}if((b|0)<(U|0)&&(Vo(ce,le),iu(le,u[Ee>>2]|0,w,1,m+8+(u[m>>2]<<4)|0),u[m>>2]=(u[m>>2]|0)+1),u[ze>>2]=u[Ee>>2],u[ze+4>>2]=u[Ee+4>>2],u[ze+8>>2]=u[Ee+8>>2],u[ze+12>>2]=u[Ee+12>>2],b=b+1|0,(b|0)>=(Ae|0)){l=3;break}}if((l|0)==3){O=dt;return}else(l|0)==12&&et(26970,27017,572,27027)}function oy(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0;w=O,O=O+128|0,d=w+64|0,m=w,y=d,_=20240,b=y+60|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(b|0));y=m,_=20304,b=y+60|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(b|0));b=(ri(u[A>>2]|0)|0)==0,d=b?d:m,m=l+4|0,ry(m),iy(m),ri(u[A>>2]|0)|0&&(zo(m),u[A>>2]=(u[A>>2]|0)+1),u[h>>2]=u[l>>2],A=h+4|0,mr(m,d,A),or(A),u[h+16>>2]=u[l>>2],A=h+20|0,mr(m,d+12|0,A),or(A),u[h+32>>2]=u[l>>2],A=h+36|0,mr(m,d+24|0,A),or(A),u[h+48>>2]=u[l>>2],A=h+52|0,mr(m,d+36|0,A),or(A),u[h+64>>2]=u[l>>2],h=h+68|0,mr(m,d+48|0,h),or(h),O=w}function Fa(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0;if(W=O,O=O+32|0,$=W+12|0,b=W,H=l+4|0,U=u[16960+(A<<2)>>2]|0,M=(d|0)!=0,U=M?U*3|0:U,m=u[H>>2]|0,E=l+8|0,_=u[E>>2]|0,M){if(y=l+12|0,d=u[y>>2]|0,m=_+m+d|0,(m|0)==(U|0))return H=1,O=W,H|0;w=y}else w=l+12|0,d=u[w>>2]|0,m=_+m+d|0;if((m|0)<=(U|0))return H=0,O=W,H|0;do if((d|0)>0){if(d=u[l>>2]|0,(_|0)>0){y=18640+(d*80|0)+60|0,d=l;break}d=18640+(d*80|0)+40|0,h?(vS($,U,0,0),Hf(H,$,b),nc(b),mr(b,$,H),y=d,d=l):(y=d,d=l)}else y=18640+((u[l>>2]|0)*80|0)+20|0,d=l;while(!1);if(u[d>>2]=u[y>>2],m=y+16|0,(u[m>>2]|0)>0){d=0;do ny(H),d=d+1|0;while((d|0)<(u[m>>2]|0))}return l=y+4|0,u[$>>2]=u[l>>2],u[$+4>>2]=u[l+4>>2],u[$+8>>2]=u[l+8>>2],A=u[16880+(A<<2)>>2]|0,J2($,M?A*3|0:A),mr(H,$,H),or(H),M?d=((u[E>>2]|0)+(u[H>>2]|0)+(u[w>>2]|0)|0)==(U|0)?1:2:d=2,H=d,O=W,H|0}function qS(l,A){l=l|0,A=A|0;var h=0;do h=Fa(l,A,0,1)|0;while((h|0)==2);return h|0}function Xf(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0;if(lt=O,O=O+240|0,y=lt+224|0,Re=lt+208|0,Ve=lt,Fe=lt+192|0,st=lt+176|0,se=lt+160|0,ce=lt+144|0,Ae=lt+128|0,le=lt+112|0,ne=lt+96|0,u[y>>2]=A,u[Re>>2]=u[l>>2],u[Re+4>>2]=u[l+4>>2],u[Re+8>>2]=u[l+8>>2],u[Re+12>>2]=u[l+12>>2],ay(Re,y,Ve),u[m>>2]=0,te=d+h+((d|0)==6&1)|0,(te|0)<=(h|0)){O=lt;return}w=u[y>>2]|0,E=h+6|0,M=16960+(w<<2)|0,U=ce+8|0,$=Ae+8|0,H=le+8|0,W=Fe+4|0,_=0,b=h,d=-1;e:for(;;){if(y=(b|0)%6|0,l=Ve+(y<<4)|0,u[Fe>>2]=u[l>>2],u[Fe+4>>2]=u[l+4>>2],u[Fe+8>>2]=u[l+8>>2],u[Fe+12>>2]=u[l+12>>2],l=_,_=Fa(Fe,w,0,1)|0,(b|0)>(h|0)&(ri(A)|0)!=0&&(l|0)!=1&&(u[Fe>>2]|0)!=(d|0)){switch(Vo(Ve+(((y+5|0)%6|0)<<4)+4|0,st),Vo(Ve+(y<<4)+4|0,se),yt=+(u[M>>2]|0),L[ce>>3]=yt*3,L[U>>3]=0,Ze=yt*-1.5,L[Ae>>3]=Ze,L[$>>3]=yt*2.598076211353316,L[le>>3]=Ze,L[H>>3]=yt*-2.598076211353316,y=u[Re>>2]|0,u[17040+(y*80|0)+(((d|0)==(y|0)?u[Fe>>2]|0:d)<<2)>>2]|0){case 1:{l=Ae,d=ce;break}case 3:{l=le,d=Ae;break}case 2:{l=ce,d=le;break}default:{l=8;break e}}xy(st,se,d,l,ne),!(Ty(st,ne)|0)&&!(Ty(se,ne)|0)&&(iu(ne,u[Re>>2]|0,w,1,m+8+(u[m>>2]<<4)|0),u[m>>2]=(u[m>>2]|0)+1)}if((b|0)<(E|0)&&(Vo(W,st),iu(st,u[Fe>>2]|0,w,1,m+8+(u[m>>2]<<4)|0),u[m>>2]=(u[m>>2]|0)+1),b=b+1|0,(b|0)>=(te|0)){l=3;break}else d=u[Fe>>2]|0}if((l|0)==3){O=lt;return}else(l|0)==8&&et(27054,27017,737,27099)}function ay(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0;w=O,O=O+160|0,d=w+80|0,m=w,y=d,_=20368,b=y+72|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(b|0));y=m,_=20448,b=y+72|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(b|0));b=(ri(u[A>>2]|0)|0)==0,d=b?d:m,m=l+4|0,ry(m),iy(m),ri(u[A>>2]|0)|0&&(zo(m),u[A>>2]=(u[A>>2]|0)+1),u[h>>2]=u[l>>2],A=h+4|0,mr(m,d,A),or(A),u[h+16>>2]=u[l>>2],A=h+20|0,mr(m,d+12|0,A),or(A),u[h+32>>2]=u[l>>2],A=h+36|0,mr(m,d+24|0,A),or(A),u[h+48>>2]=u[l>>2],A=h+52|0,mr(m,d+36|0,A),or(A),u[h+64>>2]=u[l>>2],A=h+68|0,mr(m,d+48|0,A),or(A),u[h+80>>2]=u[l>>2],h=h+84|0,mr(m,d+60|0,h),or(h),O=w}function US(l,A){return l=l|0,A=A|0,A=xe(l|0,A|0,52)|0,V()|0,A&15|0}function ly(l,A){return l=l|0,A=A|0,A=xe(l|0,A|0,45)|0,V()|0,A&127|0}function Yf(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0;return!(!0&(A&-16777216|0)==134217728)||(d=xe(l|0,A|0,52)|0,V()|0,d=d&15,h=xe(l|0,A|0,45)|0,V()|0,h=h&127,h>>>0>121)?(l=0,l|0):(_=(d^15)*3|0,m=xe(l|0,A|0,_|0)|0,_=Ce(m|0,V()|0,_|0)|0,m=V()|0,y=Kn(-1227133514,-1171,_|0,m|0)|0,!((_&613566756&y|0)==0&(m&4681&(V()|0)|0)==0)||(_=(d*3|0)+19|0,y=Ce(~l|0,~A|0,_|0)|0,_=xe(y|0,V()|0,_|0)|0,!((d|0)==15|(_|0)==0&(V()|0)==0))?(_=0,_|0):!(Te[20528+h>>0]|0)||(A=A&8191,(l|0)==0&(A|0)==0)?(_=1,_|0):(_=My(l|0,A|0)|0,V()|0,((63-_|0)%3|0|0)!=0|0))}function Kf(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0;if(m=Ce(A|0,0,52)|0,y=V()|0,h=Ce(h|0,0,45)|0,h=y|(V()|0)|134225919,(A|0)<1){y=-1,d=h,A=l,u[A>>2]=y,l=l+4|0,u[l>>2]=d;return}for(y=1,m=-1;_=(15-y|0)*3|0,b=Ce(7,0,_|0)|0,h=h&~(V()|0),_=Ce(d|0,0,_|0)|0,m=m&~b|_,h=h|(V()|0),(y|0)!=(A|0);)y=y+1|0;b=l,_=b,u[_>>2]=m,b=b+4|0,u[b>>2]=h}function Zf(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0;if(y=xe(l|0,A|0,52)|0,V()|0,y=y&15,h>>>0>15)return d=4,d|0;if((y|0)<(h|0))return d=12,d|0;if((y|0)==(h|0))return u[d>>2]=l,u[d+4>>2]=A,d=0,d|0;if(m=Ce(h|0,0,52)|0,m=m|l,l=V()|0|A&-15728641,(y|0)>(h|0))do A=Ce(7,0,(14-h|0)*3|0)|0,h=h+1|0,m=A|m,l=V()|0|l;while((h|0)<(y|0));return u[d>>2]=m,u[d+4>>2]=l,d=0,d|0}function su(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0;if(y=xe(l|0,A|0,52)|0,V()|0,y=y&15,!((h|0)<16&(y|0)<=(h|0)))return d=4,d|0;m=h-y|0,h=xe(l|0,A|0,45)|0,V()|0;e:do if(!(rn(h&127)|0))h=to(7,0,m,((m|0)<0)<<31>>31)|0,m=V()|0;else{t:do if(y|0){for(h=1;_=Ce(7,0,(15-h|0)*3|0)|0,!!((_&l|0)==0&((V()|0)&A|0)==0);)if(h>>>0<y>>>0)h=h+1|0;else break t;h=to(7,0,m,((m|0)<0)<<31>>31)|0,m=V()|0;break e}while(!1);h=to(7,0,m,((m|0)<0)<<31>>31)|0,h=Hn(h|0,V()|0,5,0)|0,h=je(h|0,V()|0,-5,-1)|0,h=ro(h|0,V()|0,6,0)|0,h=je(h|0,V()|0,1,0)|0,m=V()|0}while(!1);return _=d,u[_>>2]=h,u[_+4>>2]=m,_=0,_|0}function Qt(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;if(m=xe(l|0,A|0,45)|0,V()|0,!(rn(m&127)|0))return m=0,m|0;m=xe(l|0,A|0,52)|0,V()|0,m=m&15;e:do if(!m)h=0;else for(d=1;;){if(h=xe(l|0,A|0,(15-d|0)*3|0)|0,V()|0,h=h&7,h|0)break e;if(d>>>0<m>>>0)d=d+1|0;else{h=0;break}}while(!1);return m=(h|0)==0&1,m|0}function GS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0;if(_=O,O=O+16|0,y=_,id(y,l,A,h),A=y,l=u[A>>2]|0,A=u[A+4>>2]|0,(l|0)==0&(A|0)==0)return O=_,0;m=0,h=0;do b=d+(m<<3)|0,u[b>>2]=l,u[b+4>>2]=A,m=je(m|0,h|0,1,0)|0,h=V()|0,sd(y),b=y,l=u[b>>2]|0,A=u[b+4>>2]|0;while(!((l|0)==0&(A|0)==0));return O=_,0}function uy(l,A,h,d){return l=l|0,A=A|0,h=h|0,d=d|0,(d|0)<(h|0)?(h=A,d=l,at(h|0),d|0):(h=Ce(-1,-1,((d-h|0)*3|0)+3|0)|0,d=Ce(~h|0,~(V()|0)|0,(15-d|0)*3|0)|0,h=~(V()|0)&A,d=~d&l,at(h|0),d|0)}function Ay(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0;return m=xe(l|0,A|0,52)|0,V()|0,m=m&15,(h|0)<16&(m|0)<=(h|0)?((m|0)<(h|0)&&(m=Ce(-1,-1,((h+-1-m|0)*3|0)+3|0)|0,m=Ce(~m|0,~(V()|0)|0,(15-h|0)*3|0)|0,A=~(V()|0)&A,l=~m&l),m=Ce(h|0,0,52)|0,h=A&-15728641|(V()|0),u[d>>2]=l|m,u[d+4>>2]=h,d=0,d|0):(d=4,d|0)}function VS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0,ze=0,Ee=0;if((h|0)==0&(d|0)==0)return Ee=0,Ee|0;if(m=l,y=u[m>>2]|0,m=u[m+4>>2]|0,!0&(m&15728640|0)==0){if(!((d|0)>0|(d|0)==0&h>>>0>0)||(Ee=A,u[Ee>>2]=y,u[Ee+4>>2]=m,(h|0)==1&(d|0)==0))return Ee=0,Ee|0;m=1,y=0;do Ze=l+(m<<3)|0,ze=u[Ze+4>>2]|0,Ee=A+(m<<3)|0,u[Ee>>2]=u[Ze>>2],u[Ee+4>>2]=ze,m=je(m|0,y|0,1,0)|0,y=V()|0;while((y|0)<(d|0)|(y|0)==(d|0)&m>>>0<h>>>0);return m=0,m|0}if(yt=h<<3,ze=ji(yt)|0,!ze)return Ee=13,Ee|0;if(Va(ze|0,l|0,yt|0)|0,Ze=Rr(h,8)|0,!Ze)return $e(ze),Ee=13,Ee|0;e:for(;;){m=ze,E=u[m>>2]|0,m=u[m+4>>2]|0,st=xe(E|0,m|0,52)|0,V()|0,st=st&15,lt=st+-1|0,Fe=(st|0)!=0,Ve=(d|0)>0|(d|0)==0&h>>>0>0;t:do if(Fe&Ve){if(Ae=Ce(lt|0,0,52)|0,le=V()|0,lt>>>0>15){if(!((E|0)==0&(m|0)==0)){Ee=16;break e}for(y=0,l=0;;){if(y=je(y|0,l|0,1,0)|0,l=V()|0,!((l|0)<(d|0)|(l|0)==(d|0)&y>>>0<h>>>0))break t;if(_=ze+(y<<3)|0,Re=u[_>>2]|0,_=u[_+4>>2]|0,!((Re|0)==0&(_|0)==0)){m=_,Ee=16;break e}}}for(b=E,l=m,y=0,_=0;;){if(!((b|0)==0&(l|0)==0)){if(!(!0&(l&117440512|0)==0)){Ee=21;break e}if(M=xe(b|0,l|0,52)|0,V()|0,M=M&15,(M|0)<(lt|0)){m=12,Ee=27;break e}if((M|0)!=(lt|0)&&(b=b|Ae,l=l&-15728641|le,M>>>0>=st>>>0)){w=lt;do Re=Ce(7,0,(14-w|0)*3|0)|0,w=w+1|0,b=Re|b,l=V()|0|l;while(w>>>0<M>>>0)}if($=Ga(b|0,l|0,h|0,d|0)|0,H=V()|0,w=Ze+($<<3)|0,M=w,U=u[M>>2]|0,M=u[M+4>>2]|0,!((U|0)==0&(M|0)==0)){se=0,ce=0;do{if((se|0)>(d|0)|(se|0)==(d|0)&ce>>>0>h>>>0){Ee=31;break e}if((U|0)==(b|0)&(M&-117440513|0)==(l|0)){W=xe(U|0,M|0,56)|0,V()|0,W=W&7,te=W+1|0,Re=xe(U|0,M|0,45)|0,V()|0;n:do if(!(rn(Re&127)|0))M=7;else{if(U=xe(U|0,M|0,52)|0,V()|0,U=U&15,!U){M=6;break}for(M=1;;){if(Re=Ce(7,0,(15-M|0)*3|0)|0,!((Re&b|0)==0&((V()|0)&l|0)==0)){M=7;break n}if(M>>>0<U>>>0)M=M+1|0;else{M=6;break}}}while(!1);if((W+2|0)>>>0>M>>>0){Ee=41;break e}Re=Ce(te|0,0,56)|0,l=V()|0|l&-117440513,ne=w,u[ne>>2]=0,u[ne+4>>2]=0,b=Re|b}else $=je($|0,H|0,1,0)|0,$=Ua($|0,V()|0,h|0,d|0)|0,H=V()|0;ce=je(ce|0,se|0,1,0)|0,se=V()|0,w=Ze+($<<3)|0,M=w,U=u[M>>2]|0,M=u[M+4>>2]|0}while(!((U|0)==0&(M|0)==0))}Re=w,u[Re>>2]=b,u[Re+4>>2]=l}if(y=je(y|0,_|0,1,0)|0,_=V()|0,!((_|0)<(d|0)|(_|0)==(d|0)&y>>>0<h>>>0))break t;l=ze+(y<<3)|0,b=u[l>>2]|0,l=u[l+4>>2]|0}}while(!1);if(Re=je(h|0,d|0,5,0)|0,ne=V()|0,ne>>>0<0|(ne|0)==0&Re>>>0<11){Ee=85;break}if(Re=ro(h|0,d|0,6,0)|0,V()|0,Re=Rr(Re,8)|0,!Re){Ee=48;break}do if(Ve){for(te=0,l=0,W=0,se=0;;){if(M=Ze+(te<<3)|0,_=M,y=u[_>>2]|0,_=u[_+4>>2]|0,(y|0)==0&(_|0)==0)ne=W;else{U=xe(y|0,_|0,56)|0,V()|0,U=U&7,b=U+1|0,$=_&-117440513,ne=xe(y|0,_|0,45)|0,V()|0;t:do if(rn(ne&127)|0){if(H=xe(y|0,_|0,52)|0,V()|0,H=H&15,H|0)for(w=1;;){if(ne=Ce(7,0,(15-w|0)*3|0)|0,!((y&ne|0)==0&($&(V()|0)|0)==0))break t;if(w>>>0<H>>>0)w=w+1|0;else break}_=Ce(b|0,0,56)|0,y=_|y,_=V()|0|$,b=M,u[b>>2]=y,u[b+4>>2]=_,b=U+2|0}while(!1);(b|0)==7?(ne=Re+(l<<3)|0,u[ne>>2]=y,u[ne+4>>2]=_&-117440513,l=je(l|0,W|0,1,0)|0,ne=V()|0):ne=W}if(te=je(te|0,se|0,1,0)|0,se=V()|0,(se|0)<(d|0)|(se|0)==(d|0)&te>>>0<h>>>0)W=ne;else break}if(Ve){if(ce=lt>>>0>15,Ae=Ce(lt|0,0,52)|0,le=V()|0,!Fe){for(y=0,w=0,b=0,_=0;(E|0)==0&(m|0)==0||(lt=A+(y<<3)|0,u[lt>>2]=E,u[lt+4>>2]=m,y=je(y|0,w|0,1,0)|0,w=V()|0),b=je(b|0,_|0,1,0)|0,_=V()|0,!!((_|0)<(d|0)|(_|0)==(d|0)&b>>>0<h>>>0);)m=ze+(b<<3)|0,E=u[m>>2]|0,m=u[m+4>>2]|0;m=ne;break}for(y=0,w=0,_=0,b=0;;){do if(!((E|0)==0&(m|0)==0)){if(H=xe(E|0,m|0,52)|0,V()|0,H=H&15,ce|(H|0)<(lt|0)){Ee=80;break e}if((H|0)!=(lt|0)){if(M=E|Ae,U=m&-15728641|le,H>>>0>=st>>>0){$=lt;do Fe=Ce(7,0,(14-$|0)*3|0)|0,$=$+1|0,M=Fe|M,U=V()|0|U;while($>>>0<H>>>0)}}else M=E,U=m;W=Ga(M|0,U|0,h|0,d|0)|0,$=0,H=0,se=V()|0;do{if(($|0)>(d|0)|($|0)==(d|0)&H>>>0>h>>>0){Ee=81;break e}if(Fe=Ze+(W<<3)|0,te=u[Fe+4>>2]|0,(te&-117440513|0)==(U|0)&&(u[Fe>>2]|0)==(M|0)){Ee=65;break}Fe=je(W|0,se|0,1,0)|0,W=Ua(Fe|0,V()|0,h|0,d|0)|0,se=V()|0,H=je(H|0,$|0,1,0)|0,$=V()|0,Fe=Ze+(W<<3)|0}while(!((u[Fe>>2]|0)==(M|0)&&(u[Fe+4>>2]|0)==(U|0)));if((Ee|0)==65&&(Ee=0,!0&(te&117440512|0)==100663296))break;Fe=A+(y<<3)|0,u[Fe>>2]=E,u[Fe+4>>2]=m,y=je(y|0,w|0,1,0)|0,w=V()|0}while(!1);if(_=je(_|0,b|0,1,0)|0,b=V()|0,!((b|0)<(d|0)|(b|0)==(d|0)&_>>>0<h>>>0))break;m=ze+(_<<3)|0,E=u[m>>2]|0,m=u[m+4>>2]|0}m=ne}else y=0,m=ne}else y=0,l=0,m=0;while(!1);if(io(Ze|0,0,yt|0)|0,Va(ze|0,Re|0,l<<3|0)|0,$e(Re),(l|0)==0&(m|0)==0){Ee=89;break}else A=A+(y<<3)|0,d=m,h=l}if((Ee|0)==16)!0&(m&117440512|0)==0?(m=4,Ee=27):Ee=21;else if((Ee|0)==31)et(27795,27122,529,27132);else{if((Ee|0)==41)return $e(ze),$e(Ze),Ee=10,Ee|0;if((Ee|0)==48)return $e(ze),$e(Ze),Ee=13,Ee|0;(Ee|0)==80?et(27795,27122,620,27132):(Ee|0)==81?et(27795,27122,632,27132):(Ee|0)==85&&(Va(A|0,ze|0,h<<3|0)|0,Ee=89)}return(Ee|0)==21?($e(ze),$e(Ze),Ee=5,Ee|0):(Ee|0)==27?($e(ze),$e(Ze),Ee=m,Ee|0):(Ee|0)==89?($e(ze),$e(Ze),Ee=0,Ee|0):0}function zS(l,A,h,d,m,y,_){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0,_=_|0;var b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0;if(te=O,O=O+16|0,W=te,!((h|0)>0|(h|0)==0&A>>>0>0))return W=0,O=te,W|0;if((_|0)>=16)return W=12,O=te,W|0;$=0,H=0,U=0,b=0;e:for(;;){if(E=l+($<<3)|0,w=u[E>>2]|0,E=u[E+4>>2]|0,M=xe(w|0,E|0,52)|0,V()|0,(M&15|0)>(_|0)){b=12,w=11;break}if(id(W,w,E,_),M=W,E=u[M>>2]|0,M=u[M+4>>2]|0,(E|0)==0&(M|0)==0)w=U;else{w=U;do{if(!((b|0)<(y|0)|(b|0)==(y|0)&w>>>0<m>>>0)){w=10;break e}U=d+(w<<3)|0,u[U>>2]=E,u[U+4>>2]=M,w=je(w|0,b|0,1,0)|0,b=V()|0,sd(W),U=W,E=u[U>>2]|0,M=u[U+4>>2]|0}while(!((E|0)==0&(M|0)==0))}if($=je($|0,H|0,1,0)|0,H=V()|0,(H|0)<(h|0)|(H|0)==(h|0)&$>>>0<A>>>0)U=w;else{b=0,w=11;break}}return(w|0)==10?(W=14,O=te,W|0):(w|0)==11?(O=te,b|0):0}function jS(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;$=O,O=O+16|0,U=$;e:do if((h|0)>0|(h|0)==0&A>>>0>0){for(E=0,_=0,y=0,M=0;;){if(w=l+(E<<3)|0,b=u[w>>2]|0,w=u[w+4>>2]|0,!((b|0)==0&(w|0)==0)&&(w=(su(b,w,d,U)|0)==0,b=U,_=je(u[b>>2]|0,u[b+4>>2]|0,_|0,y|0)|0,y=V()|0,!w)){y=12;break}if(E=je(E|0,M|0,1,0)|0,M=V()|0,!((M|0)<(h|0)|(M|0)==(h|0)&E>>>0<A>>>0))break e}return O=$,y|0}else _=0,y=0;while(!1);return u[m>>2]=_,u[m+4>>2]=y,m=0,O=$,m|0}function $S(l,A){return l=l|0,A=A|0,A=xe(l|0,A|0,52)|0,V()|0,A&1|0}function Er(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;if(m=xe(l|0,A|0,52)|0,V()|0,m=m&15,!m)return m=0,m|0;for(d=1;;){if(h=xe(l|0,A|0,(15-d|0)*3|0)|0,V()|0,h=h&7,h|0){d=5;break}if(d>>>0<m>>>0)d=d+1|0;else{h=0,d=5;break}}return(d|0)==5?h|0:0}function Jf(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0;if(w=xe(l|0,A|0,52)|0,V()|0,w=w&15,!w)return b=A,w=l,at(b|0),w|0;for(b=1,h=0;;){y=(15-b|0)*3|0,d=Ce(7,0,y|0)|0,m=V()|0,_=xe(l|0,A|0,y|0)|0,V()|0,y=Ce(jo(_&7)|0,0,y|0)|0,_=V()|0,l=y|l&~d,A=_|A&~m;e:do if(!h)if((y&d|0)==0&(_&m|0)==0)h=0;else if(d=xe(l|0,A|0,52)|0,V()|0,d=d&15,!d)h=1;else{h=1;t:for(;;){switch(_=xe(l|0,A|0,(15-h|0)*3|0)|0,V()|0,_&7){case 1:break t;case 0:break;default:{h=1;break e}}if(h>>>0<d>>>0)h=h+1|0;else{h=1;break e}}for(h=1;;)if(_=(15-h|0)*3|0,m=xe(l|0,A|0,_|0)|0,V()|0,y=Ce(7,0,_|0)|0,A=A&~(V()|0),_=Ce(jo(m&7)|0,0,_|0)|0,l=l&~y|_,A=A|(V()|0),h>>>0<d>>>0)h=h+1|0;else{h=1;break}}while(!1);if(b>>>0<w>>>0)b=b+1|0;else break}return at(A|0),l|0}function $o(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0;if(d=xe(l|0,A|0,52)|0,V()|0,d=d&15,!d)return h=A,d=l,at(h|0),d|0;for(h=1;y=(15-h|0)*3|0,_=xe(l|0,A|0,y|0)|0,V()|0,m=Ce(7,0,y|0)|0,A=A&~(V()|0),y=Ce(jo(_&7)|0,0,y|0)|0,l=y|l&~m,A=V()|0|A,h>>>0<d>>>0;)h=h+1|0;return at(A|0),l|0}function HS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0;if(w=xe(l|0,A|0,52)|0,V()|0,w=w&15,!w)return b=A,w=l,at(b|0),w|0;for(b=1,h=0;;){y=(15-b|0)*3|0,d=Ce(7,0,y|0)|0,m=V()|0,_=xe(l|0,A|0,y|0)|0,V()|0,y=Ce(eo(_&7)|0,0,y|0)|0,_=V()|0,l=y|l&~d,A=_|A&~m;e:do if(!h)if((y&d|0)==0&(_&m|0)==0)h=0;else if(d=xe(l|0,A|0,52)|0,V()|0,d=d&15,!d)h=1;else{h=1;t:for(;;){switch(_=xe(l|0,A|0,(15-h|0)*3|0)|0,V()|0,_&7){case 1:break t;case 0:break;default:{h=1;break e}}if(h>>>0<d>>>0)h=h+1|0;else{h=1;break e}}for(h=1;;)if(m=(15-h|0)*3|0,y=Ce(7,0,m|0)|0,_=A&~(V()|0),A=xe(l|0,A|0,m|0)|0,V()|0,A=Ce(eo(A&7)|0,0,m|0)|0,l=l&~y|A,A=_|(V()|0),h>>>0<d>>>0)h=h+1|0;else{h=1;break}}while(!1);if(b>>>0<w>>>0)b=b+1|0;else break}return at(A|0),l|0}function ed(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0;if(d=xe(l|0,A|0,52)|0,V()|0,d=d&15,!d)return h=A,d=l,at(h|0),d|0;for(h=1;_=(15-h|0)*3|0,y=Ce(7,0,_|0)|0,m=A&~(V()|0),A=xe(l|0,A|0,_|0)|0,V()|0,A=Ce(eo(A&7)|0,0,_|0)|0,l=A|l&~y,A=V()|0|m,h>>>0<d>>>0;)h=h+1|0;return at(A|0),l|0}function WS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(w=O,O=O+64|0,b=w+40|0,d=w+24|0,m=w+12|0,y=w,Ce(A|0,0,52)|0,h=V()|0|134225919,!A)return(u[l+4>>2]|0)>2||(u[l+8>>2]|0)>2||(u[l+12>>2]|0)>2?(_=0,b=0,at(_|0),O=w,b|0):(Ce(W2(l)|0,0,45)|0,_=V()|0|h,b=-1,at(_|0),O=w,b|0);if(u[b>>2]=u[l>>2],u[b+4>>2]=u[l+4>>2],u[b+8>>2]=u[l+8>>2],u[b+12>>2]=u[l+12>>2],_=b+4|0,(A|0)>0)for(l=-1;u[d>>2]=u[_>>2],u[d+4>>2]=u[_+4>>2],u[d+8>>2]=u[_+8>>2],A&1?(wS(_),u[m>>2]=u[_>>2],u[m+4>>2]=u[_+4>>2],u[m+8>>2]=u[_+8>>2],tc(m)):(ey(_),u[m>>2]=u[_>>2],u[m+4>>2]=u[_+4>>2],u[m+8>>2]=u[_+8>>2],zo(m)),Hf(d,m,y),or(y),M=(15-A|0)*3|0,E=Ce(7,0,M|0)|0,h=h&~(V()|0),M=Ce(ec(y)|0,0,M|0)|0,l=M|l&~E,h=V()|0|h,(A|0)>1;)A=A+-1|0;else l=-1;e:do if((u[_>>2]|0)<=2&&(u[b+8>>2]|0)<=2&&(u[b+12>>2]|0)<=2){if(d=W2(b)|0,A=Ce(d|0,0,45)|0,A=A|l,l=V()|0|h&-1040385,y=AS(b)|0,!(rn(d)|0)){if((y|0)<=0)break;for(m=0;;){if(d=xe(A|0,l|0,52)|0,V()|0,d=d&15,d)for(h=1;M=(15-h|0)*3|0,b=xe(A|0,l|0,M|0)|0,V()|0,E=Ce(7,0,M|0)|0,l=l&~(V()|0),M=Ce(jo(b&7)|0,0,M|0)|0,A=A&~E|M,l=l|(V()|0),h>>>0<d>>>0;)h=h+1|0;if(m=m+1|0,(m|0)==(y|0))break e}}m=xe(A|0,l|0,52)|0,V()|0,m=m&15;t:do if(m){h=1;n:for(;;){switch(M=xe(A|0,l|0,(15-h|0)*3|0)|0,V()|0,M&7){case 1:break n;case 0:break;default:break t}if(h>>>0<m>>>0)h=h+1|0;else break t}if(Q2(d,u[b>>2]|0)|0)for(h=1;b=(15-h|0)*3|0,E=Ce(7,0,b|0)|0,M=l&~(V()|0),l=xe(A|0,l|0,b|0)|0,V()|0,l=Ce(eo(l&7)|0,0,b|0)|0,A=A&~E|l,l=M|(V()|0),h>>>0<m>>>0;)h=h+1|0;else for(h=1;M=(15-h|0)*3|0,b=xe(A|0,l|0,M|0)|0,V()|0,E=Ce(7,0,M|0)|0,l=l&~(V()|0),M=Ce(jo(b&7)|0,0,M|0)|0,A=A&~E|M,l=l|(V()|0),h>>>0<m>>>0;)h=h+1|0}while(!1);if((y|0)>0){h=0;do A=Jf(A,l)|0,l=V()|0,h=h+1|0;while((h|0)!=(y|0))}}else A=0,l=0;while(!1);return E=l,M=A,at(E|0),O=w,M|0}function ri(l){return l=l|0,(l|0)%2|0|0}function td(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0;return m=O,O=O+16|0,d=m,A>>>0>15?(d=4,O=m,d|0):(u[l+4>>2]&2146435072|0)==2146435072||(u[l+8+4>>2]&2146435072|0)==2146435072?(d=3,O=m,d|0):(OS(l,A,d),A=WS(d,A)|0,d=V()|0,u[h>>2]=A,u[h+4>>2]=d,(A|0)==0&(d|0)==0&&et(27795,27122,959,27145),d=0,O=m,d|0)}function nd(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;if(m=h+4|0,y=xe(l|0,A|0,52)|0,V()|0,y=y&15,_=xe(l|0,A|0,45)|0,V()|0,d=(y|0)==0,rn(_&127)|0){if(d)return _=1,_|0;d=1}else{if(d)return _=0,_|0;(u[m>>2]|0)==0&&(u[h+8>>2]|0)==0?d=(u[h+12>>2]|0)!=0&1:d=1}for(h=1;h&1?tc(m):zo(m),_=xe(l|0,A|0,(15-h|0)*3|0)|0,V()|0,ty(m,_&7),h>>>0<y>>>0;)h=h+1|0;return d|0}function Ia(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(M=O,O=O+16|0,w=M,E=xe(l|0,A|0,45)|0,V()|0,E=E&127,E>>>0>121)return u[h>>2]=0,u[h+4>>2]=0,u[h+8>>2]=0,u[h+12>>2]=0,E=5,O=M,E|0;e:do if((rn(E)|0)!=0&&(y=xe(l|0,A|0,52)|0,V()|0,y=y&15,(y|0)!=0)){d=1;t:for(;;){switch(b=xe(l|0,A|0,(15-d|0)*3|0)|0,V()|0,b&7){case 5:break t;case 0:break;default:{d=A;break e}}if(d>>>0<y>>>0)d=d+1|0;else{d=A;break e}}for(m=1,d=A;A=(15-m|0)*3|0,_=Ce(7,0,A|0)|0,b=d&~(V()|0),d=xe(l|0,d|0,A|0)|0,V()|0,d=Ce(eo(d&7)|0,0,A|0)|0,l=l&~_|d,d=b|(V()|0),m>>>0<y>>>0;)m=m+1|0}else d=A;while(!1);if(b=7696+(E*28|0)|0,u[h>>2]=u[b>>2],u[h+4>>2]=u[b+4>>2],u[h+8>>2]=u[b+8>>2],u[h+12>>2]=u[b+12>>2],!(nd(l,d,h)|0))return E=0,O=M,E|0;if(_=h+4|0,u[w>>2]=u[_>>2],u[w+4>>2]=u[_+4>>2],u[w+8>>2]=u[_+8>>2],y=xe(l|0,d|0,52)|0,V()|0,b=y&15,y&1?(zo(_),y=b+1|0):y=b,!(rn(E)|0))d=0;else{e:do if(!b)d=0;else for(A=1;;){if(m=xe(l|0,d|0,(15-A|0)*3|0)|0,V()|0,m=m&7,m|0){d=m;break e}if(A>>>0<b>>>0)A=A+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(Fa(h,y,d,0)|0))(y|0)!=(b|0)&&(u[_>>2]=u[w>>2],u[_+4>>2]=u[w+4>>2],u[_+8>>2]=u[w+8>>2]);else{if(rn(E)|0)do;while((Fa(h,y,0,0)|0)!=0);(y|0)!=(b|0)&&ey(_)}return E=0,O=M,E|0}function Ho(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;return y=O,O=O+16|0,d=y,m=Ia(l,A,d)|0,m|0?(O=y,m|0):(m=xe(l|0,A|0,52)|0,V()|0,kS(d,m&15,h),m=0,O=y,m|0)}function ka(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0;if(_=O,O=O+16|0,y=_,d=Ia(l,A,y)|0,d|0)return y=d,O=_,y|0;d=xe(l|0,A|0,45)|0,V()|0,d=(rn(d&127)|0)==0,m=xe(l|0,A|0,52)|0,V()|0,m=m&15;e:do if(!d){if(m|0)for(d=1;;){if(b=Ce(7,0,(15-d|0)*3|0)|0,!((b&l|0)==0&((V()|0)&A|0)==0))break e;if(d>>>0<m>>>0)d=d+1|0;else break}return Qf(y,m,0,5,h),b=0,O=_,b|0}while(!1);return Xf(y,m,0,6,h),b=0,O=_,b|0}function QS(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;if(m=xe(l|0,A|0,45)|0,V()|0,!(rn(m&127)|0))return m=2,u[h>>2]=m,0;if(m=xe(l|0,A|0,52)|0,V()|0,m=m&15,!m)return m=5,u[h>>2]=m,0;for(d=1;;){if(y=Ce(7,0,(15-d|0)*3|0)|0,!((y&l|0)==0&((V()|0)&A|0)==0)){d=2,l=6;break}if(d>>>0<m>>>0)d=d+1|0;else{d=5,l=6;break}}return(l|0)==6&&(u[h>>2]=d),0}function cy(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0;U=O,O=O+128|0,E=U+112|0,y=U+96|0,M=U,m=xe(l|0,A|0,52)|0,V()|0,b=m&15,u[E>>2]=b,_=xe(l|0,A|0,45)|0,V()|0,_=_&127;e:do if(rn(_)|0){if(b|0)for(d=1;;){if(w=Ce(7,0,(15-d|0)*3|0)|0,!((w&l|0)==0&((V()|0)&A|0)==0)){m=0;break e}if(d>>>0<b>>>0)d=d+1|0;else break}if(m&1)m=1;else return w=Ce(b+1|0,0,52)|0,M=V()|0|A&-15728641,E=Ce(7,0,(14-b|0)*3|0)|0,M=cy((w|l)&~E,M&~(V()|0),h)|0,O=U,M|0}else m=0;while(!1);if(d=Ia(l,A,y)|0,!d){m?(oy(y,E,M),w=5):(ay(y,E,M),w=6);e:do if(rn(_)|0)if(!b)l=5;else for(d=1;;){if(_=Ce(7,0,(15-d|0)*3|0)|0,!((_&l|0)==0&((V()|0)&A|0)==0)){l=2;break e}if(d>>>0<b>>>0)d=d+1|0;else{l=5;break}}else l=2;while(!1);io(h|0,-1,l<<2|0)|0;e:do if(m)for(y=0;;){if(_=M+(y<<4)|0,qS(_,u[E>>2]|0)|0,_=u[_>>2]|0,b=u[h>>2]|0,(b|0)==-1|(b|0)==(_|0))d=h;else{m=0;do{if(m=m+1|0,m>>>0>=l>>>0){d=1;break e}d=h+(m<<2)|0,b=u[d>>2]|0}while(!((b|0)==-1|(b|0)==(_|0)))}if(u[d>>2]=_,y=y+1|0,y>>>0>=w>>>0){d=0;break}}else for(y=0;;){if(_=M+(y<<4)|0,Fa(_,u[E>>2]|0,0,1)|0,_=u[_>>2]|0,b=u[h>>2]|0,(b|0)==-1|(b|0)==(_|0))d=h;else{m=0;do{if(m=m+1|0,m>>>0>=l>>>0){d=1;break e}d=h+(m<<2)|0,b=u[d>>2]|0}while(!((b|0)==-1|(b|0)==(_|0)))}if(u[d>>2]=_,y=y+1|0,y>>>0>=w>>>0){d=0;break}}while(!1)}return M=d,O=U,M|0}function XS(){return 12}function rd(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0;if(l>>>0>15)return b=4,b|0;if(Ce(l|0,0,52)|0,b=V()|0|134225919,!l){h=0,d=0;do rn(d)|0&&(Ce(d|0,0,45)|0,_=b|(V()|0),l=A+(h<<3)|0,u[l>>2]=-1,u[l+4>>2]=_,h=h+1|0),d=d+1|0;while((d|0)!=122);return h=0,h|0}h=0,_=0;do{if(rn(_)|0){for(Ce(_|0,0,45)|0,d=1,m=-1,y=b|(V()|0);w=Ce(7,0,(15-d|0)*3|0)|0,m=m&~w,y=y&~(V()|0),(d|0)!=(l|0);)d=d+1|0;w=A+(h<<3)|0,u[w>>2]=m,u[w+4>>2]=y,h=h+1|0}_=_+1|0}while((_|0)!=122);return h=0,h|0}function YS(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0;if(Ae=O,O=O+16|0,se=Ae,ce=xe(l|0,A|0,52)|0,V()|0,ce=ce&15,h>>>0>15)return ce=4,O=Ae,ce|0;if((ce|0)<(h|0))return ce=12,O=Ae,ce|0;if((ce|0)!=(h|0))if(y=Ce(h|0,0,52)|0,y=y|l,b=V()|0|A&-15728641,(ce|0)>(h|0)){w=h;do te=Ce(7,0,(14-w|0)*3|0)|0,w=w+1|0,y=te|y,b=V()|0|b;while((w|0)<(ce|0));te=y}else te=y;else te=l,b=A;W=xe(te|0,b|0,45)|0,V()|0;e:do if(rn(W&127)|0){if(w=xe(te|0,b|0,52)|0,V()|0,w=w&15,w|0)for(y=1;;){if(W=Ce(7,0,(15-y|0)*3|0)|0,!((W&te|0)==0&((V()|0)&b|0)==0)){E=33;break e}if(y>>>0<w>>>0)y=y+1|0;else break}if(W=d,u[W>>2]=0,u[W+4>>2]=0,(ce|0)>(h|0)){for(W=A&-15728641,H=ce;;){if($=H,H=H+-1|0,H>>>0>15|(ce|0)<(H|0)){E=19;break}if((ce|0)!=(H|0))if(y=Ce(H|0,0,52)|0,y=y|l,w=V()|0|W,(ce|0)<($|0))U=y;else{E=H;do U=Ce(7,0,(14-E|0)*3|0)|0,E=E+1|0,y=U|y,w=V()|0|w;while((E|0)<(ce|0));U=y}else U=l,w=A;if(M=xe(U|0,w|0,45)|0,V()|0,!(rn(M&127)|0))y=0;else{M=xe(U|0,w|0,52)|0,V()|0,M=M&15;t:do if(!M)y=0;else for(E=1;;){if(y=xe(U|0,w|0,(15-E|0)*3|0)|0,V()|0,y=y&7,y|0)break t;if(E>>>0<M>>>0)E=E+1|0;else{y=0;break}}while(!1);y=(y|0)==0&1}if(w=xe(l|0,A|0,(15-$|0)*3|0)|0,V()|0,w=w&7,(w|0)==7){m=5,E=42;break}if(y=(y|0)!=0,(w|0)==1&y){m=5,E=42;break}if(U=w+(((w|0)!=0&y)<<31>>31)|0,U|0&&(E=ce-$|0,E=to(7,0,E,((E|0)<0)<<31>>31)|0,M=V()|0,y?(y=Hn(E|0,M|0,5,0)|0,y=je(y|0,V()|0,-5,-1)|0,y=ro(y|0,V()|0,6,0)|0,y=je(y|0,V()|0,1,0)|0,w=V()|0):(y=E,w=M),$=U+-1|0,$=Hn(E|0,M|0,$|0,(($|0)<0)<<31>>31|0)|0,$=je(y|0,w|0,$|0,V()|0)|0,U=V()|0,M=d,M=je($|0,U|0,u[M>>2]|0,u[M+4>>2]|0)|0,U=V()|0,$=d,u[$>>2]=M,u[$+4>>2]=U),(H|0)<=(h|0)){E=37;break}}if((E|0)==19)et(27795,27122,1276,27158);else if((E|0)==37){_=d,m=u[_+4>>2]|0,_=u[_>>2]|0;break}else if((E|0)==42)return O=Ae,m|0}else m=0,_=0}else E=33;while(!1);e:do if((E|0)==33)if(W=d,u[W>>2]=0,u[W+4>>2]=0,(ce|0)>(h|0)){for(y=ce;;){if(m=xe(l|0,A|0,(15-y|0)*3|0)|0,V()|0,m=m&7,(m|0)==7){m=5;break}if(_=ce-y|0,_=to(7,0,_,((_|0)<0)<<31>>31)|0,m=Hn(_|0,V()|0,m|0,0)|0,_=V()|0,W=d,_=je(u[W>>2]|0,u[W+4>>2]|0,m|0,_|0)|0,m=V()|0,W=d,u[W>>2]=_,u[W+4>>2]=m,y=y+-1|0,(y|0)<=(h|0))break e}return O=Ae,m|0}else m=0,_=0;while(!1);return su(te,b,ce,se)|0&&et(27795,27122,1236,27173),ce=se,se=u[ce+4>>2]|0,((m|0)>-1|(m|0)==-1&_>>>0>4294967295)&((se|0)>(m|0)|((se|0)==(m|0)?(u[ce>>2]|0)>>>0>_>>>0:0))?(ce=0,O=Ae,ce|0):(et(27795,27122,1316,27158),0)}function KS(l,A,h,d,m,y){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0;var _=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0;if(U=O,O=O+16|0,_=U,m>>>0>15)return y=4,O=U,y|0;if(b=xe(h|0,d|0,52)|0,V()|0,b=b&15,(b|0)>(m|0))return y=12,O=U,y|0;if(su(h,d,m,_)|0&&et(27795,27122,1236,27173),M=_,E=u[M+4>>2]|0,!(((A|0)>-1|(A|0)==-1&l>>>0>4294967295)&((E|0)>(A|0)|((E|0)==(A|0)?(u[M>>2]|0)>>>0>l>>>0:0))))return y=2,O=U,y|0;M=m-b|0,m=Ce(m|0,0,52)|0,w=V()|0|d&-15728641,E=y,u[E>>2]=m|h,u[E+4>>2]=w,E=xe(h|0,d|0,45)|0,V()|0;e:do if(rn(E&127)|0){if(b|0)for(_=1;;){if(E=Ce(7,0,(15-_|0)*3|0)|0,!((E&h|0)==0&((V()|0)&d|0)==0))break e;if(_>>>0<b>>>0)_=_+1|0;else break}if((M|0)<1)return y=0,O=U,y|0;for(E=b^15,d=-1,w=1,_=1;;){b=M-w|0,b=to(7,0,b,((b|0)<0)<<31>>31)|0,h=V()|0;do if(_)if(_=Hn(b|0,h|0,5,0)|0,_=je(_|0,V()|0,-5,-1)|0,_=ro(_|0,V()|0,6,0)|0,m=V()|0,(A|0)>(m|0)|(A|0)==(m|0)&l>>>0>_>>>0){A=je(l|0,A|0,-1,-1)|0,A=Kn(A|0,V()|0,_|0,m|0)|0,_=V()|0,$=y,W=u[$>>2]|0,$=u[$+4>>2]|0,te=(E+d|0)*3|0,H=Ce(7,0,te|0)|0,$=$&~(V()|0),d=ro(A|0,_|0,b|0,h|0)|0,l=V()|0,m=je(d|0,l|0,2,0)|0,te=Ce(m|0,V()|0,te|0)|0,$=V()|0|$,m=y,u[m>>2]=te|W&~H,u[m+4>>2]=$,l=Hn(d|0,l|0,b|0,h|0)|0,l=Kn(A|0,_|0,l|0,V()|0)|0,_=0,A=V()|0;break}else{te=y,H=u[te>>2]|0,te=u[te+4>>2]|0,W=Ce(7,0,(E+d|0)*3|0)|0,te=te&~(V()|0),_=y,u[_>>2]=H&~W,u[_+4>>2]=te,_=1;break}else H=y,m=u[H>>2]|0,H=u[H+4>>2]|0,d=(E+d|0)*3|0,$=Ce(7,0,d|0)|0,H=H&~(V()|0),te=ro(l|0,A|0,b|0,h|0)|0,_=V()|0,d=Ce(te|0,_|0,d|0)|0,H=V()|0|H,W=y,u[W>>2]=d|m&~$,u[W+4>>2]=H,_=Hn(te|0,_|0,b|0,h|0)|0,l=Kn(l|0,A|0,_|0,V()|0)|0,_=0,A=V()|0;while(!1);if((M|0)>(w|0))d=~w,w=w+1|0;else{A=0;break}}return O=U,A|0}while(!1);if((M|0)<1)return te=0,O=U,te|0;for(m=b^15,_=1;;)if(W=M-_|0,W=to(7,0,W,((W|0)<0)<<31>>31)|0,te=V()|0,w=y,h=u[w>>2]|0,w=u[w+4>>2]|0,b=(m-_|0)*3|0,d=Ce(7,0,b|0)|0,w=w&~(V()|0),$=ro(l|0,A|0,W|0,te|0)|0,H=V()|0,b=Ce($|0,H|0,b|0)|0,w=V()|0|w,E=y,u[E>>2]=b|h&~d,u[E+4>>2]=w,te=Hn($|0,H|0,W|0,te|0)|0,l=Kn(l|0,A|0,te|0,V()|0)|0,A=V()|0,(M|0)<=(_|0)){A=0;break}else _=_+1|0;return O=U,A|0}function id(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0;m=xe(A|0,h|0,52)|0,V()|0,m=m&15,(A|0)==0&(h|0)==0|((d|0)>15|(m|0)>(d|0))?(y=-1,A=-1,h=0,m=0):(A=uy(A,h,m+1|0,d)|0,_=(V()|0)&-15728641,h=Ce(d|0,0,52)|0,h=A|h,_=_|(V()|0),A=(Qt(h,_)|0)==0,y=m,A=A?-1:d,m=_),_=l,u[_>>2]=h,u[_+4>>2]=m,u[l+8>>2]=y,u[l+12>>2]=A}function hy(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0;if(m=xe(l|0,A|0,52)|0,V()|0,m=m&15,y=d+8|0,u[y>>2]=m,(l|0)==0&(A|0)==0|((h|0)>15|(m|0)>(h|0))){h=d,u[h>>2]=0,u[h+4>>2]=0,u[y>>2]=-1,u[d+12>>2]=-1;return}if(l=uy(l,A,m+1|0,h)|0,y=(V()|0)&-15728641,m=Ce(h|0,0,52)|0,m=l|m,y=y|(V()|0),l=d,u[l>>2]=m,u[l+4>>2]=y,l=d+12|0,Qt(m,y)|0){u[l>>2]=h;return}else{u[l>>2]=-1;return}}function sd(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0;if(h=l,A=u[h>>2]|0,h=u[h+4>>2]|0,!((A|0)==0&(h|0)==0)&&(d=xe(A|0,h|0,52)|0,V()|0,d=d&15,b=Ce(1,0,(d^15)*3|0)|0,A=je(b|0,V()|0,A|0,h|0)|0,h=V()|0,b=l,u[b>>2]=A,u[b+4>>2]=h,b=l+8|0,_=u[b>>2]|0,!((d|0)<(_|0)))){for(w=l+12|0,y=d;;){if((y|0)==(_|0)){d=5;break}if(E=(y|0)==(u[w>>2]|0),m=(15-y|0)*3|0,d=xe(A|0,h|0,m|0)|0,V()|0,d=d&7,E&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(E=Ce(1,0,m|0)|0,A=je(A|0,h|0,E|0,V()|0)|0,h=V()|0,E=l,u[E>>2]=A,u[E+4>>2]=h,(y|0)>(_|0))y=y+-1|0;else{d=10;break}}if((d|0)==5){E=l,u[E>>2]=0,u[E+4>>2]=0,u[b>>2]=-1,u[w>>2]=-1;return}else if((d|0)==7){_=Ce(1,0,m|0)|0,_=je(A|0,h|0,_|0,V()|0)|0,b=V()|0,E=l,u[E>>2]=_,u[E+4>>2]=b,u[w>>2]=y+-1;return}else if((d|0)==10)return}}function ou(l){l=+l;var A=0;return A=l<0?l+6.283185307179586:l,+(l>=6.283185307179586?A+-6.283185307179586:A)}function qa(l,A){return l=l|0,A=A|0,+mt(+(+L[l>>3]-+L[A>>3]))<17453292519943298e-27?(A=+mt(+(+L[l+8>>3]-+L[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function Ur(l,A){switch(l=+l,A=A|0,A|0){case 1:{l=l<0?l+6.283185307179586:l;break}case 2:{l=l>0?l+-6.283185307179586:l;break}}return+l}function ZS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;return m=+L[A>>3],d=+L[l>>3],y=+gt(+((m-d)*.5)),h=+gt(+((+L[A+8>>3]-+L[l+8>>3])*.5)),h=y*y+h*(+Bt(+m)*+Bt(+d)*h),+(+ni(+ +Rt(+h),+ +Rt(+(1-h)))*2)}function au(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;return m=+L[A>>3],d=+L[l>>3],y=+gt(+((m-d)*.5)),h=+gt(+((+L[A+8>>3]-+L[l+8>>3])*.5)),h=y*y+h*(+Bt(+m)*+Bt(+d)*h),+(+ni(+ +Rt(+h),+ +Rt(+(1-h)))*2*6371.007180918475)}function JS(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;return m=+L[A>>3],d=+L[l>>3],y=+gt(+((m-d)*.5)),h=+gt(+((+L[A+8>>3]-+L[l+8>>3])*.5)),h=y*y+h*(+Bt(+m)*+Bt(+d)*h),+(+ni(+ +Rt(+h),+ +Rt(+(1-h)))*2*6371.007180918475*1e3)}function eE(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0;return y=+L[A>>3],d=+Bt(+y),m=+L[A+8>>3]-+L[l+8>>3],_=d*+gt(+m),h=+L[l>>3],+ +ni(+_,+(+gt(+y)*+Bt(+h)-+Bt(+m)*(d*+gt(+h))))}function tE(l,A,h,d){l=l|0,A=+A,h=+h,d=d|0;var m=0,y=0,_=0,b=0;if(h<1e-16){u[d>>2]=u[l>>2],u[d+4>>2]=u[l+4>>2],u[d+8>>2]=u[l+8>>2],u[d+12>>2]=u[l+12>>2];return}y=A<0?A+6.283185307179586:A,y=A>=6.283185307179586?y+-6.283185307179586:y;do if(y<1e-16)A=+L[l>>3]+h,L[d>>3]=A,m=d;else{if(m=+mt(+(y+-3.141592653589793))<1e-16,A=+L[l>>3],m){A=A-h,L[d>>3]=A,m=d;break}if(_=+Bt(+h),h=+gt(+h),A=_*+gt(+A)+ +Bt(+y)*(h*+Bt(+A)),A=A>1?1:A,A=+H7(+(A<-1?-1:A)),L[d>>3]=A,+mt(+(A+-1.5707963267948966))<1e-16){L[d>>3]=1.5707963267948966,L[d+8>>3]=0;return}if(+mt(+(A+1.5707963267948966))<1e-16){L[d>>3]=-1.5707963267948966,L[d+8>>3]=0;return}if(b=1/+Bt(+A),y=h*+gt(+y)*b,h=+L[l>>3],A=b*((_-+gt(+A)*+gt(+h))/+Bt(+h)),_=y>1?1:y,A=A>1?1:A,A=+L[l+8>>3]+ +ni(+(_<-1?-1:_),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);L[d+8>>3]=A;return}while(!1);if(+mt(+(A+-1.5707963267948966))<1e-16){L[m>>3]=1.5707963267948966,L[d+8>>3]=0;return}if(+mt(+(A+1.5707963267948966))<1e-16){L[m>>3]=-1.5707963267948966,L[d+8>>3]=0;return}if(A=+L[l+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);L[d+8>>3]=A}function fy(l,A){return l=l|0,A=A|0,l>>>0>15?(A=4,A|0):(L[A>>3]=+L[20656+(l<<3)>>3],A=0,A|0)}function nE(l,A){return l=l|0,A=A|0,l>>>0>15?(A=4,A|0):(L[A>>3]=+L[20784+(l<<3)>>3],A=0,A|0)}function rE(l,A){return l=l|0,A=A|0,l>>>0>15?(A=4,A|0):(L[A>>3]=+L[20912+(l<<3)>>3],A=0,A|0)}function iE(l,A){return l=l|0,A=A|0,l>>>0>15?(A=4,A|0):(L[A>>3]=+L[21040+(l<<3)>>3],A=0,A|0)}function ic(l,A){l=l|0,A=A|0;var h=0;return l>>>0>15?(A=4,A|0):(h=to(7,0,l,((l|0)<0)<<31>>31)|0,h=Hn(h|0,V()|0,120,0)|0,l=V()|0,u[A>>2]=h|2,u[A+4>>2]=l,A=0,A|0)}function dy(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;return $=+L[A>>3],M=+L[l>>3],w=+gt(+(($-M)*.5)),y=+L[A+8>>3],E=+L[l+8>>3],_=+gt(+((y-E)*.5)),b=+Bt(+M),U=+Bt(+$),_=w*w+_*(U*b*_),_=+ni(+ +Rt(+_),+ +Rt(+(1-_)))*2,w=+L[h>>3],$=+gt(+((w-$)*.5)),d=+L[h+8>>3],y=+gt(+((d-y)*.5)),m=+Bt(+w),y=$*$+y*(U*m*y),y=+ni(+ +Rt(+y),+ +Rt(+(1-y)))*2,w=+gt(+((M-w)*.5)),d=+gt(+((E-d)*.5)),d=w*w+d*(b*m*d),d=+ni(+ +Rt(+d),+ +Rt(+(1-d)))*2,m=(_+y+d)*.5,+(+kf(+ +Rt(+(+ti(+(m*.5))*+ti(+((m-_)*.5))*+ti(+((m-y)*.5))*+ti(+((m-d)*.5)))))*4)}function od(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0;if(b=O,O=O+192|0,y=b+168|0,_=b,m=Ho(l,A,y)|0,m|0)return h=m,O=b,h|0;if(ka(l,A,_)|0&&et(27795,27190,415,27199),A=u[_>>2]|0,(A|0)>0){if(d=+dy(_+8|0,_+8+(((A|0)!=1&1)<<4)|0,y)+0,(A|0)!=1){l=1;do m=l,l=l+1|0,d=d+ +dy(_+8+(m<<4)|0,_+8+(((l|0)%(A|0)|0)<<4)|0,y);while((l|0)<(A|0))}}else d=0;return L[h>>3]=d,h=0,O=b,h|0}function sE(l,A,h){return l=l|0,A=A|0,h=h|0,l=od(l,A,h)|0,l|0||(L[h>>3]=+L[h>>3]*6371.007180918475*6371.007180918475),l|0}function oE(l,A,h){return l=l|0,A=A|0,h=h|0,l=od(l,A,h)|0,l|0||(L[h>>3]=+L[h>>3]*6371.007180918475*6371.007180918475*1e3*1e3),l|0}function aE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(b=O,O=O+176|0,_=b,l=rc(l,A,_)|0,l|0)return _=l,O=b,_|0;if(L[h>>3]=0,l=u[_>>2]|0,(l|0)<=1)return _=0,O=b,_|0;A=l+-1|0,l=0,d=+L[_+8>>3],m=+L[_+16>>3],y=0;do l=l+1|0,E=d,d=+L[_+8+(l<<4)>>3],M=+gt(+((d-E)*.5)),w=m,m=+L[_+8+(l<<4)+8>>3],w=+gt(+((m-w)*.5)),w=M*M+w*(+Bt(+d)*+Bt(+E)*w),y=y+ +ni(+ +Rt(+w),+ +Rt(+(1-w)))*2;while((l|0)<(A|0));return L[h>>3]=y,_=0,O=b,_|0}function lE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(b=O,O=O+176|0,_=b,l=rc(l,A,_)|0,l|0)return _=l,y=+L[h>>3],y=y*6371.007180918475,L[h>>3]=y,O=b,_|0;if(L[h>>3]=0,l=u[_>>2]|0,(l|0)<=1)return _=0,y=0,y=y*6371.007180918475,L[h>>3]=y,O=b,_|0;A=l+-1|0,l=0,d=+L[_+8>>3],m=+L[_+16>>3],y=0;do l=l+1|0,E=d,d=+L[_+8+(l<<4)>>3],M=+gt(+((d-E)*.5)),w=m,m=+L[_+8+(l<<4)+8>>3],w=+gt(+((m-w)*.5)),w=M*M+w*(+Bt(+E)*+Bt(+d)*w),y=y+ +ni(+ +Rt(+w),+ +Rt(+(1-w)))*2;while((l|0)!=(A|0));return L[h>>3]=y,_=0,M=y,M=M*6371.007180918475,L[h>>3]=M,O=b,_|0}function uE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(b=O,O=O+176|0,_=b,l=rc(l,A,_)|0,l|0)return _=l,y=+L[h>>3],y=y*6371.007180918475,y=y*1e3,L[h>>3]=y,O=b,_|0;if(L[h>>3]=0,l=u[_>>2]|0,(l|0)<=1)return _=0,y=0,y=y*6371.007180918475,y=y*1e3,L[h>>3]=y,O=b,_|0;A=l+-1|0,l=0,d=+L[_+8>>3],m=+L[_+16>>3],y=0;do l=l+1|0,E=d,d=+L[_+8+(l<<4)>>3],M=+gt(+((d-E)*.5)),w=m,m=+L[_+8+(l<<4)+8>>3],w=+gt(+((m-w)*.5)),w=M*M+w*(+Bt(+E)*+Bt(+d)*w),y=y+ +ni(+ +Rt(+w),+ +Rt(+(1-w)))*2;while((l|0)!=(A|0));return L[h>>3]=y,_=0,M=y,M=M*6371.007180918475,M=M*1e3,L[h>>3]=M,O=b,_|0}function AE(l){l=l|0;var A=0,h=0,d=0;return A=Rr(1,12)|0,A||et(27280,27235,49,27293),h=l+4|0,d=u[h>>2]|0,d|0?(d=d+8|0,u[d>>2]=A,u[h>>2]=A,A|0):(u[l>>2]|0&&et(27310,27235,61,27333),d=l,u[d>>2]=A,u[h>>2]=A,A|0)}function cE(l,A){l=l|0,A=A|0;var h=0,d=0;return d=ji(24)|0,d||et(27347,27235,78,27361),u[d>>2]=u[A>>2],u[d+4>>2]=u[A+4>>2],u[d+8>>2]=u[A+8>>2],u[d+12>>2]=u[A+12>>2],u[d+16>>2]=0,A=l+4|0,h=u[A>>2]|0,h|0?(u[h+16>>2]=d,u[A>>2]=d,d|0):(u[l>>2]|0&&et(27376,27235,82,27361),u[l>>2]=d,u[A>>2]=d,d|0)}function py(l){l=l|0;var A=0,h=0,d=0,m=0;if(l)for(d=1;;){if(A=u[l>>2]|0,A|0)do{if(h=u[A>>2]|0,h|0)do m=h,h=u[h+16>>2]|0,$e(m);while((h|0)!=0);m=A,A=u[A+8>>2]|0,$e(m)}while((A|0)!=0);if(A=l,l=u[l+8>>2]|0,d||$e(A),l)d=0;else break}}function hE(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0,lt=0,yt=0,Ze=0,ze=0,Ee=0,dt=0,jt=0,At=0;if(m=l+8|0,u[m>>2]|0)return At=1,At|0;if(d=u[l>>2]|0,!d)return At=0,At|0;A=d,h=0;do h=h+1|0,A=u[A+8>>2]|0;while((A|0)!=0);if(h>>>0<2)return At=0,At|0;dt=ji(h<<2)|0,dt||et(27396,27235,317,27415),Ee=ji(h<<5)|0,Ee||et(27437,27235,321,27415),u[l>>2]=0,Ve=l+4|0,u[Ve>>2]=0,u[m>>2]=0,h=0,ze=0,Re=0,U=0;e:for(;;){if(M=u[d>>2]|0,M){y=0,_=M;do{if(w=+L[_+8>>3],A=_,_=u[_+16>>2]|0,E=(_|0)==0,m=E?M:_,b=+L[m+8>>3],+mt(+(w-b))>3.141592653589793){At=14;break}y=y+(b-w)*(+L[A>>3]+ +L[m>>3])}while(!E);if((At|0)==14){At=0,y=0,A=M;do ne=+L[A+8>>3],Ze=A+16|0,yt=u[Ze>>2]|0,yt=(yt|0)==0?M:yt,le=+L[yt+8>>3],y=y+(+L[A>>3]+ +L[yt>>3])*((le<0?le+6.283185307179586:le)-(ne<0?ne+6.283185307179586:ne)),A=u[((A|0)==0?d:Ze)>>2]|0;while((A|0)!=0)}y>0?(u[dt+(ze<<2)>>2]=d,ze=ze+1|0,m=Re,A=U):At=19}else At=19;if((At|0)==19){At=0;do if(h){if(A=h+8|0,u[A>>2]|0){At=21;break e}if(h=Rr(1,12)|0,!h){At=23;break e}u[A>>2]=h,m=h+4|0,_=h,A=U}else if(U){m=Ve,_=U+8|0,A=d,h=l;break}else if(u[l>>2]|0){At=27;break e}else{m=Ve,_=l,A=d,h=l;break}while(!1);if(u[_>>2]=d,u[m>>2]=d,_=Ee+(Re<<5)|0,E=u[d>>2]|0,E){for(M=Ee+(Re<<5)+8|0,L[M>>3]=17976931348623157e292,U=Ee+(Re<<5)+24|0,L[U>>3]=17976931348623157e292,L[_>>3]=-17976931348623157e292,$=Ee+(Re<<5)+16|0,L[$>>3]=-17976931348623157e292,ce=17976931348623157e292,Ae=-17976931348623157e292,m=0,H=E,w=17976931348623157e292,te=17976931348623157e292,se=-17976931348623157e292,b=-17976931348623157e292;y=+L[H>>3],ne=+L[H+8>>3],H=u[H+16>>2]|0,W=(H|0)==0,le=+L[(W?E:H)+8>>3],y<w&&(L[M>>3]=y,w=y),ne<te&&(L[U>>3]=ne,te=ne),y>se?L[_>>3]=y:y=se,ne>b&&(L[$>>3]=ne,b=ne),ce=ne>0&ne<ce?ne:ce,Ae=ne<0&ne>Ae?ne:Ae,m=m|+mt(+(ne-le))>3.141592653589793,!W;)se=y;m&&(L[$>>3]=Ae,L[U>>3]=ce)}else u[_>>2]=0,u[_+4>>2]=0,u[_+8>>2]=0,u[_+12>>2]=0,u[_+16>>2]=0,u[_+20>>2]=0,u[_+24>>2]=0,u[_+28>>2]=0;m=Re+1|0}if(Ze=d+8|0,d=u[Ze>>2]|0,u[Ze>>2]=0,d)Re=m,U=A;else{At=45;break}}if((At|0)==21)et(27213,27235,35,27247);else if((At|0)==23)et(27267,27235,37,27247);else if((At|0)==27)et(27310,27235,61,27333);else if((At|0)==45){e:do if((ze|0)>0){for(Ze=(m|0)==0,lt=m<<2,yt=(l|0)==0,st=0,A=0;;){if(Fe=u[dt+(st<<2)>>2]|0,Ze)At=73;else{if(Re=ji(lt)|0,!Re){At=50;break}if(Ve=ji(lt)|0,!Ve){At=52;break}t:do if(yt)h=0;else{for(m=0,h=0,_=l;d=Ee+(m<<5)|0,my(u[_>>2]|0,d,u[Fe>>2]|0)|0?(u[Re+(h<<2)>>2]=_,u[Ve+(h<<2)>>2]=d,W=h+1|0):W=h,_=u[_+8>>2]|0,_;)m=m+1|0,h=W;if((W|0)>0)if(d=u[Re>>2]|0,(W|0)==1)h=d;else for($=0,H=-1,h=d,U=d;;){for(E=u[U>>2]|0,d=0,_=0;m=u[u[Re+(_<<2)>>2]>>2]|0,(m|0)==(E|0)?M=d:M=d+((my(m,u[Ve+(_<<2)>>2]|0,u[E>>2]|0)|0)&1)|0,_=_+1|0,(_|0)!=(W|0);)d=M;if(m=(M|0)>(H|0),h=m?U:h,d=$+1|0,(d|0)==(W|0))break t;$=d,H=m?M:H,U=u[Re+(d<<2)>>2]|0}else h=0}while(!1);if($e(Re),$e(Ve),h){if(m=h+4|0,d=u[m>>2]|0,d)h=d+8|0;else if(u[h>>2]|0){At=70;break}u[h>>2]=Fe,u[m>>2]=Fe}else At=73}if((At|0)==73){if(At=0,A=u[Fe>>2]|0,A|0)do Ve=A,A=u[A+16>>2]|0,$e(Ve);while((A|0)!=0);$e(Fe),A=1}if(st=st+1|0,(st|0)>=(ze|0)){jt=A;break e}}(At|0)==50?et(27452,27235,249,27471):(At|0)==52?et(27490,27235,252,27471):(At|0)==70&&et(27310,27235,61,27333)}else jt=0;while(!1);return $e(dt),$e(Ee),At=jt,At|0}return 0}function my(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(!(jf(A,h)|0)||(A=X2(A)|0,d=+L[h>>3],m=+L[h+8>>3],m=A&m<0?m+6.283185307179586:m,l=u[l>>2]|0,!l))return l=0,l|0;if(A){A=0,E=m,h=l;e:for(;;){for(;_=+L[h>>3],m=+L[h+8>>3],h=h+16|0,M=u[h>>2]|0,M=(M|0)==0?l:M,y=+L[M>>3],b=+L[M+8>>3],_>y?(w=_,_=b):(w=y,y=_,_=m,m=b),d=d==y|d==w?d+2220446049250313e-31:d,!!(d<y|d>w);)if(h=u[h>>2]|0,!h){h=22;break e}if(b=_<0?_+6.283185307179586:_,_=m<0?m+6.283185307179586:m,E=b==E|_==E?E+-2220446049250313e-31:E,w=b+(_-b)*((d-y)/(w-y)),(w<0?w+6.283185307179586:w)>E&&(A=A^1),h=u[h>>2]|0,!h){h=22;break}}if((h|0)==22)return A|0}else{A=0,E=m,h=l;e:for(;;){for(;_=+L[h>>3],m=+L[h+8>>3],h=h+16|0,M=u[h>>2]|0,M=(M|0)==0?l:M,y=+L[M>>3],b=+L[M+8>>3],_>y?(w=_,_=b):(w=y,y=_,_=m,m=b),d=d==y|d==w?d+2220446049250313e-31:d,!!(d<y|d>w);)if(h=u[h>>2]|0,!h){h=22;break e}if(E=_==E|m==E?E+-2220446049250313e-31:E,_+(m-_)*((d-y)/(w-y))>E&&(A=A^1),h=u[h>>2]|0,!h){h=22;break}}if((h|0)==22)return A|0}return 0}function Ss(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0;if(Ae=O,O=O+32|0,ce=Ae+16|0,se=Ae,y=xe(l|0,A|0,52)|0,V()|0,y=y&15,H=xe(h|0,d|0,52)|0,V()|0,(y|0)!=(H&15|0))return ce=12,O=Ae,ce|0;if(E=xe(l|0,A|0,45)|0,V()|0,E=E&127,M=xe(h|0,d|0,45)|0,V()|0,M=M&127,E>>>0>121|M>>>0>121)return ce=5,O=Ae,ce|0;if(H=(E|0)!=(M|0),H){if(b=zf(E,M)|0,(b|0)==7)return ce=1,O=Ae,ce|0;w=zf(M,E)|0,(w|0)==7?et(27514,27538,161,27548):(W=b,_=w)}else W=0,_=0;U=rn(E)|0,$=rn(M)|0,u[ce>>2]=0,u[ce+4>>2]=0,u[ce+8>>2]=0,u[ce+12>>2]=0;do if(W){if(M=u[4272+(E*28|0)+(W<<2)>>2]|0,b=(M|0)>0,$)if(b){E=0,w=h,b=d;do w=HS(w,b)|0,b=V()|0,_=eo(_)|0,(_|0)==1&&(_=eo(1)|0),E=E+1|0;while((E|0)!=(M|0));M=_,E=w,w=b}else M=_,E=h,w=d;else if(b){E=0,w=h,b=d;do w=ed(w,b)|0,b=V()|0,_=eo(_)|0,E=E+1|0;while((E|0)!=(M|0));M=_,E=w,w=b}else M=_,E=h,w=d;if(nd(E,w,ce)|0,H||et(27563,27538,191,27548),b=(U|0)!=0,_=($|0)!=0,b&_&&et(27590,27538,192,27548),b){if(_=Er(l,A)|0,(_|0)==7){y=5;break}if(Te[22e3+(_*7|0)+W>>0]|0){y=1;break}w=u[21168+(_*28|0)+(W<<2)>>2]|0,E=w}else if(_){if(_=Er(E,w)|0,(_|0)==7){y=5;break}if(Te[22e3+(_*7|0)+M>>0]|0){y=1;break}E=0,w=u[21168+(M*28|0)+(_<<2)>>2]|0}else E=0,w=0;if((E|w|0)<0)y=5;else{if((w|0)>0){b=ce+4|0,_=0;do nc(b),_=_+1|0;while((_|0)!=(w|0))}if(u[se>>2]=0,u[se+4>>2]=0,u[se+8>>2]=0,ty(se,W),y|0)for(;ri(y)|0?tc(se):zo(se),(y|0)>1;)y=y+-1|0;if((E|0)>0){y=0;do nc(se),y=y+1|0;while((y|0)!=(E|0))}te=ce+4|0,mr(te,se,te),or(te),te=51}}else if(nd(h,d,ce)|0,(U|0)!=0&($|0)!=0)if((M|0)!=(E|0)&&et(27621,27538,261,27548),_=Er(l,A)|0,y=Er(h,d)|0,(_|0)==7|(y|0)==7)y=5;else if(Te[22e3+(_*7|0)+y>>0]|0)y=1;else if(_=u[21168+(_*28|0)+(y<<2)>>2]|0,(_|0)>0){b=ce+4|0,y=0;do nc(b),y=y+1|0;while((y|0)!=(_|0));te=51}else te=51;else te=51;while(!1);return(te|0)==51&&(y=ce+4|0,u[m>>2]=u[y>>2],u[m+4>>2]=u[y+4>>2],u[m+8>>2]=u[y+8>>2],y=0),ce=y,O=Ae,ce|0}function gy(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0;if(te=O,O=O+48|0,E=te+36|0,_=te+24|0,b=te+12|0,w=te,m=xe(l|0,A|0,52)|0,V()|0,m=m&15,$=xe(l|0,A|0,45)|0,V()|0,$=$&127,$>>>0>121)return d=5,O=te,d|0;if(M=rn($)|0,Ce(m|0,0,52)|0,se=V()|0|134225919,y=d,u[y>>2]=-1,u[y+4>>2]=se,!m)return m=ec(h)|0,(m|0)==7||(m=Vf($,m)|0,(m|0)==127)?(se=1,O=te,se|0):(H=Ce(m|0,0,45)|0,W=V()|0,$=d,W=u[$+4>>2]&-1040385|W,se=d,u[se>>2]=u[$>>2]|H,u[se+4>>2]=W,se=0,O=te,se|0);for(u[E>>2]=u[h>>2],u[E+4>>2]=u[h+4>>2],u[E+8>>2]=u[h+8>>2],h=m;;){if(y=h,h=h+-1|0,u[_>>2]=u[E>>2],u[_+4>>2]=u[E+4>>2],u[_+8>>2]=u[E+8>>2],ri(y)|0){if(m=xS(E)|0,m|0){h=13;break}u[b>>2]=u[E>>2],u[b+4>>2]=u[E+4>>2],u[b+8>>2]=u[E+8>>2],tc(b)}else{if(m=TS(E)|0,m|0){h=13;break}u[b>>2]=u[E>>2],u[b+4>>2]=u[E+4>>2],u[b+8>>2]=u[E+8>>2],zo(b)}if(Hf(_,b,w),or(w),m=d,Ae=u[m>>2]|0,m=u[m+4>>2]|0,le=(15-y|0)*3|0,ce=Ce(7,0,le|0)|0,m=m&~(V()|0),le=Ce(ec(w)|0,0,le|0)|0,m=V()|0|m,se=d,u[se>>2]=le|Ae&~ce,u[se+4>>2]=m,(y|0)<=1){h=14;break}}e:do if((h|0)!=13&&(h|0)==14)if((u[E>>2]|0)<=1&&(u[E+4>>2]|0)<=1&&(u[E+8>>2]|0)<=1){h=ec(E)|0,m=Vf($,h)|0,(m|0)==127?w=0:w=rn(m)|0;t:do if(h){if(M){if(m=Er(l,A)|0,(m|0)==7){m=5;break e}if(y=u[21376+(m*28|0)+(h<<2)>>2]|0,(y|0)>0){m=h,h=0;do m=jo(m)|0,h=h+1|0;while((h|0)!=(y|0))}else m=h;if((m|0)==1){m=9;break e}h=Vf($,m)|0,(h|0)==127&&et(27648,27538,411,27678),rn(h)|0?et(27693,27538,412,27678):(W=h,H=y,U=m)}else W=m,H=0,U=h;if(b=u[4272+($*28|0)+(U<<2)>>2]|0,(b|0)<=-1&&et(27724,27538,419,27678),!w){if((H|0)<0){m=5;break e}if(H|0){y=d,m=0,h=u[y>>2]|0,y=u[y+4>>2]|0;do h=$o(h,y)|0,y=V()|0,le=d,u[le>>2]=h,u[le+4>>2]=y,m=m+1|0;while((m|0)<(H|0))}if((b|0)<=0){m=W,h=58;break}for(y=d,m=0,h=u[y>>2]|0,y=u[y+4>>2]|0;;)if(h=$o(h,y)|0,y=V()|0,le=d,u[le>>2]=h,u[le+4>>2]=y,m=m+1|0,(m|0)==(b|0)){m=W,h=58;break t}}if(_=zf(W,$)|0,(_|0)==7&&et(27514,27538,428,27678),m=d,h=u[m>>2]|0,m=u[m+4>>2]|0,(b|0)>0){y=0;do h=$o(h,m)|0,m=V()|0,le=d,u[le>>2]=h,u[le+4>>2]=m,y=y+1|0;while((y|0)!=(b|0))}if(m=Er(h,m)|0,(m|0)==7&&et(27795,27538,440,27678),h=Gf(W)|0,h=u[(h?21792:21584)+(_*28|0)+(m<<2)>>2]|0,(h|0)<0&&et(27795,27538,454,27678),!h)m=W,h=58;else{_=d,m=0,y=u[_>>2]|0,_=u[_+4>>2]|0;do y=Jf(y,_)|0,_=V()|0,le=d,u[le>>2]=y,u[le+4>>2]=_,m=m+1|0;while((m|0)<(h|0));m=W,h=58}}else if((M|0)!=0&(w|0)!=0){if(h=Er(l,A)|0,y=d,y=Er(u[y>>2]|0,u[y+4>>2]|0)|0,(h|0)==7|(y|0)==7){m=5;break e}if(y=u[21376+(h*28|0)+(y<<2)>>2]|0,(y|0)<0){m=5;break e}if(!y)h=59;else{b=d,h=0,_=u[b>>2]|0,b=u[b+4>>2]|0;do _=$o(_,b)|0,b=V()|0,le=d,u[le>>2]=_,u[le+4>>2]=b,h=h+1|0;while((h|0)<(y|0));h=58}}else h=58;while(!1);if((h|0)==58&&w&&(h=59),(h|0)==59&&(le=d,(Er(u[le>>2]|0,u[le+4>>2]|0)|0)==1)){m=9;break}le=d,ce=u[le>>2]|0,le=u[le+4>>2]&-1040385,Ae=Ce(m|0,0,45)|0,le=le|(V()|0),m=d,u[m>>2]=ce|Ae,u[m+4>>2]=le,m=0}else m=1;while(!1);return le=m,O=te,le|0}function fE(l,A,h,d,m,y){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0;var _=0,b=0;return b=O,O=O+16|0,_=b,m?l=15:(l=Ss(l,A,h,d,_)|0,l||(SS(_,y),l=0)),O=b,l|0}function dE(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0;return _=O,O=O+16|0,y=_,d?h=15:(h=ES(h,y)|0,h||(h=gy(l,A,y,m)|0)),O=_,h|0}function pE(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0;return w=O,O=O+32|0,_=w+12|0,b=w,y=Ss(l,A,l,A,_)|0,y|0?(b=y,O=w,b|0):(l=Ss(l,A,h,d,b)|0,l|0?(b=l,O=w,b|0):(_=Wf(_,b)|0,b=m,u[b>>2]=_,u[b+4>>2]=((_|0)<0)<<31>>31,b=0,O=w,b|0))}function mE(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0;return w=O,O=O+32|0,_=w+12|0,b=w,y=Ss(l,A,l,A,_)|0,!y&&(y=Ss(l,A,h,d,b)|0,!y)?(d=Wf(_,b)|0,d=je(d|0,((d|0)<0)<<31>>31|0,1,0)|0,_=V()|0,b=m,u[b>>2]=d,u[b+4>>2]=_,b=0,O=w,b|0):(b=y,O=w,b|0)}function gE(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0;if(Fe=O,O=O+48|0,Re=Fe+24|0,_=Fe+12|0,Ve=Fe,y=Ss(l,A,l,A,Re)|0,!y&&(y=Ss(l,A,h,d,_)|0,!y)){le=Wf(Re,_)|0,ne=((le|0)<0)<<31>>31,u[Re>>2]=0,u[Re+4>>2]=0,u[Re+8>>2]=0,u[_>>2]=0,u[_+4>>2]=0,u[_+8>>2]=0,Ss(l,A,l,A,Re)|0&&et(27795,27538,692,27747),Ss(l,A,h,d,_)|0&&et(27795,27538,697,27747),sy(Re),sy(_),M=(le|0)==0?0:1/+(le|0),h=u[Re>>2]|0,te=M*+((u[_>>2]|0)-h|0),se=Re+4|0,d=u[se>>2]|0,ce=M*+((u[_+4>>2]|0)-d|0),Ae=Re+8|0,y=u[Ae>>2]|0,M=M*+((u[_+8>>2]|0)-y|0),u[Ve>>2]=h,U=Ve+4|0,u[U>>2]=d,$=Ve+8|0,u[$>>2]=y;e:do if((le|0)<0)y=0;else for(H=0,W=0;;){w=+(W>>>0)+4294967296*+(H|0),st=te*w+ +(h|0),b=ce*w+ +(d|0),w=M*w+ +(y|0),h=~~+lc(+st),_=~~+lc(+b),y=~~+lc(+w),st=+mt(+(+(h|0)-st)),b=+mt(+(+(_|0)-b)),w=+mt(+(+(y|0)-w));do if(st>b&st>w)h=0-(_+y)|0,d=_;else if(E=0-h|0,b>w){d=E-y|0;break}else{d=_,y=E-_|0;break}while(!1);if(u[Ve>>2]=h,u[U>>2]=d,u[$>>2]=y,RS(Ve),y=gy(l,A,Ve,m+(W<<3)|0)|0,y|0)break e;if(!((H|0)<(ne|0)|(H|0)==(ne|0)&W>>>0<le>>>0)){y=0;break e}h=je(W|0,H|0,1,0)|0,d=V()|0,H=d,W=h,h=u[Re>>2]|0,d=u[se>>2]|0,y=u[Ae>>2]|0}while(!1);return Ve=y,O=Fe,Ve|0}return Ve=y,O=Fe,Ve|0}function to(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0;if((h|0)==0&(d|0)==0)return m=0,y=1,at(m|0),y|0;y=l,m=A,l=1,A=0;do _=(h&1|0)==0&!0,l=Hn((_?1:y)|0,(_?0:m)|0,l|0,A|0)|0,A=V()|0,h=Cy(h|0,d|0,1)|0,d=V()|0,y=Hn(y|0,m|0,y|0,m|0)|0,m=V()|0;while(!((h|0)==0&(d|0)==0));return at(A|0),l|0}function ad(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0;b=O,O=O+16|0,y=b,_=xe(l|0,A|0,52)|0,V()|0,_=_&15;do if(_){if(m=Ho(l,A,y)|0,!m){E=+L[y>>3],w=1/+Bt(+E),M=+L[25968+(_<<3)>>3],L[h>>3]=E+M,L[h+8>>3]=E-M,E=+L[y+8>>3],w=M*w,L[h+16>>3]=w+E,L[h+24>>3]=E-w;break}return _=m,O=b,_|0}else{if(m=xe(l|0,A|0,45)|0,V()|0,m=m&127,m>>>0>121)return _=5,O=b,_|0;y=22064+(m<<5)|0,u[h>>2]=u[y>>2],u[h+4>>2]=u[y+4>>2],u[h+8>>2]=u[y+8>>2],u[h+12>>2]=u[y+12>>2],u[h+16>>2]=u[y+16>>2],u[h+20>>2]=u[y+20>>2],u[h+24>>2]=u[y+24>>2],u[h+28>>2]=u[y+28>>2];break}while(!1);return _S(h,d?1.4:1.1),d=26096+(_<<3)|0,(u[d>>2]|0)==(l|0)&&(u[d+4>>2]|0)==(A|0)&&(L[h>>3]=1.5707963267948966),_=26224+(_<<3)|0,(u[_>>2]|0)==(l|0)&&(u[_+4>>2]|0)==(A|0)&&(L[h+8>>3]=-1.5707963267948966),+L[h>>3]!=1.5707963267948966&&+L[h+8>>3]!=-1.5707963267948966?(_=0,O=b,_|0):(L[h+16>>3]=3.141592653589793,L[h+24>>3]=-3.141592653589793,_=0,O=b,_|0)}function yE(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0;E=O,O=O+48|0,_=E+32|0,y=E+40|0,b=E,Kf(_,0,0,0),w=u[_>>2]|0,_=u[_+4>>2]|0;do if(h>>>0<=15){if(m=uu(d)|0,m|0){d=b,u[d>>2]=0,u[d+4>>2]=0,u[b+8>>2]=m,u[b+12>>2]=-1,d=b+16|0,w=b+29|0,u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,Te[d+12>>0]=0,Te[w>>0]=Te[y>>0]|0,Te[w+1>>0]=Te[y+1>>0]|0,Te[w+2>>0]=Te[y+2>>0]|0;break}if(m=Rr((u[A+8>>2]|0)+1|0,32)|0,m){ld(A,m),M=b,u[M>>2]=w,u[M+4>>2]=_,u[b+8>>2]=0,u[b+12>>2]=h,u[b+16>>2]=d,u[b+20>>2]=A,u[b+24>>2]=m,Te[b+28>>0]=0,w=b+29|0,Te[w>>0]=Te[y>>0]|0,Te[w+1>>0]=Te[y+1>>0]|0,Te[w+2>>0]=Te[y+2>>0]|0;break}else{d=b,u[d>>2]=0,u[d+4>>2]=0,u[b+8>>2]=13,u[b+12>>2]=-1,d=b+16|0,w=b+29|0,u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,Te[d+12>>0]=0,Te[w>>0]=Te[y>>0]|0,Te[w+1>>0]=Te[y+1>>0]|0,Te[w+2>>0]=Te[y+2>>0]|0;break}}else w=b,u[w>>2]=0,u[w+4>>2]=0,u[b+8>>2]=4,u[b+12>>2]=-1,w=b+16|0,M=b+29|0,u[w>>2]=0,u[w+4>>2]=0,u[w+8>>2]=0,Te[w+12>>0]=0,Te[M>>0]=Te[y>>0]|0,Te[M+1>>0]=Te[y+1>>0]|0,Te[M+2>>0]=Te[y+2>>0]|0;while(!1);sc(b),u[l>>2]=u[b>>2],u[l+4>>2]=u[b+4>>2],u[l+8>>2]=u[b+8>>2],u[l+12>>2]=u[b+12>>2],u[l+16>>2]=u[b+16>>2],u[l+20>>2]=u[b+20>>2],u[l+24>>2]=u[b+24>>2],u[l+28>>2]=u[b+28>>2],O=E}function sc(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0;if(ne=O,O=O+336|0,H=ne+168|0,W=ne,d=l,h=u[d>>2]|0,d=u[d+4>>2]|0,(h|0)==0&(d|0)==0){O=ne;return}if(A=l+28|0,Te[A>>0]|0?(h=yy(h,d)|0,d=V()|0):Te[A>>0]=1,le=l+20|0,!(u[u[le>>2]>>2]|0)){A=l+24|0,h=u[A>>2]|0,h|0&&$e(h),Ae=l,u[Ae>>2]=0,u[Ae+4>>2]=0,u[l+8>>2]=0,u[le>>2]=0,u[l+12>>2]=-1,u[l+16>>2]=0,u[A>>2]=0,O=ne;return}Ae=l+16|0,A=u[Ae>>2]|0,m=A&15;e:do if((h|0)==0&(d|0)==0)ce=l+24|0;else{te=l+12|0,U=(m|0)==3,M=A&255,w=(m|1|0)==3,$=l+24|0,E=(m+-1|0)>>>0<3,_=(m|2|0)==3,b=W+8|0;t:for(;;){if(y=xe(h|0,d|0,52)|0,V()|0,y=y&15,(y|0)==(u[te>>2]|0)){switch(M&15){case 0:case 2:case 3:{if(m=Ho(h,d,H)|0,m|0){se=15;break t}if(ud(u[le>>2]|0,u[$>>2]|0,H)|0){se=19;break t}break}}if(w&&(m=u[(u[le>>2]|0)+4>>2]|0,u[H>>2]=u[m>>2],u[H+4>>2]=u[m+4>>2],u[H+8>>2]=u[m+8>>2],u[H+12>>2]=u[m+12>>2],jf(26832,H)|0)){if(td(u[(u[le>>2]|0)+4>>2]|0,y,W)|0){se=25;break}if(m=W,(u[m>>2]|0)==(h|0)&&(u[m+4>>2]|0)==(d|0)){se=29;break}}if(E){if(m=ka(h,d,H)|0,m|0){se=32;break}if(ad(h,d,W,0)|0){se=36;break}if(_&&vy(u[le>>2]|0,u[$>>2]|0,H,W)|0){se=42;break}if(w&&by(u[le>>2]|0,u[$>>2]|0,H,W)|0){se=42;break}}if(U){if(A=ad(h,d,H,1)|0,m=u[$>>2]|0,A|0){se=45;break}if($f(m,H)|0){if(K2(W,H),Y2(H,u[$>>2]|0)|0){se=53;break}if(ud(u[le>>2]|0,u[$>>2]|0,b)|0){se=53;break}if(by(u[le>>2]|0,u[$>>2]|0,W,H)|0){se=53;break}}}}do if((y|0)<(u[te>>2]|0)){if(A=ad(h,d,H,1)|0,m=u[$>>2]|0,A|0){se=58;break t}if(!($f(m,H)|0)){se=73;break}if(Y2(u[$>>2]|0,H)|0&&(K2(W,H),vy(u[le>>2]|0,u[$>>2]|0,W,H)|0)){se=65;break t}if(h=Ay(h,d,y+1|0,W)|0,h|0){se=67;break t}d=W,h=u[d>>2]|0,d=u[d+4>>2]|0}else se=73;while(!1);if((se|0)==73&&(se=0,h=yy(h,d)|0,d=V()|0),(h|0)==0&(d|0)==0){ce=$;break e}}switch(se|0){case 15:{A=u[$>>2]|0,A|0&&$e(A),se=l,u[se>>2]=0,u[se+4>>2]=0,u[le>>2]=0,u[te>>2]=-1,u[Ae>>2]=0,u[$>>2]=0,u[l+8>>2]=m,se=20;break}case 19:{u[l>>2]=h,u[l+4>>2]=d,se=20;break}case 25:{et(27795,27761,470,27772);break}case 29:{u[l>>2]=h,u[l+4>>2]=d,O=ne;return}case 32:{A=u[$>>2]|0,A|0&&$e(A),ce=l,u[ce>>2]=0,u[ce+4>>2]=0,u[le>>2]=0,u[te>>2]=-1,u[Ae>>2]=0,u[$>>2]=0,u[l+8>>2]=m,O=ne;return}case 36:{et(27795,27761,493,27772);break}case 42:{u[l>>2]=h,u[l+4>>2]=d,O=ne;return}case 45:{m|0&&$e(m),se=l,u[se>>2]=0,u[se+4>>2]=0,u[le>>2]=0,u[te>>2]=-1,u[Ae>>2]=0,u[$>>2]=0,u[l+8>>2]=A,se=55;break}case 53:{u[l>>2]=h,u[l+4>>2]=d,se=55;break}case 58:{m|0&&$e(m),se=l,u[se>>2]=0,u[se+4>>2]=0,u[le>>2]=0,u[te>>2]=-1,u[Ae>>2]=0,u[$>>2]=0,u[l+8>>2]=A,se=71;break}case 65:{u[l>>2]=h,u[l+4>>2]=d,se=71;break}case 67:{A=u[$>>2]|0,A|0&&$e(A),ce=l,u[ce>>2]=0,u[ce+4>>2]=0,u[le>>2]=0,u[te>>2]=-1,u[Ae>>2]=0,u[$>>2]=0,u[l+8>>2]=h,O=ne;return}}if((se|0)==20){O=ne;return}else if((se|0)==55){O=ne;return}else if((se|0)==71){O=ne;return}}while(!1);A=u[ce>>2]|0,A|0&&$e(A),se=l,u[se>>2]=0,u[se+4>>2]=0,u[l+8>>2]=0,u[le>>2]=0,u[l+12>>2]=-1,u[Ae>>2]=0,u[ce>>2]=0,O=ne}function yy(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0;U=O,O=O+16|0,M=U,d=xe(l|0,A|0,52)|0,V()|0,d=d&15,h=xe(l|0,A|0,45)|0,V()|0;do if(d){for(;h=Ce(d+4095|0,0,52)|0,m=V()|0|A&-15728641,y=(15-d|0)*3|0,_=Ce(7,0,y|0)|0,b=V()|0,h=h|l|_,m=m|b,w=xe(l|0,A|0,y|0)|0,V()|0,w=w&7,d=d+-1|0,!(w>>>0<6);)if(d)A=m,l=h;else{E=4;break}if((E|0)==4){h=xe(h|0,m|0,45)|0,V()|0;break}return M=(w|0)==0&(Qt(h,m)|0)!=0,M=Ce((M?2:1)+w|0,0,y|0)|0,E=V()|0|A&~b,M=M|l&~_,at(E|0),O=U,M|0}while(!1);return h=h&127,h>>>0>120?(E=0,M=0,at(E|0),O=U,M|0):(Kf(M,0,h+1|0,0),E=u[M+4>>2]|0,M=u[M>>2]|0,at(E|0),O=U,M|0)}function _E(l,A,h,d,m,y){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0,y=y|0;var _=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0;se=O,O=O+160|0,U=se+80|0,b=se+64|0,$=se+112|0,te=se,yE(U,l,A,h),E=U,id(b,u[E>>2]|0,u[E+4>>2]|0,A),E=b,w=u[E>>2]|0,E=u[E+4>>2]|0,_=u[U+8>>2]|0,H=$+4|0,u[H>>2]=u[U>>2],u[H+4>>2]=u[U+4>>2],u[H+8>>2]=u[U+8>>2],u[H+12>>2]=u[U+12>>2],u[H+16>>2]=u[U+16>>2],u[H+20>>2]=u[U+20>>2],u[H+24>>2]=u[U+24>>2],u[H+28>>2]=u[U+28>>2],H=te,u[H>>2]=w,u[H+4>>2]=E,H=te+8|0,u[H>>2]=_,l=te+12|0,A=$,h=l+36|0;do u[l>>2]=u[A>>2],l=l+4|0,A=A+4|0;while((l|0)<(h|0));if($=te+48|0,u[$>>2]=u[b>>2],u[$+4>>2]=u[b+4>>2],u[$+8>>2]=u[b+8>>2],u[$+12>>2]=u[b+12>>2],(w|0)==0&(E|0)==0)return te=_,O=se,te|0;h=te+16|0,M=te+24|0,U=te+28|0,_=0,b=0,A=w,l=E;do{if(!((_|0)<(m|0)|(_|0)==(m|0)&b>>>0<d>>>0)){W=4;break}if(E=b,b=je(b|0,_|0,1,0)|0,_=V()|0,E=y+(E<<3)|0,u[E>>2]=A,u[E+4>>2]=l,sd($),l=$,A=u[l>>2]|0,l=u[l+4>>2]|0,(A|0)==0&(l|0)==0){if(sc(h),A=h,l=u[A>>2]|0,A=u[A+4>>2]|0,(l|0)==0&(A|0)==0){W=10;break}hy(l,A,u[U>>2]|0,$),l=$,A=u[l>>2]|0,l=u[l+4>>2]|0}E=te,u[E>>2]=A,u[E+4>>2]=l}while(!((A|0)==0&(l|0)==0));return(W|0)==4?(l=te+40|0,A=u[l>>2]|0,A|0&&$e(A),W=te+16|0,u[W>>2]=0,u[W+4>>2]=0,u[M>>2]=0,u[te+36>>2]=0,u[U>>2]=-1,u[te+32>>2]=0,u[l>>2]=0,hy(0,0,0,$),u[te>>2]=0,u[te+4>>2]=0,u[H>>2]=0,te=14,O=se,te|0):((W|0)==10&&(u[te>>2]=0,u[te+4>>2]=0,u[H>>2]=u[M>>2]),te=u[H>>2]|0,O=se,te|0)}function vE(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0;if(U=O,O=O+48|0,w=U+32|0,b=U+40|0,E=U,!(u[l>>2]|0))return M=d,u[M>>2]=0,u[M+4>>2]=0,M=0,O=U,M|0;Kf(w,0,0,0),_=w,m=u[_>>2]|0,_=u[_+4>>2]|0;do if(A>>>0>15)M=E,u[M>>2]=0,u[M+4>>2]=0,u[E+8>>2]=4,u[E+12>>2]=-1,M=E+16|0,h=E+29|0,u[M>>2]=0,u[M+4>>2]=0,u[M+8>>2]=0,Te[M+12>>0]=0,Te[h>>0]=Te[b>>0]|0,Te[h+1>>0]=Te[b+1>>0]|0,Te[h+2>>0]=Te[b+2>>0]|0,h=4,M=9;else{if(h=uu(h)|0,h|0){w=E,u[w>>2]=0,u[w+4>>2]=0,u[E+8>>2]=h,u[E+12>>2]=-1,w=E+16|0,M=E+29|0,u[w>>2]=0,u[w+4>>2]=0,u[w+8>>2]=0,Te[w+12>>0]=0,Te[M>>0]=Te[b>>0]|0,Te[M+1>>0]=Te[b+1>>0]|0,Te[M+2>>0]=Te[b+2>>0]|0,M=9;break}if(h=Rr((u[l+8>>2]|0)+1|0,32)|0,!h){M=E,u[M>>2]=0,u[M+4>>2]=0,u[E+8>>2]=13,u[E+12>>2]=-1,M=E+16|0,h=E+29|0,u[M>>2]=0,u[M+4>>2]=0,u[M+8>>2]=0,Te[M+12>>0]=0,Te[h>>0]=Te[b>>0]|0,Te[h+1>>0]=Te[b+1>>0]|0,Te[h+2>>0]=Te[b+2>>0]|0,h=13,M=9;break}ld(l,h),H=E,u[H>>2]=m,u[H+4>>2]=_,_=E+8|0,u[_>>2]=0,u[E+12>>2]=A,u[E+20>>2]=l,u[E+24>>2]=h,Te[E+28>>0]=0,m=E+29|0,Te[m>>0]=Te[b>>0]|0,Te[m+1>>0]=Te[b+1>>0]|0,Te[m+2>>0]=Te[b+2>>0]|0,u[E+16>>2]=3,$=+mS(h),$=$*+pS(h),y=+mt(+ +L[h>>3]),y=$/+Bt(+ +ac(+y,+ +mt(+ +L[h+8>>3])))*6371.007180918475*6371.007180918475,m=E+12|0,h=u[m>>2]|0;e:do if((h|0)>0)do{if(fy(h+-1|0,w)|0,!(y/+L[w>>3]>10))break e;H=u[m>>2]|0,h=H+-1|0,u[m>>2]=h}while((H|0)>1);while(!1);if(sc(E),m=d,u[m>>2]=0,u[m+4>>2]=0,m=E,h=u[m>>2]|0,m=u[m+4>>2]|0,!((h|0)==0&(m|0)==0))do su(h,m,A,w)|0,b=w,l=d,b=je(u[l>>2]|0,u[l+4>>2]|0,u[b>>2]|0,u[b+4>>2]|0)|0,l=V()|0,H=d,u[H>>2]=b,u[H+4>>2]=l,sc(E),H=E,h=u[H>>2]|0,m=u[H+4>>2]|0;while(!((h|0)==0&(m|0)==0));h=u[_>>2]|0}while(!1);return H=h,O=U,H|0}function lu(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;if(!(jf(A,h)|0)||(A=X2(A)|0,d=+L[h>>3],m=+L[h+8>>3],m=A&m<0?m+6.283185307179586:m,$=u[l>>2]|0,($|0)<=0))return $=0,$|0;if(U=u[l+4>>2]|0,A){A=0,M=m,h=-1,l=0;e:for(;;){for(E=l;_=+L[U+(E<<4)>>3],m=+L[U+(E<<4)+8>>3],l=(h+2|0)%($|0)|0,y=+L[U+(l<<4)>>3],b=+L[U+(l<<4)+8>>3],_>y?(w=_,_=b):(w=y,y=_,_=m,m=b),d=d==y|d==w?d+2220446049250313e-31:d,!!(d<y|d>w);)if(h=E+1|0,(h|0)>=($|0)){h=22;break e}else l=E,E=h,h=l;if(b=_<0?_+6.283185307179586:_,_=m<0?m+6.283185307179586:m,M=b==M|_==M?M+-2220446049250313e-31:M,w=b+(_-b)*((d-y)/(w-y)),(w<0?w+6.283185307179586:w)>M&&(A=A^1),l=E+1|0,(l|0)>=($|0)){h=22;break}else h=E}if((h|0)==22)return A|0}else{A=0,M=m,h=-1,l=0;e:for(;;){for(E=l;_=+L[U+(E<<4)>>3],m=+L[U+(E<<4)+8>>3],l=(h+2|0)%($|0)|0,y=+L[U+(l<<4)>>3],b=+L[U+(l<<4)+8>>3],_>y?(w=_,_=b):(w=y,y=_,_=m,m=b),d=d==y|d==w?d+2220446049250313e-31:d,!!(d<y|d>w);)if(h=E+1|0,(h|0)>=($|0)){h=22;break e}else l=E,E=h,h=l;if(M=_==M|m==M?M+-2220446049250313e-31:M,_+(m-_)*((d-y)/(w-y))>M&&(A=A^1),l=E+1|0,(l|0)>=($|0)){h=22;break}else h=E}if((h|0)==22)return A|0}return 0}function _y(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0;if(W=u[l>>2]|0,!W){u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;return}if(te=A+8|0,L[te>>3]=17976931348623157e292,se=A+24|0,L[se>>3]=17976931348623157e292,L[A>>3]=-17976931348623157e292,ce=A+16|0,L[ce>>3]=-17976931348623157e292,!((W|0)<=0)){for($=u[l+4>>2]|0,E=17976931348623157e292,M=-17976931348623157e292,U=0,l=-1,y=17976931348623157e292,_=17976931348623157e292,w=-17976931348623157e292,d=-17976931348623157e292,H=0;h=+L[$+(H<<4)>>3],b=+L[$+(H<<4)+8>>3],l=l+2|0,m=+L[$+(((l|0)==(W|0)?0:l)<<4)+8>>3],h<y&&(L[te>>3]=h,y=h),b<_&&(L[se>>3]=b,_=b),h>w?L[A>>3]=h:h=w,b>d&&(L[ce>>3]=b,d=b),E=b>0&b<E?b:E,M=b<0&b>M?b:M,U=U|+mt(+(b-m))>3.141592653589793,l=H+1|0,(l|0)!=(W|0);)Ae=H,w=h,H=l,l=Ae;U&&(L[ce>>3]=M,L[se>>3]=E)}}function uu(l){return l=l|0,(l>>>0<4?0:15)|0}function ld(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0;if(W=u[l>>2]|0,W){if(te=A+8|0,L[te>>3]=17976931348623157e292,se=A+24|0,L[se>>3]=17976931348623157e292,L[A>>3]=-17976931348623157e292,ce=A+16|0,L[ce>>3]=-17976931348623157e292,(W|0)>0){for(m=u[l+4>>2]|0,$=17976931348623157e292,H=-17976931348623157e292,d=0,h=-1,w=17976931348623157e292,E=17976931348623157e292,U=-17976931348623157e292,_=-17976931348623157e292,Ae=0;y=+L[m+(Ae<<4)>>3],M=+L[m+(Ae<<4)+8>>3],Ve=h+2|0,b=+L[m+(((Ve|0)==(W|0)?0:Ve)<<4)+8>>3],y<w&&(L[te>>3]=y,w=y),M<E&&(L[se>>3]=M,E=M),y>U?L[A>>3]=y:y=U,M>_&&(L[ce>>3]=M,_=M),$=M>0&M<$?M:$,H=M<0&M>H?M:H,d=d|+mt(+(M-b))>3.141592653589793,h=Ae+1|0,(h|0)!=(W|0);)Ve=Ae,U=y,Ae=h,h=Ve;d&&(L[ce>>3]=H,L[se>>3]=$)}}else u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;if(Ve=l+8|0,h=u[Ve>>2]|0,!((h|0)<=0)){Re=l+12|0,ne=0;do if(m=u[Re>>2]|0,d=ne,ne=ne+1|0,se=A+(ne<<5)|0,ce=u[m+(d<<3)>>2]|0,ce){if(Ae=A+(ne<<5)+8|0,L[Ae>>3]=17976931348623157e292,l=A+(ne<<5)+24|0,L[l>>3]=17976931348623157e292,L[se>>3]=-17976931348623157e292,le=A+(ne<<5)+16|0,L[le>>3]=-17976931348623157e292,(ce|0)>0){for(W=u[m+(d<<3)+4>>2]|0,$=17976931348623157e292,H=-17976931348623157e292,m=0,d=-1,te=0,w=17976931348623157e292,E=17976931348623157e292,M=-17976931348623157e292,_=-17976931348623157e292;y=+L[W+(te<<4)>>3],U=+L[W+(te<<4)+8>>3],d=d+2|0,b=+L[W+(((d|0)==(ce|0)?0:d)<<4)+8>>3],y<w&&(L[Ae>>3]=y,w=y),U<E&&(L[l>>3]=U,E=U),y>M?L[se>>3]=y:y=M,U>_&&(L[le>>3]=U,_=U),$=U>0&U<$?U:$,H=U<0&U>H?U:H,m=m|+mt(+(U-b))>3.141592653589793,d=te+1|0,(d|0)!=(ce|0);)Fe=te,te=d,M=y,d=Fe;m&&(L[le>>3]=H,L[l>>3]=$)}}else u[se>>2]=0,u[se+4>>2]=0,u[se+8>>2]=0,u[se+12>>2]=0,u[se+16>>2]=0,u[se+20>>2]=0,u[se+24>>2]=0,u[se+28>>2]=0,h=u[Ve>>2]|0;while((ne|0)<(h|0))}}function ud(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;if(!(lu(l,A,h)|0))return m=0,m|0;if(m=l+8|0,(u[m>>2]|0)<=0)return m=1,m|0;for(d=l+12|0,l=0;;){if(y=l,l=l+1|0,lu((u[d>>2]|0)+(y<<3)|0,A+(l<<5)|0,h)|0){l=0,d=6;break}if((l|0)>=(u[m>>2]|0)){l=1,d=6;break}}return(d|0)==6?l|0:0}function vy(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0;if(E=O,O=O+16|0,b=E,_=h+8|0,!(lu(l,A,_)|0))return w=0,O=E,w|0;w=l+8|0;e:do if((u[w>>2]|0)>0){for(y=l+12|0,m=0;;){if(M=m,m=m+1|0,lu((u[y>>2]|0)+(M<<3)|0,A+(m<<5)|0,_)|0){m=0;break}if((m|0)>=(u[w>>2]|0))break e}return O=E,m|0}while(!1);if(oc(l,A,h,d)|0)return M=0,O=E,M|0;u[b>>2]=u[h>>2],u[b+4>>2]=_,m=u[w>>2]|0;e:do if((m|0)>0)for(l=l+12|0,_=0,y=m;;){if(m=u[l>>2]|0,(u[m+(_<<3)>>2]|0)>0){if(lu(b,d,u[m+(_<<3)+4>>2]|0)|0){m=0;break e}if(m=_+1|0,oc((u[l>>2]|0)+(_<<3)|0,A+(m<<5)|0,h,d)|0){m=0;break e}y=u[w>>2]|0}else m=_+1|0;if((m|0)<(y|0))_=m;else{m=1;break}}else m=1;while(!1);return M=m,O=E,M|0}function oc(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0,Ve=0,Fe=0,st=0;if(Ve=O,O=O+176|0,Ae=Ve+172|0,m=Ve+168|0,le=Ve,!($f(A,d)|0))return l=0,O=Ve,l|0;if(gS(A,d,Ae,m),Va(le|0,h|0,168)|0,(u[h>>2]|0)>0){A=0;do Fe=le+8+(A<<4)+8|0,ce=+Ur(+L[Fe>>3],u[m>>2]|0),L[Fe>>3]=ce,A=A+1|0;while((A|0)<(u[h>>2]|0))}te=+L[d>>3],se=+L[d+8>>3],ce=+Ur(+L[d+16>>3],u[m>>2]|0),H=+Ur(+L[d+24>>3],u[m>>2]|0);e:do if((u[l>>2]|0)>0){if(d=l+4|0,m=u[le>>2]|0,(m|0)<=0){for(A=0;;)if(A=A+1|0,(A|0)>=(u[l>>2]|0)){A=0;break e}}for(h=0;;){if(A=u[d>>2]|0,$=+L[A+(h<<4)>>3],W=+Ur(+L[A+(h<<4)+8>>3],u[Ae>>2]|0),A=u[d>>2]|0,h=h+1|0,Fe=(h|0)%(u[l>>2]|0)|0,y=+L[A+(Fe<<4)>>3],_=+Ur(+L[A+(Fe<<4)+8>>3],u[Ae>>2]|0),!($>=te)|!(y>=te)&&!($<=se)|!(y<=se)&&!(W<=H)|!(_<=H)&&!(W>=ce)|!(_>=ce)){U=y-$,E=_-W,A=0;do if(st=A,A=A+1|0,Fe=(A|0)==(m|0)?0:A,y=+L[le+8+(st<<4)+8>>3],_=+L[le+8+(Fe<<4)+8>>3]-y,b=+L[le+8+(st<<4)>>3],w=+L[le+8+(Fe<<4)>>3]-b,M=U*_-E*w,M!=0&&(ne=W-y,Re=$-b,w=(ne*w-_*Re)/M,!(w<0|w>1))&&(M=(U*ne-E*Re)/M,M>=0&M<=1)){A=1;break e}while((A|0)<(m|0))}if((h|0)>=(u[l>>2]|0)){A=0;break}}}else A=0;while(!1);return st=A,O=Ve,st|0}function by(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0;if(oc(l,A,h,d)|0)return y=1,y|0;if(y=l+8|0,(u[y>>2]|0)<=0)return y=0,y|0;for(m=l+12|0,l=0;;){if(_=l,l=l+1|0,oc((u[m>>2]|0)+(_<<3)|0,A+(l<<5)|0,h,d)|0){l=1,m=6;break}if((l|0)>=(u[y>>2]|0)){l=0,m=6;break}}return(m|0)==6?l|0:0}function bE(){return 8}function xE(){return 16}function TE(){return 168}function wE(){return 8}function SE(){return 16}function EE(){return 12}function RE(){return 8}function NE(l){return l=l|0,+(+((u[l>>2]|0)>>>0)+4294967296*+(u[l+4>>2]|0))}function CE(l){l=l|0;var A=0,h=0;return h=+L[l>>3],A=+L[l+8>>3],+ +Rt(+(h*h+A*A))}function xy(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0;E=+L[l>>3],w=+L[A>>3]-E,b=+L[l+8>>3],_=+L[A+8>>3]-b,U=+L[h>>3],y=+L[d>>3]-U,$=+L[h+8>>3],M=+L[d+8>>3]-$,y=(y*(b-$)-(E-U)*M)/(w*M-_*y),L[m>>3]=E+w*y,L[m+8>>3]=b+_*y}function Ty(l,A){return l=l|0,A=A|0,+mt(+(+L[l>>3]-+L[A>>3]))<11920928955078125e-23?(A=+mt(+(+L[l+8>>3]-+L[A+8>>3]))<11920928955078125e-23,A|0):(A=0,A|0)}function Bn(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;return m=+L[l>>3]-+L[A>>3],d=+L[l+8>>3]-+L[A+8>>3],h=+L[l+16>>3]-+L[A+16>>3],+(m*m+d*d+h*h)}function ME(l,A){l=l|0,A=A|0;var h=0,d=0,m=0;h=+L[l>>3],d=+Bt(+h),h=+gt(+h),L[A+16>>3]=h,h=+L[l+8>>3],m=d*+Bt(+h),L[A>>3]=m,h=d*+gt(+h),L[A+8>>3]=h}function PE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;if(y=O,O=O+16|0,m=y,d=Qt(l,A)|0,(h+-1|0)>>>0>5||(d=(d|0)!=0,(h|0)==1&d))return m=-1,O=y,m|0;do if(Au(l,A,m)|0)d=-1;else if(d){d=((u[26352+(h<<2)>>2]|0)+5-(u[m>>2]|0)|0)%5|0;break}else{d=((u[26384+(h<<2)>>2]|0)+6-(u[m>>2]|0)|0)%6|0;break}while(!1);return m=d,O=y,m|0}function Au(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0,E=0;if(E=O,O=O+32|0,_=E+16|0,b=E,d=Ia(l,A,_)|0,d|0)return h=d,O=E,h|0;y=ly(l,A)|0,w=Er(l,A)|0,cS(y,b),d=hS(y,u[_>>2]|0)|0;e:do if(rn(y)|0){do switch(y|0){case 4:{l=0;break}case 14:{l=1;break}case 24:{l=2;break}case 38:{l=3;break}case 49:{l=4;break}case 58:{l=5;break}case 63:{l=6;break}case 72:{l=7;break}case 83:{l=8;break}case 97:{l=9;break}case 107:{l=10;break}case 117:{l=11;break}default:{d=1;break e}}while(!1);if(m=u[26416+(l*24|0)+8>>2]|0,A=u[26416+(l*24|0)+16>>2]|0,l=u[_>>2]|0,(l|0)!=(u[b>>2]|0)&&(b=Gf(y)|0,l=u[_>>2]|0,b|(l|0)==(A|0)&&(d=(d+1|0)%6|0)),(w|0)==3&(l|0)==(A|0)){d=(d+5|0)%6|0,m=22;break}(w|0)==5&(l|0)==(m|0)&&(d=(d+1|0)%6|0),m=22}else m=22;while(!1);return(m|0)==22&&(u[h>>2]=d,d=0),h=d,O=E,h|0}function ii(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0;if(le=O,O=O+32|0,Ae=le+24|0,se=le+20|0,W=le+8|0,H=le+16|0,$=le,w=(Qt(l,A)|0)==0,w=w?6:5,M=xe(l|0,A|0,52)|0,V()|0,M=M&15,w>>>0<=h>>>0)return d=2,O=le,d|0;U=(M|0)==0,!U&&(te=Ce(7,0,(M^15)*3|0)|0,(te&l|0)==0&((V()|0)&A|0)==0)?m=h:y=4;e:do if((y|0)==4){if(m=(Qt(l,A)|0)!=0,((m?4:5)|0)<(h|0)||Au(l,A,Ae)|0||(y=(u[Ae>>2]|0)+h|0,m?m=26704+(((y|0)%5|0)<<2)|0:m=26736+(((y|0)%6|0)<<2)|0,te=u[m>>2]|0,(te|0)==7))return d=1,O=le,d|0;u[se>>2]=0,m=$n(l,A,te,se,W)|0;do if(!m){if(b=W,E=u[b>>2]|0,b=u[b+4>>2]|0,_=b>>>0<A>>>0|(b|0)==(A|0)&E>>>0<l>>>0,y=_?E:l,_=_?b:A,!U&&(U=Ce(7,0,(M^15)*3|0)|0,(E&U|0)==0&(b&(V()|0)|0)==0))m=h;else{if(b=(h+-1+w|0)%(w|0)|0,m=Qt(l,A)|0,(b|0)<0&&et(27795,27797,246,27806),w=(m|0)!=0,((w?4:5)|0)<(b|0)&&et(27795,27797,246,27806),Au(l,A,Ae)|0&&et(27795,27797,246,27806),m=(u[Ae>>2]|0)+b|0,w?m=26704+(((m|0)%5|0)<<2)|0:m=26736+(((m|0)%6|0)<<2)|0,b=u[m>>2]|0,(b|0)==7&&et(27795,27797,246,27806),u[H>>2]=0,m=$n(l,A,b,H,$)|0,m|0)break;E=$,w=u[E>>2]|0,E=u[E+4>>2]|0;do if(E>>>0<_>>>0|(E|0)==(_|0)&w>>>0<y>>>0){if(Qt(w,E)|0?y=Uf(w,E,l,A)|0:y=u[26800+((((u[H>>2]|0)+(u[26768+(b<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,m=Qt(w,E)|0,(y+-1|0)>>>0>5){m=-1,y=w,_=E;break}if(m=(m|0)!=0,(y|0)==1&m){m=-1,y=w,_=E;break}do if(Au(w,E,Ae)|0)m=-1;else if(m){m=((u[26352+(y<<2)>>2]|0)+5-(u[Ae>>2]|0)|0)%5|0;break}else{m=((u[26384+(y<<2)>>2]|0)+6-(u[Ae>>2]|0)|0)%6|0;break}while(!1);y=w,_=E}else m=h;while(!1);b=W,E=u[b>>2]|0,b=u[b+4>>2]|0}if((y|0)==(E|0)&(_|0)==(b|0)){if(w=(Qt(E,b)|0)!=0,w?l=Uf(E,b,l,A)|0:l=u[26800+((((u[se>>2]|0)+(u[26768+(te<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,m=Qt(E,b)|0,(l+-1|0)>>>0<=5&&(ce=(m|0)!=0,!((l|0)==1&ce)))do if(Au(E,b,Ae)|0)m=-1;else if(ce){m=((u[26352+(l<<2)>>2]|0)+5-(u[Ae>>2]|0)|0)%5|0;break}else{m=((u[26384+(l<<2)>>2]|0)+6-(u[Ae>>2]|0)|0)%6|0;break}while(!1);else m=-1;m=m+1|0,m=(m|0)==6|w&(m|0)==5?0:m}A=_,l=y;break e}while(!1);return d=m,O=le,d|0}while(!1);return ce=Ce(m|0,0,56)|0,Ae=V()|0|A&-2130706433|536870912,u[d>>2]=ce|l,u[d+4>>2]=Ae,d=0,O=le,d|0}function BE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;return y=(Qt(l,A)|0)==0,d=ii(l,A,0,h)|0,m=(d|0)==0,y?!m||(d=ii(l,A,1,h+8|0)|0,d|0)||(d=ii(l,A,2,h+16|0)|0,d|0)||(d=ii(l,A,3,h+24|0)|0,d|0)||(d=ii(l,A,4,h+32|0)|0,d)?(y=d,y|0):ii(l,A,5,h+40|0)|0:!m||(d=ii(l,A,1,h+8|0)|0,d|0)||(d=ii(l,A,2,h+16|0)|0,d|0)||(d=ii(l,A,3,h+24|0)|0,d|0)||(d=ii(l,A,4,h+32|0)|0,d|0)?(y=d,y|0):(y=h+40|0,u[y>>2]=0,u[y+4>>2]=0,y=0,y|0)}function DE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0,b=0,w=0;return w=O,O=O+192|0,m=w,y=w+168|0,_=xe(l|0,A|0,56)|0,V()|0,_=_&7,b=A&-2130706433|134217728,d=Ia(l,b,y)|0,d|0?(b=d,O=w,b|0):(A=xe(l|0,A|0,52)|0,V()|0,A=A&15,Qt(l,b)|0?Qf(y,A,_,1,m):Xf(y,A,_,1,m),b=m+8|0,u[h>>2]=u[b>>2],u[h+4>>2]=u[b+4>>2],u[h+8>>2]=u[b+8>>2],u[h+12>>2]=u[b+12>>2],b=0,O=w,b|0)}function LE(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;return m=O,O=O+16|0,h=m,!(!0&(A&2013265920|0)==536870912)||(d=A&-2130706433|134217728,!(Yf(l,d)|0))?(d=0,O=m,d|0):(y=xe(l|0,A|0,56)|0,V()|0,y=(ii(l,d,y&7,h)|0)==0,d=h,d=y&((u[d>>2]|0)==(l|0)?(u[d+4>>2]|0)==(A|0):0)&1,O=m,d|0)}function wy(l,A,h){l=l|0,A=A|0,h=h|0;var d=0;(A|0)>0?(d=Rr(A,4)|0,u[l>>2]=d,d||et(27819,27842,40,27856)):u[l>>2]=0,u[l+4>>2]=A,u[l+8>>2]=0,u[l+12>>2]=h}function Sy(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0;m=l+4|0,y=l+12|0,_=l+8|0;e:for(;;){for(h=u[m>>2]|0,A=0;;){if((A|0)>=(h|0))break e;if(d=u[l>>2]|0,b=u[d+(A<<2)>>2]|0,!b)A=A+1|0;else break}A=d+(~~(+mt(+(+Js(10,+ +(15-(u[y>>2]|0)|0))*(+L[b>>3]+ +L[b+8>>3])))%+(h|0))>>>0<<2)|0,h=u[A>>2]|0;t:do if(h|0){if(d=b+32|0,(h|0)==(b|0))u[A>>2]=u[d>>2];else{if(h=h+32|0,A=u[h>>2]|0,!A)break;for(;(A|0)!=(b|0);)if(h=A+32|0,A=u[h>>2]|0,!A)break t;u[h>>2]=u[d>>2]}$e(b),u[_>>2]=(u[_>>2]|0)+-1}while(!1)}$e(u[l>>2]|0)}function Ey(l){l=l|0;var A=0,h=0,d=0;for(d=u[l+4>>2]|0,h=0;;){if((h|0)>=(d|0)){A=0,h=4;break}if(A=u[(u[l>>2]|0)+(h<<2)>>2]|0,!A)h=h+1|0;else{h=4;break}}return(h|0)==4?A|0:0}function Ry(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;if(h=~~(+mt(+(+Js(10,+ +(15-(u[l+12>>2]|0)|0))*(+L[A>>3]+ +L[A+8>>3])))%+(u[l+4>>2]|0))>>>0,h=(u[l>>2]|0)+(h<<2)|0,d=u[h>>2]|0,!d)return y=1,y|0;y=A+32|0;do if((d|0)!=(A|0)){if(h=u[d+32>>2]|0,!h)return y=1,y|0;for(m=h;;){if((m|0)==(A|0)){m=8;break}if(h=u[m+32>>2]|0,h)d=m,m=h;else{h=1,m=10;break}}if((m|0)==8){u[d+32>>2]=u[y>>2];break}else if((m|0)==10)return h|0}else u[h>>2]=u[y>>2];while(!1);return $e(A),y=l+8|0,u[y>>2]=(u[y>>2]|0)+-1,y=0,y|0}function OE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;y=ji(40)|0,y||et(27872,27842,98,27885),u[y>>2]=u[A>>2],u[y+4>>2]=u[A+4>>2],u[y+8>>2]=u[A+8>>2],u[y+12>>2]=u[A+12>>2],m=y+16|0,u[m>>2]=u[h>>2],u[m+4>>2]=u[h+4>>2],u[m+8>>2]=u[h+8>>2],u[m+12>>2]=u[h+12>>2],u[y+32>>2]=0,m=~~(+mt(+(+Js(10,+ +(15-(u[l+12>>2]|0)|0))*(+L[A>>3]+ +L[A+8>>3])))%+(u[l+4>>2]|0))>>>0,m=(u[l>>2]|0)+(m<<2)|0,d=u[m>>2]|0;do if(!d)u[m>>2]=y;else{for(;!(qa(d,A)|0&&qa(d+16|0,h)|0);)if(m=u[d+32>>2]|0,d=(m|0)==0?d:m,!(u[d+32>>2]|0)){_=10;break}if((_|0)==10){u[d+32>>2]=y;break}return $e(y),_=d,_|0}while(!1);return _=l+8|0,u[_>>2]=(u[_>>2]|0)+1,_=y,_|0}function FE(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0;if(m=~~(+mt(+(+Js(10,+ +(15-(u[l+12>>2]|0)|0))*(+L[A>>3]+ +L[A+8>>3])))%+(u[l+4>>2]|0))>>>0,m=u[(u[l>>2]|0)+(m<<2)>>2]|0,!m)return h=0,h|0;if(!h){for(l=m;;){if(qa(l,A)|0){d=10;break}if(l=u[l+32>>2]|0,!l){l=0,d=10;break}}if((d|0)==10)return l|0}for(l=m;;){if(qa(l,A)|0&&qa(l+16|0,h)|0){d=10;break}if(l=u[l+32>>2]|0,!l){l=0,d=10;break}}return(d|0)==10?l|0:0}function IE(l,A){l=l|0,A=A|0;var h=0;if(h=~~(+mt(+(+Js(10,+ +(15-(u[l+12>>2]|0)|0))*(+L[A>>3]+ +L[A+8>>3])))%+(u[l+4>>2]|0))>>>0,l=u[(u[l>>2]|0)+(h<<2)>>2]|0,!l)return h=0,h|0;for(;;){if(qa(l,A)|0){A=5;break}if(l=u[l+32>>2]|0,!l){l=0,A=5;break}}return(A|0)==5?l|0:0}function kE(){return 27904}function no(l){return l=+l,~~+By(+l)|0}function ji(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0,te=0,se=0,ce=0,Ae=0,le=0,ne=0,Re=0;Re=O,O=O+16|0,$=Re;do if(l>>>0<245){if(E=l>>>0<11?16:l+11&-8,l=E>>>3,U=u[6977]|0,h=U>>>l,h&3|0)return A=(h&1^1)+l|0,l=27948+(A<<1<<2)|0,h=l+8|0,d=u[h>>2]|0,m=d+8|0,y=u[m>>2]|0,(y|0)==(l|0)?u[6977]=U&~(1<<A):(u[y+12>>2]=l,u[h>>2]=y),ne=A<<3,u[d+4>>2]=ne|3,ne=d+ne+4|0,u[ne>>2]=u[ne>>2]|1,ne=m,O=Re,ne|0;if(M=u[6979]|0,E>>>0>M>>>0){if(h|0)return A=2<<l,A=h<<l&(A|0-A),A=(A&0-A)+-1|0,b=A>>>12&16,A=A>>>b,h=A>>>5&8,A=A>>>h,y=A>>>2&4,A=A>>>y,l=A>>>1&2,A=A>>>l,d=A>>>1&1,d=(h|b|y|l|d)+(A>>>d)|0,A=27948+(d<<1<<2)|0,l=A+8|0,y=u[l>>2]|0,b=y+8|0,h=u[b>>2]|0,(h|0)==(A|0)?(l=U&~(1<<d),u[6977]=l):(u[h+12>>2]=A,u[l>>2]=h,l=U),ne=d<<3,_=ne-E|0,u[y+4>>2]=E|3,m=y+E|0,u[m+4>>2]=_|1,u[y+ne>>2]=_,M|0&&(d=u[6982]|0,A=M>>>3,h=27948+(A<<1<<2)|0,A=1<<A,l&A?(l=h+8|0,A=u[l>>2]|0):(u[6977]=l|A,A=h,l=h+8|0),u[l>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=h),u[6979]=_,u[6982]=m,ne=b,O=Re,ne|0;if(y=u[6978]|0,y){for(h=(y&0-y)+-1|0,m=h>>>12&16,h=h>>>m,d=h>>>5&8,h=h>>>d,_=h>>>2&4,h=h>>>_,b=h>>>1&2,h=h>>>b,w=h>>>1&1,w=u[28212+((d|m|_|b|w)+(h>>>w)<<2)>>2]|0,h=w,b=w,w=(u[w+4>>2]&-8)-E|0;l=u[h+16>>2]|0,!(!l&&(l=u[h+20>>2]|0,!l));)_=(u[l+4>>2]&-8)-E|0,m=_>>>0<w>>>0,h=l,b=m?l:b,w=m?_:w;if(_=b+E|0,_>>>0>b>>>0){m=u[b+24>>2]|0,A=u[b+12>>2]|0;do if((A|0)==(b|0)){if(l=b+20|0,A=u[l>>2]|0,!A&&(l=b+16|0,A=u[l>>2]|0,!A)){h=0;break}for(;;)if(d=A+20|0,h=u[d>>2]|0,h)A=h,l=d;else if(d=A+16|0,h=u[d>>2]|0,h)A=h,l=d;else break;u[l>>2]=0,h=A}else h=u[b+8>>2]|0,u[h+12>>2]=A,u[A+8>>2]=h,h=A;while(!1);do if(m|0){if(A=u[b+28>>2]|0,l=28212+(A<<2)|0,(b|0)==(u[l>>2]|0)){if(u[l>>2]=h,!h){u[6978]=y&~(1<<A);break}}else if(ne=m+16|0,u[((u[ne>>2]|0)==(b|0)?ne:m+20|0)>>2]=h,!h)break;u[h+24>>2]=m,A=u[b+16>>2]|0,A|0&&(u[h+16>>2]=A,u[A+24>>2]=h),A=u[b+20>>2]|0,A|0&&(u[h+20>>2]=A,u[A+24>>2]=h)}while(!1);return w>>>0<16?(ne=w+E|0,u[b+4>>2]=ne|3,ne=b+ne+4|0,u[ne>>2]=u[ne>>2]|1):(u[b+4>>2]=E|3,u[_+4>>2]=w|1,u[_+w>>2]=w,M|0&&(d=u[6982]|0,A=M>>>3,h=27948+(A<<1<<2)|0,A=1<<A,A&U?(l=h+8|0,A=u[l>>2]|0):(u[6977]=A|U,A=h,l=h+8|0),u[l>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=h),u[6979]=w,u[6982]=_),ne=b+8|0,O=Re,ne|0}else U=E}else U=E}else U=E}else if(l>>>0<=4294967231)if(l=l+11|0,E=l&-8,d=u[6978]|0,d){m=0-E|0,l=l>>>8,l?E>>>0>16777215?w=31:(U=(l+1048320|0)>>>16&8,te=l<<U,b=(te+520192|0)>>>16&4,te=te<<b,w=(te+245760|0)>>>16&2,w=14-(b|U|w)+(te<<w>>>15)|0,w=E>>>(w+7|0)&1|w<<1):w=0,h=u[28212+(w<<2)>>2]|0;e:do if(!h)h=0,l=0,te=61;else for(l=0,b=E<<((w|0)==31?0:25-(w>>>1)|0),y=0;;){if(_=(u[h+4>>2]&-8)-E|0,_>>>0<m>>>0)if(_)l=h,m=_;else{l=h,m=0,te=65;break e}if(te=u[h+20>>2]|0,h=u[h+16+(b>>>31<<2)>>2]|0,y=(te|0)==0|(te|0)==(h|0)?y:te,h)b=b<<1;else{h=y,te=61;break}}while(!1);if((te|0)==61){if((h|0)==0&(l|0)==0){if(l=2<<w,l=(l|0-l)&d,!l){U=E;break}U=(l&0-l)+-1|0,_=U>>>12&16,U=U>>>_,y=U>>>5&8,U=U>>>y,b=U>>>2&4,U=U>>>b,w=U>>>1&2,U=U>>>w,h=U>>>1&1,l=0,h=u[28212+((y|_|b|w|h)+(U>>>h)<<2)>>2]|0}h?te=65:(b=l,_=m)}if((te|0)==65)for(y=h;;)if(U=(u[y+4>>2]&-8)-E|0,h=U>>>0<m>>>0,m=h?U:m,l=h?y:l,h=u[y+16>>2]|0,h||(h=u[y+20>>2]|0),h)y=h;else{b=l,_=m;break}if((b|0)!=0&&_>>>0<((u[6979]|0)-E|0)>>>0&&(M=b+E|0,M>>>0>b>>>0)){y=u[b+24>>2]|0,A=u[b+12>>2]|0;do if((A|0)==(b|0)){if(l=b+20|0,A=u[l>>2]|0,!A&&(l=b+16|0,A=u[l>>2]|0,!A)){A=0;break}for(;;)if(m=A+20|0,h=u[m>>2]|0,h)A=h,l=m;else if(m=A+16|0,h=u[m>>2]|0,h)A=h,l=m;else break;u[l>>2]=0}else ne=u[b+8>>2]|0,u[ne+12>>2]=A,u[A+8>>2]=ne;while(!1);do if(y){if(l=u[b+28>>2]|0,h=28212+(l<<2)|0,(b|0)==(u[h>>2]|0)){if(u[h>>2]=A,!A){d=d&~(1<<l),u[6978]=d;break}}else if(ne=y+16|0,u[((u[ne>>2]|0)==(b|0)?ne:y+20|0)>>2]=A,!A)break;u[A+24>>2]=y,l=u[b+16>>2]|0,l|0&&(u[A+16>>2]=l,u[l+24>>2]=A),l=u[b+20>>2]|0,l&&(u[A+20>>2]=l,u[l+24>>2]=A)}while(!1);e:do if(_>>>0<16)ne=_+E|0,u[b+4>>2]=ne|3,ne=b+ne+4|0,u[ne>>2]=u[ne>>2]|1;else{if(u[b+4>>2]=E|3,u[M+4>>2]=_|1,u[M+_>>2]=_,A=_>>>3,_>>>0<256){h=27948+(A<<1<<2)|0,l=u[6977]|0,A=1<<A,l&A?(l=h+8|0,A=u[l>>2]|0):(u[6977]=l|A,A=h,l=h+8|0),u[l>>2]=M,u[A+12>>2]=M,u[M+8>>2]=A,u[M+12>>2]=h;break}if(A=_>>>8,A?_>>>0>16777215?h=31:(le=(A+1048320|0)>>>16&8,ne=A<<le,Ae=(ne+520192|0)>>>16&4,ne=ne<<Ae,h=(ne+245760|0)>>>16&2,h=14-(Ae|le|h)+(ne<<h>>>15)|0,h=_>>>(h+7|0)&1|h<<1):h=0,A=28212+(h<<2)|0,u[M+28>>2]=h,l=M+16|0,u[l+4>>2]=0,u[l>>2]=0,l=1<<h,!(d&l)){u[6978]=d|l,u[A>>2]=M,u[M+24>>2]=A,u[M+12>>2]=M,u[M+8>>2]=M;break}A=u[A>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(_|0)){for(d=_<<((h|0)==31?0:25-(h>>>1)|0);h=A+16+(d>>>31<<2)|0,l=u[h>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(_|0)){A=l;break t}else d=d<<1,A=l;u[h>>2]=M,u[M+24>>2]=A,u[M+12>>2]=M,u[M+8>>2]=M;break e}while(!1);le=A+8|0,ne=u[le>>2]|0,u[ne+12>>2]=M,u[le>>2]=M,u[M+8>>2]=ne,u[M+12>>2]=A,u[M+24>>2]=0}while(!1);return ne=b+8|0,O=Re,ne|0}else U=E}else U=E;else U=-1;while(!1);if(h=u[6979]|0,h>>>0>=U>>>0)return A=h-U|0,l=u[6982]|0,A>>>0>15?(ne=l+U|0,u[6982]=ne,u[6979]=A,u[ne+4>>2]=A|1,u[l+h>>2]=A,u[l+4>>2]=U|3):(u[6979]=0,u[6982]=0,u[l+4>>2]=h|3,ne=l+h+4|0,u[ne>>2]=u[ne>>2]|1),ne=l+8|0,O=Re,ne|0;if(_=u[6980]|0,_>>>0>U>>>0)return Ae=_-U|0,u[6980]=Ae,ne=u[6983]|0,le=ne+U|0,u[6983]=le,u[le+4>>2]=Ae|1,u[ne+4>>2]=U|3,ne=ne+8|0,O=Re,ne|0;if(u[7095]|0?l=u[7097]|0:(u[7097]=4096,u[7096]=4096,u[7098]=-1,u[7099]=-1,u[7100]=0,u[7088]=0,u[7095]=$&-16^1431655768,l=4096),b=U+48|0,w=U+47|0,y=l+w|0,m=0-l|0,E=y&m,E>>>0<=U>>>0||(l=u[7087]|0,l|0&&(M=u[7085]|0,$=M+E|0,$>>>0<=M>>>0|$>>>0>l>>>0)))return ne=0,O=Re,ne|0;e:do if(u[7088]&4)A=0,te=143;else{h=u[6983]|0;t:do if(h){for(d=28356;$=u[d>>2]|0,!($>>>0<=h>>>0&&($+(u[d+4>>2]|0)|0)>>>0>h>>>0);)if(l=u[d+8>>2]|0,l)d=l;else{te=128;break t}if(A=y-_&m,A>>>0<2147483647)if(l=so(A|0)|0,(l|0)==((u[d>>2]|0)+(u[d+4>>2]|0)|0)){if((l|0)!=-1){_=A,y=l,te=145;break e}}else d=l,te=136;else A=0}else te=128;while(!1);do if((te|0)==128)if(h=so(0)|0,(h|0)!=-1&&(A=h,H=u[7096]|0,W=H+-1|0,A=((W&A|0)==0?0:(W+A&0-H)-A|0)+E|0,H=u[7085]|0,W=A+H|0,A>>>0>U>>>0&A>>>0<2147483647)){if($=u[7087]|0,$|0&&W>>>0<=H>>>0|W>>>0>$>>>0){A=0;break}if(l=so(A|0)|0,(l|0)==(h|0)){_=A,y=h,te=145;break e}else d=l,te=136}else A=0;while(!1);do if((te|0)==136){if(h=0-A|0,!(b>>>0>A>>>0&(A>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){A=0;break}else{_=A,y=d,te=145;break e}if(l=u[7097]|0,l=w-A+l&0-l,l>>>0>=2147483647){_=A,y=d,te=145;break e}if((so(l|0)|0)==-1){so(h|0)|0,A=0;break}else{_=l+A|0,y=d,te=145;break e}}while(!1);u[7088]=u[7088]|4,te=143}while(!1);if((te|0)==143&&E>>>0<2147483647&&(Ae=so(E|0)|0,W=so(0)|0,se=W-Ae|0,ce=se>>>0>(U+40|0)>>>0,!((Ae|0)==-1|ce^1|Ae>>>0<W>>>0&((Ae|0)!=-1&(W|0)!=-1)^1))&&(_=ce?se:A,y=Ae,te=145),(te|0)==145){A=(u[7085]|0)+_|0,u[7085]=A,A>>>0>(u[7086]|0)>>>0&&(u[7086]=A),w=u[6983]|0;e:do if(w){for(A=28356;;){if(l=u[A>>2]|0,h=u[A+4>>2]|0,(y|0)==(l+h|0)){te=154;break}if(d=u[A+8>>2]|0,d)A=d;else break}if((te|0)==154&&(le=A+4|0,(u[A+12>>2]&8|0)==0)&&y>>>0>w>>>0&l>>>0<=w>>>0){u[le>>2]=h+_,ne=(u[6980]|0)+_|0,Ae=w+8|0,Ae=(Ae&7|0)==0?0:0-Ae&7,le=w+Ae|0,Ae=ne-Ae|0,u[6983]=le,u[6980]=Ae,u[le+4>>2]=Ae|1,u[w+ne+4>>2]=40,u[6984]=u[7099];break}for(y>>>0<(u[6981]|0)>>>0&&(u[6981]=y),h=y+_|0,A=28356;;){if((u[A>>2]|0)==(h|0)){te=162;break}if(l=u[A+8>>2]|0,l)A=l;else break}if((te|0)==162&&(u[A+12>>2]&8|0)==0){u[A>>2]=y,M=A+4|0,u[M>>2]=(u[M>>2]|0)+_,M=y+8|0,M=y+((M&7|0)==0?0:0-M&7)|0,A=h+8|0,A=h+((A&7|0)==0?0:0-A&7)|0,E=M+U|0,b=A-M-U|0,u[M+4>>2]=U|3;t:do if((w|0)==(A|0))ne=(u[6980]|0)+b|0,u[6980]=ne,u[6983]=E,u[E+4>>2]=ne|1;else{if((u[6982]|0)==(A|0)){ne=(u[6979]|0)+b|0,u[6979]=ne,u[6982]=E,u[E+4>>2]=ne|1,u[E+ne>>2]=ne;break}if(l=u[A+4>>2]|0,(l&3|0)==1){_=l&-8,d=l>>>3;n:do if(l>>>0<256)if(l=u[A+8>>2]|0,h=u[A+12>>2]|0,(h|0)==(l|0)){u[6977]=u[6977]&~(1<<d);break}else{u[l+12>>2]=h,u[h+8>>2]=l;break}else{y=u[A+24>>2]|0,l=u[A+12>>2]|0;do if((l|0)==(A|0)){if(h=A+16|0,d=h+4|0,l=u[d>>2]|0,l)h=d;else if(l=u[h>>2]|0,!l){l=0;break}for(;;)if(m=l+20|0,d=u[m>>2]|0,d)l=d,h=m;else if(m=l+16|0,d=u[m>>2]|0,d)l=d,h=m;else break;u[h>>2]=0}else ne=u[A+8>>2]|0,u[ne+12>>2]=l,u[l+8>>2]=ne;while(!1);if(!y)break;h=u[A+28>>2]|0,d=28212+(h<<2)|0;do if((u[d>>2]|0)!=(A|0)){if(ne=y+16|0,u[((u[ne>>2]|0)==(A|0)?ne:y+20|0)>>2]=l,!l)break n}else{if(u[d>>2]=l,l|0)break;u[6978]=u[6978]&~(1<<h);break n}while(!1);if(u[l+24>>2]=y,h=A+16|0,d=u[h>>2]|0,d|0&&(u[l+16>>2]=d,u[d+24>>2]=l),h=u[h+4>>2]|0,!h)break;u[l+20>>2]=h,u[h+24>>2]=l}while(!1);A=A+_|0,m=_+b|0}else m=b;if(A=A+4|0,u[A>>2]=u[A>>2]&-2,u[E+4>>2]=m|1,u[E+m>>2]=m,A=m>>>3,m>>>0<256){h=27948+(A<<1<<2)|0,l=u[6977]|0,A=1<<A,l&A?(l=h+8|0,A=u[l>>2]|0):(u[6977]=l|A,A=h,l=h+8|0),u[l>>2]=E,u[A+12>>2]=E,u[E+8>>2]=A,u[E+12>>2]=h;break}A=m>>>8;do if(!A)d=0;else{if(m>>>0>16777215){d=31;break}le=(A+1048320|0)>>>16&8,ne=A<<le,Ae=(ne+520192|0)>>>16&4,ne=ne<<Ae,d=(ne+245760|0)>>>16&2,d=14-(Ae|le|d)+(ne<<d>>>15)|0,d=m>>>(d+7|0)&1|d<<1}while(!1);if(A=28212+(d<<2)|0,u[E+28>>2]=d,l=E+16|0,u[l+4>>2]=0,u[l>>2]=0,l=u[6978]|0,h=1<<d,!(l&h)){u[6978]=l|h,u[A>>2]=E,u[E+24>>2]=A,u[E+12>>2]=E,u[E+8>>2]=E;break}A=u[A>>2]|0;n:do if((u[A+4>>2]&-8|0)!=(m|0)){for(d=m<<((d|0)==31?0:25-(d>>>1)|0);h=A+16+(d>>>31<<2)|0,l=u[h>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(m|0)){A=l;break n}else d=d<<1,A=l;u[h>>2]=E,u[E+24>>2]=A,u[E+12>>2]=E,u[E+8>>2]=E;break t}while(!1);le=A+8|0,ne=u[le>>2]|0,u[ne+12>>2]=E,u[le>>2]=E,u[E+8>>2]=ne,u[E+12>>2]=A,u[E+24>>2]=0}while(!1);return ne=M+8|0,O=Re,ne|0}for(A=28356;l=u[A>>2]|0,!(l>>>0<=w>>>0&&(ne=l+(u[A+4>>2]|0)|0,ne>>>0>w>>>0));)A=u[A+8>>2]|0;m=ne+-47|0,l=m+8|0,l=m+((l&7|0)==0?0:0-l&7)|0,m=w+16|0,l=l>>>0<m>>>0?w:l,A=l+8|0,h=_+-40|0,Ae=y+8|0,Ae=(Ae&7|0)==0?0:0-Ae&7,le=y+Ae|0,Ae=h-Ae|0,u[6983]=le,u[6980]=Ae,u[le+4>>2]=Ae|1,u[y+h+4>>2]=40,u[6984]=u[7099],h=l+4|0,u[h>>2]=27,u[A>>2]=u[7089],u[A+4>>2]=u[7090],u[A+8>>2]=u[7091],u[A+12>>2]=u[7092],u[7089]=y,u[7090]=_,u[7092]=0,u[7091]=A,A=l+24|0;do le=A,A=A+4|0,u[A>>2]=7;while((le+8|0)>>>0<ne>>>0);if((l|0)!=(w|0)){if(y=l-w|0,u[h>>2]=u[h>>2]&-2,u[w+4>>2]=y|1,u[l>>2]=y,A=y>>>3,y>>>0<256){h=27948+(A<<1<<2)|0,l=u[6977]|0,A=1<<A,l&A?(l=h+8|0,A=u[l>>2]|0):(u[6977]=l|A,A=h,l=h+8|0),u[l>>2]=w,u[A+12>>2]=w,u[w+8>>2]=A,u[w+12>>2]=h;break}if(A=y>>>8,A?y>>>0>16777215?d=31:(le=(A+1048320|0)>>>16&8,ne=A<<le,Ae=(ne+520192|0)>>>16&4,ne=ne<<Ae,d=(ne+245760|0)>>>16&2,d=14-(Ae|le|d)+(ne<<d>>>15)|0,d=y>>>(d+7|0)&1|d<<1):d=0,h=28212+(d<<2)|0,u[w+28>>2]=d,u[w+20>>2]=0,u[m>>2]=0,A=u[6978]|0,l=1<<d,!(A&l)){u[6978]=A|l,u[h>>2]=w,u[w+24>>2]=h,u[w+12>>2]=w,u[w+8>>2]=w;break}A=u[h>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(y|0)){for(d=y<<((d|0)==31?0:25-(d>>>1)|0);h=A+16+(d>>>31<<2)|0,l=u[h>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(y|0)){A=l;break t}else d=d<<1,A=l;u[h>>2]=w,u[w+24>>2]=A,u[w+12>>2]=w,u[w+8>>2]=w;break e}while(!1);le=A+8|0,ne=u[le>>2]|0,u[ne+12>>2]=w,u[le>>2]=w,u[w+8>>2]=ne,u[w+12>>2]=A,u[w+24>>2]=0}}else ne=u[6981]|0,(ne|0)==0|y>>>0<ne>>>0&&(u[6981]=y),u[7089]=y,u[7090]=_,u[7092]=0,u[6986]=u[7095],u[6985]=-1,u[6990]=27948,u[6989]=27948,u[6992]=27956,u[6991]=27956,u[6994]=27964,u[6993]=27964,u[6996]=27972,u[6995]=27972,u[6998]=27980,u[6997]=27980,u[7e3]=27988,u[6999]=27988,u[7002]=27996,u[7001]=27996,u[7004]=28004,u[7003]=28004,u[7006]=28012,u[7005]=28012,u[7008]=28020,u[7007]=28020,u[7010]=28028,u[7009]=28028,u[7012]=28036,u[7011]=28036,u[7014]=28044,u[7013]=28044,u[7016]=28052,u[7015]=28052,u[7018]=28060,u[7017]=28060,u[7020]=28068,u[7019]=28068,u[7022]=28076,u[7021]=28076,u[7024]=28084,u[7023]=28084,u[7026]=28092,u[7025]=28092,u[7028]=28100,u[7027]=28100,u[7030]=28108,u[7029]=28108,u[7032]=28116,u[7031]=28116,u[7034]=28124,u[7033]=28124,u[7036]=28132,u[7035]=28132,u[7038]=28140,u[7037]=28140,u[7040]=28148,u[7039]=28148,u[7042]=28156,u[7041]=28156,u[7044]=28164,u[7043]=28164,u[7046]=28172,u[7045]=28172,u[7048]=28180,u[7047]=28180,u[7050]=28188,u[7049]=28188,u[7052]=28196,u[7051]=28196,ne=_+-40|0,Ae=y+8|0,Ae=(Ae&7|0)==0?0:0-Ae&7,le=y+Ae|0,Ae=ne-Ae|0,u[6983]=le,u[6980]=Ae,u[le+4>>2]=Ae|1,u[y+ne+4>>2]=40,u[6984]=u[7099];while(!1);if(A=u[6980]|0,A>>>0>U>>>0)return Ae=A-U|0,u[6980]=Ae,ne=u[6983]|0,le=ne+U|0,u[6983]=le,u[le+4>>2]=Ae|1,u[ne+4>>2]=U|3,ne=ne+8|0,O=Re,ne|0}return ne=kE()|0,u[ne>>2]=12,ne=0,O=Re,ne|0}function $e(l){l=l|0;var A=0,h=0,d=0,m=0,y=0,_=0,b=0,w=0;if(l){h=l+-8|0,m=u[6981]|0,l=u[l+-4>>2]|0,A=l&-8,w=h+A|0;do if(l&1)b=h,_=h;else{if(d=u[h>>2]|0,!(l&3)||(_=h+(0-d)|0,y=d+A|0,_>>>0<m>>>0))return;if((u[6982]|0)==(_|0)){if(l=w+4|0,A=u[l>>2]|0,(A&3|0)!=3){b=_,A=y;break}u[6979]=y,u[l>>2]=A&-2,u[_+4>>2]=y|1,u[_+y>>2]=y;return}if(h=d>>>3,d>>>0<256)if(l=u[_+8>>2]|0,A=u[_+12>>2]|0,(A|0)==(l|0)){u[6977]=u[6977]&~(1<<h),b=_,A=y;break}else{u[l+12>>2]=A,u[A+8>>2]=l,b=_,A=y;break}m=u[_+24>>2]|0,l=u[_+12>>2]|0;do if((l|0)==(_|0)){if(A=_+16|0,h=A+4|0,l=u[h>>2]|0,l)A=h;else if(l=u[A>>2]|0,!l){l=0;break}for(;;)if(d=l+20|0,h=u[d>>2]|0,h)l=h,A=d;else if(d=l+16|0,h=u[d>>2]|0,h)l=h,A=d;else break;u[A>>2]=0}else b=u[_+8>>2]|0,u[b+12>>2]=l,u[l+8>>2]=b;while(!1);if(m){if(A=u[_+28>>2]|0,h=28212+(A<<2)|0,(u[h>>2]|0)==(_|0)){if(u[h>>2]=l,!l){u[6978]=u[6978]&~(1<<A),b=_,A=y;break}}else if(b=m+16|0,u[((u[b>>2]|0)==(_|0)?b:m+20|0)>>2]=l,!l){b=_,A=y;break}u[l+24>>2]=m,A=_+16|0,h=u[A>>2]|0,h|0&&(u[l+16>>2]=h,u[h+24>>2]=l),A=u[A+4>>2]|0,A?(u[l+20>>2]=A,u[A+24>>2]=l,b=_,A=y):(b=_,A=y)}else b=_,A=y}while(!1);if(!(_>>>0>=w>>>0)&&(l=w+4|0,d=u[l>>2]|0,!!(d&1))){if(d&2)u[l>>2]=d&-2,u[b+4>>2]=A|1,u[_+A>>2]=A,m=A;else{if((u[6983]|0)==(w|0)){if(w=(u[6980]|0)+A|0,u[6980]=w,u[6983]=b,u[b+4>>2]=w|1,(b|0)!=(u[6982]|0))return;u[6982]=0,u[6979]=0;return}if((u[6982]|0)==(w|0)){w=(u[6979]|0)+A|0,u[6979]=w,u[6982]=_,u[b+4>>2]=w|1,u[_+w>>2]=w;return}m=(d&-8)+A|0,h=d>>>3;do if(d>>>0<256)if(A=u[w+8>>2]|0,l=u[w+12>>2]|0,(l|0)==(A|0)){u[6977]=u[6977]&~(1<<h);break}else{u[A+12>>2]=l,u[l+8>>2]=A;break}else{y=u[w+24>>2]|0,l=u[w+12>>2]|0;do if((l|0)==(w|0)){if(A=w+16|0,h=A+4|0,l=u[h>>2]|0,l)A=h;else if(l=u[A>>2]|0,!l){h=0;break}for(;;)if(d=l+20|0,h=u[d>>2]|0,h)l=h,A=d;else if(d=l+16|0,h=u[d>>2]|0,h)l=h,A=d;else break;u[A>>2]=0,h=l}else h=u[w+8>>2]|0,u[h+12>>2]=l,u[l+8>>2]=h,h=l;while(!1);if(y|0){if(l=u[w+28>>2]|0,A=28212+(l<<2)|0,(u[A>>2]|0)==(w|0)){if(u[A>>2]=h,!h){u[6978]=u[6978]&~(1<<l);break}}else if(d=y+16|0,u[((u[d>>2]|0)==(w|0)?d:y+20|0)>>2]=h,!h)break;u[h+24>>2]=y,l=w+16|0,A=u[l>>2]|0,A|0&&(u[h+16>>2]=A,u[A+24>>2]=h),l=u[l+4>>2]|0,l|0&&(u[h+20>>2]=l,u[l+24>>2]=h)}}while(!1);if(u[b+4>>2]=m|1,u[_+m>>2]=m,(b|0)==(u[6982]|0)){u[6979]=m;return}}if(l=m>>>3,m>>>0<256){h=27948+(l<<1<<2)|0,A=u[6977]|0,l=1<<l,A&l?(A=h+8|0,l=u[A>>2]|0):(u[6977]=A|l,l=h,A=h+8|0),u[A>>2]=b,u[l+12>>2]=b,u[b+8>>2]=l,u[b+12>>2]=h;return}l=m>>>8,l?m>>>0>16777215?d=31:(_=(l+1048320|0)>>>16&8,w=l<<_,y=(w+520192|0)>>>16&4,w=w<<y,d=(w+245760|0)>>>16&2,d=14-(y|_|d)+(w<<d>>>15)|0,d=m>>>(d+7|0)&1|d<<1):d=0,l=28212+(d<<2)|0,u[b+28>>2]=d,u[b+20>>2]=0,u[b+16>>2]=0,A=u[6978]|0,h=1<<d;e:do if(!(A&h))u[6978]=A|h,u[l>>2]=b,u[b+24>>2]=l,u[b+12>>2]=b,u[b+8>>2]=b;else{l=u[l>>2]|0;t:do if((u[l+4>>2]&-8|0)!=(m|0)){for(d=m<<((d|0)==31?0:25-(d>>>1)|0);h=l+16+(d>>>31<<2)|0,A=u[h>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(m|0)){l=A;break t}else d=d<<1,l=A;u[h>>2]=b,u[b+24>>2]=l,u[b+12>>2]=b,u[b+8>>2]=b;break e}while(!1);_=l+8|0,w=u[_>>2]|0,u[w+12>>2]=b,u[_>>2]=b,u[b+8>>2]=w,u[b+12>>2]=l,u[b+24>>2]=0}while(!1);if(w=(u[6985]|0)+-1|0,u[6985]=w,!(w|0)){for(l=28364;l=u[l>>2]|0,l;)l=l+8|0;u[6985]=-1}}}}function Rr(l,A){l=l|0,A=A|0;var h=0;return l?(h=Vi(A,l)|0,(A|l)>>>0>65535&&(h=((h>>>0)/(l>>>0)|0|0)==(A|0)?h:-1)):h=0,l=ji(h)|0,!l||!(u[l+-4>>2]&3)||io(l|0,0,h|0)|0,l|0}function je(l,A,h,d){return l=l|0,A=A|0,h=h|0,d=d|0,h=l+h>>>0,at(A+d+(h>>>0<l>>>0|0)>>>0|0),h|0|0}function Kn(l,A,h,d){return l=l|0,A=A|0,h=h|0,d=d|0,d=A-d-(h>>>0>l>>>0|0)>>>0,at(d|0),l-h>>>0|0|0}function Ny(l){return l=l|0,(l?31-(ws(l^l-1)|0)|0:32)|0}function Ad(l,A,h,d,m){l=l|0,A=A|0,h=h|0,d=d|0,m=m|0;var y=0,_=0,b=0,w=0,E=0,M=0,U=0,$=0,H=0,W=0;if(M=l,w=A,E=w,_=h,$=d,b=$,!E)return y=(m|0)!=0,b?y?(u[m>>2]=l|0,u[m+4>>2]=A&0,$=0,m=0,at($|0),m|0):($=0,m=0,at($|0),m|0):(y&&(u[m>>2]=(M>>>0)%(_>>>0),u[m+4>>2]=0),$=0,m=(M>>>0)/(_>>>0)>>>0,at($|0),m|0);y=(b|0)==0;do if(_){if(!y){if(y=(ws(b|0)|0)-(ws(E|0)|0)|0,y>>>0<=31){U=y+1|0,b=31-y|0,A=y-31>>31,_=U,l=M>>>(U>>>0)&A|E<<b,A=E>>>(U>>>0)&A,y=0,b=M<<b;break}return m?(u[m>>2]=l|0,u[m+4>>2]=w|A&0,$=0,m=0,at($|0),m|0):($=0,m=0,at($|0),m|0)}if(y=_-1|0,y&_|0){b=(ws(_|0)|0)+33-(ws(E|0)|0)|0,W=64-b|0,U=32-b|0,w=U>>31,H=b-32|0,A=H>>31,_=b,l=U-1>>31&E>>>(H>>>0)|(E<<U|M>>>(b>>>0))&A,A=A&E>>>(b>>>0),y=M<<W&w,b=(E<<W|M>>>(H>>>0))&w|M<<U&b-33>>31;break}return m|0&&(u[m>>2]=y&M,u[m+4>>2]=0),(_|0)==1?(H=w|A&0,W=l|0|0,at(H|0),W|0):(W=Ny(_|0)|0,H=E>>>(W>>>0)|0,W=E<<32-W|M>>>(W>>>0)|0,at(H|0),W|0)}else{if(y)return m|0&&(u[m>>2]=(E>>>0)%(_>>>0),u[m+4>>2]=0),H=0,W=(E>>>0)/(_>>>0)>>>0,at(H|0),W|0;if(!M)return m|0&&(u[m>>2]=0,u[m+4>>2]=(E>>>0)%(b>>>0)),H=0,W=(E>>>0)/(b>>>0)>>>0,at(H|0),W|0;if(y=b-1|0,!(y&b))return m|0&&(u[m>>2]=l|0,u[m+4>>2]=y&E|A&0),H=0,W=E>>>((Ny(b|0)|0)>>>0),at(H|0),W|0;if(y=(ws(b|0)|0)-(ws(E|0)|0)|0,y>>>0<=30){A=y+1|0,b=31-y|0,_=A,l=E<<b|M>>>(A>>>0),A=E>>>(A>>>0),y=0,b=M<<b;break}return m?(u[m>>2]=l|0,u[m+4>>2]=w|A&0,H=0,W=0,at(H|0),W|0):(H=0,W=0,at(H|0),W|0)}while(!1);if(!_)E=b,w=0,b=0;else{U=h|0|0,M=$|d&0,E=je(U|0,M|0,-1,-1)|0,h=V()|0,w=b,b=0;do d=w,w=y>>>31|w<<1,y=b|y<<1,d=l<<1|d>>>31|0,$=l>>>31|A<<1|0,Kn(E|0,h|0,d|0,$|0)|0,W=V()|0,H=W>>31|((W|0)<0?-1:0)<<1,b=H&1,l=Kn(d|0,$|0,H&U|0,(((W|0)<0?-1:0)>>31|((W|0)<0?-1:0)<<1)&M|0)|0,A=V()|0,_=_-1|0;while((_|0)!=0);E=w,w=0}return _=0,m|0&&(u[m>>2]=l,u[m+4>>2]=A),H=(y|0)>>>31|(E|_)<<1|(_<<1|y>>>31)&0|w,W=(y<<1|0)&-2|b,at(H|0),W|0}function ro(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0;return E=A>>31|((A|0)<0?-1:0)<<1,w=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,y=d>>31|((d|0)<0?-1:0)<<1,m=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,b=Kn(E^l|0,w^A|0,E|0,w|0)|0,_=V()|0,l=y^E,A=m^w,Kn((Ad(b,_,Kn(y^h|0,m^d|0,y|0,m|0)|0,V()|0,0)|0)^l|0,(V()|0)^A|0,l|0,A|0)|0}function qE(l,A){l=l|0,A=A|0;var h=0,d=0,m=0,y=0;return y=l&65535,m=A&65535,h=Vi(m,y)|0,d=l>>>16,l=(h>>>16)+(Vi(m,d)|0)|0,m=A>>>16,A=Vi(m,y)|0,at((l>>>16)+(Vi(m,d)|0)+(((l&65535)+A|0)>>>16)|0),l+A<<16|h&65535|0|0}function Hn(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0;return m=l,y=h,h=qE(m,y)|0,l=V()|0,at((Vi(A,y)|0)+(Vi(d,m)|0)+l|l&0|0),h|0|0|0}function Ua(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0,_=0,b=0,w=0,E=0;return m=O,O=O+16|0,b=m|0,_=A>>31|((A|0)<0?-1:0)<<1,y=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,E=d>>31|((d|0)<0?-1:0)<<1,w=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,l=Kn(_^l|0,y^A|0,_|0,y|0)|0,A=V()|0,Ad(l,A,Kn(E^h|0,w^d|0,E|0,w|0)|0,V()|0,b)|0,d=Kn(u[b>>2]^_|0,u[b+4>>2]^y|0,_|0,y|0)|0,h=V()|0,O=m,at(h|0),d|0}function Ga(l,A,h,d){l=l|0,A=A|0,h=h|0,d=d|0;var m=0,y=0;return y=O,O=O+16|0,m=y|0,Ad(l,A,h,d,m)|0,O=y,at(u[m+4>>2]|0),u[m>>2]|0|0}function Cy(l,A,h){return l=l|0,A=A|0,h=h|0,(h|0)<32?(at(A>>h|0),l>>>h|(A&(1<<h)-1)<<32-h):(at(((A|0)<0?-1:0)|0),A>>h-32|0)}function xe(l,A,h){return l=l|0,A=A|0,h=h|0,(h|0)<32?(at(A>>>h|0),l>>>h|(A&(1<<h)-1)<<32-h):(at(0),A>>>h-32|0)}function Ce(l,A,h){return l=l|0,A=A|0,h=h|0,(h|0)<32?(at(A<<h|(l&(1<<h)-1<<32-h)>>>32-h|0),l<<h):(at(l<<h-32|0),0)}function My(l,A,h){return l=l|0,A=A|0,A=ws(A)|0,(A|0)==32&&(A=A+(ws(l)|0)|0),at(0),A|0}function Py(l,A){return l=+l,A=+A,l!=l?+A:A!=A?+l:+W7(+l,+A)}function ac(l,A){return l=+l,A=+A,l!=l?+A:A!=A?+l:+qf(+l,+A)}function lc(l){return l=+l,l>=0?+jn(l+.5):+Oa(l-.5)}function Va(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0;if((h|0)>=8192)return X7(l|0,A|0,h|0)|0,l|0;if(y=l|0,m=l+h|0,(l&3)==(A&3)){for(;l&3;){if(!h)return y|0;Te[l>>0]=Te[A>>0]|0,l=l+1|0,A=A+1|0,h=h-1|0}for(h=m&-4|0,d=h-64|0;(l|0)<=(d|0);)u[l>>2]=u[A>>2],u[l+4>>2]=u[A+4>>2],u[l+8>>2]=u[A+8>>2],u[l+12>>2]=u[A+12>>2],u[l+16>>2]=u[A+16>>2],u[l+20>>2]=u[A+20>>2],u[l+24>>2]=u[A+24>>2],u[l+28>>2]=u[A+28>>2],u[l+32>>2]=u[A+32>>2],u[l+36>>2]=u[A+36>>2],u[l+40>>2]=u[A+40>>2],u[l+44>>2]=u[A+44>>2],u[l+48>>2]=u[A+48>>2],u[l+52>>2]=u[A+52>>2],u[l+56>>2]=u[A+56>>2],u[l+60>>2]=u[A+60>>2],l=l+64|0,A=A+64|0;for(;(l|0)<(h|0);)u[l>>2]=u[A>>2],l=l+4|0,A=A+4|0}else for(h=m-4|0;(l|0)<(h|0);)Te[l>>0]=Te[A>>0]|0,Te[l+1>>0]=Te[A+1>>0]|0,Te[l+2>>0]=Te[A+2>>0]|0,Te[l+3>>0]=Te[A+3>>0]|0,l=l+4|0,A=A+4|0;for(;(l|0)<(m|0);)Te[l>>0]=Te[A>>0]|0,l=l+1|0,A=A+1|0;return y|0}function io(l,A,h){l=l|0,A=A|0,h=h|0;var d=0,m=0,y=0,_=0;if(y=l+h|0,A=A&255,(h|0)>=67){for(;l&3;)Te[l>>0]=A,l=l+1|0;for(d=y&-4|0,_=A|A<<8|A<<16|A<<24,m=d-64|0;(l|0)<=(m|0);)u[l>>2]=_,u[l+4>>2]=_,u[l+8>>2]=_,u[l+12>>2]=_,u[l+16>>2]=_,u[l+20>>2]=_,u[l+24>>2]=_,u[l+28>>2]=_,u[l+32>>2]=_,u[l+36>>2]=_,u[l+40>>2]=_,u[l+44>>2]=_,u[l+48>>2]=_,u[l+52>>2]=_,u[l+56>>2]=_,u[l+60>>2]=_,l=l+64|0;for(;(l|0)<(d|0);)u[l>>2]=_,l=l+4|0}for(;(l|0)<(y|0);)Te[l>>0]=A,l=l+1|0;return y-h|0}function By(l){return l=+l,l>=0?+jn(l+.5):+Oa(l-.5)}function so(l){l=l|0;var A=0,h=0,d=0;return d=Q7()|0,h=u[kt>>2]|0,A=h+l|0,(l|0)>0&(A|0)<(h|0)|(A|0)<0?(K7(A|0)|0,G2(12),-1):(A|0)>(d|0)&&!(Y7(A|0)|0)?(G2(12),-1):(u[kt>>2]=A,h|0)}return{___divdi3:ro,___muldi3:Hn,___remdi3:Ua,___uremdi3:Ga,_areNeighborCells:NS,_bitshift64Ashr:Cy,_bitshift64Lshr:xe,_bitshift64Shl:Ce,_calloc:Rr,_cellAreaKm2:sE,_cellAreaM2:oE,_cellAreaRads2:od,_cellToBoundary:ka,_cellToCenterChild:Ay,_cellToChildPos:YS,_cellToChildren:GS,_cellToChildrenSize:su,_cellToLatLng:Ho,_cellToLocalIj:fE,_cellToParent:Zf,_cellToVertex:ii,_cellToVertexes:BE,_cellsToDirectedEdge:CS,_cellsToLinkedMultiPolygon:uS,_childPosToCell:KS,_compactCells:VS,_destroyLinkedMultiPolygon:py,_directedEdgeToBoundary:rc,_directedEdgeToCells:DS,_edgeLengthKm:lE,_edgeLengthM:uE,_edgeLengthRads:aE,_emscripten_replace_memory:Z7,_free:$e,_getBaseCellNumber:ly,_getDirectedEdgeDestination:PS,_getDirectedEdgeOrigin:MS,_getHexagonAreaAvgKm2:fy,_getHexagonAreaAvgM2:nE,_getHexagonEdgeLengthAvgKm:rE,_getHexagonEdgeLengthAvgM:iE,_getIcosahedronFaces:cy,_getNumCells:ic,_getPentagons:rd,_getRes0Cells:dS,_getResolution:US,_greatCircleDistanceKm:au,_greatCircleDistanceM:JS,_greatCircleDistanceRads:ZS,_gridDisk:V2,_gridDiskDistances:z2,_gridDistance:pE,_gridPathCells:gE,_gridPathCellsSize:mE,_gridRing:iS,_gridRingUnsafe:$2,_i64Add:je,_i64Subtract:Kn,_isPentagon:Qt,_isResClassIII:$S,_isValidCell:Yf,_isValidDirectedEdge:BS,_isValidVertex:LE,_latLngToCell:td,_llvm_ctlz_i64:My,_llvm_maxnum_f64:Py,_llvm_minnum_f64:ac,_llvm_round_f64:lc,_localIjToCell:dE,_malloc:ji,_maxFaceCount:QS,_maxGridDiskSize:rS,_maxPolygonToCellsSize:oS,_maxPolygonToCellsSizeExperimental:vE,_memcpy:Va,_memset:io,_originToDirectedEdges:LS,_pentagonCount:XS,_polygonToCells:aS,_polygonToCellsExperimental:_E,_readInt64AsDoubleFromPointer:NE,_res0CellCount:fS,_round:By,_sbrk:so,_sizeOfCellBoundary:TE,_sizeOfCoordIJ:RE,_sizeOfGeoLoop:wE,_sizeOfGeoPolygon:SE,_sizeOfH3Index:bE,_sizeOfLatLng:xE,_sizeOfLinkedGeoPolygon:EE,_uncompactCells:zS,_uncompactCellsSize:jS,_vertexToLatLng:DE,establishStackSpace:nS,stackAlloc:J7,stackRestore:tS,stackSave:eS}})(G7,V7,Q);e.___divdi3=Se.___divdi3,e.___muldi3=Se.___muldi3,e.___remdi3=Se.___remdi3,e.___uremdi3=Se.___uremdi3,e._areNeighborCells=Se._areNeighborCells,e._bitshift64Ashr=Se._bitshift64Ashr,e._bitshift64Lshr=Se._bitshift64Lshr,e._bitshift64Shl=Se._bitshift64Shl,e._calloc=Se._calloc,e._cellAreaKm2=Se._cellAreaKm2,e._cellAreaM2=Se._cellAreaM2,e._cellAreaRads2=Se._cellAreaRads2,e._cellToBoundary=Se._cellToBoundary,e._cellToCenterChild=Se._cellToCenterChild,e._cellToChildPos=Se._cellToChildPos,e._cellToChildren=Se._cellToChildren,e._cellToChildrenSize=Se._cellToChildrenSize,e._cellToLatLng=Se._cellToLatLng,e._cellToLocalIj=Se._cellToLocalIj,e._cellToParent=Se._cellToParent,e._cellToVertex=Se._cellToVertex,e._cellToVertexes=Se._cellToVertexes,e._cellsToDirectedEdge=Se._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Se._cellsToLinkedMultiPolygon,e._childPosToCell=Se._childPosToCell,e._compactCells=Se._compactCells,e._destroyLinkedMultiPolygon=Se._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Se._directedEdgeToBoundary,e._directedEdgeToCells=Se._directedEdgeToCells,e._edgeLengthKm=Se._edgeLengthKm,e._edgeLengthM=Se._edgeLengthM,e._edgeLengthRads=Se._edgeLengthRads;var z7=e._emscripten_replace_memory=Se._emscripten_replace_memory;e._free=Se._free,e._getBaseCellNumber=Se._getBaseCellNumber,e._getDirectedEdgeDestination=Se._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Se._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Se._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Se._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Se._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Se._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Se._getIcosahedronFaces,e._getNumCells=Se._getNumCells,e._getPentagons=Se._getPentagons,e._getRes0Cells=Se._getRes0Cells,e._getResolution=Se._getResolution,e._greatCircleDistanceKm=Se._greatCircleDistanceKm,e._greatCircleDistanceM=Se._greatCircleDistanceM,e._greatCircleDistanceRads=Se._greatCircleDistanceRads,e._gridDisk=Se._gridDisk,e._gridDiskDistances=Se._gridDiskDistances,e._gridDistance=Se._gridDistance,e._gridPathCells=Se._gridPathCells,e._gridPathCellsSize=Se._gridPathCellsSize,e._gridRing=Se._gridRing,e._gridRingUnsafe=Se._gridRingUnsafe,e._i64Add=Se._i64Add,e._i64Subtract=Se._i64Subtract,e._isPentagon=Se._isPentagon,e._isResClassIII=Se._isResClassIII,e._isValidCell=Se._isValidCell,e._isValidDirectedEdge=Se._isValidDirectedEdge,e._isValidVertex=Se._isValidVertex,e._latLngToCell=Se._latLngToCell,e._llvm_ctlz_i64=Se._llvm_ctlz_i64,e._llvm_maxnum_f64=Se._llvm_maxnum_f64,e._llvm_minnum_f64=Se._llvm_minnum_f64,e._llvm_round_f64=Se._llvm_round_f64,e._localIjToCell=Se._localIjToCell,e._malloc=Se._malloc,e._maxFaceCount=Se._maxFaceCount,e._maxGridDiskSize=Se._maxGridDiskSize,e._maxPolygonToCellsSize=Se._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=Se._maxPolygonToCellsSizeExperimental,e._memcpy=Se._memcpy,e._memset=Se._memset,e._originToDirectedEdges=Se._originToDirectedEdges,e._pentagonCount=Se._pentagonCount,e._polygonToCells=Se._polygonToCells,e._polygonToCellsExperimental=Se._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=Se._readInt64AsDoubleFromPointer,e._res0CellCount=Se._res0CellCount,e._round=Se._round,e._sbrk=Se._sbrk,e._sizeOfCellBoundary=Se._sizeOfCellBoundary,e._sizeOfCoordIJ=Se._sizeOfCoordIJ,e._sizeOfGeoLoop=Se._sizeOfGeoLoop,e._sizeOfGeoPolygon=Se._sizeOfGeoPolygon,e._sizeOfH3Index=Se._sizeOfH3Index,e._sizeOfLatLng=Se._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Se._sizeOfLinkedGeoPolygon,e._uncompactCells=Se._uncompactCells,e._uncompactCellsSize=Se._uncompactCellsSize,e._vertexToLatLng=Se._vertexToLatLng,e.establishStackSpace=Se.establishStackSpace;var I2=e.stackAlloc=Se.stackAlloc,j7=e.stackRestore=Se.stackRestore,$7=e.stackSave=Se.stackSave;if(e.asm=Se,e.cwrap=D,e.setValue=x,e.getValue=T,Zs){O2(Zs)||(Zs=s(Zs));{M7();var Ff=function(fe){fe.byteLength&&(fe=new Uint8Array(fe)),Z.set(fe,v),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,P7()},k2=function(){o(Zs,Ff,function(){throw"could not load memory initializer "+Zs})},q2=Of(Zs);if(q2)Ff(q2.buffer);else if(e.memoryInitializerRequest){var U2=function(){var fe=e.memoryInitializerRequest,_e=fe.response;if(fe.status!==200&&fe.status!==0){var Le=Of(e.memoryInitializerRequestURL);if(Le)_e=Le.buffer;else{k2();return}}Ff(_e)};e.memoryInitializerRequest.response?setTimeout(U2,0):e.memoryInitializerRequest.addEventListener("load",U2)}else k2()}}var ZA;Si=function fe(){ZA||If(),ZA||(Si=fe)};function If(fe){if(ei>0||(zt(),ei>0))return;function _e(){ZA||(ZA=!0,!S&&(Nn(),In(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),dn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),_e()},1)):_e()}e.run=If;function La(fe){throw e.onAbort&&e.onAbort(fe),fe+="",a(fe),c(fe),S=!0,"abort("+fe+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=La,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return If(),n})(typeof St=="object"?St:{}),rt="number",Ke=rt,gu=rt,tt=rt,nt=rt,Wn=rt,Ie=rt,ZD=[["sizeOfH3Index",rt],["sizeOfLatLng",rt],["sizeOfCellBoundary",rt],["sizeOfGeoLoop",rt],["sizeOfGeoPolygon",rt],["sizeOfLinkedGeoPolygon",rt],["sizeOfCoordIJ",rt],["readInt64AsDoubleFromPointer",rt],["isValidCell",gu,[tt,nt]],["latLngToCell",Ke,[rt,rt,Wn,Ie]],["cellToLatLng",Ke,[tt,nt,Ie]],["cellToBoundary",Ke,[tt,nt,Ie]],["maxGridDiskSize",Ke,[rt,Ie]],["gridDisk",Ke,[tt,nt,rt,Ie]],["gridDiskDistances",Ke,[tt,nt,rt,Ie,Ie]],["gridRing",Ke,[tt,nt,rt,Ie]],["gridRingUnsafe",Ke,[tt,nt,rt,Ie]],["maxPolygonToCellsSize",Ke,[Ie,Wn,rt,Ie]],["polygonToCells",Ke,[Ie,Wn,rt,Ie]],["maxPolygonToCellsSizeExperimental",Ke,[Ie,Wn,rt,Ie]],["polygonToCellsExperimental",Ke,[Ie,Wn,rt,rt,rt,Ie]],["cellsToLinkedMultiPolygon",Ke,[Ie,rt,Ie]],["destroyLinkedMultiPolygon",null,[Ie]],["compactCells",Ke,[Ie,Ie,rt,rt]],["uncompactCells",Ke,[Ie,rt,rt,Ie,rt,Wn]],["uncompactCellsSize",Ke,[Ie,rt,rt,Wn,Ie]],["isPentagon",gu,[tt,nt]],["isResClassIII",gu,[tt,nt]],["getBaseCellNumber",rt,[tt,nt]],["getResolution",rt,[tt,nt]],["maxFaceCount",Ke,[tt,nt,Ie]],["getIcosahedronFaces",Ke,[tt,nt,Ie]],["cellToParent",Ke,[tt,nt,Wn,Ie]],["cellToChildren",Ke,[tt,nt,Wn,Ie]],["cellToCenterChild",Ke,[tt,nt,Wn,Ie]],["cellToChildrenSize",Ke,[tt,nt,Wn,Ie]],["cellToChildPos",Ke,[tt,nt,Wn,Ie]],["childPosToCell",Ke,[rt,rt,tt,nt,Wn,Ie]],["areNeighborCells",Ke,[tt,nt,tt,nt,Ie]],["cellsToDirectedEdge",Ke,[tt,nt,tt,nt,Ie]],["getDirectedEdgeOrigin",Ke,[tt,nt,Ie]],["getDirectedEdgeDestination",Ke,[tt,nt,Ie]],["isValidDirectedEdge",gu,[tt,nt]],["directedEdgeToCells",Ke,[tt,nt,Ie]],["originToDirectedEdges",Ke,[tt,nt,Ie]],["directedEdgeToBoundary",Ke,[tt,nt,Ie]],["gridDistance",Ke,[tt,nt,tt,nt,Ie]],["gridPathCells",Ke,[tt,nt,tt,nt,Ie]],["gridPathCellsSize",Ke,[tt,nt,tt,nt,Ie]],["cellToLocalIj",Ke,[tt,nt,tt,nt,rt,Ie]],["localIjToCell",Ke,[tt,nt,Ie,rt,Ie]],["getHexagonAreaAvgM2",Ke,[Wn,Ie]],["getHexagonAreaAvgKm2",Ke,[Wn,Ie]],["getHexagonEdgeLengthAvgM",Ke,[Wn,Ie]],["getHexagonEdgeLengthAvgKm",Ke,[Wn,Ie]],["greatCircleDistanceM",rt,[Ie,Ie]],["greatCircleDistanceKm",rt,[Ie,Ie]],["greatCircleDistanceRads",rt,[Ie,Ie]],["cellAreaM2",Ke,[tt,nt,Ie]],["cellAreaKm2",Ke,[tt,nt,Ie]],["cellAreaRads2",Ke,[tt,nt,Ie]],["edgeLengthM",Ke,[tt,nt,Ie]],["edgeLengthKm",Ke,[tt,nt,Ie]],["edgeLengthRads",Ke,[tt,nt,Ie]],["getNumCells",Ke,[Wn,Ie]],["getRes0Cells",Ke,[Ie]],["res0CellCount",rt],["getPentagons",Ke,[rt,Ie]],["pentagonCount",rt],["cellToVertex",Ke,[tt,nt,rt,Ie]],["cellToVertexes",Ke,[tt,nt,Ie]],["vertexToLatLng",Ke,[tt,nt,Ie]],["isValidVertex",gu,[tt,nt]]],JD=0,eL=1,tL=2,nL=3,y4=4,rL=5,iL=6,sL=7,oL=8,aL=9,lL=10,uL=11,AL=12,cL=13,hL=14,fL=15,ir={};ir[JD]="Success";ir[eL]="The operation failed but a more specific error is not available";ir[tL]="Argument was outside of acceptable range";ir[nL]="Latitude or longitude arguments were outside of acceptable range";ir[y4]="Resolution argument was outside of acceptable range";ir[rL]="Cell argument was not valid";ir[iL]="Directed edge argument was not valid";ir[sL]="Undirected edge argument was not valid";ir[oL]="Vertex argument was not valid";ir[aL]="Pentagon distortion was encountered";ir[lL]="Duplicate input";ir[uL]="Cell arguments were not neighbors";ir[AL]="Cell arguments had incompatible resolutions";ir[cL]="Memory allocation failed";ir[hL]="Bounds of provided memory were insufficient";ir[fL]="Mode or flags argument was not valid";var dL=1e3,_4=1001,v4=1002,$h={};$h[dL]="Unknown unit";$h[_4]="Array length out of bounds";$h[v4]="Got unexpected null value for H3 index";var pL="Unknown error";function b4(n,e,t){var r=t&&"value"in t,i=new Error((n[e]||pL)+" (code: "+e+(r?", value: "+t.value:"")+")");return i.code=e,i}function x4(n,e){var t=arguments.length===2?{value:e}:{};return b4(ir,n,t)}function T4(n,e){var t=arguments.length===2?{value:e}:{};return b4($h,n,t)}function yA(n){if(n!==0)throw x4(n)}var Or={};ZD.forEach(function(e){Or[e[0]]=St.cwrap.apply(St,e)});var yl=16,_A=4,Gl=8,mL=8,ph=Or.sizeOfH3Index(),e1=Or.sizeOfLatLng(),gL=Or.sizeOfCellBoundary(),yL=Or.sizeOfGeoPolygon(),Ku=Or.sizeOfGeoLoop();Or.sizeOfLinkedGeoPolygon();Or.sizeOfCoordIJ();function _L(n){if(typeof n!="number"||n<0||n>15||Math.floor(n)!==n)throw x4(y4,n);return n}function vL(n){if(!n)throw T4(v4);return n}var bL=Math.pow(2,32)-1;function xL(n){if(n>bL)throw T4(_4,n);return n}var TL=/[^0-9a-fA-F]/;function w4(n){if(Array.isArray(n)&&n.length===2&&Number.isInteger(n[0])&&Number.isInteger(n[1]))return n;if(typeof n!="string"||TL.test(n))return[0,0];var e=parseInt(n.substring(0,n.length-8),yl),t=parseInt(n.substring(n.length-8),yl);return[t,e]}function gv(n){if(n>=0)return n.toString(yl);n=n&2147483647;var e=S4(8,n.toString(yl)),t=(parseInt(e[0],yl)+8).toString(yl);return e=t+e.substring(1),e}function wL(n,e){return gv(e)+S4(8,gv(n))}function S4(n,e){for(var t=n-e.length,r="",i=0;i<t;i++)r+="0";return r=r+e,r}function yv(n,e,t){for(var r=n.length,i=St._calloc(r,e1),s=t?1:0,o=t?0:1,a=0;a<r*2;a+=2)St.HEAPF64.set([n[a/2][s],n[a/2][o]].map(C4),i/Gl+a);return St.HEAPU32.set([r,i],e/_A),e}function SL(n,e){var t=n.length-1,r=St._calloc(yL),i=0,s=i+Ku,o=s+_A;yv(n[0],r+i,e);var a;if(t>0){a=St._calloc(t,Ku);for(var c=0;c<t;c++)yv(n[c+1],a+Ku*c,e)}return St.setValue(r+s,t,"i32"),St.setValue(r+o,a,"i32"),r}function EL(n){var e=0,t=e+Ku,r=t+_A,i=_A;St._free(St.getValue(n+e+i,"i8*"));var s=St.getValue(n+t,"i32");if(s>0){for(var o=St.getValue(n+r,"i32"),a=0;a<s;a++)St._free(St.getValue(o+Ku*a+i,"i8*"));St._free(o)}St._free(n)}function E4(n,e){e===void 0&&(e=0);var t=St.getValue(n+ph*e,"i32"),r=St.getValue(n+ph*e+_A,"i32");return r?wL(t,r):null}function RL(n){return Or.readInt64AsDoubleFromPointer(n)}function NL(n,e){for(var t=[],r=0;r<e;r++){var i=E4(n,r);i!==null&&t.push(i)}return t}function mh(n){return DL(St.getValue(n,"double"))}function CL(n){return[mh(n),mh(n+Gl)]}function ML(n){return[mh(n+Gl),mh(n)]}function PL(n,e,t){for(var r=St.getValue(n,"i32"),i=n+Gl,s=[],o=ML,a=0;a<r*2;a+=2)s.push(o(i+Gl*a));return s.push(s[0]),s}function BL(n,e,t){var r=St._malloc(e1);St.HEAPF64.set([n,e].map(C4),r/Gl);var i=St._malloc(ph);try{return yA(Or.latLngToCell(r,t,i)),vL(E4(i))}finally{St._free(i),St._free(r)}}function R4(n){var e=St._malloc(e1),t=w4(n),r=t[0],i=t[1];try{return yA(Or.cellToLatLng(r,i,e)),CL(e)}finally{St._free(e)}}function N4(n,e){var t=St._malloc(gL),r=w4(n),i=r[0],s=r[1];try{return yA(Or.cellToBoundary(i,s,t)),PL(t,e,e)}finally{St._free(t)}}function _v(n,e,t){if(_L(e),t=!!t,n.length===0||n[0].length===0)return[];var r=typeof n[0][0]=="number"?[n]:n,i=SL(r,t),s=St._malloc(mL);try{yA(Or.maxPolygonToCellsSize(i,e,0,s));var o=xL(RL(s)),a=St._calloc(o,ph);try{return yA(Or.polygonToCells(i,e,0,a)),NL(a,o)}finally{St._free(a)}}finally{St._free(s),EL(i)}}function C4(n){return n*Math.PI/180}function DL(n){return n*180/Math.PI}function LL(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+n*(1172.33-n*(10793.56-n*(33300.12-n*(38394.49-n*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+n*(557.33+n*(1225.33-n*(3574.96-n*(1073.77+n*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+n*(3211.1-n*(15327.97-n*(27814-n*(22569.18-n*6838.66)))))))+")"}const OL=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],Sd=new WeakMap;class FL{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=OL,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:r,material:i,object:s}=e;if(t={material:this.getMaterialData(i),geometry:{id:r.id,attributes:this.getAttributesData(r.attributes),indexVersion:r.index?r.index.version:null,drawRange:{start:r.drawRange.start,count:r.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:o,height:a}=e.context;t.bufferWidth=o,t.bufferHeight=a}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const r in e){const i=e[r];t[r]={version:i.version}}return t}containsNode(e){const t=e.material;for(const r in t)if(t[r]&&t[r].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const r of this.refreshUniforms){const i=e[r];i!=null&&(typeof i=="object"&&i.clone!==void 0?i.isTexture===!0?t[r]={id:i.id,version:i.version}:t[r]=i.clone():t[r]=i)}return t}equals(e,t){const{object:r,material:i,geometry:s}=e,o=this.getRenderObjectData(e);if(o.worldMatrix.equals(r.matrixWorld)!==!0)return o.worldMatrix.copy(r.matrixWorld),!1;const a=o.material;for(const R in a){const C=a[R],B=i[R];if(C.equals!==void 0){if(C.equals(B)===!1)return C.copy(B),!1}else if(B.isTexture===!0){if(C.id!==B.id||C.version!==B.version)return C.id=B.id,C.version=B.version,!1}else if(C!==B)return a[R]=B,!1}if(a.transmission>0){const{width:R,height:C}=e.context;if(o.bufferWidth!==R||o.bufferHeight!==C)return o.bufferWidth=R,o.bufferHeight=C,!1}const c=o.geometry,f=s.attributes,p=c.attributes,g=Object.keys(p),v=Object.keys(f);if(c.id!==s.id)return c.id=s.id,!1;if(g.length!==v.length)return o.geometry.attributes=this.getAttributesData(f),!1;for(const R of g){const C=p[R],B=f[R];if(B===void 0)return delete p[R],!1;if(C.version!==B.version)return C.version=B.version,!1}const x=s.index,T=c.indexVersion,S=x?x.version:null;if(T!==S)return c.indexVersion=S,!1;if(c.drawRange.start!==s.drawRange.start||c.drawRange.count!==s.drawRange.count)return c.drawRange.start=s.drawRange.start,c.drawRange.count=s.drawRange.count,!1;if(o.morphTargetInfluences){let R=!1;for(let C=0;C<o.morphTargetInfluences.length;C++)o.morphTargetInfluences[C]!==r.morphTargetInfluences[C]&&(R=!0);if(R)return!0}if(o.lights){for(let R=0;R<t.length;R++)if(o.lights[R].map!==t[R].map)return!1}return o.center&&o.center.equals(r.center)===!1?(o.center.copy(r.center),!0):(e.bundle!==null&&(o.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const r of e)r.isSpotLight===!0&&r.map!==null&&t.push({map:r.map.version});return t}getLights(e,t){if(Sd.has(e)){const i=Sd.get(e);if(i.renderId===t)return i.lightsData}const r=this.getLightsData(e.getLights());return Sd.set(e,{renderId:t,lightsData:r}),r}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:r}=t;if(this.renderId!==r)return this.renderId=r,!0;const i=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;if(i||s)return!1;const o=this.getLights(e.lightsNode,r);return this.equals(e,o)!==!0}}function vA(n,e=0){let t=3735928559^e,r=1103547991^e;if(n instanceof Array)for(let i=0,s;i<n.length;i++)s=n[i],t=Math.imul(t^s,2654435761),r=Math.imul(r^s,1597334677);else for(let i=0,s;i<n.length;i++)s=n.charCodeAt(i),t=Math.imul(t^s,2654435761),r=Math.imul(r^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}const M4=n=>vA(n),Hh=n=>vA(n),gh=(...n)=>vA(n);function P4(n,e=!1){const t=[];n.isNode===!0&&t.push(n.id);for(const{property:r,childNode:i}of yh(n))t.push(vA(r.slice(0,-4)),i.getCacheKey(e));return vA(t)}function*yh(n,e=!1){for(const t of Object.getOwnPropertyNames(n)){if(t.startsWith("_")===!0)continue;const r=n[t];if(Array.isArray(r)===!0)for(let i=0;i<r.length;i++){const s=r[i];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:i,childNode:s})}else if(r&&r.isNode===!0)yield{property:t,childNode:r};else if(r&&Object.getPrototypeOf(r)===Object.prototype)for(const i in r){if(i.startsWith("_")===!0)continue;const s=r[i];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:i,childNode:s})}}}const IL=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),vv=new WeakMap;function B4(n){return IL.get(n)}function _h(n){if(/[iu]?vec\d/.test(n))return n.startsWith("ivec")?Int32Array:n.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(n)||/float/.test(n))return Float32Array;if(/uint/.test(n))return Uint32Array;if(/int/.test(n))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${n}`)}function D4(n){if(/float|int|uint/.test(n))return 1;if(/vec2/.test(n))return 2;if(/vec3/.test(n))return 3;if(/vec4/.test(n)||/mat2/.test(n))return 4;if(/mat3/.test(n))return 9;if(/mat4/.test(n))return 16}function kL(n){if(/float|int|uint/.test(n))return 1;if(/vec2/.test(n))return 2;if(/vec3/.test(n))return 3;if(/vec4/.test(n)||/mat2/.test(n))return 4;if(/mat3/.test(n))return 12;if(/mat4/.test(n))return 16}function qL(n){if(/float|int|uint/.test(n))return 4;if(/vec2/.test(n))return 8;if(/vec3/.test(n)||/vec4/.test(n))return 16;if(/mat2/.test(n))return 8;if(/mat3/.test(n))return 48;if(/mat4/.test(n))return 64}function bo(n){if(n==null)return null;const e=typeof n;return n.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":n.isVector2===!0?"vec2":n.isVector3===!0?"vec3":n.isVector4===!0?"vec4":n.isMatrix2===!0?"mat2":n.isMatrix3===!0?"mat3":n.isMatrix4===!0?"mat4":n.isColor===!0?"color":n instanceof ArrayBuffer?"ArrayBuffer":null}function t1(n,...e){const t=n?n.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),n==="color"?new Gn(...e):t==="vec2"?new ht(...e):t==="vec3"?new we(...e):t==="vec4"?new Ft(...e):t==="mat2"?new nx(...e):t==="mat3"?new DA(...e):t==="mat4"?new gn(...e):n==="bool"?e[0]||!1:n==="float"||n==="int"||n==="uint"?e[0]||0:n==="string"?e[0]||"":n==="ArrayBuffer"?F4(e[0]):null}function L4(n){let e=vv.get(n);return e===void 0&&(e={},vv.set(n,e)),e}function O4(n){let e="";const t=new Uint8Array(n);for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function F4(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0)).buffer}const Vu={VERTEX:"vertex",FRAGMENT:"fragment"},ot={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},UL={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},nr={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},I4=["fragment","vertex"],Rm=["setup","analyze","generate"],Nm=[...I4,"compute"],Ca=["x","y","z","w"],GL={analyze:"setup",generate:"analyze"};let VL=0;class Oe extends gg{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=ot.NONE,this.updateBeforeType=ot.NONE,this.updateAfterType=ot.NONE,this.uuid=Dl.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:VL++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,ot.FRAME)}onRenderUpdate(e){return this.onUpdate(e,ot.RENDER)}onObjectUpdate(e){return this.onUpdate(e,ot.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of yh(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=gh(P4(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let r=0;for(const i of this.getChildren())t["node"+r++]=i;return t.outputNode||null}analyze(e,t=null){const r=e.increaseUsage(this);if(this.parents===!0){const i=e.getDataFromNode(this,"any");i.stages=i.stages||{},i.stages[e.shaderStage]=i.stages[e.shaderStage]||[],i.stages[e.shaderStage].push(t)}if(r===1){const i=e.getNodeProperties(this);for(const s of Object.values(i))s&&s.isNode===!0&&s.build(e,this)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&r.isNode===!0)return r.build(e,t)}updateBefore(){}updateAfter(){}update(){}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);const i=e.getDataFromNode(this);i.buildStages=i.buildStages||{},i.buildStages[e.buildStage]=!0;const s=GL[e.buildStage];if(s&&i.buildStages[s]!==!0){const c=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(c)}e.addNode(this),e.addChain(this);let o=null;const a=e.getBuildStage();if(a==="setup"){this.updateReference(e);const c=e.getNodeProperties(this);if(c.initialized!==!0){c.initialized=!0,c.outputNode=this.setup(e)||c.outputNode||null;for(const f of Object.values(c))if(f&&f.isNode===!0){if(f.parents===!0){const p=e.getNodeProperties(f);p.parents=p.parents||[],p.parents.push(this)}f.build(e)}}o=c.outputNode}else if(a==="analyze")this.analyze(e,t);else if(a==="generate"){if(this.generate.length===1){const f=this.getNodeType(e),p=e.getDataFromNode(this);o=p.snippet,o===void 0?p.generated===void 0?(p.generated=!0,o=this.generate(e)||"",p.snippet=o):o="/* Recursion detected. */":p.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),o=e.format(o,f,t)}else o=this.generate(e,t)||"";o===""&&t!==null&&t!=="void"&&t!=="OutputType"&&(o=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),o}getSerializeChildren(){return yh(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:i,index:s,childNode:o}of t)s!==void 0?(r[i]===void 0&&(r[i]=Number.isInteger(s)?[]:{}),r[i][s]=o.toJSON(e.meta).uuid):r[i]=o.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const i=[];for(const s of e.inputNodes[r])i.push(t[s]);this[r]=i}else if(typeof e.inputNodes[r]=="object"){const i={};for(const s in e.inputNodes[r]){const o=e.inputNodes[r][s];i[s]=t[o]}this[r]=i}else{const i=e.inputNodes[r];this[r]=t[i]}}}toJSON(e){const{uuid:t,type:r}=this,i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:r,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},i!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(a){const c=[];for(const f in a){const p=a[f];delete p.metadata,c.push(p)}return c}if(i){const a=o(e.textures),c=o(e.images),f=o(e.nodes);a.length>0&&(s.textures=a),c.length>0&&(s.images=c),f.length>0&&(s.nodes=f)}return s}}class Ma extends Oe{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),r=this.node.build(e),i=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${r}[ ${i} ]`}}class k4 extends Oe{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const i of this.convertTo.split("|"))(r===null||e.getTypeLength(t)===e.getTypeLength(i))&&(r=i);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,i=this.getNodeType(e),s=r.build(e,i);return e.format(s,i,t)}}class Rn extends Oe{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const i=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,i,t);if(i!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,i),a=e.getVarFromNode(this,null,i),c=e.getPropertyName(a);return e.addLineFlowCode(`${c} = ${o}`,this),s.snippet=o,s.propertyName=c,e.format(s.propertyName,i,t)}}return super.build(e,t)}}class zL extends Rn{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),i=e.getTypeLength(r),s=this.nodes,o=e.getComponentType(r),a=[];let c=0;for(const p of s){if(c>=i)break;let g=p.getNodeType(e),v=e.getTypeLength(g),x;if(c+v>i&&(v=i-c,g=e.getTypeFromLength(v)),c+=v,x=p.build(e,g),e.getComponentType(g)!==o){const S=e.getTypeFromLength(v,o);x=e.format(x,g,S)}a.push(x)}const f=`${e.getType(r)}( ${a.join(", ")} )`;return e.format(f,r,t)}}const jL=Ca.join("");class q4 extends Oe{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Ca.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const r=this.node,i=e.getTypeLength(r.getNodeType(e));let s=null;if(i>1){let o=null;this.getVectorLength()>=i&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const c=r.build(e,o);this.components.length===i&&this.components===jL.slice(0,this.components.length)?s=e.format(c,o,t):s=e.format(`${c}.${this.components}`,this.getNodeType(e),t)}else s=r.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class $L extends Rn{static get type(){return"SetNode"}constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:i}=this,s=this.getNodeType(e),o=e.getComponentType(i.getNodeType(e)),a=e.getTypeFromLength(r.length,o),c=i.build(e,a),f=t.build(e,s),p=e.getTypeLength(s),g=[];for(let v=0;v<p;v++){const x=Ca[v];x===r[0]?(g.push(c),v+=r.length-1):g.push(f+"."+x)}return`${e.getType(s)}( ${g.join(", ")} )`}}class HL extends Rn{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:r}=this,i=this.getNodeType(e),s=r.build(e),o=e.getVarFromNode(this),a=e.getPropertyName(o);e.addLineFlowCode(a+" = "+s,this);const c=e.getTypeLength(i),f=[];let p=0;for(let g=0;g<c;g++){const v=Ca[g];v===t[p]?(f.push("1.0 - "+(a+"."+v)),p++):f.push(a+"."+v)}return`${e.getType(i)}( ${f.join(", ")} )`}}class n1 extends Oe{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?bo(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=bo(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=O4(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?t1(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){}}const bv=/float|u?int/;class Ti extends n1{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return bv.test(r)&&bv.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),r,t)}}class WL extends Oe{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return this.structNode.isMemberNode&&this.structNode.hasMember(e)===!1?!1:this.structNode.getMemberType(e,this.property)!=="void"}getNodeType(e){return this.hasMember(e)===!1?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(this.hasMember(e)===!1)return"float";const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}generate(e){if(this.hasMember(e)===!1){const r=this.getNodeType(e);return e.generateConst(r)}return this.structNode.build(e)+"."+this.property}}let Co=null;const Cm=new Map;function de(n,e){if(!Cm.has(n)){if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${n} is not a function`);Cm.set(n,e),n!=="assign"&&(Oe.prototype[n]=function(...t){return this.isStackNode?this.add(e(...t)):e(this,...t)},Oe.prototype[n+"Assign"]=function(...t){return this.isStackNode?this.assign(t[0],e(...t)):this.assign(e(this,...t))})}}const QL=n=>n.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),xv=n=>QL(n).split("").sort().join("");Oe.prototype.assign=function(...n){if(this.isStackNode!==!0)return Co!==null&&Co.assign(this,...n),this;{const e=Cm.get("assign");return this.add(e(...n))}};Oe.prototype.toVarIntent=function(){return this};Oe.prototype.get=function(n){return new WL(this,n)};const Zu={};function Tc(n,e,t){Zu[n]=Zu[e]=Zu[t]={get(){this._cache=this._cache||{};let o=this._cache[n];return o===void 0&&(o=new q4(this,n),this._cache[n]=o),o},set(o){this[n].assign(pe(o))}};const r=n.toUpperCase(),i=e.toUpperCase(),s=t.toUpperCase();Oe.prototype["set"+r]=Oe.prototype["set"+i]=Oe.prototype["set"+s]=function(o){const a=xv(n);return new $L(this,a,pe(o))},Oe.prototype["flip"+r]=Oe.prototype["flip"+i]=Oe.prototype["flip"+s]=function(){const o=xv(n);return new HL(this,o)}}const $i=["x","y","z","w"],Hi=["r","g","b","a"],Wi=["s","t","p","q"];for(let n=0;n<4;n++){let e=$i[n],t=Hi[n],r=Wi[n];Tc(e,t,r);for(let i=0;i<4;i++){e=$i[n]+$i[i],t=Hi[n]+Hi[i],r=Wi[n]+Wi[i],Tc(e,t,r);for(let s=0;s<4;s++){e=$i[n]+$i[i]+$i[s],t=Hi[n]+Hi[i]+Hi[s],r=Wi[n]+Wi[i]+Wi[s],Tc(e,t,r);for(let o=0;o<4;o++)e=$i[n]+$i[i]+$i[s]+$i[o],t=Hi[n]+Hi[i]+Hi[s]+Hi[o],r=Wi[n]+Wi[i]+Wi[s]+Wi[o],Tc(e,t,r)}}}for(let n=0;n<32;n++)Zu[n]={get(){this._cache=this._cache||{};let e=this._cache[n];return e===void 0&&(e=new Ma(this,new Ti(n,"uint")),this._cache[n]=e),e},set(e){this[n].assign(pe(e))}};Object.defineProperties(Oe.prototype,Zu);const Tv=new WeakMap,XL=function(n,e=null){const t=bo(n);return t==="node"?n:e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string"?pe(Mm(n,e)):t==="shader"?n.isFn?n:ie(n):n},YL=function(n,e=null){for(const t in n)n[t]=pe(n[t],e);return n},KL=function(n,e=null){const t=n.length;for(let r=0;r<t;r++)n[r]=pe(n[r],e);return n},U4=function(n,e=null,t=null,r=null){function i(p){return r!==null?(p=pe(Object.assign(p,r)),r.intent===!0&&(p=p.toVarIntent())):p=pe(p),p}let s,o=e,a,c;function f(p){let g;return o?g=/[a-z]/i.test(o)?o+"()":o:g=n.type,a!==void 0&&p.length<a?p.concat(new Array(a-p.length).fill(0)):c!==void 0&&p.length>c?p.slice(0,c):p}return e===null?s=(...p)=>i(new n(..._a(f(p)))):t!==null?(t=pe(t),s=(...p)=>i(new n(e,..._a(f(p)),t))):s=(...p)=>i(new n(e,..._a(f(p)))),s.setParameterLength=(...p)=>(p.length===1?a=c=p[0]:p.length===2&&([a,c]=p),s),s.setName=p=>(o=p,s),s},ZL=function(n,...e){return pe(new n(..._a(e)))};class JL extends Oe{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:r}=this,i=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",o=s||"default";if(i[o])return i[o];const a=e.subBuildFn;e.subBuildFn=s;let c=null;if(t.layout){let f=Tv.get(e.constructor);f===void 0&&(f=new WeakMap,Tv.set(e.constructor,f));let p=f.get(t);p===void 0&&(p=pe(e.buildFunctionNode(t)),f.set(t,p)),e.addInclude(p);const g=r?eO(r):null;c=pe(p.call(g))}else{const f=new Proxy(e,{get:(T,S,R)=>{let C;return Symbol.iterator===S?C=function*(){yield void 0}:C=Reflect.get(T,S,R),C}}),p=r?tO(r):null,g=Array.isArray(r)?r.length>0:r!==null,v=t.jsFunc,x=g||v.length>1?v(p,f):v(f);c=pe(x)}return e.subBuildFn=a,t.once&&(i[o]=c),c}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),r=e.getSubBuildOutput(this);return t[r]=t[r]||this.setupOutput(e),t[r].subBuild=e.getClosestSubBuild(this),t[r]}build(e,t=null){let r=null;const i=e.getBuildStage(),s=e.getNodeProperties(this),o=e.getSubBuildOutput(this),a=this.getOutputNode(e);if(i==="setup"){const c=e.getSubBuildProperty("initialized",this);if(s[c]!==!0&&(s[c]=!0,s[o]=this.getOutputNode(e),s[o].build(e),this.shaderNode.subBuilds))for(const f of e.chaining){const p=e.getDataFromNode(f,"any");p.subBuilds=p.subBuilds||new Set;for(const g of this.shaderNode.subBuilds)p.subBuilds.add(g)}r=s[o]}else i==="analyze"?a.build(e,t):i==="generate"&&(r=a.build(e,t)||"");return r}}function eO(n){let e;return Xh(n),n[0]&&(n[0].isNode||Object.getPrototypeOf(n[0])!==Object.prototype)?e=[...n]:e=n[0],e}function tO(n){let e=0;return Xh(n),new Proxy(n,{get:(t,r,i)=>{let s;if(r==="length")return s=n.length,s;if(Symbol.iterator===r)s=function*(){for(const o of n)yield pe(o)};else{if(n.length>0)if(Object.getPrototypeOf(n[0])===Object.prototype){const o=n[0];o[r]===void 0?s=o[e++]:s=Reflect.get(o,r,i)}else n[0]instanceof Oe&&(n[r]===void 0?s=n[e++]:s=Reflect.get(n,r,i));else s=Reflect.get(t,r,i);s=pe(s)}return s}})}class nO extends Oe{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return pe(new JL(this,e))}setup(){return this.call()}}const rO=[!1,!0],iO=[0,1,2,3],sO=[-1,-2],G4=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],r1=new Map;for(const n of rO)r1.set(n,new Ti(n));const i1=new Map;for(const n of iO)i1.set(n,new Ti(n,"uint"));const s1=new Map([...i1].map(n=>new Ti(n.value,"int")));for(const n of sO)s1.set(n,new Ti(n,"int"));const Wh=new Map([...s1].map(n=>new Ti(n.value)));for(const n of G4)Wh.set(n,new Ti(n));for(const n of G4)Wh.set(-n,new Ti(-n));const Qh={bool:r1,uint:i1,ints:s1,float:Wh},wv=new Map([...r1,...Wh]),Mm=(n,e)=>wv.has(n)?wv.get(n):n.isNode===!0?n:new Ti(n,e),Fn=function(n,e=null){return(...t)=>{for(const i of t)if(i===void 0)return pe(new Ti(0,n));if((t.length===0||!["bool","float","int","uint"].includes(n)&&t.every(i=>{const s=typeof i;return s!=="object"&&s!=="function"}))&&(t=[t1(n,...t)]),t.length===1&&e!==null&&e.has(t[0]))return zu(e.get(t[0]));if(t.length===1){const i=Mm(t[0],n);return i.nodeType===n?zu(i):zu(new k4(i,n))}const r=t.map(i=>Mm(i));return zu(new zL(r,n))}},bA=n=>typeof n=="object"&&n!==null?n.value:n,V4=n=>n!=null?n.nodeType||n.convertTo||(typeof n=="string"?n:null):null;function _l(n,e){return new nO(n,e)}const pe=(n,e=null)=>XL(n,e),zu=(n,e=null)=>pe(n,e).toVarIntent(),Xh=(n,e=null)=>new YL(n,e),_a=(n,e=null)=>new KL(n,e),Ye=(n,e=null,t=null,r=null)=>new U4(n,e,t,r),Me=(n,...e)=>new ZL(n,...e),Ne=(n,e=null,t=null,r={})=>new U4(n,e,t,{intent:!0,...r});let oO=0;class aO extends Oe{constructor(e,t=null){super();let r=null;t!==null&&(typeof t=="object"?r=t.return:(typeof t=="string"&&(r=t),t=null)),this.shaderNode=new _l(e,r),t!==null&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if(typeof e.inputs!="object"){const r={name:"fn"+oO++,type:t,inputs:[]};for(const i in e)i!=="return"&&r.inputs.push({name:i,type:e[i]});e=r}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return this.shaderNode.nodeType==="void"&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return e.generateConst(t)}}function ie(n,e=null){const t=new aO(n,e);return new Proxy(()=>{},{apply(r,i,s){return t.call(...s)},get(r,i,s){return Reflect.get(t,i,s)},set(r,i,s,o){return Reflect.set(t,i,s,o)}})}const xA=n=>{Co=n},Yh=()=>Co,We=(...n)=>Co.If(...n),lO=(...n)=>Co.Switch(...n);function Kh(n){return Co&&Co.add(n),n}de("toStack",Kh);const z4=new Fn("color"),z=new Fn("float",Qh.float),X=new Fn("int",Qh.ints),De=new Fn("uint",Qh.uint),yi=new Fn("bool",Qh.bool),ge=new Fn("vec2"),Un=new Fn("ivec2"),j4=new Fn("uvec2"),$4=new Fn("bvec2"),re=new Fn("vec3"),H4=new Fn("ivec3"),Kl=new Fn("uvec3"),o1=new Fn("bvec3"),Ge=new Fn("vec4"),W4=new Fn("ivec4"),Q4=new Fn("uvec4"),X4=new Fn("bvec4"),Zh=new Fn("mat2"),pr=new Fn("mat3"),va=new Fn("mat4"),uO=(n="")=>pe(new Ti(n,"string")),AO=n=>pe(new Ti(n,"ArrayBuffer"));de("toColor",z4);de("toFloat",z);de("toInt",X);de("toUint",De);de("toBool",yi);de("toVec2",ge);de("toIVec2",Un);de("toUVec2",j4);de("toBVec2",$4);de("toVec3",re);de("toIVec3",H4);de("toUVec3",Kl);de("toBVec3",o1);de("toVec4",Ge);de("toIVec4",W4);de("toUVec4",Q4);de("toBVec4",X4);de("toMat2",Zh);de("toMat3",pr);de("toMat4",va);const Y4=Ye(Ma).setParameterLength(2),K4=(n,e)=>pe(new k4(pe(n),e)),cO=(n,e)=>pe(new q4(pe(n),e));de("element",Y4);de("convert",K4);const hO=n=>Kh(n);de("append",n=>Kh(n));class It extends Oe{static get type(){return"PropertyNode"}constructor(e,t=null,r=!1){super(e),this.name=t,this.varying=r,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Is=(n,e)=>pe(new It(n,e)),TA=(n,e)=>pe(new It(n,e,!0)),Mt=Me(It,"vec4","DiffuseColor"),Pm=Me(It,"vec3","EmissiveColor"),ns=Me(It,"float","Roughness"),wA=Me(It,"float","Metalness"),vh=Me(It,"float","Clearcoat"),SA=Me(It,"float","ClearcoatRoughness"),da=Me(It,"vec3","Sheen"),Jh=Me(It,"float","SheenRoughness"),ef=Me(It,"float","Iridescence"),a1=Me(It,"float","IridescenceIOR"),l1=Me(It,"float","IridescenceThickness"),bh=Me(It,"float","AlphaT"),po=Me(It,"float","Anisotropy"),Ju=Me(It,"vec3","AnisotropyT"),ba=Me(It,"vec3","AnisotropyB"),Cr=Me(It,"color","SpecularColor"),EA=Me(It,"float","SpecularF90"),xh=Me(It,"float","Shininess"),Rl=Me(It,"vec4","Output"),v0=Me(It,"float","dashSize"),Bm=Me(It,"float","gapSize"),fO=Me(It,"float","pointWidth"),eA=Me(It,"float","IOR"),Th=Me(It,"float","Transmission"),u1=Me(It,"float","Thickness"),A1=Me(It,"float","AttenuationDistance"),c1=Me(It,"color","AttenuationColor"),h1=Me(It,"float","Dispersion");class Z4 extends Oe{static get type(){return"UniformGroupNode"}constructor(e,t=!1,r=1){super("string"),this.name=e,this.shared=t,this.order=r,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const J4=n=>new Z4(n),tf=(n,e=0)=>new Z4(n,!0,e),eT=tf("frame"),qe=tf("render"),f1=J4("object");class IA extends n1{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=f1}setName(e){return this.name=e,this}label(e){return this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(r=>{const i=e(r,this);i!==void 0&&(this.value=i)},t)}getInputType(e){let t=super.getInputType(e);return t==="bool"&&(t="uint"),t}generate(e,t){const r=this.getNodeType(e),i=this.getUniformHash(e);let s=e.getNodeFromHash(i);s===void 0&&(e.setHashNode(this,i),s=this);const o=s.getInputType(e),a=e.getUniformFromNode(s,o,e.shaderStage,this.name||e.context.nodeName),c=e.getPropertyName(a);e.context.nodeName!==void 0&&delete e.context.nodeName;let f=c;if(r==="bool"){const p=e.getDataFromNode(this);let g=p.propertyName;if(g===void 0){const v=e.getVarFromNode(this,null,"bool");g=e.getPropertyName(v),p.propertyName=g,f=e.format(c,o,r),e.addLineFlowCode(`${g} = ${f}`,this)}f=g}return e.format(f,r,t)}}const Ue=(n,e)=>{const t=V4(e||n);return t===n&&(n=t1(t)),n=n&&n.isNode===!0?n.node&&n.node.value||n.value:n,pe(new IA(n,t))};class Sv extends Rn{static get type(){return"ArrayNode"}constructor(e,t,r=null){super(e),this.count=t,this.values=r,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const tT=(...n)=>{let e;if(n.length===1){const t=n[0];e=new Sv(null,t.length,t)}else{const t=n[0],r=n[1];e=new Sv(t,r)}return pe(e)};de("toArray",(n,e)=>tT(Array(e).fill(n)));class dO extends Rn{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const r=e.getTypeLength(t.node.getNodeType(e));return Ca.join("").slice(0,r)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:r}=this,i=t.getScope(),s=e.getNodeProperties(i);s.assign=!0;const o=e.getNodeProperties(this);o.sourceNode=r,o.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:r,sourceNode:i}=e.getNodeProperties(this),s=this.needsSplitAssign(e),o=r.build(e),a=r.getNodeType(e),c=i.build(e,a),f=i.getNodeType(e),p=e.getDataFromNode(this);let g;if(p.initialized===!0)t!=="void"&&(g=o);else if(s){const v=e.getVarFromNode(this,null,a),x=e.getPropertyName(v);e.addLineFlowCode(`${x} = ${c}`,this);const T=r.node,R=T.node.context({assign:!0}).build(e);for(let C=0;C<T.components.length;C++){const B=T.components[C];e.addLineFlowCode(`${R}.${B} = ${x}[ ${C} ]`,this)}t!=="void"&&(g=o)}else g=`${o} = ${c}`,(t==="void"||f==="void")&&(e.addLineFlowCode(g,this),t!=="void"&&(g=o));return p.initialized=!0,e.format(g,a,t)}}const nT=Ye(dO).setParameterLength(2);de("assign",nT);class pO extends Rn{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],r=this.functionNode,i=r.getInputs(e),s=this.parameters,o=(c,f)=>{const p=f.type,g=p==="pointer";let v;return g?v="&"+c.build(e):v=c.build(e,p),v};if(Array.isArray(s)){if(s.length>i.length)s.length=i.length;else if(s.length<i.length)for(;s.length<i.length;)s.push(z(0));for(let c=0;c<s.length;c++)t.push(o(s[c],i[c]))}else for(const c of i){const f=s[c.name];f!==void 0?t.push(o(f,c)):t.push(o(z(0),c))}return`${r.build(e,"property")}( ${t.join(", ")} )`}}const rT=(n,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?_a(e):Xh(e[0]),pe(new pO(pe(n),e)));de("call",rT);const mO={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class fn extends Rn{static get type(){return"OperatorNode"}constructor(e,t,r,...i){if(super(),i.length>0){let s=new fn(e,t,r);for(let o=0;o<i.length-1;o++)s=new fn(e,s,i[o]);t=s,r=i[i.length-1]}this.op=e,this.aNode=t,this.bNode=r,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(mO[this.op],t)}getNodeType(e,t=null){const r=this.op,i=this.aNode,s=this.bNode,o=i.getNodeType(e),a=s?s.getNodeType(e):null;if(o==="void"||a==="void")return t||"void";if(r==="%")return o;if(r==="~"||r==="&"||r==="|"||r==="^"||r===">>"||r==="<<")return e.getIntegerType(o);if(r==="!"||r==="&&"||r==="||"||r==="^^")return"bool";if(r==="=="||r==="!="||r==="<"||r===">"||r==="<="||r===">="){const c=Math.max(e.getTypeLength(o),e.getTypeLength(a));return c>1?`bvec${c}`:"bool"}else{if(e.isMatrix(o)){if(a==="float")return o;if(e.isVector(a))return e.getVectorFromMatrix(o);if(e.isMatrix(a))return o}else if(e.isMatrix(a)){if(o==="float")return a;if(e.isVector(o))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(o)?a:o}}generate(e,t){const r=this.op,{aNode:i,bNode:s}=this,o=this.getNodeType(e,t);let a=null,c=null;o!=="void"?(a=i.getNodeType(e),c=s?s.getNodeType(e):null,r==="<"||r===">"||r==="<="||r===">="||r==="=="||r==="!="?e.isVector(a)?c=a:e.isVector(c)?a=c:a!==c&&(a=c="float"):r===">>"||r==="<<"?(a=o,c=e.changeComponentType(c,"uint")):r==="%"?(a=o,c=e.isInteger(a)&&e.isInteger(c)?c:a):e.isMatrix(a)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(a):e.isMatrix(c)||(a=c=o):e.isMatrix(c)?a==="float"?a="float":e.isVector(a)?a=e.getVectorFromMatrix(c):a=c=o:a=c=o):a=c=o;const f=i.build(e,a),p=s?s.build(e,c):null,g=e.getFunctionOperator(r);if(t!=="void"){const v=e.renderer.coordinateSystem===M0;if(r==="=="||r==="!="||r==="<"||r===">"||r==="<="||r===">=")return v?e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${f}, ${p} )`,o,t):e.format(`( ${f} ${r} ${p} )`,o,t):e.format(`( ${f} ${r} ${p} )`,o,t);if(r==="%")return e.isInteger(c)?e.format(`( ${f} % ${p} )`,o,t):e.format(`${this.getOperatorMethod(e,o)}( ${f}, ${p} )`,o,t);if(r==="!"||r==="~")return e.format(`(${r}${f})`,a,t);if(g)return e.format(`${g}( ${f}, ${p} )`,o,t);if(e.isMatrix(a)&&c==="float")return e.format(`( ${p} ${r} ${f} )`,o,t);if(a==="float"&&e.isMatrix(c))return e.format(`${f} ${r} ${p}`,o,t);{let x=`( ${f} ${r} ${p} )`;return!v&&o==="bool"&&e.isVector(a)&&e.isVector(c)&&(x=`all${x}`),e.format(x,o,t)}}else if(a!=="void")return g?e.format(`${g}( ${f}, ${p} )`,o,t):e.isMatrix(a)&&c==="float"?e.format(`${p} ${r} ${f}`,o,t):e.format(`${f} ${r} ${p}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Pn=Ne(fn,"+").setParameterLength(2,1/0).setName("add"),vt=Ne(fn,"-").setParameterLength(2,1/0).setName("sub"),Je=Ne(fn,"*").setParameterLength(2,1/0).setName("mul"),Kr=Ne(fn,"/").setParameterLength(2,1/0).setName("div"),kA=Ne(fn,"%").setParameterLength(2).setName("mod"),d1=Ne(fn,"==").setParameterLength(2).setName("equal"),iT=Ne(fn,"!=").setParameterLength(2).setName("notEqual"),sT=Ne(fn,"<").setParameterLength(2).setName("lessThan"),p1=Ne(fn,">").setParameterLength(2).setName("greaterThan"),oT=Ne(fn,"<=").setParameterLength(2).setName("lessThanEqual"),aT=Ne(fn,">=").setParameterLength(2).setName("greaterThanEqual"),lT=Ne(fn,"&&").setParameterLength(2,1/0).setName("and"),uT=Ne(fn,"||").setParameterLength(2,1/0).setName("or"),AT=Ne(fn,"!").setParameterLength(1).setName("not"),cT=Ne(fn,"^^").setParameterLength(2).setName("xor"),hT=Ne(fn,"&").setParameterLength(2).setName("bitAnd"),fT=Ne(fn,"~").setParameterLength(2).setName("bitNot"),dT=Ne(fn,"|").setParameterLength(2).setName("bitOr"),pT=Ne(fn,"^").setParameterLength(2).setName("bitXor"),mT=Ne(fn,"<<").setParameterLength(2).setName("shiftLeft"),gT=Ne(fn,">>").setParameterLength(2).setName("shiftRight"),yT=ie(([n])=>(n.addAssign(1),n)),_T=ie(([n])=>(n.subAssign(1),n)),vT=ie(([n])=>{const e=X(n).toConst();return n.addAssign(1),e}),bT=ie(([n])=>{const e=X(n).toConst();return n.subAssign(1),e});de("add",Pn);de("sub",vt);de("mul",Je);de("div",Kr);de("mod",kA);de("equal",d1);de("notEqual",iT);de("lessThan",sT);de("greaterThan",p1);de("lessThanEqual",oT);de("greaterThanEqual",aT);de("and",lT);de("or",uT);de("not",AT);de("xor",cT);de("bitAnd",hT);de("bitNot",fT);de("bitOr",dT);de("bitXor",pT);de("shiftLeft",mT);de("shiftRight",gT);de("incrementBefore",yT);de("decrementBefore",_T);de("increment",vT);de("decrement",bT);const xT=(n,e)=>kA(X(n),X(e));de("modInt",xT);class ue extends Rn{static get type(){return"MathNode"}constructor(e,t,r=null,i=null){if(super(),(e===ue.MAX||e===ue.MIN)&&arguments.length>3){let s=new ue(e,t,r);for(let o=2;o<arguments.length-1;o++)s=new ue(e,s,arguments[o]);t=s,r=arguments[arguments.length-1],i=null}this.method=e,this.aNode=t,this.bNode=r,this.cNode=i,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,i=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(r)?0:e.getTypeLength(r),a=e.isMatrix(i)?0:e.getTypeLength(i);return s>o&&s>a?t:o>a?r:a>s?i:t}getNodeType(e){const t=this.method;return t===ue.LENGTH||t===ue.DISTANCE||t===ue.DOT?"float":t===ue.CROSS?"vec3":t===ue.ALL||t===ue.ANY?"bool":t===ue.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:r,method:i}=this;let s=null;if(i===ue.ONE_MINUS)s=vt(1,t);else if(i===ue.RECIPROCAL)s=Kr(1,t);else if(i===ue.DIFFERENCE)s=tn(vt(t,r));else if(i===ue.TRANSFORM_DIRECTION){let o=t,a=r;e.isMatrix(o.getNodeType(e))?a=Ge(re(a),0):o=Ge(re(o),0);const c=Je(o,a).xyz;s=$s(c)}return s!==null?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let i=this.method;const s=this.getNodeType(e),o=this.getInputType(e),a=this.aNode,c=this.bNode,f=this.cNode,p=e.renderer.coordinateSystem;if(i===ue.NEGATE)return e.format("( - "+a.build(e,o)+" )",s,t);{const g=[];return i===ue.CROSS?g.push(a.build(e,s),c.build(e,s)):p===M0&&i===ue.STEP?g.push(a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":o),c.build(e,o)):p===M0&&(i===ue.MIN||i===ue.MAX)?g.push(a.build(e,o),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":o)):i===ue.REFRACT?g.push(a.build(e,o),c.build(e,o),f.build(e,"float")):i===ue.MIX?g.push(a.build(e,o),c.build(e,o),f.build(e,e.getTypeLength(f.getNodeType(e))===1?"float":o)):(p===Yl&&i===ue.ATAN&&c!==null&&(i="atan2"),e.shaderStage!=="fragment"&&(i===ue.DFDX||i===ue.DFDY)&&(i="/*"+i+"*/"),g.push(a.build(e,o)),c!==null&&g.push(c.build(e,o)),f!==null&&g.push(f.build(e,o))),e.format(`${e.getMethod(i,s)}( ${g.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}ue.ALL="all";ue.ANY="any";ue.RADIANS="radians";ue.DEGREES="degrees";ue.EXP="exp";ue.EXP2="exp2";ue.LOG="log";ue.LOG2="log2";ue.SQRT="sqrt";ue.INVERSE_SQRT="inversesqrt";ue.FLOOR="floor";ue.CEIL="ceil";ue.NORMALIZE="normalize";ue.FRACT="fract";ue.SIN="sin";ue.COS="cos";ue.TAN="tan";ue.ASIN="asin";ue.ACOS="acos";ue.ATAN="atan";ue.ABS="abs";ue.SIGN="sign";ue.LENGTH="length";ue.NEGATE="negate";ue.ONE_MINUS="oneMinus";ue.DFDX="dFdx";ue.DFDY="dFdy";ue.ROUND="round";ue.RECIPROCAL="reciprocal";ue.TRUNC="trunc";ue.FWIDTH="fwidth";ue.TRANSPOSE="transpose";ue.DETERMINANT="determinant";ue.INVERSE="inverse";ue.EQUALS="equals";ue.MIN="min";ue.MAX="max";ue.STEP="step";ue.REFLECT="reflect";ue.DISTANCE="distance";ue.DIFFERENCE="difference";ue.DOT="dot";ue.CROSS="cross";ue.POW="pow";ue.TRANSFORM_DIRECTION="transformDirection";ue.MIX="mix";ue.CLAMP="clamp";ue.REFRACT="refract";ue.SMOOTHSTEP="smoothstep";ue.FACEFORWARD="faceforward";const TT=z(1e-6),gO=z(1e6),wh=z(Math.PI),yO=z(Math.PI*2),wT=Ne(ue,ue.ALL).setParameterLength(1),ST=Ne(ue,ue.ANY).setParameterLength(1),ET=Ne(ue,ue.RADIANS).setParameterLength(1),RT=Ne(ue,ue.DEGREES).setParameterLength(1),m1=Ne(ue,ue.EXP).setParameterLength(1),Vl=Ne(ue,ue.EXP2).setParameterLength(1),nf=Ne(ue,ue.LOG).setParameterLength(1),ls=Ne(ue,ue.LOG2).setParameterLength(1),bs=Ne(ue,ue.SQRT).setParameterLength(1),g1=Ne(ue,ue.INVERSE_SQRT).setParameterLength(1),us=Ne(ue,ue.FLOOR).setParameterLength(1),rf=Ne(ue,ue.CEIL).setParameterLength(1),$s=Ne(ue,ue.NORMALIZE).setParameterLength(1),Xs=Ne(ue,ue.FRACT).setParameterLength(1),Qr=Ne(ue,ue.SIN).setParameterLength(1),Cs=Ne(ue,ue.COS).setParameterLength(1),NT=Ne(ue,ue.TAN).setParameterLength(1),CT=Ne(ue,ue.ASIN).setParameterLength(1),y1=Ne(ue,ue.ACOS).setParameterLength(1),sf=Ne(ue,ue.ATAN).setParameterLength(1,2),tn=Ne(ue,ue.ABS).setParameterLength(1),RA=Ne(ue,ue.SIGN).setParameterLength(1),As=Ne(ue,ue.LENGTH).setParameterLength(1),MT=Ne(ue,ue.NEGATE).setParameterLength(1),PT=Ne(ue,ue.ONE_MINUS).setParameterLength(1),_1=Ne(ue,ue.DFDX).setParameterLength(1),v1=Ne(ue,ue.DFDY).setParameterLength(1),BT=Ne(ue,ue.ROUND).setParameterLength(1),DT=Ne(ue,ue.RECIPROCAL).setParameterLength(1),b1=Ne(ue,ue.TRUNC).setParameterLength(1),LT=Ne(ue,ue.FWIDTH).setParameterLength(1),OT=Ne(ue,ue.TRANSPOSE).setParameterLength(1),FT=Ne(ue,ue.DETERMINANT).setParameterLength(1),IT=Ne(ue,ue.INVERSE).setParameterLength(1),kT=(n,e)=>d1(n,e),Fr=Ne(ue,ue.MIN).setParameterLength(2,1/0),_n=Ne(ue,ue.MAX).setParameterLength(2,1/0),of=Ne(ue,ue.STEP).setParameterLength(2),qT=Ne(ue,ue.REFLECT).setParameterLength(2),UT=Ne(ue,ue.DISTANCE).setParameterLength(2),GT=Ne(ue,ue.DIFFERENCE).setParameterLength(2),Lo=Ne(ue,ue.DOT).setParameterLength(2),af=Ne(ue,ue.CROSS).setParameterLength(2),Ai=Ne(ue,ue.POW).setParameterLength(2),x1=n=>Je(n,n),VT=n=>Je(n,n,n),zT=n=>Je(n,n,n,n),jT=Ne(ue,ue.TRANSFORM_DIRECTION).setParameterLength(2),$T=n=>Je(RA(n),Ai(tn(n),1/3)),T1=n=>Lo(n,n),Nt=Ne(ue,ue.MIX).setParameterLength(3),_i=(n,e=0,t=1)=>pe(new ue(ue.CLAMP,pe(n),pe(e),pe(t))),w1=n=>_i(n),S1=Ne(ue,ue.REFRACT).setParameterLength(3),ps=Ne(ue,ue.SMOOTHSTEP).setParameterLength(3),E1=Ne(ue,ue.FACEFORWARD).setParameterLength(3),HT=ie(([n])=>{const r=43758.5453,i=Lo(n.xy,ge(12.9898,78.233)),s=kA(i,wh);return Xs(Qr(s).mul(r))}),WT=(n,e,t)=>Nt(e,t,n),QT=(n,e,t)=>ps(e,t,n),XT=(n,e)=>of(e,n),YT=(n,e)=>sf(n,e),_O=E1,vO=g1;de("all",wT);de("any",ST);de("equals",kT);de("radians",ET);de("degrees",RT);de("exp",m1);de("exp2",Vl);de("log",nf);de("log2",ls);de("sqrt",bs);de("inverseSqrt",g1);de("floor",us);de("ceil",rf);de("normalize",$s);de("fract",Xs);de("sin",Qr);de("cos",Cs);de("tan",NT);de("asin",CT);de("acos",y1);de("atan",sf);de("abs",tn);de("sign",RA);de("length",As);de("lengthSq",T1);de("negate",MT);de("oneMinus",PT);de("dFdx",_1);de("dFdy",v1);de("round",BT);de("reciprocal",DT);de("trunc",b1);de("fwidth",LT);de("atan2",YT);de("min",Fr);de("max",_n);de("step",XT);de("reflect",qT);de("distance",UT);de("dot",Lo);de("cross",af);de("pow",Ai);de("pow2",x1);de("pow3",VT);de("pow4",zT);de("transformDirection",jT);de("mix",WT);de("clamp",_i);de("refract",S1);de("smoothstep",QT);de("faceForward",E1);de("difference",GT);de("saturate",w1);de("cbrt",$T);de("transpose",OT);de("determinant",FT);de("inverse",IT);de("rand",HT);class bO extends Oe{static get type(){return"ConditionalNode"}constructor(e,t,r=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=r}getNodeType(e){const{ifNode:t,elseNode:r}=e.getNodeProperties(this);if(t===void 0)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const i=t.getNodeType(e);if(r!==null){const s=r.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(i))return s}return i}setup(e){const t=this.condNode.cache(),r=this.ifNode.cache(),i=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(r).parentNodeBlock=s,i!==null&&(e.getDataFromNode(i).parentNodeBlock=s);const o=e.context.uniformFlow,a=e.getNodeProperties(this);a.condNode=t,a.ifNode=o?r:r.context({nodeBlock:r}),a.elseNode=i?o?i:i.context({nodeBlock:i}):null}generate(e,t){const r=this.getNodeType(e),i=e.getDataFromNode(this);if(i.nodeProperty!==void 0)return i.nodeProperty;const{condNode:s,ifNode:o,elseNode:a}=e.getNodeProperties(this),c=e.currentFunctionNode,f=t!=="void",p=f?Is(r).build(e):"";i.nodeProperty=p;const g=s.build(e,"bool");if(e.context.uniformFlow&&a!==null){const T=o.build(e,r),S=a.build(e,r),R=e.getTernary(g,T,S);return e.format(R,r,t)}e.addFlowCode(`
${e.tab}if ( ${g} ) {

`).addFlowTab();let x=o.build(e,r);if(x&&(f?x=p+" = "+x+";":(x="return "+x+";",c===null&&(x="// "+x))),e.removeFlowTab().addFlowCode(e.tab+"	"+x+`

`+e.tab+"}"),a!==null){e.addFlowCode(` else {

`).addFlowTab();let T=a.build(e,r);T&&(f?T=p+" = "+T+";":(T="return "+T+";",c===null&&(T="// "+T))),e.removeFlowTab().addFlowCode(e.tab+"	"+T+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(p,r,t)}}const Xn=Ye(bO).setParameterLength(2,3);de("select",Xn);class KT extends Oe{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const r=e.getContext();e.setContext({...e.context,...this.value});const i=this.node.build(e,t);return e.setContext(r),i}}const qA=Ye(KT).setParameterLength(1,2),ZT=n=>qA(n,{uniformFlow:!0}),R1=(n,e)=>qA(n,{nodeName:e});function JT(n,e){return R1(n,e)}de("context",qA);de("label",JT);de("uniformFlow",ZT);de("setName",R1);class b0 extends Oe{static get type(){return"VarNode"}constructor(e,t=null,r=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=r,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}build(...e){return this.intent===!0&&e[0].getNodeProperties(this).assign!==!0?this.node.build(...e):super.build(...e)}generate(e){const{node:t,name:r,readOnly:i}=this,{renderer:s}=e,o=s.backend.isWebGPUBackend===!0;let a=!1,c=!1;i&&(a=e.isDeterministic(t),c=o?i:a);const f=e.getVectorType(this.getNodeType(e)),p=t.build(e,f),g=e.getVarFromNode(this,r,f,void 0,c),v=e.getPropertyName(g);let x=v;if(c)if(o)x=a?`const ${v}`:`let ${v}`;else{const T=t.getArrayCount(e);x=`const ${e.getVar(g.type,v,T)}`}return e.addLineFlowCode(`${x} = ${p}`,this),v}}const N1=Ye(b0),e8=(n,e=null)=>N1(n,e).toStack(),t8=(n,e=null)=>N1(n,e,!0).toStack(),n8=n=>Yh()===null?n:N1(n).setIntent(!0).toStack();de("toVar",e8);de("toConst",t8);de("toVarIntent",n8);class xO extends Oe{static get type(){return"SubBuild"}constructor(e,t,r=null){super(r),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const r=this.node.build(e,...t);return e.removeSubBuild(),r}}const Nl=(n,e,t=null)=>pe(new xO(pe(n),e,t));class TO extends Oe{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let r=t.varying;if(r===void 0){const i=this.name,s=this.getNodeType(e),o=this.interpolationType,a=this.interpolationSampling;t.varying=r=e.getVaryingFromNode(this,i,s,o,a),t.node=Nl(this.node,"VERTEX")}return r.needsInterpolation||(r.needsInterpolation=e.shaderStage==="fragment"),r}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(Vu.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(Vu.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),r=e.getNodeProperties(this),i=this.setupVarying(e);if(r[t]===void 0){const s=this.getNodeType(e),o=e.getPropertyName(i,Vu.VERTEX);e.flowNodeFromShaderStage(Vu.VERTEX,r.node,s,o),r[t]=o}return e.getPropertyName(i)}}const xs=Ye(TO).setParameterLength(1,2),r8=n=>xs(n);de("toVarying",xs);de("toVertexStage",r8);de("varying",(...n)=>xs(...n));de("vertexStage",(...n)=>xs(...n));const i8=ie(([n])=>{const e=n.mul(.9478672986).add(.0521327014).pow(2.4),t=n.mul(.0773993808),r=n.lessThanEqual(.04045);return Nt(e,t,r)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),s8=ie(([n])=>{const e=n.pow(.41666).mul(1.055).sub(.055),t=n.mul(12.92),r=n.lessThanEqual(.0031308);return Nt(e,t,r)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),C1="WorkingColorSpace",wO="OutputColorSpace";class M1 extends Rn{static get type(){return"ColorSpaceNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.source=t,this.target=r}resolveColorSpace(e,t){return t===C1?Tn.workingColorSpace:t===wO?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,r=this.resolveColorSpace(e,this.source),i=this.resolveColorSpace(e,this.target);let s=t;return Tn.enabled===!1||r===i||!r||!i||(Tn.getTransfer(r)===ct&&(s=Ge(i8(s.rgb),s.a)),Tn.getPrimaries(r)!==Tn.getPrimaries(i)&&(s=Ge(pr(Tn._getMatrix(new DA,r,i)).mul(s.rgb),s.a)),Tn.getTransfer(i)===ct&&(s=Ge(s8(s.rgb),s.a))),s}}const o8=(n,e)=>pe(new M1(pe(n),C1,e)),lf=(n,e)=>pe(new M1(pe(n),e,C1)),SO=(n,e,t)=>pe(new M1(pe(n),e,t));de("workingToColorSpace",o8);de("colorSpaceToWorking",lf);let EO=class extends Ma{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,r,i)}};class a8 extends Oe{static get type(){return"ReferenceBaseNode"}constructor(e,t,r=null,i=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=i,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.updateType=ot.OBJECT}setGroup(e){return this.group=e,this}element(e){return pe(new EO(this,pe(e)))}setNodeType(e){const t=Ue(null,e);this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let i=1;i<t.length;i++)r=r[t[i]];return r}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const RO=(n,e,t)=>pe(new a8(n,e,t));class NO extends a8{static get type(){return"RendererReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.renderer=r,this.setGroup(qe)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const l8=(n,e,t=null)=>pe(new NO(n,e,t));class CO extends Rn{static get type(){return"ToneMappingNode"}constructor(e,t=A8,r=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=r}customCacheKey(){return gh(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,r=this.toneMapping;if(r===Tl)return t;let i=null;const s=e.renderer.library.getToneMappingFunction(r);return s!==null?i=Ge(s(t.rgb,this.exposureNode),t.a):i=t,i}}const u8=(n,e,t)=>pe(new CO(n,pe(e),pe(t))),A8=l8("toneMappingExposure","float");de("toneMapping",(n,e,t)=>u8(e,t,n));class MO extends n1{static get type(){return"BufferAttributeNode"}constructor(e,t=null,r=0,i=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=r,this.bufferOffset=i,this.usage=eN,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),r=this.value,i=e.getTypeLength(t),s=this.bufferStride||i,o=this.bufferOffset,a=r.isInterleavedBuffer===!0?r:new _b(r,s),c=new vo(a,i,o);a.setUsage(this.usage),this.attribute=c,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),r=e.getBufferAttributeFromNode(this,t),i=e.getPropertyName(r);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=i,s=i):s=xs(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const UA=(n,e=null,t=0,r=0)=>pe(new MO(n,e,t,r)),c8=(n,e=null,t=0,r=0)=>UA(n,e,t,r).setUsage(hl),Sh=(n,e=null,t=0,r=0)=>UA(n,e,t,r).setInstanced(!0),Dm=(n,e=null,t=0,r=0)=>c8(n,e,t,r).setInstanced(!0);de("toAttribute",n=>UA(n.value));class PO extends Oe{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=ot.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const r=e.getNodeProperties(this);r.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:r}=e;if(r==="compute"){const i=this.computeNode.build(e,"void");i!==""&&e.addLineFlowCode(i,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const P1=(n,e=[64])=>{e.length===0||e.length>3;for(let t=0;t<e.length;t++){const r=e[t];typeof r!="number"||r<=0||Number.isInteger(r)}for(;e.length<3;)e.push(1);return pe(new PO(pe(n),e))},h8=(n,e,t)=>P1(n,t).setCount(e);de("compute",h8);de("computeKernel",P1);class BO extends Oe{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const i=this.node.getNodeType(e);return e.setCache(t),i}build(e,...t){const r=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const s=this.node.build(e,...t);return e.setCache(r),s}}const tA=(n,e)=>pe(new BO(pe(n),e));de("cache",tA);class DO extends Oe{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const f8=Ye(DO).setParameterLength(2);de("bypass",f8);class d8 extends Oe{static get type(){return"RemapNode"}constructor(e,t,r,i=z(0),s=z(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=r,this.outLowNode=i,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:r,outLowNode:i,outHighNode:s,doClamp:o}=this;let a=e.sub(t).div(r.sub(t));return o===!0&&(a=a.clamp()),a.mul(s.sub(i)).add(i)}}const p8=Ye(d8,null,null,{doClamp:!1}).setParameterLength(3,5),m8=Ye(d8).setParameterLength(3,5);de("remap",p8);de("remapClamp",m8);class x0 extends Oe{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const r=this.getNodeType(e),i=this.snippet;if(r==="void")e.addLineFlowCode(i,this);else return e.format(i,r,t)}}const Hs=Ye(x0).setParameterLength(1,2),g8=n=>(n?Xn(n,Hs("discard")):Hs("discard")).toStack(),LO=()=>Hs("return").toStack();de("discard",g8);class OO extends Rn{static get type(){return"RenderOutputNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=r,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const r=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||Tl,i=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Pl;return r!==Tl&&(t=t.toneMapping(r)),i!==Pl&&i!==Tn.workingColorSpace&&(t=t.workingToColorSpace(i)),t}}const y8=(n,e=null,t=null)=>pe(new OO(pe(n),e,t));de("renderOutput",y8);class FO extends Rn{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,r=this.node.build(e),i="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(i.length);let o="";return o+="// #"+i+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+r+` /* ... */
`,o+="// #"+s+`#
`,t!==null&&t(e,o),r}}const _8=(n,e=null)=>pe(new FO(pe(n),e)).toStack();de("debug",_8);function IO(n){}class v8 extends Oe{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const r=this.getAttributeName(e);if(e.hasGeometryAttribute(r)){const i=e.geometry.getAttribute(r);t=e.getTypeFromAttribute(i)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),r=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(s),a=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(a.name,o,r):xs(this).build(e,r)}else return e.generateConst(r)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Ws=(n,e=null)=>pe(new v8(n,e)),Wt=(n=0)=>Ws("uv"+(n>0?n:""),"vec2");class kO extends Oe{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const r=this.textureNode.build(e,"property"),i=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${r}, ${i} )`,this.getNodeType(e),t)}}const Eo=Ye(kO).setParameterLength(1,2);class qO extends IA{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=ot.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,r=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(r&&r.width!==void 0){const{width:i,height:s}=r;this.value=Math.log2(Math.max(i,s))}}}const B1=Ye(qO).setParameterLength(1),D1=new bg;class ms extends IA{static get type(){return"TextureNode"}constructor(e=D1,t=null,r=null,i=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=r,this.biasNode=i,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=ot.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Ln?"uvec4":this.value.type===vr?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Wt(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Ue(this.value.matrix)),this._matrixUniform.mul(re(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?ot.OBJECT:ot.NONE,this}setupUV(e,t){const r=this.value;return e.isFlipY()&&(r.image instanceof ImageBitmap&&r.flipY===!0||r.isRenderTargetTexture===!0||r.isFramebufferTexture===!0||r.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(X(Eo(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const r=this.value;if(!r||r.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let i=this.uvNode;(i===null||e.context.forceUVContext===!0)&&e.context.getUV&&(i=e.context.getUV(this,e)),i||(i=this.getDefaultUV()),this.updateMatrix===!0&&(i=this.getTransformedUV(i)),i=this.setupUV(e,i);let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=i,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,r,i,s,o,a,c,f){const p=this.value;let g;return i?g=e.generateTextureLevel(p,t,r,i,o,f):s?g=e.generateTextureBias(p,t,r,s,o,f):c?g=e.generateTextureGrad(p,t,r,c,o,f):a?g=e.generateTextureCompare(p,t,r,a,o,f):this.sampler===!1?g=e.generateTextureLoad(p,t,r,o,f):g=e.generateTexture(p,t,r,o,f),g}generate(e,t){const r=this.value,i=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const o=e.getDataFromNode(this);let a=o.propertyName;if(a===void 0){const{uvNode:p,levelNode:g,biasNode:v,compareNode:x,depthNode:T,gradNode:S,offsetNode:R}=i,C=this.generateUV(e,p),B=g?g.build(e,"float"):null,D=v?v.build(e,"float"):null,F=T?T.build(e,"int"):null,I=x?x.build(e,"float"):null,q=S?[S[0].build(e,"vec2"),S[1].build(e,"vec2")]:null,k=R?this.generateOffset(e,R):null,G=e.getVarFromNode(this);a=e.getPropertyName(G);const j=this.generateSnippet(e,s,C,B,D,F,I,q,k);e.addLineFlowCode(`${a} = ${j}`,this),o.snippet=j,o.propertyName=a}let c=a;const f=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(c=lf(Hs(c,f),r.colorSpace).setup(e).build(e,f)),e.format(c,f,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return this.sample(e)}sample(e){const t=this.clone();return t.uvNode=pe(e),t.referenceNode=this.getBase(),pe(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=pe(e).mul(B1(t)),t.referenceNode=this.getBase();const r=t.value;return t.generateMipmaps===!1&&(r&&r.generateMipmaps===!1||r.minFilter===Bi||r.magFilter===Bi)&&(t.biasNode=null),pe(t)}level(e){const t=this.clone();return t.levelNode=pe(e),t.referenceNode=this.getBase(),pe(t)}size(e){return Eo(this,e)}bias(e){const t=this.clone();return t.biasNode=pe(e),t.referenceNode=this.getBase(),pe(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=pe(e),t.referenceNode=this.getBase(),pe(t)}grad(e,t){const r=this.clone();return r.gradNode=[pe(e),pe(t)],r.referenceNode=this.getBase(),pe(r)}depth(e){const t=this.clone();return t.depthNode=pe(e),t.referenceNode=this.getBase(),pe(t)}offset(e){const t=this.clone();return t.offsetNode=pe(e),t.referenceNode=this.getBase(),pe(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const UO=Ye(ms).setParameterLength(1,4).setName("texture"),_t=(n=D1,e=null,t=null,r=null)=>{let i;return n&&n.isTextureNode===!0?(i=pe(n.clone()),i.referenceNode=n.getBase(),e!==null&&(i.uvNode=pe(e)),t!==null&&(i.levelNode=pe(t)),r!==null&&(i.biasNode=pe(r))):i=UO(n,e,t,r),i},GO=(n=D1)=>_t(n),bn=(...n)=>_t(...n).setSampler(!1),VO=n=>(n.isNode===!0?n:_t(n)).convert("sampler"),zO=n=>(n.isNode===!0?n:_t(n)).convert("samplerComparison");class L1 extends IA{static get type(){return"BufferNode"}constructor(e,t,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=r}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const GA=(n,e,t)=>pe(new L1(n,e,t));class jO extends Ma{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),r=this.getNodeType(),i=this.node.getPaddedType();return e.format(t,i,r)}}class $O extends L1{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?bo(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=ot.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,r=this.elementType;if(r==="float"||r==="int"||r==="uint")for(let i=0;i<e.length;i++){const s=i*4;t[s]=e[i]}else if(r==="color")for(let i=0;i<e.length;i++){const s=i*4,o=e[i];t[s]=o.r,t[s+1]=o.g,t[s+2]=o.b||0}else if(r==="mat2")for(let i=0;i<e.length;i++){const s=i*4,o=e[i];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+3]=o.elements[3]}else if(r==="mat3")for(let i=0;i<e.length;i++){const s=i*16,o=e[i];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+4]=o.elements[3],t[s+5]=o.elements[4],t[s+6]=o.elements[5],t[s+8]=o.elements[6],t[s+9]=o.elements[7],t[s+10]=o.elements[8],t[s+15]=1}else if(r==="mat4")for(let i=0;i<e.length;i++){const s=i*16,o=e[i];for(let a=0;a<o.elements.length;a++)t[s+a]=o.elements[a]}else for(let i=0;i<e.length;i++){const s=i*4,o=e[i];t[s]=o.x,t[s+1]=o.y,t[s+2]=o.z||0,t[s+3]=o.w||0}}setup(e){const t=this.array.length,r=this.elementType;let i=Float32Array;const s=this.paddedType,o=e.getTypeLength(s);return r.charAt(0)==="i"&&(i=Int32Array),r.charAt(0)==="u"&&(i=Uint32Array),this.value=new i(t*o),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return pe(new jO(this,pe(e)))}}const cr=(n,e)=>pe(new $O(n,e));class HO extends Oe{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const Ys=Ye(HO).setParameterLength(1);let yu,_u;class Jt extends Oe{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===Jt.DPR?"float":this.scope===Jt.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=ot.NONE;return(this.scope===Jt.SIZE||this.scope===Jt.VIEWPORT||this.scope===Jt.DPR)&&(e=ot.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===Jt.VIEWPORT?t!==null?_u.copy(t.viewport):(e.getViewport(_u),_u.multiplyScalar(e.getPixelRatio())):this.scope===Jt.DPR?this._output.value=e.getPixelRatio():t!==null?(yu.width=t.width,yu.height=t.height):e.getDrawingBufferSize(yu)}setup(){const e=this.scope;let t=null;return e===Jt.SIZE?t=Ue(yu||(yu=new ht)):e===Jt.VIEWPORT?t=Ue(_u||(_u=new Ft)):e===Jt.DPR?t=Ue(1):t=ge(VA.div(Ra)),this._output=t,t}generate(e){if(this.scope===Jt.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const r=e.getNodeProperties(Ra).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${r}.y - ${t}.y )`}return t}return super.generate(e)}}Jt.COORDINATE="coordinate";Jt.VIEWPORT="viewport";Jt.SIZE="size";Jt.UV="uv";Jt.DPR="dpr";const b8=Me(Jt,Jt.DPR),ks=Me(Jt,Jt.UV),Ra=Me(Jt,Jt.SIZE),VA=Me(Jt,Jt.COORDINATE),O1=Me(Jt,Jt.VIEWPORT),F1=O1.zw,x8=VA.sub(O1.xy),WO=x8.div(F1),QO=ie(()=>Ra,"vec2").once()(),Oo=Ue(0,"uint").setName("u_cameraIndex").setGroup(tf("cameraIndex")).toVarying("v_cameraIndex"),go=Ue("float").setName("cameraNear").setGroup(qe).onRenderUpdate(({camera:n})=>n.near),yo=Ue("float").setName("cameraFar").setGroup(qe).onRenderUpdate(({camera:n})=>n.far),Zl=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.projectionMatrix);e=cr(t).setGroup(qe).setName("cameraProjectionMatrices").element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraProjectionMatrix")}else e=Ue("mat4").setName("cameraProjectionMatrix").setGroup(qe).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),XO=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.projectionMatrixInverse);e=cr(t).setGroup(qe).setName("cameraProjectionMatricesInverse").element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraProjectionMatrixInverse")}else e=Ue("mat4").setName("cameraProjectionMatrixInverse").setGroup(qe).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse);return e}).once()(),wi=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.matrixWorldInverse);e=cr(t).setGroup(qe).setName("cameraViewMatrices").element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraViewMatrix")}else e=Ue("mat4").setName("cameraViewMatrix").setGroup(qe).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),YO=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.matrixWorld);e=cr(t).setGroup(qe).setName("cameraWorldMatrices").element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraWorldMatrix")}else e=Ue("mat4").setName("cameraWorldMatrix").setGroup(qe).onRenderUpdate(({camera:t})=>t.matrixWorld);return e}).once()(),KO=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.normalMatrix);e=cr(t).setGroup(qe).setName("cameraNormalMatrices").element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraNormalMatrix")}else e=Ue("mat3").setName("cameraNormalMatrix").setGroup(qe).onRenderUpdate(({camera:t})=>t.normalMatrix);return e}).once()(),T8=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(let i=0,s=n.cameras.length;i<s;i++)t.push(new we);e=cr(t).setGroup(qe).setName("cameraPositions").onRenderUpdate(({camera:i},s)=>{const o=i.cameras,a=s.array;for(let c=0,f=o.length;c<f;c++)a[c].setFromMatrixPosition(o[c].matrixWorld)}).element(n.isMultiViewCamera?Ys("gl_ViewID_OVR"):Oo).toConst("cameraPosition")}else e=Ue(new we).setName("cameraPosition").setGroup(qe).onRenderUpdate(({camera:t},r)=>r.value.setFromMatrixPosition(t.matrixWorld));return e}).once()(),ZO=ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const i of n.cameras)t.push(i.viewport);e=cr(t,"vec4").setGroup(qe).setName("cameraViewports").element(Oo).toConst("cameraViewport")}else e=Ge(0,0,Ra.x,Ra.y).toConst("cameraViewport");return e}).once()(),Ev=new Bg;class xt extends Oe{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=ot.OBJECT,this.uniformNode=new IA(null)}getNodeType(){const e=this.scope;if(e===xt.WORLD_MATRIX)return"mat4";if(e===xt.POSITION||e===xt.VIEW_POSITION||e===xt.DIRECTION||e===xt.SCALE)return"vec3";if(e===xt.RADIUS)return"float"}update(e){const t=this.object3d,r=this.uniformNode,i=this.scope;if(i===xt.WORLD_MATRIX)r.value=t.matrixWorld;else if(i===xt.POSITION)r.value=r.value||new we,r.value.setFromMatrixPosition(t.matrixWorld);else if(i===xt.SCALE)r.value=r.value||new we,r.value.setFromMatrixScale(t.matrixWorld);else if(i===xt.DIRECTION)r.value=r.value||new we,t.getWorldDirection(r.value);else if(i===xt.VIEW_POSITION){const s=e.camera;r.value=r.value||new we,r.value.setFromMatrixPosition(t.matrixWorld),r.value.applyMatrix4(s.matrixWorldInverse)}else if(i===xt.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),Ev.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),r.value=Ev.radius}}generate(e){const t=this.scope;return t===xt.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===xt.POSITION||t===xt.VIEW_POSITION||t===xt.DIRECTION||t===xt.SCALE?this.uniformNode.nodeType="vec3":t===xt.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}xt.WORLD_MATRIX="worldMatrix";xt.POSITION="position";xt.SCALE="scale";xt.VIEW_POSITION="viewPosition";xt.DIRECTION="direction";xt.RADIUS="radius";const JO=Ye(xt,xt.DIRECTION).setParameterLength(1),eF=Ye(xt,xt.WORLD_MATRIX).setParameterLength(1),w8=Ye(xt,xt.POSITION).setParameterLength(1),tF=Ye(xt,xt.SCALE).setParameterLength(1),nF=Ye(xt,xt.VIEW_POSITION).setParameterLength(1),rF=Ye(xt,xt.RADIUS).setParameterLength(1);class vi extends xt{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const iF=Me(vi,vi.DIRECTION),ci=Me(vi,vi.WORLD_MATRIX),sF=Me(vi,vi.POSITION),oF=Me(vi,vi.SCALE),aF=Me(vi,vi.VIEW_POSITION),lF=Me(vi,vi.RADIUS),S8=Ue(new DA).onObjectUpdate(({object:n},e)=>e.value.getNormalMatrix(n.matrixWorld)),uF=Ue(new gn).onObjectUpdate(({object:n},e)=>e.value.copy(n.matrixWorld).invert()),Pa=ie(n=>n.renderer.overrideNodes.modelViewMatrix||E8).once()().toVar("modelViewMatrix"),E8=wi.mul(ci),Lm=ie(n=>(n.context.isHighPrecisionModelViewMatrix=!0,Ue("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),Om=ie(n=>{const e=n.context.isHighPrecisionModelViewMatrix;return Ue("mat3").onObjectUpdate(({object:t,camera:r})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),zA=Ws("position","vec3"),wn=zA.toVarying("positionLocal"),Eh=zA.toVarying("positionPrevious"),cs=ie(n=>ci.mul(wn).xyz.toVarying(n.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),I1=ie(()=>wn.transformDirection(ci).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),Sn=ie(n=>n.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),sn=Sn.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class AF extends Oe{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{material:t}=e;return t.side===hr?"false":e.getFrontFacing()}}const R8=Me(AF),k1=z(R8).mul(2).sub(1),Jl=ie(([n],{material:e})=>{const t=e.side;return t===hr?n=n.mul(-1):t===fi&&(n=n.mul(k1)),n}),uf=Ws("normal","vec3"),Ir=ie(n=>n.geometry.hasAttribute("normal")===!1?re(0,1,0):uf,"vec3").once()().toVar("normalLocal"),N8=Sn.dFdx().cross(Sn.dFdy()).normalize().toVar("normalFlat"),zl=ie(n=>{let e;return n.material.flatShading===!0?e=N8:e=q1(Ir).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),C8=ie(n=>{let e=zl.transformDirection(wi);return n.material.flatShading!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Gt=ie(({subBuildFn:n,material:e,context:t})=>{let r;return n==="NORMAL"||n==="VERTEX"?(r=zl,e.flatShading!==!0&&(r=Jl(r))):r=t.setupNormal().context({getUV:null}),r},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),Fo=Gt.transformDirection(wi).toVar("normalWorld"),pa=ie(({subBuildFn:n,context:e})=>{let t;return n==="NORMAL"||n==="VERTEX"?t=Gt:t=e.setupClearcoatNormal().context({getUV:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),M8=ie(([n,e=ci])=>{const t=pr(e),r=n.div(re(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(r).xyz}),q1=ie(([n],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(n);const r=S8.mul(n);return wi.transformDirection(r)}),cF=ie(()=>Gt).once(["NORMAL","VERTEX"])(),hF=ie(()=>Fo).once(["NORMAL","VERTEX"])(),fF=ie(()=>pa).once(["NORMAL","VERTEX"])(),Rv=new lA,Ed=new gn,P8=Ue(0).onReference(({material:n})=>n).onObjectUpdate(({material:n})=>n.refractionRatio),T0=Ue(1).onReference(({material:n})=>n).onObjectUpdate(function({material:n,scene:e}){return n.envMap?n.envMapIntensity:e.environmentIntensity}),U1=Ue(new gn).onReference(function(n){return n.material}).onObjectUpdate(function({material:n,scene:e}){const t=e.environment!==null&&n.envMap===null?e.environmentRotation:n.envMapRotation;return t?(Rv.copy(t),Ed.makeRotationFromEuler(Rv)):Ed.identity(),Ed}),B8=sn.negate().reflect(Gt),D8=sn.negate().refract(Gt,P8),L8=B8.transformDirection(wi).toVar("reflectVector"),O8=D8.transformDirection(wi).toVar("reflectVector"),F8=new vg;class dF extends ms{static get type(){return"CubeTextureNode"}constructor(e,t=null,r=null,i=null){super(e,t,r,i),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===L0?L8:e.mapping===O0?O8:re(0,0,0)}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return(e.renderer.coordinateSystem===Yl||!r.isRenderTargetTexture)&&(t=re(t.x.negate(),t.yz)),U1.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const G1=Ye(dF).setParameterLength(1,4).setName("cubeTexture"),jl=(n=F8,e=null,t=null,r=null)=>{let i;return n&&n.isCubeTextureNode===!0?(i=pe(n.clone()),i.referenceNode=n,e!==null&&(i.uvNode=pe(e)),t!==null&&(i.levelNode=pe(t)),r!==null&&(i.biasNode=pe(r))):i=G1(n,e,t,r),i},pF=(n=F8)=>G1(n);class mF extends Ma{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,r,i)}}class Af extends Oe{static get type(){return"ReferenceNode"}constructor(e,t,r=null,i=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=i,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.name=null,this.updateType=ot.OBJECT}element(e){return pe(new mF(this,pe(e)))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return this.setName(e)}setNodeType(e){let t=null;this.count!==null?t=GA(null,e,this.count):Array.isArray(this.getValueFromReference())?t=cr(null,e):e==="texture"?t=_t(null):e==="cubeTexture"?t=jl(null):t=Ue(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.setName(this.name),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let i=1;i<t.length;i++)r=r[t[i]];return r}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Xt=(n,e,t)=>pe(new Af(n,e,t)),Fm=(n,e,t,r)=>pe(new Af(n,e,r,t));class gF extends Af{static get type(){return"MaterialReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.material=r,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Bs=(n,e,t=null)=>pe(new gF(n,e,t)),I8=Wt(),yF=Sn.dFdx(),_F=Sn.dFdy(),k8=I8.dFdx(),q8=I8.dFdy(),U8=Gt,G8=_F.cross(U8),V8=U8.cross(yF),Im=G8.mul(k8.x).add(V8.mul(q8.x)),km=G8.mul(k8.y).add(V8.mul(q8.y)),Nv=Im.dot(Im).max(km.dot(km)),z8=Nv.equal(0).select(0,Nv.inverseSqrt()),vF=Im.mul(z8).toVar("tangentViewFrame"),bF=km.mul(z8).toVar("bitangentViewFrame"),cf=ie(n=>(n.geometry.hasAttribute("tangent")===!1&&n.geometry.computeTangents(),Ws("tangent","vec4")))(),jA=cf.xyz.toVar("tangentLocal"),hf=ie(({subBuildFn:n,geometry:e,material:t})=>{let r;return n==="VERTEX"||e.hasAttribute("tangent")?r=Pa.mul(Ge(jA,0)).xyz.toVarying("v_tangentView").normalize():r=vF,t.flatShading!==!0&&(r=Jl(r)),r},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),j8=hf.transformDirection(wi).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),ff=ie(([n,e],{subBuildFn:t,material:r})=>{let i=n.mul(cf.w).xyz;return t==="NORMAL"&&r.flatShading!==!0&&(i=i.toVarying(e)),i}).once(["NORMAL"]),xF=ff(uf.cross(cf),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),TF=ff(Ir.cross(jA),"v_bitangentLocal").normalize().toVar("bitangentLocal"),$8=ie(({subBuildFn:n,geometry:e,material:t})=>{let r;return n==="VERTEX"||e.hasAttribute("tangent")?r=ff(Gt.cross(hf),"v_bitangentView").normalize():r=bF,t.flatShading!==!0&&(r=Jl(r)),r},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),wF=ff(Fo.cross(j8),"v_bitangentWorld").normalize().toVar("bitangentWorld"),ma=pr(hf,$8,Gt).toVar("TBNViewMatrix"),H8=sn.mul(ma),SF=(n,e)=>n.sub(H8.mul(e)),W8=ie(()=>{let n=ba.cross(sn);return n=n.cross(ba).normalize(),n=Nt(n,Gt,po.mul(ns.oneMinus()).oneMinus().pow2().pow2()).normalize(),n}).once()();class EF extends Rn{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Gy}setup({material:e}){const{normalMapType:t,scaleNode:r}=this;let i=this.node.mul(2).sub(1);if(r!==null){let o=r;e.flatShading===!0&&(o=Jl(o)),i=re(i.xy.mul(o),i.z)}let s=null;return t===ZR?s=q1(i):t===Gy?s=ma.mul(i).normalize():s=Gt,s}}const qm=Ye(EF).setParameterLength(1,2),RF=ie(({textureNode:n,bumpScale:e})=>{const t=i=>n.cache().context({getUV:s=>i(s.uvNode||Wt()),forceUVContext:!0}),r=z(t(i=>i));return ge(z(t(i=>i.add(i.dFdx()))).sub(r),z(t(i=>i.add(i.dFdy()))).sub(r)).mul(e)}),NF=ie(n=>{const{surf_pos:e,surf_norm:t,dHdxy:r}=n,i=e.dFdx().normalize(),s=e.dFdy().normalize(),o=t,a=s.cross(o),c=o.cross(i),f=i.dot(a).mul(k1),p=f.sign().mul(r.x.mul(a).add(r.y.mul(c)));return f.abs().mul(t).sub(p).normalize()});class CF extends Rn{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=RF({textureNode:this.textureNode,bumpScale:e});return NF({surf_pos:Sn,surf_norm:Gt,dHdxy:t})}}const V1=Ye(CF).setParameterLength(1,2),Cv=new Map;class me extends Oe{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let r=Cv.get(e);return r===void 0&&(r=Bs(e,t),Cv.set(e,r)),r}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,r=this.scope;let i=null;if(r===me.COLOR){const s=t.color!==void 0?this.getColor(r):re();t.map&&t.map.isTexture===!0?i=s.mul(this.getTexture("map")):i=s}else if(r===me.OPACITY){const s=this.getFloat(r);t.alphaMap&&t.alphaMap.isTexture===!0?i=s.mul(this.getTexture("alpha")):i=s}else if(r===me.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?i=this.getTexture("specular").r:i=z(1);else if(r===me.SPECULAR_INTENSITY){const s=this.getFloat(r);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?i=s.mul(this.getTexture(r).a):i=s}else if(r===me.SPECULAR_COLOR){const s=this.getColor(r);t.specularColorMap&&t.specularColorMap.isTexture===!0?i=s.mul(this.getTexture(r).rgb):i=s}else if(r===me.ROUGHNESS){const s=this.getFloat(r);t.roughnessMap&&t.roughnessMap.isTexture===!0?i=s.mul(this.getTexture(r).g):i=s}else if(r===me.METALNESS){const s=this.getFloat(r);t.metalnessMap&&t.metalnessMap.isTexture===!0?i=s.mul(this.getTexture(r).b):i=s}else if(r===me.EMISSIVE){const s=this.getFloat("emissiveIntensity"),o=this.getColor(r).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?i=o.mul(this.getTexture(r)):i=o}else if(r===me.NORMAL)t.normalMap?(i=qm(this.getTexture("normal"),this.getCache("normalScale","vec2")),i.normalMapType=t.normalMapType):t.bumpMap?i=V1(this.getTexture("bump").r,this.getFloat("bumpScale")):i=Gt;else if(r===me.CLEARCOAT){const s=this.getFloat(r);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?i=s.mul(this.getTexture(r).r):i=s}else if(r===me.CLEARCOAT_ROUGHNESS){const s=this.getFloat(r);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?i=s.mul(this.getTexture(r).r):i=s}else if(r===me.CLEARCOAT_NORMAL)t.clearcoatNormalMap?i=qm(this.getTexture(r),this.getCache(r+"Scale","vec2")):i=Gt;else if(r===me.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?i=s.mul(this.getTexture("sheenColor").rgb):i=s}else if(r===me.SHEEN_ROUGHNESS){const s=this.getFloat(r);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?i=s.mul(this.getTexture(r).a):i=s,i=i.clamp(.07,1)}else if(r===me.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(r);i=Zh(ul.x,ul.y,ul.y.negate(),ul.x).mul(s.rg.mul(2).sub(ge(1)).normalize().mul(s.b))}else i=ul;else if(r===me.IRIDESCENCE_THICKNESS){const s=Xt("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=Xt("0","float",t.iridescenceThicknessRange);i=s.sub(o).mul(this.getTexture(r).g).add(o)}else i=s}else if(r===me.TRANSMISSION){const s=this.getFloat(r);t.transmissionMap?i=s.mul(this.getTexture(r).r):i=s}else if(r===me.THICKNESS){const s=this.getFloat(r);t.thicknessMap?i=s.mul(this.getTexture(r).g):i=s}else if(r===me.IOR)i=this.getFloat(r);else if(r===me.LIGHT_MAP)i=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===me.AO)i=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(r===me.LINE_DASH_OFFSET)i=t.dashOffset?this.getFloat(r):z(0);else{const s=this.getNodeType(e);i=this.getCache(r,s)}return i}}me.ALPHA_TEST="alphaTest";me.COLOR="color";me.OPACITY="opacity";me.SHININESS="shininess";me.SPECULAR="specular";me.SPECULAR_STRENGTH="specularStrength";me.SPECULAR_INTENSITY="specularIntensity";me.SPECULAR_COLOR="specularColor";me.REFLECTIVITY="reflectivity";me.ROUGHNESS="roughness";me.METALNESS="metalness";me.NORMAL="normal";me.CLEARCOAT="clearcoat";me.CLEARCOAT_ROUGHNESS="clearcoatRoughness";me.CLEARCOAT_NORMAL="clearcoatNormal";me.EMISSIVE="emissive";me.ROTATION="rotation";me.SHEEN="sheen";me.SHEEN_ROUGHNESS="sheenRoughness";me.ANISOTROPY="anisotropy";me.IRIDESCENCE="iridescence";me.IRIDESCENCE_IOR="iridescenceIOR";me.IRIDESCENCE_THICKNESS="iridescenceThickness";me.IOR="ior";me.TRANSMISSION="transmission";me.THICKNESS="thickness";me.ATTENUATION_DISTANCE="attenuationDistance";me.ATTENUATION_COLOR="attenuationColor";me.LINE_SCALE="scale";me.LINE_DASH_SIZE="dashSize";me.LINE_GAP_SIZE="gapSize";me.LINE_WIDTH="linewidth";me.LINE_DASH_OFFSET="dashOffset";me.POINT_SIZE="size";me.DISPERSION="dispersion";me.LIGHT_MAP="light";me.AO="ao";const Q8=Me(me,me.ALPHA_TEST),X8=Me(me,me.COLOR),Y8=Me(me,me.SHININESS),K8=Me(me,me.EMISSIVE),z1=Me(me,me.OPACITY),Z8=Me(me,me.SPECULAR),Um=Me(me,me.SPECULAR_INTENSITY),J8=Me(me,me.SPECULAR_COLOR),nA=Me(me,me.SPECULAR_STRENGTH),w0=Me(me,me.REFLECTIVITY),ew=Me(me,me.ROUGHNESS),tw=Me(me,me.METALNESS),nw=Me(me,me.NORMAL),rw=Me(me,me.CLEARCOAT),iw=Me(me,me.CLEARCOAT_ROUGHNESS),sw=Me(me,me.CLEARCOAT_NORMAL),ow=Me(me,me.ROTATION),aw=Me(me,me.SHEEN),lw=Me(me,me.SHEEN_ROUGHNESS),uw=Me(me,me.ANISOTROPY),Aw=Me(me,me.IRIDESCENCE),cw=Me(me,me.IRIDESCENCE_IOR),hw=Me(me,me.IRIDESCENCE_THICKNESS),fw=Me(me,me.TRANSMISSION),dw=Me(me,me.THICKNESS),pw=Me(me,me.IOR),mw=Me(me,me.ATTENUATION_DISTANCE),gw=Me(me,me.ATTENUATION_COLOR),yw=Me(me,me.LINE_SCALE),_w=Me(me,me.LINE_DASH_SIZE),vw=Me(me,me.LINE_GAP_SIZE),MF=Me(me,me.LINE_WIDTH),bw=Me(me,me.LINE_DASH_OFFSET),xw=Me(me,me.POINT_SIZE),Tw=Me(me,me.DISPERSION),j1=Me(me,me.LIGHT_MAP),ww=Me(me,me.AO),ul=Ue(new ht).onReference(function(n){return n.material}).onRenderUpdate(function({material:n}){this.value.set(n.anisotropy*Math.cos(n.anisotropyRotation),n.anisotropy*Math.sin(n.anisotropyRotation))}),$1=ie(n=>n.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class on extends Oe{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),r=this.scope;let i;if(r===on.VERTEX)i=e.getVertexIndex();else if(r===on.INSTANCE)i=e.getInstanceIndex();else if(r===on.DRAW)i=e.getDrawIndex();else if(r===on.INVOCATION_LOCAL)i=e.getInvocationLocalIndex();else if(r===on.INVOCATION_SUBGROUP)i=e.getInvocationSubgroupIndex();else if(r===on.SUBGROUP)i=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+r);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=i:s=xs(this).build(e,t),s}}on.VERTEX="vertex";on.INSTANCE="instance";on.SUBGROUP="subgroup";on.INVOCATION_LOCAL="invocationLocal";on.INVOCATION_SUBGROUP="invocationSubgroup";on.DRAW="draw";const Sw=Me(on,on.VERTEX),Ro=Me(on,on.INSTANCE),PF=Me(on,on.SUBGROUP),BF=Me(on,on.INVOCATION_SUBGROUP),DF=Me(on,on.INVOCATION_LOCAL),Ew=Me(on,on.DRAW);class Rw extends Oe{static get type(){return"InstanceNode"}constructor(e,t,r=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=r,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=ot.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{instanceMatrix:t,instanceColor:r}=this,{count:i}=t;let{instanceMatrixNode:s,instanceColorNode:o}=this;if(s===null){if(i<=1e3)s=GA(t.array,"mat4",Math.max(i,1)).element(Ro);else{const c=new F0(t.array,16,1);this.buffer=c;const f=t.usage===hl?Dm:Sh,p=[f(c,"vec4",16,0),f(c,"vec4",16,4),f(c,"vec4",16,8),f(c,"vec4",16,12)];s=va(...p)}this.instanceMatrixNode=s}if(r&&o===null){const c=new xo(r.array,3),f=r.usage===hl?Dm:Sh;this.bufferColor=c,o=re(f(c,"vec3",3,0)),this.instanceColorNode=o}const a=s.mul(wn).xyz;if(wn.assign(a),e.hasGeometryAttribute("normal")){const c=M8(Ir,s);Ir.assign(c)}this.instanceColorNode!==null&&TA("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==hl&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==hl&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const LF=Ye(Rw).setParameterLength(2,3);class OF extends Rw{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:r,instanceColor:i}=e;super(t,r,i),this.instancedMesh=e}}const Nw=Ye(OF).setParameterLength(1);class FF extends Oe{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=Ro:this.batchingIdNode=Ew);const r=ie(([T])=>{const S=X(Eo(bn(this.batchMesh._indirectTexture),0).x),R=X(T).mod(S),C=X(T).div(S);return bn(this.batchMesh._indirectTexture,Un(R,C)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(X(this.batchingIdNode)),i=this.batchMesh._matricesTexture,s=X(Eo(bn(i),0).x),o=z(r).mul(4).toInt().toVar(),a=o.mod(s),c=o.div(s),f=va(bn(i,Un(a,c)),bn(i,Un(a.add(1),c)),bn(i,Un(a.add(2),c)),bn(i,Un(a.add(3),c))),p=this.batchMesh._colorsTexture;if(p!==null){const S=ie(([R])=>{const C=X(Eo(bn(p),0).x),B=R,D=B.mod(C),F=B.div(C);return bn(p,Un(D,F)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(r);TA("vec3","vBatchColor").assign(S)}const g=pr(f);wn.assign(f.mul(wn));const v=Ir.div(re(g[0].dot(g[0]),g[1].dot(g[1]),g[2].dot(g[2]))),x=g.mul(v).xyz;Ir.assign(x),e.hasGeometryAttribute("tangent")&&jA.mulAssign(g)}}const Cw=Ye(FF).setParameterLength(1);class IF extends Ma{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const r=this.storageBufferNode.structTypeNode;return r?r.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let r;const i=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&i!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?r=e.generatePBO(this):r=this.node.build(e):r=super.generate(e),i!==!0){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}const kF=Ye(IF).setParameterLength(2);class qF extends L1{static get type(){return"StorageBufferNode"}constructor(e,t=null,r=0){let i,s=null;t&&t.isStruct?(i="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(r=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(i=B4(e.itemSize),r=e.count):i=t,super(e,i,r),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=nr.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return kF(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(nr.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=UA(this.value),this._varying=xs(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:r}=this.getAttributeData(),i=r.build(e);return e.registerTransform(i,t),i}}const xa=(n,e=null,t=0)=>pe(new qF(n,e,t)),UF=(n,e,t)=>xa(n,e,t).setPBO(!0),Mv=new WeakMap;class Mw extends Oe{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=ot.OBJECT,this.skinIndexNode=Ws("skinIndex","uvec4"),this.skinWeightNode=Ws("skinWeight","vec4"),this.bindMatrixNode=Xt("bindMatrix","mat4"),this.bindMatrixInverseNode=Xt("bindMatrixInverse","mat4"),this.boneMatricesNode=Fm("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=wn,this.toPositionNode=wn,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:r,skinWeightNode:i,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(r.x),c=e.element(r.y),f=e.element(r.z),p=e.element(r.w),g=s.mul(t),v=Pn(a.mul(i.x).mul(g),c.mul(i.y).mul(g),f.mul(i.z).mul(g),p.mul(i.w).mul(g));return o.mul(v).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Ir){const{skinIndexNode:r,skinWeightNode:i,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(r.x),c=e.element(r.y),f=e.element(r.z),p=e.element(r.w);let g=Pn(i.x.mul(a),i.y.mul(c),i.z.mul(f),i.w.mul(p));return g=o.mul(g).mul(s),g.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Fm("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Eh)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||L4(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&Eh.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const r=this.getSkinnedNormal();Ir.assign(r),e.hasGeometryAttribute("tangent")&&jA.assign(r)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;Mv.get(t)!==e.frameId&&(Mv.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const Pw=n=>pe(new Mw(n)),GF=(n,e=null)=>{const t=new Mw(n);return t.positionNode=xa(new xo(n.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(Ro).toVar(),t.skinIndexNode=xa(new xo(new Uint32Array(n.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(Ro).toVar(),t.skinWeightNode=xa(new xo(n.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(Ro).toVar(),t.bindMatrixNode=Ue(n.bindMatrix,"mat4"),t.bindMatrixInverseNode=Ue(n.bindMatrixInverse,"mat4"),t.boneMatricesNode=GA(n.skeleton.boneMatrices,"mat4",n.skeleton.bones.length),t.toPositionNode=e,pe(t)};class VF extends Oe{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const r={};for(let o=0,a=this.params.length-1;o<a;o++){const c=this.params[o],f=c.isNode!==!0&&c.name||this.getVarName(o),p=c.isNode!==!0&&c.type||"int";r[f]=Hs(f,p)}const i=e.addStack();t.returnsNode=this.params[this.params.length-1](r,e),t.stackNode=i;const s=this.params[0];return s.isNode!==!0&&typeof s.update=="function"&&(t.updateNode=ie(this.params[0].update)(r)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),r=this.params,i=t.stackNode;for(let a=0,c=r.length-1;a<c;a++){const f=r[a];let p=!1,g=null,v=null,x=null,T=null,S=null,R=null;f.isNode?f.getNodeType(e)==="bool"?(p=!0,T="bool",v=f.build(e,T)):(T="int",x=this.getVarName(a),g="0",v=f.build(e,T),S="<"):(T=f.type||"int",x=f.name||this.getVarName(a),g=f.start,v=f.end,S=f.condition,R=f.update,typeof g=="number"?g=e.generateConst(T,g):g&&g.isNode&&(g=g.build(e,T)),typeof v=="number"?v=e.generateConst(T,v):v&&v.isNode&&(v=v.build(e,T)),g!==void 0&&v===void 0?(g=g+" - 1",v="0",S=">="):v!==void 0&&g===void 0&&(g="0",S="<"),S===void 0&&(Number(g)>Number(v)?S=">=":S="<"));let C;if(p)C=`while ( ${v} )`;else{const B={start:g,end:v},D=B.start,F=B.end;let I;const q=()=>S.includes("<")?"+=":"-=";if(R!=null)switch(typeof R){case"function":I=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":I=x+" "+q()+" "+e.generateConst(T,R);break;case"string":I=x+" "+R;break;default:R.isNode?I=x+" "+q()+" "+R.build(e):I="break /* invalid update */"}else T==="int"||T==="uint"?R=S.includes("<")?"++":"--":R=q()+" 1.",I=x+" "+R;const k=e.getVar(T,x)+" = "+D,G=x+" "+S+" "+F;C=`for ( ${k}; ${G}; ${I} )`}e.addFlowCode((a===0?`
`:"")+e.tab+C+` {

`).addFlowTab()}const s=i.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,c=this.params.length-1;a<c;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const Vt=(...n)=>pe(new VF(_a(n,"int"))).toStack(),zF=()=>Hs("continue").toStack(),Bw=()=>Hs("break").toStack(),Rd=new WeakMap,Gr=new Ft,Pv=ie(({bufferMap:n,influence:e,stride:t,width:r,depth:i,offset:s})=>{const o=X(Sw).mul(t).add(s),a=o.div(r),c=o.sub(a.mul(r));return bn(n,Un(c,a)).depth(i).xyz.mul(e)});function jF(n){const e=n.morphAttributes.position!==void 0,t=n.morphAttributes.normal!==void 0,r=n.morphAttributes.color!==void 0,i=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,s=i!==void 0?i.length:0;let o=Rd.get(n);if(o===void 0||o.count!==s){let C=function(){S.dispose(),Rd.delete(n),n.removeEventListener("dispose",C)};o!==void 0&&o.texture.dispose();const a=n.morphAttributes.position||[],c=n.morphAttributes.normal||[],f=n.morphAttributes.color||[];let p=0;e===!0&&(p=1),t===!0&&(p=2),r===!0&&(p=3);let g=n.attributes.position.count*p,v=1;const x=4096;g>x&&(v=Math.ceil(g/x),g=x);const T=new Float32Array(g*v*4*s),S=new JR(T,g,v,s);S.type=ui,S.needsUpdate=!0;const R=p*4;for(let B=0;B<s;B++){const D=a[B],F=c[B],I=f[B],q=g*v*4*B;for(let k=0;k<D.count;k++){const G=k*R;e===!0&&(Gr.fromBufferAttribute(D,k),T[q+G+0]=Gr.x,T[q+G+1]=Gr.y,T[q+G+2]=Gr.z,T[q+G+3]=0),t===!0&&(Gr.fromBufferAttribute(F,k),T[q+G+4]=Gr.x,T[q+G+5]=Gr.y,T[q+G+6]=Gr.z,T[q+G+7]=0),r===!0&&(Gr.fromBufferAttribute(I,k),T[q+G+8]=Gr.x,T[q+G+9]=Gr.y,T[q+G+10]=Gr.z,T[q+G+11]=I.itemSize===4?Gr.w:1)}}o={count:s,texture:S,stride:p,size:new ht(g,v)},Rd.set(n,o),n.addEventListener("dispose",C)}return o}class $F extends Oe{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Ue(1),this.updateType=ot.OBJECT}setup(e){const{geometry:t}=e,r=t.morphAttributes.position!==void 0,i=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=s!==void 0?s.length:0,{texture:a,stride:c,size:f}=jF(t);r===!0&&wn.mulAssign(this.morphBaseInfluence),i===!0&&Ir.mulAssign(this.morphBaseInfluence);const p=X(f.width);Vt(o,({i:g})=>{const v=z(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?v.assign(bn(this.mesh.morphTexture,Un(X(g).add(1),X(Ro))).r):v.assign(Xt("morphTargetInfluences","float").element(g).toVar()),We(v.notEqual(0),()=>{r===!0&&wn.addAssign(Pv({bufferMap:a,influence:v,stride:c,width:p,depth:g,offset:X(0)})),i===!0&&Ir.addAssign(Pv({bufferMap:a,influence:v,stride:c,width:p,depth:g,offset:X(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,r)=>t+r,0)}}const Dw=Ye($F).setParameterLength(1);class eu extends Oe{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class HF extends eu{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class WF extends KT{static get type(){return"LightingContextNode"}constructor(e,t=null,r=null,i=null){super(e),this.lightingModel=t,this.backdropNode=r,this.backdropAlphaNode=i,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,r=re().toVar("directDiffuse"),i=re().toVar("directSpecular"),s=re().toVar("indirectDiffuse"),o=re().toVar("indirectSpecular"),a={directDiffuse:r,directSpecular:i,indirectDiffuse:s,indirectSpecular:o};return{radiance:re().toVar("radiance"),irradiance:re().toVar("irradiance"),iblIrradiance:re().toVar("iblIrradiance"),ambientOcclusion:z(1).toVar("ambientOcclusion"),reflectedLight:a,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const Lw=Ye(WF);class QF extends eu{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const Ya=new ht;class df extends ms{static get type(){return"ViewportTextureNode"}constructor(e=ks,t=null,r=null){let i=null;r===null?(i=new rx,i.minFilter=ga,r=i):i=r,super(r,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=i,this.isOutputTextureNode=!0,this.updateBeforeType=ot.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,r;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,r=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,r=this._cacheTextures),e===null)return t;if(r.has(e)===!1){const i=t.clone();r.set(e,i)}return r.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,r=t.getRenderTarget();r===null?t.getDrawingBufferSize(Ya):Ya.set(r.width,r.height);const i=this.getTextureForReference(r);(i.image.width!==Ya.width||i.image.height!==Ya.height)&&(i.image.width=Ya.width,i.image.height=Ya.height,i.needsUpdate=!0);const s=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(i),i.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const XF=Ye(df).setParameterLength(0,3),H1=Ye(df,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let wc=null;class YF extends df{static get type(){return"ViewportDepthTextureNode"}constructor(e=ks,t=null){wc===null&&(wc=new qi),super(e,t,wc)}getTextureForReference(){return wc}}const W1=Ye(YF).setParameterLength(0,2);class Dr extends Oe{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Dr.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,r=this.valueNode;let i=null;if(t===Dr.DEPTH_BASE)r!==null&&(i=Fw().assign(r));else if(t===Dr.DEPTH)e.isPerspectiveCamera?i=Ow(Sn.z,go,yo):i=Cl(Sn.z,go,yo);else if(t===Dr.LINEAR_DEPTH)if(r!==null)if(e.isPerspectiveCamera){const s=Q1(r,go,yo);i=Cl(s,go,yo)}else i=r;else i=Cl(Sn.z,go,yo);return i}}Dr.DEPTH_BASE="depthBase";Dr.DEPTH="depth";Dr.LINEAR_DEPTH="linearDepth";const Cl=(n,e,t)=>n.add(e).div(e.sub(t)),KF=(n,e,t)=>e.sub(t).mul(n).sub(e),Ow=(n,e,t)=>e.add(n).mul(t).div(t.sub(e).mul(n)),Q1=(n,e,t)=>e.mul(t).div(t.sub(e).mul(n).sub(t)),X1=(n,e,t)=>{e=e.max(1e-6).toVar();const r=ls(n.negate().div(e)),i=ls(t.div(e));return r.div(i)},ZF=(n,e,t)=>{const r=n.mul(nf(t.div(e)));return z(Math.E).pow(r).mul(e).negate()},Fw=Ye(Dr,Dr.DEPTH_BASE),Y1=Me(Dr,Dr.DEPTH),Rh=Ye(Dr,Dr.LINEAR_DEPTH).setParameterLength(0,1),JF=Rh(W1());Y1.assign=n=>Fw(n);class pi extends Oe{static get type(){return"ClippingNode"}constructor(e=pi.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:r,unionPlanes:i}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===pi.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(r,i):this.scope===pi.HARDWARE?this.setupHardwareClipping(i,e):this.setupDefault(r,i)}setupAlphaToCoverage(e,t){return ie(()=>{const r=z().toVar("distanceToPlane"),i=z().toVar("distanceToGradient"),s=z(1).toVar("clipOpacity"),o=t.length;if(this.hardwareClipping===!1&&o>0){const c=cr(t).setGroup(qe);Vt(o,({i:f})=>{const p=c.element(f);r.assign(Sn.dot(p.xyz).negate().add(p.w)),i.assign(r.fwidth().div(2)),s.mulAssign(ps(i.negate(),i,r))})}const a=e.length;if(a>0){const c=cr(e).setGroup(qe),f=z(1).toVar("intersectionClipOpacity");Vt(a,({i:p})=>{const g=c.element(p);r.assign(Sn.dot(g.xyz).negate().add(g.w)),i.assign(r.fwidth().div(2)),f.mulAssign(ps(i.negate(),i,r).oneMinus())}),s.mulAssign(f.oneMinus())}Mt.a.mulAssign(s),Mt.a.equal(0).discard()})()}setupDefault(e,t){return ie(()=>{const r=t.length;if(this.hardwareClipping===!1&&r>0){const s=cr(t).setGroup(qe);Vt(r,({i:o})=>{const a=s.element(o);Sn.dot(a.xyz).greaterThan(a.w).discard()})}const i=e.length;if(i>0){const s=cr(e).setGroup(qe),o=yi(!0).toVar("clipped");Vt(i,({i:a})=>{const c=s.element(a);o.assign(Sn.dot(c.xyz).greaterThan(c.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,t){const r=e.length;return t.enableHardwareClipping(r),ie(()=>{const i=cr(e).setGroup(qe),s=Ys(t.getClipDistance());Vt(r,({i:o})=>{const a=i.element(o),c=Sn.dot(a.xyz).sub(a.w).negate();s.element(o).assign(c)})})()}}pi.ALPHA_TO_COVERAGE="alphaToCoverage";pi.DEFAULT="default";pi.HARDWARE="hardware";const eI=()=>pe(new pi),tI=()=>pe(new pi(pi.ALPHA_TO_COVERAGE)),nI=()=>pe(new pi(pi.HARDWARE)),rI=.05,Bv=ie(([n])=>Xs(Je(1e4,Qr(Je(17,n.x).add(Je(.1,n.y)))).mul(Pn(.1,tn(Qr(Je(13,n.y).add(n.x))))))),Dv=ie(([n])=>Bv(ge(Bv(n.xy),n.z))),iI=ie(([n])=>{const e=_n(As(_1(n.xyz)),As(v1(n.xyz))),t=z(1).div(z(rI).mul(e)).toVar("pixScale"),r=ge(Vl(us(ls(t))),Vl(rf(ls(t)))),i=ge(Dv(us(r.x.mul(n.xyz))),Dv(us(r.y.mul(n.xyz)))),s=Xs(ls(t)),o=Pn(Je(s.oneMinus(),i.x),Je(s,i.y)),a=Fr(s,s.oneMinus()),c=re(o.mul(o).div(Je(2,a).mul(vt(1,a))),o.sub(Je(.5,a)).div(vt(1,a)),vt(1,vt(1,o).mul(vt(1,o)).div(Je(2,a).mul(vt(1,a))))),f=o.lessThan(a.oneMinus()).select(o.lessThan(a).select(c.x,c.y),c.z);return _i(f,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class sI extends v8{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),r=e.hasGeometryAttribute(t);let i;return r===!0?i=super.generate(e):i=e.generateConst(this.nodeType,new Ft(1,1,1,1)),i}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const Iw=(n=0)=>pe(new sI(n)),kw=ie(([n,e])=>Fr(1,n.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),qw=ie(([n,e])=>Fr(n.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Uw=ie(([n,e])=>n.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Gw=ie(([n,e])=>Nt(n.mul(2).mul(e),n.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),of(.5,n))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),oI=ie(([n,e])=>{const t=e.a.add(n.a.mul(e.a.oneMinus()));return Ge(e.rgb.mul(e.a).add(n.rgb.mul(n.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),Vw=ie(([n])=>Ge(n.rgb.mul(n.a),n.a),{color:"vec4",return:"vec4"}),aI=ie(([n])=>(We(n.a.equal(0),()=>Ge(0)),Ge(n.rgb.div(n.a),n.a)),{color:"vec4",return:"vec4"}),lI=(...n)=>kw(n),uI=(...n)=>qw(n),AI=(...n)=>Uw(n),cI=(...n)=>Gw(n);class En extends Oy{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+P4(this)}build(e){this.setup(e)}setupObserver(e){return new FL(e)}setup(e){e.context.setupNormal=()=>Nl(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,r=t.getRenderTarget();e.addStack();const i=Nl(this.setupVertex(e),"VERTEX"),s=this.vertexNode||i;e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const a=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(r!==null?r.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const c=this.setupLighting(e);a!==null&&e.stack.add(a);const f=Ge(c,Mt.a).max(0);o=this.setupOutput(e,f),Rl.assign(o);const p=this.outputNode!==null;if(p&&(o=this.outputNode),r!==null){const g=t.getMRT(),v=this.mrtNode;g!==null?(p&&Rl.assign(o),o=g,v!==null&&(o=g.merge(v))):v!==null&&(o=v)}}else{let c=this.fragmentNode;c.isOutputStructNode!==!0&&(c=Ge(c)),o=this.setupOutput(e,c)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:r}=e.clippingContext;let i=null;if(t.length>0||r.length>0){const s=e.renderer.samples;this.alphaToCoverage&&s>1?i=tI():e.stack.add(eI())}return i}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(nI()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:r}=e;let i=this.depthNode;if(i===null){const s=t.getMRT();s&&s.has("depth")?i=s.get("depth"):t.logarithmicDepthBuffer===!0&&(r.isPerspectiveCamera?i=X1(Sn.z,go,yo):i=Cl(Sn.z,go,yo))}i!==null&&Y1.assign(i).toStack()}setupPositionView(){return Pa.mul(wn).xyz}setupModelViewProjection(){return Zl.mul(Sn)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),$1}setupPosition(e){const{object:t,geometry:r}=e;if((r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color)&&Dw(t).toStack(),t.isSkinnedMesh===!0&&Pw(t).toStack(),this.displacementMap){const i=Bs("displacementMap","texture"),s=Bs("displacementScale","float"),o=Bs("displacementBias","float");wn.addAssign(Ir.normalize().mul(i.x.mul(s).add(o)))}return t.isBatchedMesh&&Cw(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&Nw(t).toStack(),this.positionNode!==null&&wn.assign(Nl(this.positionNode,"POSITION","vec3")),wn}setupDiffuseColor({object:e,geometry:t}){this.maskNode!==null&&yi(this.maskNode).not().discard();let r=this.colorNode?Ge(this.colorNode):X8;this.vertexColors===!0&&t.hasAttribute("color")&&(r=r.mul(Iw())),e.instanceColor&&(r=TA("vec3","vInstanceColor").mul(r)),e.isBatchedMesh&&e._colorsTexture&&(r=TA("vec3","vBatchColor").mul(r)),Mt.assign(r);const i=this.opacityNode?z(this.opacityNode):z1;Mt.a.assign(Mt.a.mul(i));let s=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(s=this.alphaTestNode!==null?z(this.alphaTestNode):Q8,Mt.a.lessThanEqual(s).discard()),this.alphaHash===!0&&Mt.a.lessThan(iI(wn)).discard(),this.transparent===!1&&this.blending===Ls&&this.alphaToCoverage===!1?Mt.a.assign(1):s===null&&Mt.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return this.lights===!0?re(0):Mt.rgb}setupNormal(){return this.normalNode?re(this.normalNode):nw}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Bs("envMap","cubeTexture"):Bs("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new QF(j1)),t}setupLights(e){const t=[],r=this.setupEnvironment(e);r&&r.isLightingNode&&t.push(r);const i=this.setupLightMap(e);if(i&&i.isLightingNode&&t.push(i),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:ww;t.push(new HF(o))}let s=this.lightsNode||e.lightsNode;return t.length>0&&(s=e.renderer.lighting.createNode([...s.getLights(),...t])),s}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:r,backdropAlphaNode:i,emissiveNode:s}=this,a=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let c=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){const f=this.setupLightingModel(e)||null;c=Lw(a,f,r,i)}else r!==null&&(c=re(i!==null?Nt(c,r,i):r));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(Pm.assign(re(s||K8)),c=c.add(Pm)),c}setupFog(e,t){const r=e.fogNode;return r&&(Rl.assign(t),t=Ge(r.toVar())),t}setupPremultipliedAlpha(e,t){return Vw(t)}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),this.premultipliedAlpha===!0&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const r in e){const i=e[r];this[r]===void 0&&(this[r]=i,i&&i.clone&&(this[r]=i.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const r in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,r)===void 0&&t[r].get!==void 0&&Object.defineProperty(this.constructor.prototype,r,t[r])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const r=Oy.prototype.toJSON.call(this,e),i=yh(this);r.inputNodes={};for(const{property:o,childNode:a}of i)r.inputNodes[o]=a.toJSON(e).uuid;function s(o){const a=[];for(const c in o){const f=o[c];delete f.metadata,a.push(f)}return a}if(t){const o=s(e.textures),a=s(e.images),c=s(e.nodes);o.length>0&&(r.textures=o),a.length>0&&(r.images=a),c.length>0&&(r.nodes=c)}return r}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const hI=new Uh;class fI extends En{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(hI),this.setValues(e)}}const dI=new _R;class pI extends En{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(dI),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?z(this.offsetNode):bw,t=this.dashScaleNode?z(this.dashScaleNode):yw,r=this.dashSizeNode?z(this.dashSizeNode):_w,i=this.gapSizeNode?z(this.gapSizeNode):vw;v0.assign(r),Bm.assign(i);const s=xs(Ws("lineDistance").mul(t));(e?s.add(e):s).mod(v0.add(Bm)).greaterThan(v0).discard()}}let Sc=null;class mI extends df{static get type(){return"ViewportSharedTextureNode"}constructor(e=ks,t=null){Sc===null&&(Sc=new rx),super(e,t,Sc)}getTextureForReference(){return Sc}updateReference(){return this}}const gI=Ye(mI).setParameterLength(0,2),zw=n=>pe(n).mul(.5).add(.5),yI=n=>pe(n).mul(2).sub(1),_I=new gR;class vI extends En{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(_I),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?z(this.opacityNode):z1;Mt.assign(lf(Ge(zw(Gt),e),BA))}}const K1=ie(([n=I1])=>{const e=n.z.atan(n.x).mul(1/(Math.PI*2)).add(.5),t=n.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return ge(e,t)});class jw extends XR{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const r=t.minFilter,i=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new Pg(5,5,5),o=K1(I1),a=new En;a.colorNode=_t(t,o,0),a.side=hr,a.blending=Bl;const c=new hn(s,a),f=new Ih;f.add(c),t.minFilter===ga&&(t.minFilter=qs);const p=new YR(1,10,this),g=e.getMRT();return e.setMRT(null),p.update(e,f),e.setMRT(g),t.minFilter=r,t.currentGenerateMipmaps=i,c.geometry.dispose(),c.material.dispose(),this}}const rA=new WeakMap;class bI extends Rn{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=jl(null);const t=new vg;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=ot.RENDER}updateBefore(e){const{renderer:t,material:r}=e,i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const s=i.isTextureNode?i.value:r[i.property];if(s&&s.isTexture){const o=s.mapping;if(o===yg||o===_g){if(rA.has(s)){const a=rA.get(s);Lv(a,s.mapping),this._cubeTexture=a}else{const a=s.image;if(xI(a)){const c=new jw(a.height);c.fromEquirectangularTexture(t,s),Lv(c.texture,s.mapping),this._cubeTexture=c.texture,rA.set(s,c.texture),s.addEventListener("dispose",$w)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function xI(n){return n==null?!1:n.height>0}function $w(n){const e=n.target;e.removeEventListener("dispose",$w);const t=rA.get(e);t!==void 0&&(rA.delete(e),t.dispose())}function Lv(n,e){e===yg?n.mapping=L0:e===_g&&(n.mapping=O0)}const Hw=Ye(bI).setParameterLength(1);class Z1 extends eu{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=Hw(this.envNode)}}class TI extends eu{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=z(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class pf{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Ww extends pf{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,r=e.reflectedLight,i=e.irradianceLightMap;r.indirectDiffuse.assign(Ge(0)),i?r.indirectDiffuse.addAssign(i):r.indirectDiffuse.addAssign(Ge(1,1,1,0)),r.indirectDiffuse.mulAssign(t),r.indirectDiffuse.mulAssign(Mt.rgb)}finish(e){const{material:t,context:r}=e,i=r.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case WR:i.rgb.assign(Nt(i.rgb,i.rgb.mul(s.rgb),nA.mul(w0)));break;case HR:i.rgb.assign(Nt(i.rgb,s.rgb,nA.mul(w0)));break;case $R:i.rgb.addAssign(s.rgb.mul(nA.mul(w0)));break;default:break}}}const wI=new ts;class SI extends En{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(wI),this.setValues(e)}setupNormal(){return Jl(zl)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Z1(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new TI(j1)),t}setupOutgoingLight(){return Mt.rgb}setupLightingModel(){return new Ww}}const $l=ie(({f0:n,f90:e,dotVH:t})=>{const r=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return n.mul(r.oneMinus()).add(e.mul(r))}),Na=ie(n=>n.diffuseColor.mul(1/Math.PI)),EI=()=>z(.25),RI=ie(({dotNH:n})=>xh.mul(z(.5)).add(1).mul(z(1/Math.PI)).mul(n.pow(xh))),NI=ie(({lightDirection:n})=>{const e=n.add(sn).normalize(),t=Gt.dot(e).clamp(),r=sn.dot(e).clamp(),i=$l({f0:Cr,f90:1,dotVH:r}),s=EI(),o=RI({dotNH:t});return i.mul(s).mul(o)});class Qw extends Ww{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Gt.dot(e).clamp().mul(t);r.directDiffuse.addAssign(s.mul(Na({diffuseColor:Mt.rgb}))),this.specular===!0&&r.directSpecular.addAssign(s.mul(NI({lightDirection:e})).mul(nA))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(r.mul(Na({diffuseColor:Mt}))),i.indirectDiffuse.mulAssign(t)}}const CI=new Qs;class MI extends En{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(CI),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Z1(t):null}setupLightingModel(){return new Qw(!1)}}const PI=new Jb;class BI extends En{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(PI),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Z1(t):null}setupLightingModel(){return new Qw}setupVariants(){const e=(this.shininessNode?z(this.shininessNode):Y8).max(1e-4);xh.assign(e);const t=this.specularNode||Z8;Cr.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const Xw=ie(n=>{if(n.geometry.hasAttribute("normal")===!1)return z(0);const e=zl.dFdx().abs().max(zl.dFdy().abs());return e.x.max(e.y).max(e.z)}),J1=ie(n=>{const{roughness:e}=n,t=Xw();let r=e.max(.0525);return r=r.add(t),r=r.min(1),r}),Yw=ie(({alpha:n,dotNL:e,dotNV:t})=>{const r=n.pow2(),i=e.mul(r.add(r.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(r.add(r.oneMinus().mul(e.pow2())).sqrt());return Kr(.5,i.add(s).max(TT))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),DI=ie(({alphaT:n,alphaB:e,dotTV:t,dotBV:r,dotTL:i,dotBL:s,dotNV:o,dotNL:a})=>{const c=a.mul(re(n.mul(t),e.mul(r),o).length()),f=o.mul(re(n.mul(i),e.mul(s),a).length());return Kr(.5,c.add(f)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),Kw=ie(({alpha:n,dotNH:e})=>{const t=n.pow2(),r=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(r.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),LI=z(1/Math.PI),OI=ie(({alphaT:n,alphaB:e,dotNH:t,dotTH:r,dotBH:i})=>{const s=n.mul(e),o=re(e.mul(r),n.mul(i),s.mul(t)),a=o.dot(o),c=s.div(a);return LI.mul(s.mul(c.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),Gm=ie(({lightDirection:n,f0:e,f90:t,roughness:r,f:i,normalView:s=Gt,USE_IRIDESCENCE:o,USE_ANISOTROPY:a})=>{const c=r.pow2(),f=n.add(sn).normalize(),p=s.dot(n).clamp(),g=s.dot(sn).clamp(),v=s.dot(f).clamp(),x=sn.dot(f).clamp();let T=$l({f0:e,f90:t,dotVH:x}),S,R;if(bA(o)&&(T=ef.mix(T,i)),bA(a)){const C=Ju.dot(n),B=Ju.dot(sn),D=Ju.dot(f),F=ba.dot(n),I=ba.dot(sn),q=ba.dot(f);S=DI({alphaT:bh,alphaB:c,dotTV:B,dotBV:I,dotTL:C,dotBL:F,dotNV:g,dotNL:p}),R=OI({alphaT:bh,alphaB:c,dotNH:v,dotTH:D,dotBH:q})}else S=Yw({alpha:c,dotNL:p,dotNV:g}),R=Kw({alpha:c,dotNH:v});return T.mul(S).mul(R)}),e2=ie(({roughness:n,dotNV:e})=>{const t=Ge(-1,-.0275,-.572,.022),r=Ge(1,.0425,1.04,-.04),i=n.mul(t).add(r),s=i.x.mul(i.x).min(e.mul(-9.28).exp2()).mul(i.x).add(i.y);return ge(-1.04,1.04).mul(s).add(i.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),Zw=ie(n=>{const{dotNV:e,specularColor:t,specularF90:r,roughness:i}=n,s=e2({dotNV:e,roughness:i});return t.mul(s.x).add(r.mul(s.y))}),Jw=ie(({f:n,f90:e,dotVH:t})=>{const r=t.oneMinus().saturate(),i=r.mul(r),s=r.mul(i,i).clamp(0,.9999);return n.sub(re(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),FI=ie(({roughness:n,dotNH:e})=>{const t=n.pow2(),r=z(1).div(t),s=e.pow2().oneMinus().max(.0078125);return z(2).add(r).mul(s.pow(r.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),II=ie(({dotNV:n,dotNL:e})=>z(1).div(z(4).mul(e.add(n).sub(e.mul(n))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),kI=ie(({lightDirection:n})=>{const e=n.add(sn).normalize(),t=Gt.dot(n).clamp(),r=Gt.dot(sn).clamp(),i=Gt.dot(e).clamp(),s=FI({roughness:Jh,dotNH:i}),o=II({dotNV:r,dotNL:t});return da.mul(s).mul(o)}),qI=ie(({N:n,V:e,roughness:t})=>{const s=.0078125,o=n.dot(e).saturate(),a=ge(t,o.oneMinus().sqrt());return a.assign(a.mul(.984375).add(s)),a}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),UI=ie(({f:n})=>{const e=n.length();return _n(e.mul(e).add(n.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Ec=ie(({v1:n,v2:e})=>{const t=n.dot(e),r=t.abs().toVar(),i=r.mul(.0145206).add(.4965155).mul(r).add(.8543985).toVar(),s=r.add(4.1616724).mul(r).add(3.417594).toVar(),o=i.div(s),a=t.greaterThan(0).select(o,_n(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return n.cross(e).mul(a)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),Ov=ie(({N:n,V:e,P:t,mInv:r,p0:i,p1:s,p2:o,p3:a})=>{const c=s.sub(i).toVar(),f=a.sub(i).toVar(),p=c.cross(f),g=re().toVar();return We(p.dot(t.sub(i)).greaterThanEqual(0),()=>{const v=e.sub(n.mul(e.dot(n))).normalize(),x=n.cross(v).negate(),T=r.mul(pr(v,x,n).transpose()).toVar(),S=T.mul(i.sub(t)).normalize().toVar(),R=T.mul(s.sub(t)).normalize().toVar(),C=T.mul(o.sub(t)).normalize().toVar(),B=T.mul(a.sub(t)).normalize().toVar(),D=re(0).toVar();D.addAssign(Ec({v1:S,v2:R})),D.addAssign(Ec({v1:R,v2:C})),D.addAssign(Ec({v1:C,v2:B})),D.addAssign(Ec({v1:B,v2:S})),g.assign(re(UI({f:D})))}),g}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),mf=1/6,e6=n=>Je(mf,Je(n,Je(n,n.negate().add(3)).sub(3)).add(1)),Vm=n=>Je(mf,Je(n,Je(n,Je(3,n).sub(6))).add(4)),t6=n=>Je(mf,Je(n,Je(n,Je(-3,n).add(3)).add(3)).add(1)),zm=n=>Je(mf,Ai(n,3)),Fv=n=>e6(n).add(Vm(n)),Iv=n=>t6(n).add(zm(n)),kv=n=>Pn(-1,Vm(n).div(e6(n).add(Vm(n)))),qv=n=>Pn(1,zm(n).div(t6(n).add(zm(n)))),Uv=(n,e,t)=>{const r=n.uvNode,i=Je(r,e.zw).add(.5),s=us(i),o=Xs(i),a=Fv(o.x),c=Iv(o.x),f=kv(o.x),p=qv(o.x),g=kv(o.y),v=qv(o.y),x=ge(s.x.add(f),s.y.add(g)).sub(.5).mul(e.xy),T=ge(s.x.add(p),s.y.add(g)).sub(.5).mul(e.xy),S=ge(s.x.add(f),s.y.add(v)).sub(.5).mul(e.xy),R=ge(s.x.add(p),s.y.add(v)).sub(.5).mul(e.xy),C=Fv(o.y).mul(Pn(a.mul(n.sample(x).level(t)),c.mul(n.sample(T).level(t)))),B=Iv(o.y).mul(Pn(a.mul(n.sample(S).level(t)),c.mul(n.sample(R).level(t))));return C.add(B)},t2=ie(([n,e])=>{const t=ge(n.size(X(e))),r=ge(n.size(X(e.add(1)))),i=Kr(1,t),s=Kr(1,r),o=Uv(n,Ge(i,t),us(e)),a=Uv(n,Ge(s,r),rf(e));return Xs(e).mix(o,a)}),GI=ie(([n,e])=>{const t=e.mul(B1(n));return t2(n,t)}),Gv=ie(([n,e,t,r,i])=>{const s=re(S1(e.negate(),$s(n),Kr(1,r))),o=re(As(i[0].xyz),As(i[1].xyz),As(i[2].xyz));return $s(s).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),VI=ie(([n,e])=>n.mul(_i(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),zI=H1(),jI=H1(),Vv=ie(([n,e,t],{material:r})=>{const s=(r.side===hr?zI:jI).sample(n),o=ls(Ra.x).mul(VI(e,t));return t2(s,o)}),zv=ie(([n,e,t])=>(We(t.notEqual(0),()=>{const r=nf(e).negate().div(t);return m1(r.negate().mul(n))}),re(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),$I=ie(([n,e,t,r,i,s,o,a,c,f,p,g,v,x,T])=>{let S,R;if(T){S=Ge().toVar(),R=re().toVar();const I=p.sub(1).mul(T.mul(.025)),q=re(p.sub(I),p,p.add(I));Vt({start:0,end:3},({i:k})=>{const G=q.element(k),j=Gv(n,e,g,G,a),ee=o.add(j),Q=f.mul(c.mul(Ge(ee,1))),Y=ge(Q.xy.div(Q.w)).toVar();Y.addAssign(1),Y.divAssign(2),Y.assign(ge(Y.x,Y.y.oneMinus()));const Z=Vv(Y,t,G);S.element(k).assign(Z.element(k)),S.a.addAssign(Z.a),R.element(k).assign(r.element(k).mul(zv(As(j),v,x).element(k)))}),S.a.divAssign(3)}else{const I=Gv(n,e,g,p,a),q=o.add(I),k=f.mul(c.mul(Ge(q,1))),G=ge(k.xy.div(k.w)).toVar();G.addAssign(1),G.divAssign(2),G.assign(ge(G.x,G.y.oneMinus())),S=Vv(G,t,p),R=r.mul(zv(As(I),v,x))}const C=R.rgb.mul(S.rgb),B=n.dot(e).clamp(),D=re(Zw({dotNV:B,specularColor:i,specularF90:s,roughness:t})),F=R.r.add(R.g,R.b).div(3);return Ge(D.oneMinus().mul(C),S.a.oneMinus().mul(F).oneMinus())}),HI=pr(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),WI=n=>{const e=n.sqrt();return re(1).add(e).div(re(1).sub(e))},jv=(n,e)=>n.sub(e).div(n.add(e)).pow2(),QI=(n,e)=>{const t=n.mul(2*Math.PI*1e-9),r=re(54856e-17,44201e-17,52481e-17),i=re(1681e3,1795300,2208400),s=re(43278e5,93046e5,66121e5),o=z(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let a=r.mul(s.mul(2*Math.PI).sqrt()).mul(i.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return a=re(a.x.add(o),a.y,a.z).div(10685e-11),HI.mul(a)},XI=ie(({outsideIOR:n,eta2:e,cosTheta1:t,thinFilmThickness:r,baseF0:i})=>{const s=Nt(n,e,ps(0,.03,r)),a=n.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();We(a.lessThan(0),()=>re(1));const c=a.sqrt(),f=jv(s,n),p=$l({f0:f,f90:1,dotVH:t}),g=p.oneMinus(),v=s.lessThan(n).select(Math.PI,0),x=z(Math.PI).sub(v),T=WI(i.clamp(0,.9999)),S=jv(T,s.toVec3()),R=$l({f0:S,f90:1,dotVH:c}),C=re(T.x.lessThan(s).select(Math.PI,0),T.y.lessThan(s).select(Math.PI,0),T.z.lessThan(s).select(Math.PI,0)),B=s.mul(r,c,2),D=re(x).add(C),F=p.mul(R).clamp(1e-5,.9999),I=F.sqrt(),q=g.pow2().mul(R).div(re(1).sub(F)),G=p.add(q).toVar(),j=q.sub(g).toVar();return Vt({start:1,end:2,condition:"<=",name:"m"},({m:ee})=>{j.mulAssign(I);const Q=QI(z(ee).mul(B),z(ee).mul(D)).mul(2);G.addAssign(j.mul(Q))}),G.max(re(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),YI=ie(({normal:n,viewDir:e,roughness:t})=>{const r=n.dot(e).saturate(),i=t.pow2(),s=Xn(t.lessThan(.25),z(-339.2).mul(i).add(z(161.4).mul(t)).sub(25.9),z(-8.48).mul(i).add(z(14.3).mul(t)).sub(9.95)),o=Xn(t.lessThan(.25),z(44).mul(i).sub(z(23.7).mul(t)).add(3.26),z(1.97).mul(i).sub(z(3.27).mul(t)).add(.72));return Xn(t.lessThan(.25),0,z(.1).mul(t).sub(.025)).add(s.mul(r).add(o).exp()).mul(1/Math.PI).saturate()}),Nd=re(.04),Cd=z(1);class n6 extends pf{constructor(e=!1,t=!1,r=!1,i=!1,s=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=r,this.anisotropy=i,this.transmission=s,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=re().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=re().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=re().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=re().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=re().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=Gt.dot(sn).clamp();this.iridescenceFresnel=XI({outsideIOR:z(1),eta2:a1,cosTheta1:t,thinFilmThickness:l1,baseF0:Cr}),this.iridescenceF0=Jw({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=cs,r=T8.sub(cs).normalize(),i=Fo,s=e.context;s.backdrop=$I(i,r,ns,Mt,Cr,EA,t,ci,wi,Zl,eA,u1,c1,A1,this.dispersion?h1:null),s.backdropAlpha=Th,Mt.a.mulAssign(Nt(1,s.backdrop.a,Th))}super.start(e)}computeMultiscattering(e,t,r){const i=Gt.dot(sn).clamp(),s=e2({roughness:ns,dotNV:i}),a=(this.iridescenceF0?ef.mix(Cr,this.iridescenceF0):Cr).mul(s.x).add(r.mul(s.y)),f=s.x.add(s.y).oneMinus(),p=Cr.add(Cr.oneMinus().mul(.047619)),g=a.mul(p).div(f.mul(p).oneMinus());e.addAssign(a),t.addAssign(g.mul(f))}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Gt.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(kI({lightDirection:e}))),this.clearcoat===!0){const a=pa.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(a.mul(Gm({lightDirection:e,f0:Nd,f90:Cd,roughness:SA,normalView:pa})))}r.directDiffuse.addAssign(s.mul(Na({diffuseColor:Mt.rgb}))),r.directSpecular.addAssign(s.mul(Gm({lightDirection:e,f0:Cr,f90:1,roughness:ns,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:r,halfHeight:i,reflectedLight:s,ltc_1:o,ltc_2:a}){const c=t.add(r).sub(i),f=t.sub(r).sub(i),p=t.sub(r).add(i),g=t.add(r).add(i),v=Gt,x=sn,T=Sn.toVar(),S=qI({N:v,V:x,roughness:ns}),R=o.sample(S).toVar(),C=a.sample(S).toVar(),B=pr(re(R.x,0,R.y),re(0,1,0),re(R.z,0,R.w)).toVar(),D=Cr.mul(C.x).add(Cr.oneMinus().mul(C.y)).toVar();s.directSpecular.addAssign(e.mul(D).mul(Ov({N:v,V:x,P:T,mInv:B,p0:c,p1:f,p2:p,p3:g}))),s.directDiffuse.addAssign(e.mul(Mt).mul(Ov({N:v,V:x,P:T,mInv:pr(1,0,0,0,1,0,0,0,1),p0:c,p1:f,p2:p,p3:g})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(t.mul(Na({diffuseColor:Mt})))}indirectSpecular(e){const{radiance:t,iblIrradiance:r,reflectedLight:i}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(r.mul(da,YI({normal:Gt,viewDir:sn,roughness:Jh}))),this.clearcoat===!0){const p=pa.dot(sn).clamp(),g=Zw({dotNV:p,specularColor:Nd,specularF90:Cd,roughness:SA});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(g))}const s=re().toVar("singleScattering"),o=re().toVar("multiScattering"),a=r.mul(1/Math.PI);this.computeMultiscattering(s,o,EA);const c=s.add(o),f=Mt.mul(c.r.max(c.g).max(c.b).oneMinus());i.indirectSpecular.addAssign(t.mul(s)),i.indirectSpecular.addAssign(o.mul(a)),i.indirectDiffuse.addAssign(f.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:r}=e.context,s=Gt.dot(sn).clamp().add(t),o=ns.mul(-16).oneMinus().negate().exp2(),a=t.sub(s.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),r.indirectDiffuse.mulAssign(t),r.indirectSpecular.mulAssign(a)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const r=pa.dot(sn).clamp(),i=$l({dotVH:r,f0:Nd,f90:Cd}),s=t.mul(vh.mul(i).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(vh));t.assign(s)}if(this.sheen===!0){const r=da.r.max(da.g).max(da.b).mul(.157).oneMinus(),i=t.mul(r).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(i)}}}const $v=z(1),jm=z(-2),Rc=z(.8),Md=z(-1),Nc=z(.4),Pd=z(2),Cc=z(.305),Bd=z(3),Hv=z(.21),KI=z(4),Wv=z(4),ZI=z(16),JI=ie(([n])=>{const e=re(tn(n)).toVar(),t=z(-1).toVar();return We(e.x.greaterThan(e.z),()=>{We(e.x.greaterThan(e.y),()=>{t.assign(Xn(n.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Xn(n.y.greaterThan(0),1,4))})}).Else(()=>{We(e.z.greaterThan(e.y),()=>{t.assign(Xn(n.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Xn(n.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),ek=ie(([n,e])=>{const t=ge().toVar();return We(e.equal(0),()=>{t.assign(ge(n.z,n.y).div(tn(n.x)))}).ElseIf(e.equal(1),()=>{t.assign(ge(n.x.negate(),n.z.negate()).div(tn(n.y)))}).ElseIf(e.equal(2),()=>{t.assign(ge(n.x.negate(),n.y).div(tn(n.z)))}).ElseIf(e.equal(3),()=>{t.assign(ge(n.z.negate(),n.y).div(tn(n.x)))}).ElseIf(e.equal(4),()=>{t.assign(ge(n.x.negate(),n.z).div(tn(n.y)))}).Else(()=>{t.assign(ge(n.x,n.y).div(tn(n.z)))}),Je(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),tk=ie(([n])=>{const e=z(0).toVar();return We(n.greaterThanEqual(Rc),()=>{e.assign($v.sub(n).mul(Md.sub(jm)).div($v.sub(Rc)).add(jm))}).ElseIf(n.greaterThanEqual(Nc),()=>{e.assign(Rc.sub(n).mul(Pd.sub(Md)).div(Rc.sub(Nc)).add(Md))}).ElseIf(n.greaterThanEqual(Cc),()=>{e.assign(Nc.sub(n).mul(Bd.sub(Pd)).div(Nc.sub(Cc)).add(Pd))}).ElseIf(n.greaterThanEqual(Hv),()=>{e.assign(Cc.sub(n).mul(KI.sub(Bd)).div(Cc.sub(Hv)).add(Bd))}).Else(()=>{e.assign(z(-2).mul(ls(Je(1.16,n))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),r6=ie(([n,e])=>{const t=n.toVar();t.assign(Je(2,t).sub(1));const r=re(t,1).toVar();return We(e.equal(0),()=>{r.assign(r.zyx)}).ElseIf(e.equal(1),()=>{r.assign(r.xzy),r.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{r.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{r.assign(r.zyx),r.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{r.assign(r.xzy),r.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{r.z.mulAssign(-1)}),r}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),i6=ie(([n,e,t,r,i,s])=>{const o=z(t),a=re(e),c=_i(tk(o),jm,s),f=Xs(c),p=us(c),g=re($m(n,a,p,r,i,s)).toVar();return We(f.notEqual(0),()=>{const v=re($m(n,a,p.add(1),r,i,s)).toVar();g.assign(Nt(g,v,f))}),g}),$m=ie(([n,e,t,r,i,s])=>{const o=z(t).toVar(),a=re(e),c=z(JI(a)).toVar(),f=z(_n(Wv.sub(o),0)).toVar();o.assign(_n(o,Wv));const p=z(Vl(o)).toVar(),g=ge(ek(a,c).mul(p.sub(2)).add(1)).toVar();return We(c.greaterThan(2),()=>{g.y.addAssign(p),c.subAssign(3)}),g.x.addAssign(c.mul(p)),g.x.addAssign(f.mul(Je(3,ZI))),g.y.addAssign(Je(4,Vl(s).sub(p))),g.x.mulAssign(r),g.y.mulAssign(i),n.sample(g).grad(ge(),ge())}),Dd=ie(({envMap:n,mipInt:e,outputDirection:t,theta:r,axis:i,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:a})=>{const c=Cs(r),f=t.mul(c).add(i.cross(t).mul(Qr(r))).add(i.mul(i.dot(t).mul(c.oneMinus())));return $m(n,f,e,s,o,a)}),s6=ie(({n,latitudinal:e,poleAxis:t,outputDirection:r,weights:i,samples:s,dTheta:o,mipInt:a,envMap:c,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g})=>{const v=re(Xn(e,t,af(t,r))).toVar();We(v.equal(re(0)),()=>{v.assign(re(r.z,0,r.x.negate()))}),v.assign($s(v));const x=re().toVar();return x.addAssign(i.element(0).mul(Dd({theta:0,axis:v,outputDirection:r,mipInt:a,envMap:c,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g}))),Vt({start:X(1),end:n},({i:T})=>{We(T.greaterThanEqual(s),()=>{Bw()});const S=z(o.mul(z(T))).toVar();x.addAssign(i.element(T).mul(Dd({theta:S.mul(-1),axis:v,outputDirection:r,mipInt:a,envMap:c,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g}))),x.addAssign(i.element(T).mul(Dd({theta:S,axis:v,outputDirection:r,mipInt:a,envMap:c,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g})))}),Ge(x,1)}),vl=4,Qv=[.125,.215,.35,.446,.526,.582],bl=20,Ld=new mg(-1,1,1,-1,0,1),nk=new oA(90,1),Xv=new Gn;let Od=null,Fd=0,Id=0;const sa=(1+Math.sqrt(5))/2,Ka=1/sa,Yv=[new we(-sa,Ka,0),new we(sa,Ka,0),new we(-Ka,0,sa),new we(Ka,0,sa),new we(0,sa,-Ka),new we(0,sa,Ka),new we(-1,1,-1),new we(1,1,-1),new we(-1,1,1),new we(1,1,1)],rk=new we,o6=new WeakMap,ik=[3,1,5,0,4,2],kd=r6(Wt(),Ws("faceIndex")).normalize(),n2=re(kd.x,kd.y,kd.z);class sk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,r=.1,i=100,s={}){const{size:o=256,position:a=rk,renderTarget:c=null}=s;if(this._setSize(o),this._hasInitialized===!1){const p=c||this._allocateTarget();return s.renderTarget=p,this.fromSceneAsync(e,t,r,i,s),p}Od=this._renderer.getRenderTarget(),Fd=this._renderer.getActiveCubeFace(),Id=this._renderer.getActiveMipmapLevel();const f=c||this._allocateTarget();return f.depthBuffer=!0,this._init(f),this._sceneToCubeUV(e,r,i,f,a),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}async fromSceneAsync(e,t=0,r=.1,i=100,s={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,r,i,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromEquirectangularAsync(e,r),r}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromCubemapAsync(e,t),r}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Zv(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Jv(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===L0||e.mapping===O0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Od,Fd,Id),e.scissorTest=!1,Mc(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),Od=this._renderer.getRenderTarget(),Fd=this._renderer.getActiveCubeFace(),Id=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTarget();return this._init(r),this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return Kv(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Kv(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=ok(t)),this._blurMaterial=ak(t,e.width,e.height)}}async _compileMaterial(e){const t=new hn(this._lodPlanes[0],e);await this._renderer.compile(t,Ld)}_sceneToCubeUV(e,t,r,i,s){const o=nk;o.near=t,o.far=r;const a=[1,1,1,1,-1,1],c=[1,-1,1,-1,1,-1],f=this._renderer,p=f.autoClear;f.getClearColor(Xv),f.autoClear=!1;let g=this._backgroundBox;if(g===null){const T=new ts({name:"PMREM.Background",side:hr,depthWrite:!1,depthTest:!1});g=new hn(new Pg,T)}let v=!1;const x=e.background;x?x.isColor&&(g.material.color.copy(x),e.background=null,v=!0):(g.material.color.copy(Xv),v=!0),f.setRenderTarget(i),f.clear(),v&&f.render(g,o);for(let T=0;T<6;T++){const S=T%3;S===0?(o.up.set(0,a[T],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x+c[T],s.y,s.z)):S===1?(o.up.set(0,0,a[T]),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y+c[T],s.z)):(o.up.set(0,a[T],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y,s.z+c[T]));const R=this._cubeSize;Mc(i,S*R,T>2?R:0,R,R),f.render(e,o)}f.autoClear=p,e.background=x}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===L0||e.mapping===O0;i?this._cubemapMaterial===null&&(this._cubemapMaterial=Zv(e)):this._equirectMaterial===null&&(this._equirectMaterial=Jv(e));const s=i?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=s;const a=this._cubeSize;Mc(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(o,Ld)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=Yv[(i-s-1)%Yv.length];this._blur(e,s-1,s,o,a)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const c=this._renderer,f=this._blurMaterial,p=3,g=this._lodMeshes[i];g.material=f;const v=o6.get(f),x=this._sizeLods[r]-1,T=isFinite(s)?Math.PI/(2*x):2*Math.PI/(2*bl-1),S=s/T,R=isFinite(s)?1+Math.floor(p*S):bl;R>bl;const C=[];let B=0;for(let k=0;k<bl;++k){const G=k/S,j=Math.exp(-G*G/2);C.push(j),k===0?B+=j:k<R&&(B+=2*j)}for(let k=0;k<C.length;k++)C[k]=C[k]/B;e.texture.frame=(e.texture.frame||0)+1,v.envMap.value=e.texture,v.samples.value=R,v.weights.array=C,v.latitudinal.value=o==="latitudinal"?1:0,a&&(v.poleAxis.value=a);const{_lodMax:D}=this;v.dTheta.value=T,v.mipInt.value=D-r;const F=this._sizeLods[i],I=3*F*(i>D-vl?i-D+vl:0),q=4*(this._cubeSize-F);Mc(t,I,q,3*F,2*F),c.setRenderTarget(t),c.render(g,Ld)}}function ok(n){const e=[],t=[],r=[],i=[];let s=n;const o=n-vl+1+Qv.length;for(let a=0;a<o;a++){const c=Math.pow(2,s);t.push(c);let f=1/c;a>n-vl?f=Qv[a-n+vl-1]:a===0&&(f=0),r.push(f);const p=1/(c-2),g=-p,v=1+p,x=[g,g,v,g,v,v,g,g,v,v,g,v],T=6,S=6,R=3,C=2,B=1,D=new Float32Array(R*S*T),F=new Float32Array(C*S*T),I=new Float32Array(B*S*T);for(let k=0;k<T;k++){const G=k%3*2/3-1,j=k>2?0:-1,ee=[G,j,0,G+2/3,j,0,G+2/3,j+1,0,G,j,0,G+2/3,j+1,0,G,j+1,0],Q=ik[k];D.set(ee,R*S*Q),F.set(x,C*S*Q);const Y=[Q,Q,Q,Q,Q,Q];I.set(Y,B*S*Q)}const q=new Zr;q.setAttribute("position",new Ii(D,R)),q.setAttribute("uv",new Ii(F,C)),q.setAttribute("faceIndex",new Ii(I,B)),e.push(q),i.push(new hn(q,null)),s>vl&&s--}return{lodPlanes:e,sizeLods:t,sigmas:r,lodMeshes:i}}function Kv(n,e){const t={magFilter:qs,minFilter:qs,generateMipmaps:!1,type:wr,format:Li,colorSpace:ix},r=new Do(n,e,t);return r.texture.mapping=gp,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function Mc(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function r2(n){const e=new En;return e.depthTest=!1,e.depthWrite=!1,e.blending=Bl,e.name=`PMREM_${n}`,e}function ak(n,e,t){const r=cr(new Array(bl).fill(0)),i=Ue(new we(0,1,0)),s=Ue(0),o=z(bl),a=Ue(0),c=Ue(1),f=_t(null),p=Ue(0),g=z(1/e),v=z(1/t),x=z(n),T={n:o,latitudinal:a,weights:r,poleAxis:i,outputDirection:n2,dTheta:s,samples:c,envMap:f,mipInt:p,CUBEUV_TEXEL_WIDTH:g,CUBEUV_TEXEL_HEIGHT:v,CUBEUV_MAX_MIP:x},S=r2("blur");return S.fragmentNode=s6({...T,latitudinal:a.equal(1)}),o6.set(S,T),S}function Zv(n){const e=r2("cubemap");return e.fragmentNode=jl(n,n2),e}function Jv(n){const e=r2("equirect");return e.fragmentNode=_t(n,K1(n2),0),e}const e3=new WeakMap;function lk(n){const e=Math.log2(n)-2,t=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:t,maxMip:e}}function uk(n,e,t){const r=Ak(e);let i=r.get(n);if((i!==void 0?i.pmremVersion:-1)!==n.pmremVersion){const o=n.image;if(n.isCubeTexture)if(hk(o))i=t.fromCubemap(n,i);else return null;else if(fk(o))i=t.fromEquirectangular(n,i);else return null;i.pmremVersion=n.pmremVersion,r.set(n,i)}return i.texture}function Ak(n){let e=e3.get(n);return e===void 0&&(e=new WeakMap,e3.set(n,e)),e}class ck extends Rn{static get type(){return"PMREMNode"}constructor(e,t=null,r=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=r,this._generator=null;const i=new bg;i.isRenderTargetTexture=!0,this._texture=_t(i),this._width=Ue(0),this._height=Ue(0),this._maxMip=Ue(0),this.updateBeforeType=ot.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=lk(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const r=t?t.pmremVersion:-1,i=this._value;r!==i.pmremVersion&&(i.isPMREMTexture===!0?t=i:t=uk(i,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new sk(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=U1.mul(re(t.x,t.y.negate(),t.z));let r=this.levelNode;return r===null&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),i6(this._texture,t,r,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function hk(n){if(n==null)return!1;let e=0;const t=6;for(let r=0;r<t;r++)n[r]!==void 0&&e++;return e===t}function fk(n){return n==null?!1:n.height>0}const i2=Ye(ck).setParameterLength(1,3),t3=new WeakMap;class dk extends eu{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const g=r.isTextureNode?r.value:t[r.property];let v=t3.get(g);v===void 0&&(v=i2(g),t3.set(g,v)),r=v}const s=t.useAnisotropy===!0||t.anisotropy>0?W8:Gt,o=r.context(n3(ns,s)).mul(T0),a=r.context(pk(Fo)).mul(Math.PI).mul(T0),c=tA(o),f=tA(a);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(f);const p=e.context.lightingModel.clearcoatRadiance;if(p){const g=r.context(n3(SA,pa)).mul(T0),v=tA(g);p.addAssign(v)}}}const n3=(n,e)=>{let t=null;return{getUV:()=>(t===null&&(t=sn.negate().reflect(e),t=n.mul(n).mix(t,e).normalize(),t=t.transformDirection(wi)),t),getTextureLevel:()=>n}},pk=n=>({getUV:()=>n,getTextureLevel:()=>z(1)}),mk=new dR;class a6 extends En{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(mk),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new dk(t):null}setupLightingModel(){return new n6}setupSpecular(){const e=Nt(re(.04),Mt.rgb,wA);Cr.assign(e),EA.assign(1)}setupVariants(){const e=this.metalnessNode?z(this.metalnessNode):tw;wA.assign(e);let t=this.roughnessNode?z(this.roughnessNode):ew;t=J1({roughness:t}),ns.assign(t),this.setupSpecular(),Mt.assign(Ge(Mt.rgb.mul(e.oneMinus()),Mt.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const gk=new pR;class yk extends a6{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(gk),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?z(this.iorNode):pw;eA.assign(e),Cr.assign(Nt(Fr(x1(eA.sub(1).div(eA.add(1))).mul(J8),re(1)).mul(Um),Mt.rgb,wA)),EA.assign(Nt(Um,1,wA))}setupLightingModel(){return new n6(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?z(this.clearcoatNode):rw,r=this.clearcoatRoughnessNode?z(this.clearcoatRoughnessNode):iw;vh.assign(t),SA.assign(J1({roughness:r}))}if(this.useSheen){const t=this.sheenNode?re(this.sheenNode):aw,r=this.sheenRoughnessNode?z(this.sheenRoughnessNode):lw;da.assign(t),Jh.assign(r)}if(this.useIridescence){const t=this.iridescenceNode?z(this.iridescenceNode):Aw,r=this.iridescenceIORNode?z(this.iridescenceIORNode):cw,i=this.iridescenceThicknessNode?z(this.iridescenceThicknessNode):hw;ef.assign(t),a1.assign(r),l1.assign(i)}if(this.useAnisotropy){const t=(this.anisotropyNode?ge(this.anisotropyNode):uw).toVar();po.assign(t.length()),We(po.equal(0),()=>{t.assign(ge(1,0))}).Else(()=>{t.divAssign(ge(po)),po.assign(po.saturate())}),bh.assign(po.pow2().mix(ns.pow2(),1)),Ju.assign(ma[0].mul(t.x).add(ma[1].mul(t.y))),ba.assign(ma[1].mul(t.x).sub(ma[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?z(this.transmissionNode):fw,r=this.thicknessNode?z(this.thicknessNode):dw,i=this.attenuationDistanceNode?z(this.attenuationDistanceNode):mw,s=this.attenuationColorNode?re(this.attenuationColorNode):gw;if(Th.assign(t),u1.assign(r),A1.assign(i),c1.assign(s),this.useDispersion){const o=this.dispersionNode?z(this.dispersionNode):Tw;h1.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?re(this.clearcoatNormalNode):sw}setup(e){e.context.setupClearcoatNormal=()=>Nl(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const _k=ie(({normal:n,lightDirection:e,builder:t})=>{const r=n.dot(e),i=ge(r.mul(.5).add(.5),0);if(t.material.gradientMap){const s=Bs("gradientMap","texture").context({getUV:()=>i});return re(s.r)}else{const s=i.fwidth().mul(.5);return Nt(re(.7),re(1),ps(z(.7).sub(s.x),z(.7).add(s.x),i.x))}});class vk extends pf{direct({lightDirection:e,lightColor:t,reflectedLight:r},i){const s=_k({normal:uf,lightDirection:e,builder:i}).mul(t);r.directDiffuse.addAssign(s.mul(Na({diffuseColor:Mt.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(r.mul(Na({diffuseColor:Mt}))),i.indirectDiffuse.mulAssign(t)}}const bk=new mR;class xk extends En{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(bk),this.setValues(e)}setupLightingModel(){return new vk}}const l6=ie(()=>{const n=re(sn.z,0,sn.x.negate()).normalize(),e=sn.cross(n);return ge(n.dot(Gt),e.dot(Gt)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),Tk=new yR;class wk extends En{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(Tk),this.setValues(e)}setupVariants(e){const t=l6;let r;e.material.matcap?r=Bs("matcap","texture").context({getUV:()=>t}):r=re(Nt(.2,.8,t.y)),Mt.rgb.mulAssign(r.rgb)}}class Sk extends Rn{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:r}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),o=t.sin();return Zh(s,o,o.negate(),s).mul(r)}else{const s=t,o=va(Ge(1,0,0,0),Ge(0,Cs(s.x),Qr(s.x).negate(),0),Ge(0,Qr(s.x),Cs(s.x),0),Ge(0,0,0,1)),a=va(Ge(Cs(s.y),0,Qr(s.y),0),Ge(0,1,0,0),Ge(Qr(s.y).negate(),0,Cs(s.y),0),Ge(0,0,0,1)),c=va(Ge(Cs(s.z),Qr(s.z).negate(),0,0),Ge(Qr(s.z),Cs(s.z),0,0),Ge(0,0,1,0),Ge(0,0,0,1));return o.mul(a).mul(c).mul(Ge(r,1)).xyz}}}const $A=Ye(Sk).setParameterLength(2),Ek=new vR;class u6 extends En{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(Ek),this.setValues(e)}setupPositionView(e){const{object:t,camera:r}=e,{positionNode:i,rotationNode:s,scaleNode:o,sizeAttenuation:a}=this,c=Pa.mul(re(i||0));let f=ge(ci[0].xyz.length(),ci[1].xyz.length());o!==null&&(f=f.mul(ge(o))),r.isPerspectiveCamera&&a===!1&&(f=f.mul(c.z.negate()));let p=zA.xy;if(t.center&&t.center.isVector2===!0){const x=RO("center","vec2",t);p=p.sub(x.sub(.5))}p=p.mul(f);const g=z(s||ow),v=$A(p,g);return Ge(c.xy.add(v),c.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const Rk=new ex,Nk=new ht;class Ck extends u6{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(Rk),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return Pa.mul(re(e||wn)).xyz}setupVertexSprite(e){const{material:t,camera:r}=e,{rotationNode:i,scaleNode:s,sizeNode:o,sizeAttenuation:a}=this;let c=super.setupVertex(e);if(t.isNodeMaterial!==!0)return c;let f=o!==null?ge(o):xw;f=f.mul(b8),r.isPerspectiveCamera&&a===!0&&(f=f.mul(Mk.div(Sn.z.negate()))),s&&s.isNode&&(f=f.mul(ge(s)));let p=zA.xy;if(i&&i.isNode){const g=z(i);p=$A(p,g)}return p=p.mul(f),p=p.div(F1.div(2)),p=p.mul(c.w),c=c.add(Ge(p,0,0)),c}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const Mk=Ue(1).onFrameUpdate(function({renderer:n}){const e=n.getSize(Nk);this.value=.5*e.y});class Pk extends pf{constructor(){super(),this.shadowNode=z(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Mt.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Mt.rgb)}}const Bk=new bR;class Dk extends En{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Bk),this.setValues(e)}setupLightingModel(){return new Pk}}Is("vec3");Is("vec3");Is("vec3");class Lk{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,r)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,r)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Gi{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let r=this.weakMap;for(let i=0;i<e.length-1;i++){const s=e[i];r.has(s)===!1&&r.set(s,new WeakMap),r=r.get(s)}return r.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),t===void 0)return!1;return t.delete(e[e.length-1])}}let Ok=0;function Fk(n){const e=Object.keys(n);let t=Object.getPrototypeOf(n);for(;t;){const r=Object.getOwnPropertyDescriptors(t);for(const i in r)if(r[i]!==void 0){const s=r[i];s&&typeof s.get=="function"&&e.push(i)}t=Object.getPrototypeOf(t)}return e}class Ik{constructor(e,t,r,i,s,o,a,c,f,p){this.id=Ok++,this._nodes=e,this._geometries=t,this.renderer=r,this.object=i,this.material=s,this.scene=o,this.camera=a,this.lightsNode=c,this.context=f,this.geometry=i.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=p,this.clippingContextCacheKey=p!==null?p.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,r=[],i=new Set,s={};for(const o of e){let a;if(o.node&&o.node.attribute?a=o.node.attribute:(a=t.getAttribute(o.name),s[o.name]=a.version),a===void 0)continue;r.push(a);const c=a.isInterleavedBufferAttribute?a.data:a;i.add(c)}return this.attributes=r,this.attributesId=s,this.vertexBuffers=Array.from(i.values()),r}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:r,group:i,drawRange:s}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),c=a!==null;let f=1;if(r.isInstancedBufferGeometry===!0?f=r.instanceCount:e.count!==void 0&&(f=Math.max(0,e.count)),f===0)return null;if(o.instanceCount=f,e.isBatchedMesh===!0)return o;let p=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(p=2);let g=s.start*p,v=(s.start+s.count)*p;i!==null&&(g=Math.max(g,i.start*p),v=Math.min(v,(i.start+i.count)*p));const x=r.attributes.position;let T=1/0;c?T=a.count:x!=null&&(T=x.count),g=Math.max(g,0),v=Math.min(v,T);const S=v-g;return S<0||S===1/0?null:(o.vertexCount=S,o.firstVertex=g,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const r of Object.keys(e.attributes).sort()){const i=e.attributes[r];t+=r+",",i.data&&(t+=i.data.stride+","),i.offset&&(t+=i.offset+","),i.itemSize&&(t+=i.itemSize+","),i.normalized&&(t+="n,")}for(const r of Object.keys(e.morphAttributes).sort()){const i=e.morphAttributes[r];t+="morph-"+r+",";for(let s=0,o=i.length;s<o;s++){const a=i[s];t+=a.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:r}=this;let i=t.customProgramCacheKey();for(const s of Fk(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const o=t[s];let a;if(o!==null){const c=typeof o;c==="number"?a=o!==0?"1":"0":c==="object"?(a="{",o.isTexture&&(a+=o.mapping,r.backend.isWebGPUBackend===!0&&(a+=o.magFilter,a+=o.minFilter,a+=o.wrapS,a+=o.wrapT,a+=o.wrapR)),a+="}"):a=String(o)}else a=String(o);i+=a+","}return i+=this.clippingContextCacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1)&&(i+=e.uuid+","),i+=e.receiveShadow+",",M4(i)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const t in e){const r=this.geometry.getAttribute(t);if(r===void 0||e[t]!==r.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=gh(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=gh(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Xo=[];class kk{constructor(e,t,r,i,s,o){this.renderer=e,this.nodes=t,this.geometries=r,this.pipelines=i,this.bindings=s,this.info=o,this.chainMaps={}}get(e,t,r,i,s,o,a,c){const f=this.getChainMap(c);Xo[0]=e,Xo[1]=t,Xo[2]=o,Xo[3]=s;let p=f.get(Xo);return p===void 0?(p=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,r,i,s,o,a,c),f.set(Xo,p)):(p.updateClipping(a),p.needsGeometryUpdate&&p.setGeometry(e.geometry),(p.version!==t.version||p.needsUpdate)&&(p.initialCacheKey!==p.getCacheKey()?(p.dispose(),p=this.get(e,t,r,i,s,o,a,c)):p.version=t.version)),Xo.length=0,p}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Gi)}dispose(){this.chainMaps={}}createRenderObject(e,t,r,i,s,o,a,c,f,p,g){const v=this.getChainMap(g),x=new Ik(e,t,r,i,s,o,a,c,f,p);return x.onDispose=()=>{this.pipelines.delete(x),this.bindings.delete(x),this.nodes.delete(x),v.delete(x.getChainArray())},x}}class Io{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const hi={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},_o=16,qk=211,Uk=212;class Gk extends Io{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const r=this.get(e);if(r.version===void 0)t===hi.VERTEX?this.backend.createAttribute(e):t===hi.INDEX?this.backend.createIndexAttribute(e):t===hi.STORAGE?this.backend.createStorageAttribute(e):t===hi.INDIRECT&&this.backend.createIndirectStorageAttribute(e),r.version=this._getBufferAttribute(e).version;else{const i=this._getBufferAttribute(e);(r.version<i.version||i.usage===hl)&&(this.backend.updateAttribute(e),r.version=i.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function A6(n){return n.index!==null?n.index.version:n.attributes.position.version}function r3(n){const e=[],t=n.index,r=n.attributes.position;if(t!==null){const s=t.array;for(let o=0,a=s.length;o<a;o+=3){const c=s[o+0],f=s[o+1],p=s[o+2];e.push(c,f,f,p,p,c)}}else{const s=r.array;for(let o=0,a=s.length/3-1;o<a;o+=3){const c=o+0,f=o+1,p=o+2;e.push(c,f,f,p,p,c)}}const i=new(SR(e)?TR:wR)(e,1);return i.version=A6(n),i}class Vk extends Io{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,r=this.get(t);r.initialized=!0,this.info.memory.geometries++;const i=()=>{this.info.memory.geometries--;const s=t.index,o=e.getAttributes();s!==null&&this.attributes.delete(s);for(const c of o)this.attributes.delete(c);const a=this.wireframes.get(t);a!==void 0&&this.attributes.delete(a),t.removeEventListener("dispose",i)};t.addEventListener("dispose",i)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,hi.STORAGE):this.updateAttribute(s,hi.VERTEX);const r=this.getIndex(e);r!==null&&this.updateAttribute(r,hi.INDEX);const i=e.geometry.indirect;i!==null&&this.updateAttribute(i,hi.INDIRECT)}updateAttribute(e,t){const r=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,r)):this.attributeCall.get(e.data)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e.data,r),this.attributeCall.set(e,r)):this.attributeCall.get(e)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e,r))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:r}=e;let i=t.index;if(r.wireframe===!0){const s=this.wireframes;let o=s.get(t);o===void 0?(o=r3(t),s.set(t,o)):o.version!==A6(t)&&(this.attributes.delete(o),o=r3(t),s.set(t,o)),i=o}return i}}class zk{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,r){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=r*(t/3):e.isPoints?this.render.points+=r*t:e.isLineSegments?this.render.lines+=r*(t/2):e.isLine&&(this.render.lines+=r*(t-1))}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class c6{constructor(e){this.cacheKey=e,this.usedTimes=0}}class jk extends c6{constructor(e,t,r){super(e),this.vertexProgram=t,this.fragmentProgram=r}}class $k extends c6{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let Hk=0;class qd{constructor(e,t,r,i=null,s=null){this.id=Hk++,this.code=e,this.stage=t,this.name=r,this.transforms=i,this.attributes=s,this.usedTimes=0}}class Wk extends Io{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:r}=this,i=this.get(e);if(this._needsComputeUpdate(e)){const s=i.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let a=this.programs.compute.get(o.computeShader);a===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),a=new qd(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,a),r.createProgram(a));const c=this._getComputeCacheKey(e,a);let f=this.caches.get(c);f===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),f=this._getComputePipeline(e,a,c,t)),f.usedTimes++,a.usedTimes++,i.version=e.version,i.pipeline=f}return i.pipeline}getForRender(e,t=null){const{backend:r}=this,i=this.get(e);if(this._needsRenderUpdate(e)){const s=i.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),a=e.material?e.material.name:"";let c=this.programs.vertex.get(o.vertexShader);c===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),c=new qd(o.vertexShader,"vertex",a),this.programs.vertex.set(o.vertexShader,c),r.createProgram(c));let f=this.programs.fragment.get(o.fragmentShader);f===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),f=new qd(o.fragmentShader,"fragment",a),this.programs.fragment.set(o.fragmentShader,f),r.createProgram(f));const p=this._getRenderCacheKey(e,c,f);let g=this.caches.get(p);g===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),g=this._getRenderPipeline(e,c,f,p,t)):e.pipeline=g,g.usedTimes++,c.usedTimes++,f.usedTimes++,i.pipeline=g}return i.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,r,i){r=r||this._getComputeCacheKey(e,t);let s=this.caches.get(r);return s===void 0&&(s=new $k(r,t),this.caches.set(r,s),this.backend.createComputePipeline(s,i)),s}_getRenderPipeline(e,t,r,i,s){i=i||this._getRenderCacheKey(e,t,r);let o=this.caches.get(i);return o===void 0&&(o=new jk(i,t,r),this.caches.set(i,o),e.pipeline=o,this.backend.createRenderPipeline(e,s)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,r){return t.id+","+r.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,r=e.stage;this.programs[r].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class Qk extends Io{constructor(e,t,r,i,s,o){super(),this.backend=e,this.textures=r,this.pipelines=s,this.attributes=i,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const r of t){const i=this.get(r);i.bindGroup===void 0&&(this._init(r),this.backend.createBindings(r,t,0),i.bindGroup=r)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const r of t){const i=this.get(r);i.bindGroup===void 0&&(this._init(r),this.backend.createBindings(r,t,0),i.bindGroup=r)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const r=t.attribute,i=r.isIndirectStorageBufferAttribute?hi.INDIRECT:hi.STORAGE;this.attributes.update(r,i)}}_update(e,t){const{backend:r}=this;let i=!1,s=!0,o=0,a=0;for(const c of e.bindings)if(!(c.isNodeUniformsGroup&&this.nodes.updateGroup(c)===!1)){if(c.isStorageBuffer){const f=c.attribute,p=f.isIndirectStorageBufferAttribute?hi.INDIRECT:hi.STORAGE;this.attributes.update(f,p)}if(c.isUniformBuffer)c.update()&&r.updateBinding(c);else if(c.isSampledTexture){const f=c.update(),p=c.texture,g=this.textures.get(p);if(f&&(this.textures.updateTexture(p),c.generation!==g.generation&&(c.generation=g.generation,i=!0,s=!1)),r.get(p).externalTexture!==void 0||g.isDefaultTexture?s=!1:(o=o*10+p.id,a+=p.version),p.isStorageTexture===!0){const x=this.get(p);c.store===!0?x.needsMipmap=!0:this.textures.needsMipmaps(p)&&x.needsMipmap===!0&&(this.backend.generateMipmaps(p),x.needsMipmap=!1)}}else c.isSampler&&c.update()}i===!0&&this.backend.updateBindings(e,t,s?o:0,a)}}function Xk(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?n.z-e.z:n.id-e.id}function i3(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function s3(n){return(n.transmission>0||n.transmissionNode)&&n.side===fi&&n.forceSinglePass===!1}class Yk{constructor(e,t,r){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,r),this.lightsArray=[],this.scene=t,this.camera=r,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,r,i,s,o,a){let c=this.renderItems[this.renderItemsIndex];return c===void 0?(c={id:e.id,object:e,geometry:t,material:r,groupOrder:i,renderOrder:e.renderOrder,z:s,group:o,clippingContext:a},this.renderItems[this.renderItemsIndex]=c):(c.id=e.id,c.object=e,c.geometry=t,c.material=r,c.groupOrder=i,c.renderOrder=e.renderOrder,c.z=s,c.group=o,c.clippingContext=a),this.renderItemsIndex++,c}push(e,t,r,i,s,o,a){const c=this.getNextRenderItem(e,t,r,i,s,o,a);e.occlusionTest===!0&&this.occlusionQueryCount++,r.transparent===!0||r.transmission>0?(s3(r)&&this.transparentDoublePass.push(c),this.transparent.push(c)):this.opaque.push(c)}unshift(e,t,r,i,s,o,a){const c=this.getNextRenderItem(e,t,r,i,s,o,a);r.transparent===!0||r.transmission>0?(s3(r)&&this.transparentDoublePass.unshift(c),this.transparent.unshift(c)):this.opaque.unshift(c)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||Xk),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||i3),this.transparent.length>1&&this.transparent.sort(t||i3)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const r=this.renderItems[e];if(r.id===null)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.groupOrder=null,r.renderOrder=null,r.z=null,r.group=null,r.clippingContext=null}}}const vu=[];class Kk{constructor(e){this.lighting=e,this.lists=new Gi}get(e,t){const r=this.lists;vu[0]=e,vu[1]=t;let i=r.get(vu);return i===void 0&&(i=new Yk(this.lighting,e,t),r.set(vu,i)),vu.length=0,i}dispose(){this.lists=new Gi}}let Zk=0;class Jk{constructor(){this.id=Zk++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Ft,this.scissor=!1,this.scissorValue=new Ft,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return h6(this)}}function h6(n){const{textures:e,activeCubeFace:t,activeMipmapLevel:r}=n,i=[t,r];for(const s of e)i.push(s.id);return Hh(i)}const bu=[],eq=new Ih,tq=new fg;class nq{constructor(){this.chainMaps={}}get(e,t,r=null){bu[0]=e,bu[1]=t;let i;if(r===null)i="default";else{const a=r.texture.format;i=`${r.textures.length}:${a}:${r.samples}:${r.depthBuffer}:${r.stencilBuffer}`}const s=this._getChainMap(i);let o=s.get(bu);return o===void 0&&(o=new Jk,s.set(bu,o)),bu.length=0,r!==null&&(o.sampleCount=r.samples===0?1:r.samples),o}getForClear(e=null){return this.get(eq,tq,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Gi)}dispose(){this.chainMaps={}}}const rq=new we;class iq extends Io{constructor(e,t,r){super(),this.renderer=e,this.backend=t,this.info=r}updateRenderTarget(e,t=0){const r=this.get(e),i=e.samples===0?1:e.samples,s=r.depthTextureMips||(r.depthTextureMips={}),o=e.textures,a=this.getSize(o[0]),c=a.width>>t,f=a.height>>t;let p=e.depthTexture||s[t];const g=e.depthBuffer===!0||e.stencilBuffer===!0;let v=!1;p===void 0&&g&&(p=new qi,p.format=e.stencilBuffer?wo:So,p.type=e.stencilBuffer?To:Ln,p.image.width=c,p.image.height=f,p.image.depth=a.depth,p.isArrayTexture=e.multiview===!0&&a.depth>1,s[t]=p),(r.width!==a.width||a.height!==r.height)&&(v=!0,p&&(p.needsUpdate=!0,p.image.width=c,p.image.height=f,p.image.depth=p.isArrayTexture?p.image.depth:1)),r.width=a.width,r.height=a.height,r.textures=o,r.depthTexture=p||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==i&&(v=!0,p&&(p.needsUpdate=!0),r.sampleCount=i);const x={sampleCount:i};if(e.isXRRenderTarget!==!0){for(let T=0;T<o.length;T++){const S=o[T];v&&(S.needsUpdate=!0),this.updateTexture(S,x)}p&&this.updateTexture(p,x)}if(r.initialized!==!0){r.initialized=!0;const T=()=>{e.removeEventListener("dispose",T);for(let S=0;S<o.length;S++)this._destroyTexture(o[S]);p&&this._destroyTexture(p),this.delete(e),this.backend.delete(e)};e.addEventListener("dispose",T)}}updateTexture(e,t={}){const r=this.get(e);if(r.initialized===!0&&r.version===e.version)return;const i=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(i&&r.initialized===!0&&(s.destroySampler(e),s.destroyTexture(e)),e.isFramebufferTexture){const f=this.renderer.getRenderTarget();f?e.type=f.texture.type:e.type=Xr}const{width:o,height:a,depth:c}=this.getSize(e);if(t.width=o,t.height=a,t.depth=c,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,a):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,i||e.isStorageTexture===!0||e.isExternalTexture===!0)s.createSampler(e),s.createTexture(e,t),r.generation=e.version;else if(r.initialized!==!0&&s.createSampler(e),e.version>0){const p=e.image;if(p!==void 0){if(p.complete!==!1){if(e.images){const g=[];for(const v of e.images)g.push(v);t.images=g}else t.image=p;(r.isDefaultTexture===void 0||r.isDefaultTexture===!0)&&(s.createTexture(e,t),r.isDefaultTexture=!1,r.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&s.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}}else s.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version;if(r.initialized!==!0){r.initialized=!0,r.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&(Tn.getTransfer(e.colorSpace),ct);const f=()=>{e.removeEventListener("dispose",f),this._destroyTexture(e)};e.addEventListener("dispose",f)}r.version=e.version}getSize(e,t=rq){let r=e.images?e.images[0]:e.image;return r?(r.image!==void 0&&(r=r.image),typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement?(t.width=r.videoWidth||1,t.height=r.videoHeight||1,t.depth=1):r instanceof VideoFrame?(t.width=r.displayWidth||1,t.height=r.displayHeight||1,t.depth=1):(t.width=r.width||1,t.height=r.height||1,t.depth=e.isCubeTexture?6:r.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,r){let i;return e.mipmaps.length>0?i=e.mipmaps.length:e.isCompressedTexture===!0?i=1:i=Math.floor(Math.log2(Math.max(t,r)))+1,i}needsMipmaps(e){return e.generateMipmaps===!0||e.mipmaps.length>0}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class s2 extends Gn{constructor(e,t,r,i=1){super(e,t,r),this.a=i}set(e,t,r,i=1){return this.a=i,super.set(e,t,r)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class f6 extends It{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}const sq=(n,e)=>pe(new f6(n,e));class oq extends Oe{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}add(e){return e.isNode!==!0?this:(this.nodes.push(e),this)}If(e,t){const r=new _l(t);return this._currentCond=Xn(e,r),this.add(this._currentCond)}ElseIf(e,t){const r=new _l(t),i=Xn(e,r);return this._currentCond.elseNode=i,this._currentCond=i,this}Else(e){return this._currentCond.elseNode=new _l(e),this}Switch(e){return this._expressionNode=pe(e),this}Case(...e){const t=[];if(e.length>=2)for(let a=0;a<e.length-1;a++)t.push(this._expressionNode.equal(pe(e[a])));const r=e[e.length-1],i=new _l(r);let s=t[0];for(let a=1;a<t.length;a++)s=s.or(t[a]);const o=Xn(s,i);return this._currentCond===null?(this._currentCond=o,this.add(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let r=0;for(const i of this.getChildren())i.isVarNode&&i.intent===!0&&e.getNodeProperties(i).assign!==!0||(t["node"+r++]=i);return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...t){const r=e.currentStack,i=Yh();xA(this),e.currentStack=this;const s=e.buildStage;for(const a of this.nodes)if(!(a.isVarNode&&a.intent===!0&&e.getNodeProperties(a).assign!==!0)){if(s==="setup")a.build(e);else if(s==="analyze")a.build(e,this);else if(s==="generate"){const c=e.getDataFromNode(a,"any").stages,f=c&&c[e.shaderStage];if(a.isVarNode&&f&&f.length===1&&f[0]&&f[0].isStackNode)continue;a.build(e,"void")}}let o;return this.hasOutput?o=this.outputNode.build(e,...t):o=super.build(e,...t),xA(i),e.currentStack=r,o}}const S0=Ye(oq).setParameterLength(0,1);function aq(n){return Object.entries(n).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class lq extends Oe{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=aq(e),this.name=t,this.isStructLayoutNode=!0}getLength(){const t=Float32Array.BYTES_PER_ELEMENT;let r=0;for(const i of this.membersLayout){const s=i.type,o=kL(s)*t,a=qL(s),c=r%8,f=c%a,p=c+f;r+=f,p!==0&&8-p<o&&(r+=8-p),r+=o}return Math.ceil(r/8)*8/t}getMemberType(e,t){const r=this.membersLayout.find(i=>i.name===t);return r?r.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class uq extends Oe{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),r=t.type,i=e.getPropertyName(t);return e.addLineFlowCode(`${i} = ${e.generateStruct(r,this.structTypeNode.membersLayout,this.values)}`,this),t.name}}const Aq=(n,e=null)=>{const t=new lq(n,e),r=(...i)=>{let s=null;if(i.length>0)if(i[0].isNode){s={};const o=Object.keys(n);for(let a=0;a<i.length;a++)s[o[a]]=i[a]}else s=i[0];return pe(new uq(t,s))};return r.layout=t,r.isStruct=!0,r};class d6 extends Oe{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(t.membersLayout===void 0){const r=this.members,i=[];for(let s=0;s<r.length;s++){const o="m"+s,a=r[s].getNodeType(e);i.push({name:o,type:a,index:s})}t.membersLayout=i,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),r=this.members,i=t!==""?t+".":"";for(let s=0;s<r.length;s++){const o=r[s].build(e);e.addLineFlowCode(`${i}m${s} = ${o}`,this)}return t}}const cq=Ye(d6);function p6(n,e){for(let t=0;t<n.length;t++)if(n[t].name===e)return t;return-1}class hq extends d6{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return m6(t)}setup(e){const t=this.outputNodes,r=e.renderer.getRenderTarget(),i=[],s=r.textures;for(const o in t){const a=p6(s,o);i[a]=Ge(t[o])}return this.members=i,super.setup(e)}}const m6=Ye(hq);class HA extends Rn{static get type(){return"BitcastNode"}constructor(e,t,r=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=r,this.isBitcastNode=!0}getNodeType(e){if(this.inputType!==null){const t=this.valueNode.getNodeType(e),r=e.getTypeLength(t);return e.getTypeFromLength(r,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let r="";if(this.inputType!==null){const i=this.valueNode.getNodeType(e);r=e.getTypeLength(i)===1?this.inputType:e.changeComponentType(i,this.inputType)}else r=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,r)}( ${this.valueNode.build(e,r)} )`}}const fq=Ne(HA).setParameterLength(2),dq=n=>new HA(n,"int","float"),pq=n=>new HA(n,"uint","float"),mq=n=>new HA(n,"float","int"),gq=n=>new HA(n,"float","uint"),yq=ie(([n])=>{const e=n.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),Hm=(n,e)=>Ai(Je(4,n.mul(vt(1,n))),e),_q=(n,e)=>n.lessThan(.5)?Hm(n.mul(2),e).div(2):vt(1,Hm(Je(vt(1,n),2),e).div(2)),vq=(n,e,t)=>Ai(Kr(Ai(n,e),Pn(Ai(n,e),Ai(vt(1,n),t))),1/e),bq=(n,e)=>Qr(wh.mul(e.mul(n).sub(1))).div(wh.mul(e.mul(n).sub(1))),Ms=ie(([n])=>n.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),xq=ie(([n])=>re(Ms(n.z.add(Ms(n.y.mul(1)))),Ms(n.z.add(Ms(n.x.mul(1)))),Ms(n.y.add(Ms(n.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Tq=ie(([n,e,t])=>{const r=re(n).toVar(),i=z(1.4).toVar(),s=z(0).toVar(),o=re(r).toVar();return Vt({start:z(0),end:z(3),type:"float",condition:"<="},()=>{const a=re(xq(o.mul(2))).toVar();r.addAssign(a.add(t.mul(z(.1).mul(e)))),o.mulAssign(1.8),i.mulAssign(1.5),r.mulAssign(1.2);const c=z(Ms(r.z.add(Ms(r.x.add(Ms(r.y)))))).toVar();s.addAssign(c.div(i)),o.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class wq extends Oe{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let r=this._candidateFnCall;if(r===null){let i=null,s=-1;for(const o of this.functionNodes){const c=o.shaderNode.layout;if(c===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const f=c.inputs;if(t.length===f.length){let p=0;for(let g=0;g<t.length;g++){const v=t[g],x=f[g];v.getNodeType(e)===x.type?p++:p=0}p>s&&(i=o,s=p)}}this._candidateFnCall=r=i(...t)}return r}}const Sq=Ye(wq),sr=n=>(...e)=>Sq(n,...e),tu=Ue(0).setGroup(qe).onRenderUpdate(n=>n.time),Eq=Ue(0).setGroup(qe).onRenderUpdate(n=>n.deltaTime),g6=Ue(0,"uint").setGroup(qe).onRenderUpdate(n=>n.frameId),Rq=(n=tu)=>n.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),Nq=(n=tu)=>n.fract().round(),Cq=(n=tu)=>n.add(.5).fract().mul(2).sub(1).abs(),Mq=(n=tu)=>n.fract(),Pq=ie(([n,e,t=ge(.5)])=>$A(n.sub(t),e).add(t)),Bq=ie(([n,e,t=ge(.5)])=>{const r=n.sub(t),i=r.dot(r),o=i.mul(i).mul(e);return n.add(r.mul(o))}),Dq=ie(({position:n=null,horizontal:e=!0,vertical:t=!1})=>{let r;n!==null?(r=ci.toVar(),r[3][0]=n.x,r[3][1]=n.y,r[3][2]=n.z):r=ci;const i=wi.mul(r);return bA(e)&&(i[0][0]=ci[0].length(),i[0][1]=0,i[0][2]=0),bA(t)&&(i[1][0]=0,i[1][1]=ci[1].length(),i[1][2]=0),i[2][0]=0,i[2][1]=0,i[2][2]=1,Zl.mul(i).mul(wn)}),Lq=ie(([n=null])=>{const e=Rh();return Rh(W1(n)).sub(e).lessThan(0).select(ks,n)});class Oq extends Oe{static get type(){return"SpriteSheetUVNode"}constructor(e,t=Wt(),r=z(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=r}setup(){const{frameNode:e,uvNode:t,countNode:r}=this,{width:i,height:s}=r,o=e.mod(i.mul(s)).floor(),a=o.mod(i),c=s.sub(o.add(1).div(i).ceil()),f=r.reciprocal(),p=ge(a,c);return t.add(p).mul(f)}}const Fq=Ye(Oq).setParameterLength(3),y6=ie(([n,e=null,t=null,r=z(1),i=wn,s=Ir])=>{let o=s.abs().normalize();o=o.div(o.dot(re(1)));const a=i.yz.mul(r),c=i.zx.mul(r),f=i.xy.mul(r),p=n.value,g=e!==null?e.value:p,v=t!==null?t.value:p,x=_t(p,a).mul(o.x),T=_t(g,c).mul(o.y),S=_t(v,f).mul(o.z);return Pn(x,T,S)}),Iq=(...n)=>y6(...n),Za=new xg,Yo=new we,Ja=new we,Ud=new we,xu=new gn,Pc=new we(0,0,-1),Qi=new Ft,Tu=new we,Bc=new we,wu=new Ft,Dc=new ht,Nh=new Do,kq=ks.flipX();Nh.depthTexture=new qi(1,1);let Lc=!1;class o2 extends ms{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||Nh.texture,kq),this._reflectorBaseNode=e.reflector||new qq(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=pe(new o2({defaultTexture:Nh.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class qq extends Oe{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:r=new Fh,resolutionScale:i=1,generateMipmaps:s=!1,bounces:o=!0,depth:a=!1,samples:c=0}=t;this.textureNode=e,this.target=r,this.resolutionScale=i,t.resolution!==void 0&&(ki('THREE.ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=s,this.bounces=o,this.depth=a,this.samples=c,this.updateBeforeType=o?ot.RENDER:ot.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const r=this.resolutionScale;t.getDrawingBufferSize(Dc),e.setSize(Math.round(Dc.width*r),Math.round(Dc.height*r))}setup(e){return this._updateResolution(Nh,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new Do(0,0,{type:wr,samples:this.samples}),this.generateMipmaps===!0&&(t.texture.minFilter=tN,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new qi),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&Lc)return!1;Lc=!0;const{scene:t,camera:r,renderer:i,material:s}=e,{target:o}=this,a=this.getVirtualCamera(r),c=this.getRenderTarget(a);i.getDrawingBufferSize(Dc),this._updateResolution(c,i),Ja.setFromMatrixPosition(o.matrixWorld),Ud.setFromMatrixPosition(r.matrixWorld),xu.extractRotation(o.matrixWorld),Yo.set(0,0,1),Yo.applyMatrix4(xu),Tu.subVectors(Ja,Ud);const f=Tu.dot(Yo)>0;let p=!1;if(f===!0&&this.forceUpdate===!1){if(this.hasOutput===!1){Lc=!1;return}p=!0}Tu.reflect(Yo).negate(),Tu.add(Ja),xu.extractRotation(r.matrixWorld),Pc.set(0,0,-1),Pc.applyMatrix4(xu),Pc.add(Ud),Bc.subVectors(Ja,Pc),Bc.reflect(Yo).negate(),Bc.add(Ja),a.coordinateSystem=r.coordinateSystem,a.position.copy(Tu),a.up.set(0,1,0),a.up.applyMatrix4(xu),a.up.reflect(Yo),a.lookAt(Bc),a.near=r.near,a.far=r.far,a.updateMatrixWorld(),a.projectionMatrix.copy(r.projectionMatrix),Za.setFromNormalAndCoplanarPoint(Yo,Ja),Za.applyMatrix4(a.matrixWorldInverse),Qi.set(Za.normal.x,Za.normal.y,Za.normal.z,Za.constant);const g=a.projectionMatrix;wu.x=(Math.sign(Qi.x)+g.elements[8])/g.elements[0],wu.y=(Math.sign(Qi.y)+g.elements[9])/g.elements[5],wu.z=-1,wu.w=(1+g.elements[10])/g.elements[14],Qi.multiplyScalar(1/Qi.dot(wu));const v=0;g.elements[2]=Qi.x,g.elements[6]=Qi.y,g.elements[10]=i.coordinateSystem===Yl?Qi.z-v:Qi.z+1-v,g.elements[14]=Qi.w,this.textureNode.value=c.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=c.depthTexture),s.visible=!1;const x=i.getRenderTarget(),T=i.getMRT(),S=i.autoClear;i.setMRT(null),i.setRenderTarget(c),i.autoClear=!0,p?(i.clear(),this.hasOutput=!1):(i.render(t,a),this.hasOutput=!0),i.setMRT(T),i.setRenderTarget(x),i.autoClear=S,s.visible=!0,Lc=!1,this.forceUpdate=!1}get resolution(){return ki('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){ki('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const Uq=n=>pe(new o2(n)),Gd=new mg(-1,1,1,-1,0,1);class Gq extends Zr{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new fs([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fs(t,2))}}const Vq=new Gq;class gf extends hn{constructor(e=null){super(Vq,e),this.camera=Gd,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,Gd)}render(e){e.render(this,Gd)}}const zq=new ht;class jq extends ms{static get type(){return"RTTNode"}constructor(e,t=null,r=null,i={type:wr}){const s=new Do(t,r,i);super(s.texture,Wt()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=r,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new gf(new En),this.updateBeforeType=ot.RENDER}get autoResize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const r=e*this.pixelRatio,i=t*this.pixelRatio;this.renderTarget.setSize(r,i),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoResize===!0){const r=e.getPixelRatio(),i=e.getSize(zq),s=i.width*r,o=i.height*r;(s!==this.renderTarget.width||o!==this.renderTarget.height)&&(this.renderTarget.setSize(s,o),this.textureNeedsUpdate=!0)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new ms(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const _6=(n,...e)=>pe(new jq(pe(n),...e)),$q=(n,...e)=>n.isSampleNode||n.isTextureNode?n:n.isPassNode?n.getTextureNode():_6(n,...e),Al=ie(([n,e,t],r)=>{let i;r.renderer.coordinateSystem===Yl?(n=ge(n.x,n.y.oneMinus()).mul(2).sub(1),i=Ge(re(n,e),1)):i=Ge(re(n.x,n.y.oneMinus(),e).mul(2).sub(1),1);const s=Ge(t.mul(i));return s.xyz.div(s.w)}),Hq=ie(([n,e])=>{const t=e.mul(Ge(n,1)),r=t.xy.div(t.w).mul(.5).add(.5).toVar();return ge(r.x,r.y.oneMinus())}),Wq=ie(([n,e,t])=>{const r=Eo(bn(e)),i=Un(n.mul(r)).toVar(),s=bn(e,i).toVar(),o=bn(e,i.sub(Un(2,0))).toVar(),a=bn(e,i.sub(Un(1,0))).toVar(),c=bn(e,i.add(Un(1,0))).toVar(),f=bn(e,i.add(Un(2,0))).toVar(),p=bn(e,i.add(Un(0,2))).toVar(),g=bn(e,i.add(Un(0,1))).toVar(),v=bn(e,i.sub(Un(0,1))).toVar(),x=bn(e,i.sub(Un(0,2))).toVar(),T=tn(vt(z(2).mul(a).sub(o),s)).toVar(),S=tn(vt(z(2).mul(c).sub(f),s)).toVar(),R=tn(vt(z(2).mul(g).sub(p),s)).toVar(),C=tn(vt(z(2).mul(v).sub(x),s)).toVar(),B=Al(n,s,t).toVar(),D=T.lessThan(S).select(B.sub(Al(n.sub(ge(z(1).div(r.x),0)),a,t)),B.negate().add(Al(n.add(ge(z(1).div(r.x),0)),c,t))),F=R.lessThan(C).select(B.sub(Al(n.add(ge(0,z(1).div(r.y))),g,t)),B.negate().add(Al(n.sub(ge(0,z(1).div(r.y))),v,t)));return $s(af(D,F))});class Qq extends Oe{static get type(){return"SampleNode"}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}setup(){return this.sample(Wt())}sample(e){return this.callback(e)}}const Xq=(n,e=null)=>pe(new Qq(n,pe(e)));class Mo extends Oe{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===Mo.OBJECT?this.updateType=ot.OBJECT:e===Mo.MATERIAL&&(this.updateType=ot.RENDER)}update(e){this.callback(e)}}Mo.OBJECT="object";Mo.MATERIAL="material";const v6=(n,e)=>pe(new Mo(n,e)).toStack(),Yq=n=>v6(Mo.OBJECT,n),Kq=n=>v6(Mo.MATERIAL,n);class E0 extends xo{constructor(e,t,r=Float32Array){const i=ArrayBuffer.isView(e)?e:new r(e*t);super(i,t),this.isStorageInstancedBufferAttribute=!0}}class Zq extends Ii{constructor(e,t,r=Float32Array){const i=ArrayBuffer.isView(e)?e:new r(e*t);super(i,t),this.isStorageBufferAttribute=!0}}const Jq=(n,e="float")=>{let t,r;e.isStruct===!0?(t=e.layout.getLength(),r=_h("float")):(t=D4(e),r=_h(e));const i=new Zq(n,t,r);return xa(i,e,n)},eU=(n,e="float")=>{let t,r;e.isStruct===!0?(t=e.layout.getLength(),r=_h("float")):(t=D4(e),r=_h(e));const i=new E0(n,t,r);return xa(i,e,n)};class tU extends Oe{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const nU=Me(tU),Su=new lA,Vd=new gn;class Lr extends Oe{static get type(){return"SceneNode"}constructor(e=Lr.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,r=this.scene!==null?this.scene:e.scene;let i;return t===Lr.BACKGROUND_BLURRINESS?i=Xt("backgroundBlurriness","float",r):t===Lr.BACKGROUND_INTENSITY?i=Xt("backgroundIntensity","float",r):t===Lr.BACKGROUND_ROTATION&&(i=Ue("mat4").setName("backgroundRotation").setGroup(qe).onRenderUpdate(()=>{const s=r.background;return s!==null&&s.isTexture&&s.mapping!==QR?(Su.copy(r.backgroundRotation),Su.x*=-1,Su.y*=-1,Su.z*=-1,Vd.makeRotationFromEuler(Su)):Vd.identity(),Vd})),i}}Lr.BACKGROUND_BLURRINESS="backgroundBlurriness";Lr.BACKGROUND_INTENSITY="backgroundIntensity";Lr.BACKGROUND_ROTATION="backgroundRotation";const b6=Me(Lr,Lr.BACKGROUND_BLURRINESS),Wm=Me(Lr,Lr.BACKGROUND_INTENSITY),x6=Me(Lr,Lr.BACKGROUND_ROTATION);class rU extends ms{static get type(){return"StorageTextureNode"}constructor(e,t,r=null){super(e,t),this.storeNode=r,this.isStorageTextureNode=!0,this.access=nr.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}generate(e,t){let r;return this.storeNode!==null?r=this.generateStore(e):r=super.generate(e,t),r}toReadWrite(){return this.setAccess(nr.READ_WRITE)}toReadOnly(){return this.setAccess(nr.READ_ONLY)}toWriteOnly(){return this.setAccess(nr.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:r,storeNode:i,depthNode:s}=t,o=super.generate(e,"property"),a=r.build(e,this.value.is3DTexture===!0?"uvec3":"uvec2"),c=i.build(e,"vec4"),f=s?s.build(e,"int"):null,p=e.generateTextureStore(e,o,a,f,c);e.addLineFlowCode(p,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e}}const T6=Ye(rU).setParameterLength(1,3),iU=(n,e,t)=>{const r=T6(n,e,t);return t!==null&&r.toStack(),r},sU=ie(({texture:n,uv:e})=>{const r=re().toVar();return We(e.x.lessThan(1e-4),()=>{r.assign(re(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{r.assign(re(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{r.assign(re(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{r.assign(re(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{r.assign(re(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{r.assign(re(0,0,-1))}).Else(()=>{const s=n.sample(e.add(re(-.01,0,0))).r.sub(n.sample(e.add(re(.01,0,0))).r),o=n.sample(e.add(re(0,-.01,0))).r.sub(n.sample(e.add(re(0,.01,0))).r),a=n.sample(e.add(re(0,0,-.01))).r.sub(n.sample(e.add(re(0,0,.01))).r);r.assign(re(s,o,a))}),r.normalize()});class oU extends ms{static get type(){return"Texture3DNode"}constructor(e,t=null,r=null){super(e,t,r),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return re(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return e.isFlipY()&&(r.isRenderTargetTexture===!0||r.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(X(Eo(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return sU({texture:this,uv:e})}}const w6=Ye(oU).setParameterLength(1,3);class aU extends Af{static get type(){return"UserDataNode"}constructor(e,t,r=null){super(e,t,r),this.userData=r}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const lU=(n,e,t)=>pe(new aU(n,e,t)),o3=new WeakMap;class uU extends Rn{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=ot.OBJECT,this.updateAfterType=ot.OBJECT,this.previousModelWorldMatrix=Ue(new gn),this.previousProjectionMatrix=Ue(new gn).setGroup(qe),this.previousCameraViewMatrix=Ue(new gn)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:r}){const i=a3(r);this.previousModelWorldMatrix.value.copy(i);const s=S6(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new gn,s.previousCameraViewMatrix=new gn,s.currentProjectionMatrix=new gn,s.currentCameraViewMatrix=new gn,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){a3(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?Zl:Ue(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),r=e.mul(Pa).mul(wn),i=this.previousProjectionMatrix.mul(t).mul(Eh),s=r.xy.div(r.w),o=i.xy.div(i.w);return vt(s,o)}}function S6(n){let e=o3.get(n);return e===void 0&&(e={},o3.set(n,e)),e}function a3(n,e=0){const t=S6(n);let r=t[e];return r===void 0&&(t[e]=r=new gn,t[e].copy(n.matrixWorld)),r}const AU=Me(uU),cU=ie(([n])=>a2(n.rgb)),hU=ie(([n,e=z(1)])=>e.mix(a2(n.rgb),n.rgb)),fU=ie(([n,e=z(1)])=>{const t=Pn(n.r,n.g,n.b).div(3),r=n.r.max(n.g.max(n.b)),i=r.sub(t).mul(e).mul(-3);return Nt(n.rgb,r,i)}),dU=ie(([n,e=z(1)])=>{const t=re(.57735,.57735,.57735),r=e.cos();return re(n.rgb.mul(r).add(t.cross(n.rgb).mul(e.sin()).add(t.mul(Lo(t,n.rgb).mul(r.oneMinus())))))}),a2=(n,e=re(Tn.getLuminanceCoefficients(new we)))=>Lo(n,e),pU=ie(([n,e=re(1),t=re(0),r=re(1),i=z(1),s=re(Tn.getLuminanceCoefficients(new we,ix))])=>{const o=n.rgb.dot(re(s)),a=_n(n.rgb.mul(e).add(t),0).toVar(),c=a.pow(r).toVar();return We(a.r.greaterThan(0),()=>{a.r.assign(c.r)}),We(a.g.greaterThan(0),()=>{a.g.assign(c.g)}),We(a.b.greaterThan(0),()=>{a.b.assign(c.b)}),a.assign(o.add(a.sub(o).mul(i))),Ge(a.rgb,n.a)});class mU extends Rn{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const gU=Ye(mU).setParameterLength(2),Oc=new ht;class E6 extends ms{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class l3 extends E6{static get type(){return"PassMultipleTextureNode"}constructor(e,t,r=!1){super(e,null),this.textureName=t,this.previousTexture=r}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}class gs extends Rn{static get type(){return"PassNode"}constructor(e,t,r,i={}){super("vec4"),this.scope=e,this.scene=t,this.camera=r,this.options=i,this._pixelRatio=1,this._width=1,this._height=1;const s=new qi;s.isRenderTargetTexture=!0,s.name="depth";const o=new Do(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:wr,...i});o.texture.name="output",o.depthTexture=s,this.renderTarget=o,this._textures={output:o.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Ue(0),this._cameraFar=Ue(0),this._mrt=null,this._layers=null,this._resolution=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=ot.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const r=this._textures[e],i=this.renderTarget.textures.indexOf(r);this.renderTarget.textures[i]=t,this._textures[e]=t,this._previousTextures[e]=r,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=pe(new l3(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=pe(new l3(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const r=this._cameraNear,i=this._cameraFar;this._viewZNodes[e]=t=Q1(this.getTextureNode(e),r,i)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const r=this._cameraNear,i=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=Cl(s,r,i)}return t}async compileAsync(e){const t=e.getRenderTarget(),r=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(r)}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getColorBufferType(),this.scope===gs.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:r}=this;let i,s;const o=t.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(s=1,i=t.xr.getCamera(),t.xr.updateCamera(i),Oc.set(o.width,o.height)):(i=this.camera,s=t.getPixelRatio(),t.getSize(Oc)),this._pixelRatio=s,this.setSize(Oc.width,Oc.height);const a=t.getRenderTarget(),c=t.getMRT(),f=i.layers.mask;this._cameraNear.value=i.near,this._cameraFar.value=i.far,this._layers!==null&&(i.layers.mask=this._layers.mask);for(const p in this._previousTextures)this.toggleTexture(p);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(r,i),t.setRenderTarget(a),t.setMRT(c),i.layers.mask=f}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio*this._resolution,i=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(r,i),this._scissor!==null&&this.renderTarget.scissor.copy(this._scissor),this._viewport!==null&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,r,i){e===null?this._scissor=null:(this._scissor===null&&(this._scissor=new Ft),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,r,i),this._scissor.multiplyScalar(this._pixelRatio*this._resolution).floor())}setViewport(e,t,r,i){e===null?this._viewport=null:(this._viewport===null&&(this._viewport=new Ft),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,r,i),this._viewport.multiplyScalar(this._pixelRatio*this._resolution).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}gs.COLOR="color";gs.DEPTH="depth";const yU=(n,e,t)=>pe(new gs(gs.COLOR,n,e,t)),_U=(n,e)=>pe(new E6(n,e)),vU=(n,e,t)=>pe(new gs(gs.DEPTH,n,e,t));class bU extends gs{static get type(){return"ToonOutlinePassNode"}constructor(e,t,r,i,s){super(gs.COLOR,e,t),this.colorNode=r,this.thicknessNode=i,this.alphaNode=s,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,r=t.getRenderObjectFunction();t.setRenderObjectFunction((i,s,o,a,c,f,p,g)=>{if((c.isMeshToonMaterial||c.isMeshToonNodeMaterial)&&c.wireframe===!1){const v=this._getOutlineMaterial(c);t.renderObject(i,s,o,a,v,f,p,g)}t.renderObject(i,s,o,a,c,f,p,g)}),super.updateBefore(e),t.setRenderObjectFunction(r)}_createMaterial(){const e=new En;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=hr;const t=Ir.negate(),r=Zl.mul(Pa),i=z(1),s=r.mul(Ge(wn,1)),o=r.mul(Ge(wn.add(t),1)),a=$s(s.sub(o));return e.vertexNode=s.add(a.mul(this.thicknessNode).mul(s.w).mul(i)),e.colorNode=Ge(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const xU=(n,e,t=new Gn(0,0,0),r=.003,i=1)=>pe(new bU(n,e,pe(t),pe(r),pe(i))),R6=ie(([n,e])=>n.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),N6=ie(([n,e])=>(n=n.mul(e),n.div(n.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),C6=ie(([n,e])=>{n=n.mul(e),n=n.sub(.004).max(0);const t=n.mul(n.mul(6.2).add(.5)),r=n.mul(n.mul(6.2).add(1.7)).add(.06);return t.div(r).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),TU=ie(([n])=>{const e=n.mul(n.add(.0245786)).sub(90537e-9),t=n.mul(n.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),M6=ie(([n,e])=>{const t=pr(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),r=pr(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return n=n.mul(e).div(.6),n=t.mul(n),n=TU(n),n=r.mul(n),n.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),wU=pr(re(1.6605,-.1246,-.0182),re(-.5876,1.1329,-.1006),re(-.0728,-.0083,1.1187)),SU=pr(re(.6274,.0691,.0164),re(.3293,.9195,.088),re(.0433,.0113,.8956)),EU=ie(([n])=>{const e=re(n).toVar(),t=re(e.mul(e)).toVar(),r=re(t.mul(t)).toVar();return z(15.5).mul(r.mul(t)).sub(Je(40.14,r.mul(e))).add(Je(31.96,r).sub(Je(6.868,t.mul(e))).add(Je(.4298,t).add(Je(.1191,e).sub(.00232))))}),P6=ie(([n,e])=>{const t=re(n).toVar(),r=pr(re(.856627153315983,.137318972929847,.11189821299995),re(.0951212405381588,.761241990602591,.0767994186031903),re(.0482516061458583,.101439036467562,.811302368396859)),i=pr(re(1.1271005818144368,-.1413297634984383,-.14132976349843826),re(-.11060664309660323,1.157823702216272,-.11060664309660294),re(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=z(-12.47393),o=z(4.026069);return t.mulAssign(e),t.assign(SU.mul(t)),t.assign(r.mul(t)),t.assign(_n(t,1e-10)),t.assign(ls(t)),t.assign(t.sub(s).div(o.sub(s))),t.assign(_i(t,0,1)),t.assign(EU(t)),t.assign(i.mul(t)),t.assign(Ai(_n(re(0),t),re(2.2))),t.assign(wU.mul(t)),t.assign(_i(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),B6=ie(([n,e])=>{const t=z(.76),r=z(.15);n=n.mul(e);const i=Fr(n.r,Fr(n.g,n.b)),s=Xn(i.lessThan(.08),i.sub(Je(6.25,i.mul(i))),.04);n.subAssign(s);const o=_n(n.r,_n(n.g,n.b));We(o.lessThan(t),()=>n);const a=vt(1,t),c=vt(1,a.mul(a).div(o.add(a.sub(t))));n.mulAssign(c.div(o));const f=vt(1,Kr(1,r.mul(o.sub(c)).add(1)));return Nt(n,re(c),f)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class ur extends Oe{static get type(){return"CodeNode"}constructor(e="",t=[],r=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=r}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const i of t)i.build(e);const r=e.getCodeFromNode(this,this.getNodeType(e));return r.code=this.code,r.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const yf=Ye(ur).setParameterLength(1,3),RU=(n,e)=>yf(n,e,"js"),NU=(n,e)=>yf(n,e,"wgsl"),CU=(n,e)=>yf(n,e,"glsl");class D6 extends ur{static get type(){return"FunctionNode"}constructor(e="",t=[],r=""){super(e,t,r)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let r=t.nodeFunction;return r===void 0&&(r=e.parser.parseFunction(this.code),t.nodeFunction=r),r}generate(e,t){super.generate(e);const r=this.getNodeFunction(e),i=r.name,s=r.type,o=e.getCodeFromNode(this,s);i!==""&&(o.name=i);const a=e.getPropertyName(o),c=this.getNodeFunction(e).getCode(a);return o.code=c+`
`,t==="property"?a:e.format(`${a}()`,s,t)}}const L6=(n,e=[],t="")=>{for(let s=0;s<e.length;s++){const o=e[s];typeof o=="function"&&(e[s]=o.functionNode)}const r=pe(new D6(n,e,t)),i=(...s)=>r.call(...s);return i.functionNode=r,i},MU=(n,e)=>L6(n,e,"glsl"),PU=(n,e)=>L6(n,e,"wgsl");class BU extends Oe{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new gg,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:z()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=O4(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;e.value!==null&&(e.inputType==="ArrayBuffer"?t=F4(e.value):e.inputType==="Texture"?t=e.meta.textures[e.value]:t=e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const R0=Ye(BU).setParameterLength(1);class O6 extends Map{get(e,t=null,...r){if(this.has(e))return super.get(e);if(t!==null){const i=t(...r);return this.set(e,i),i}}}class DU{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const N0=new O6;class LU extends Oe{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new O6,this._output=R0(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const r=this._outputs;return r[e]===void 0?r[e]=R0(t):r[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const r=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),r[e]=t,r[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),r[e]=t,r[e].events.addEventListener("refresh",this.onRefresh)):r[e]===void 0?(r[e]=R0(t),r[e].events.addEventListener("refresh",this.onRefresh)):r[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const i=this.getObject()[e];if(typeof i=="function")return i(...t)}async callAsync(e,...t){const i=this.getObject()[e];if(typeof i=="function")return i.constructor.name==="AsyncFunction"?await i(...t):i(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),t=(f,p)=>this.setOutput(f,p),r=new DU(this),i=N0.get("THREE"),s=N0.get("TSL"),o=this.getMethod(),a=[r,this._local,N0,e,t,i,s];this._object=o(...a);const c=this._object.layout;if(c&&(c.cache===!1&&this._local.clear(),this._output.outputType=c.outputType||null,Array.isArray(c.elements)))for(const f of c.elements){const p=f.id||f.name;f.inputType&&(this.getParameter(p)===void 0&&this.setParameter(p,null),this.getParameter(p).inputType=f.inputType),f.outputType&&(this.getOutput(p)===void 0&&this.setOutput(p,null),this.getOutput(p).outputType=f.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let r=this.parameters[t];r.isScriptableNode&&(r=r.getDefaultOutput()),r.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:z()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],r=["layout","init","main","dispose"].join(", "),i="var "+r+`; var output = {};
`,s=`
return { ...output, `+r+" };",o=i+this.codeNode.code+s;return this._method=new Function(...e,o),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[M4(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const r in this.parameters)t.push(this.parameters[r].getCacheKey(e));return Hh(t)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const OU=Ye(LU).setParameterLength(1,2);function F6(n){let e;const t=n.context.getViewZ;return t!==void 0&&(e=t(this)),(e||Sn.z).negate()}const l2=ie(([n,e],t)=>{const r=F6(t);return ps(n,e,r)}),u2=ie(([n],e)=>{const t=F6(e);return n.mul(n,t,t).negate().exp().oneMinus()}),NA=ie(([n,e])=>Ge(e.toFloat().mix(Rl.rgb,n.toVec3()),Rl.a));function FU(n,e,t){return NA(n,l2(e,t))}function IU(n,e){return NA(n,u2(e))}let Ko=null,Zo=null;class kU extends Oe{static get type(){return"RangeNode"}constructor(e=z(),t=z()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(bo(this.minNode.value)),r=e.getTypeLength(bo(this.maxNode.value));return t>r?t:r}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let r=null;if(t.count>1){const i=this.minNode.value,s=this.maxNode.value,o=e.getTypeLength(bo(i)),a=e.getTypeLength(bo(s));Ko=Ko||new Ft,Zo=Zo||new Ft,Ko.setScalar(0),Zo.setScalar(0),o===1?Ko.setScalar(i):i.isColor?Ko.set(i.r,i.g,i.b,1):Ko.set(i.x,i.y,i.z||0,i.w||0),a===1?Zo.setScalar(s):s.isColor?Zo.set(s.r,s.g,s.b,1):Zo.set(s.x,s.y,s.z||0,s.w||0);const c=4,f=c*t.count,p=new Float32Array(f);for(let v=0;v<f;v++){const x=v%c,T=Ko.getComponent(x),S=Zo.getComponent(x);p[v]=Dl.lerp(T,S,Math.random())}const g=this.getNodeType(e);if(t.count<=4096)r=GA(p,"vec4",t.count).element(Ro).convert(g);else{const v=new xo(p,4);e.geometry.setAttribute("__range"+this.id,v),r=Sh(v).convert(g)}}else r=z(0);return r}}const qU=Ye(kU).setParameterLength(2);class UU extends Oe{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const r=this.getBuiltinName(e),i=this.getNodeType(e);return e.shaderStage==="compute"?e.format(r,i,t):e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const WA=(n,e)=>pe(new UU(n,e)),GU=WA("numWorkgroups","uvec3"),VU=WA("workgroupId","uvec3"),zU=WA("globalId","uvec3"),jU=WA("localId","uvec3"),$U=WA("subgroupSize","uint");class HU extends Oe{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:r}=e;r.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const A2=Ye(HU),WU=()=>A2("workgroup").toStack(),QU=()=>A2("storage").toStack(),XU=()=>A2("texture").toStack();class YU extends Ma{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let r;const i=e.context.assign;if(r=super.generate(e),i!==!0){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}class KU extends Oe{constructor(e,t,r=0){super(t),this.bufferType=t,this.bufferCount=r,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return pe(new YU(this,e))}generate(e){const t=this.name!==""?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const ZU=(n,e)=>pe(new KU("Workgroup",n,e));class zn extends Oe{static get type(){return"AtomicFunctionNode"}constructor(e,t,r){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=r,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),r=t.parents,i=this.method,s=this.getNodeType(e),o=this.getInputType(e),a=this.pointerNode,c=this.valueNode,f=[];f.push(`&${a.build(e,o)}`),c!==null&&f.push(c.build(e,o));const p=`${e.getMethod(i,s)}( ${f.join(", ")} )`;if(r?r.length===1&&r[0].isStackNode===!0:!1)e.addLineFlowCode(p,this);else return t.constNode===void 0&&(t.constNode=Hs(p,s).toConst()),t.constNode.build(e)}}zn.ATOMIC_LOAD="atomicLoad";zn.ATOMIC_STORE="atomicStore";zn.ATOMIC_ADD="atomicAdd";zn.ATOMIC_SUB="atomicSub";zn.ATOMIC_MAX="atomicMax";zn.ATOMIC_MIN="atomicMin";zn.ATOMIC_AND="atomicAnd";zn.ATOMIC_OR="atomicOr";zn.ATOMIC_XOR="atomicXor";const JU=Ye(zn),Ts=(n,e,t)=>JU(n,e,t).toStack(),eG=n=>Ts(zn.ATOMIC_LOAD,n,null),tG=(n,e)=>Ts(zn.ATOMIC_STORE,n,e),nG=(n,e)=>Ts(zn.ATOMIC_ADD,n,e),rG=(n,e)=>Ts(zn.ATOMIC_SUB,n,e),iG=(n,e)=>Ts(zn.ATOMIC_MAX,n,e),sG=(n,e)=>Ts(zn.ATOMIC_MIN,n,e),oG=(n,e)=>Ts(zn.ATOMIC_AND,n,e),aG=(n,e)=>Ts(zn.ATOMIC_OR,n,e),lG=(n,e)=>Ts(zn.ATOMIC_XOR,n,e);class Pe extends Rn{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=r}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,r=this.bNode?this.bNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(r)?0:e.getTypeLength(r);return i>s?t:r}getNodeType(e){const t=this.method;return t===Pe.SUBGROUP_ELECT?"bool":t===Pe.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const r=this.method,i=this.getNodeType(e),s=this.getInputType(e),o=this.aNode,a=this.bNode,c=[];if(r===Pe.SUBGROUP_BROADCAST||r===Pe.SUBGROUP_SHUFFLE||r===Pe.QUAD_BROADCAST){const p=a.getNodeType(e);c.push(o.build(e,i),a.build(e,p==="float"?"int":i))}else r===Pe.SUBGROUP_SHUFFLE_XOR||r===Pe.SUBGROUP_SHUFFLE_DOWN||r===Pe.SUBGROUP_SHUFFLE_UP?c.push(o.build(e,i),a.build(e,"uint")):(o!==null&&c.push(o.build(e,s)),a!==null&&c.push(a.build(e,s)));const f=c.length===0?"()":`( ${c.join(", ")} )`;return e.format(`${e.getMethod(r,i)}${f}`,i,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Pe.SUBGROUP_ELECT="subgroupElect";Pe.SUBGROUP_BALLOT="subgroupBallot";Pe.SUBGROUP_ADD="subgroupAdd";Pe.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd";Pe.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd";Pe.SUBGROUP_MUL="subgroupMul";Pe.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul";Pe.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul";Pe.SUBGROUP_AND="subgroupAnd";Pe.SUBGROUP_OR="subgroupOr";Pe.SUBGROUP_XOR="subgroupXor";Pe.SUBGROUP_MIN="subgroupMin";Pe.SUBGROUP_MAX="subgroupMax";Pe.SUBGROUP_ALL="subgroupAll";Pe.SUBGROUP_ANY="subgroupAny";Pe.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst";Pe.QUAD_SWAP_X="quadSwapX";Pe.QUAD_SWAP_Y="quadSwapY";Pe.QUAD_SWAP_DIAGONAL="quadSwapDiagonal";Pe.SUBGROUP_BROADCAST="subgroupBroadcast";Pe.SUBGROUP_SHUFFLE="subgroupShuffle";Pe.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor";Pe.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp";Pe.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown";Pe.QUAD_BROADCAST="quadBroadcast";const uG=Ne(Pe,Pe.SUBGROUP_ELECT).setParameterLength(0),AG=Ne(Pe,Pe.SUBGROUP_BALLOT).setParameterLength(1),cG=Ne(Pe,Pe.SUBGROUP_ADD).setParameterLength(1),hG=Ne(Pe,Pe.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),fG=Ne(Pe,Pe.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),dG=Ne(Pe,Pe.SUBGROUP_MUL).setParameterLength(1),pG=Ne(Pe,Pe.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),mG=Ne(Pe,Pe.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),gG=Ne(Pe,Pe.SUBGROUP_AND).setParameterLength(1),yG=Ne(Pe,Pe.SUBGROUP_OR).setParameterLength(1),_G=Ne(Pe,Pe.SUBGROUP_XOR).setParameterLength(1),vG=Ne(Pe,Pe.SUBGROUP_MIN).setParameterLength(1),bG=Ne(Pe,Pe.SUBGROUP_MAX).setParameterLength(1),xG=Ne(Pe,Pe.SUBGROUP_ALL).setParameterLength(0),TG=Ne(Pe,Pe.SUBGROUP_ANY).setParameterLength(0),wG=Ne(Pe,Pe.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),SG=Ne(Pe,Pe.QUAD_SWAP_X).setParameterLength(1),EG=Ne(Pe,Pe.QUAD_SWAP_Y).setParameterLength(1),RG=Ne(Pe,Pe.QUAD_SWAP_DIAGONAL).setParameterLength(1),NG=Ne(Pe,Pe.SUBGROUP_BROADCAST).setParameterLength(2),CG=Ne(Pe,Pe.SUBGROUP_SHUFFLE).setParameterLength(2),MG=Ne(Pe,Pe.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),PG=Ne(Pe,Pe.SUBGROUP_SHUFFLE_UP).setParameterLength(2),BG=Ne(Pe,Pe.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),DG=Ne(Pe,Pe.QUAD_BROADCAST).setParameterLength(1);let Fc;function _f(n){Fc=Fc||new WeakMap;let e=Fc.get(n);return e===void 0&&Fc.set(n,e={}),e}function vf(n){const e=_f(n);return e.shadowMatrix||(e.shadowMatrix=Ue("mat4").setGroup(qe).onRenderUpdate(t=>((n.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&n.shadow.updateMatrices(n),n.shadow.matrix)))}function I6(n,e=cs){const t=vf(n).mul(e);return t.xyz.div(t.w)}function c2(n){const e=_f(n);return e.position||(e.position=Ue(new we).setGroup(qe).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(n.matrixWorld)))}function k6(n){const e=_f(n);return e.targetPosition||(e.targetPosition=Ue(new we).setGroup(qe).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(n.target.matrixWorld)))}function h2(n){const e=_f(n);return e.viewPosition||(e.viewPosition=Ue(new we).setGroup(qe).onRenderUpdate(({camera:t},r)=>{r.value=r.value||new we,r.value.setFromMatrixPosition(n.matrixWorld),r.value.applyMatrix4(t.matrixWorldInverse)}))}const f2=n=>wi.transformDirection(c2(n).sub(k6(n))),LG=n=>n.sort((e,t)=>e.id-t.id),OG=(n,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===n)return t;return null},zd=new WeakMap,Eu=[];class d2 extends Oe{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Is("vec3","totalDiffuse"),this.totalSpecularNode=Is("vec3","totalSpecular"),this.outgoingLightNode=Is("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let r=0;r<e.length;r++){const i=e[r];if(Eu.push(i.id),Eu.push(i.castShadow?1:0),i.isSpotLight===!0){const s=i.map!==null?i.map.id:-1,o=i.colorNode?i.colorNode.getCacheKey():-1;Eu.push(s,o)}}const t=Hh(Eu);return Eu.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const r of this._lightNodes)t.push(r.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const r of t.nodes)r.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],r=this._lightNodes,i=LG(this._lights),s=e.renderer.library;for(const o of i)if(o.isNode)t.push(pe(o));else{let a=null;if(r!==null&&(a=OG(o.id,r)),a===null){const c=s.getLightNodeClass(o.constructor);if(c===null)continue;let f=null;zd.has(o)?f=zd.get(o):(f=pe(new c(o)),zd.set(o,f)),t.push(f)}}this._lightNodes=t}setupDirectLight(e,t,r){const{lightingModel:i,reflectedLight:s}=e.context;i.direct({...r,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,r){const{lightingModel:i,reflectedLight:s}=e.context;i.directRectArea({...r,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const r of t)r.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let r=this.outgoingLightNode;const i=e.context,s=i.lightingModel,o=e.getNodeProperties(this);if(s){const{totalDiffuseNode:a,totalSpecularNode:c}=this;i.outgoingLight=r;const f=e.addStack();o.nodes=f.nodes,s.start(e);const{backdrop:p,backdropAlpha:g}=i,{directDiffuse:v,directSpecular:x,indirectDiffuse:T,indirectSpecular:S}=i.reflectedLight;let R=v.add(T);p!==null&&(g!==null?R=re(g.mix(R,p)):R=re(p),i.material.transparent=!0),a.assign(R),c.assign(x.add(S)),r.assign(a.add(c)),s.finish(e),r=r.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=t,r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const FG=(n=[])=>pe(new d2).setLights(n);class IG extends Oe{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=ot.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){p2.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||cs)}}const p2=Is("vec3","shadowPositionWorld");function kG(n,e={}){return e.toneMapping=n.toneMapping,e.toneMappingExposure=n.toneMappingExposure,e.outputColorSpace=n.outputColorSpace,e.renderTarget=n.getRenderTarget(),e.activeCubeFace=n.getActiveCubeFace(),e.activeMipmapLevel=n.getActiveMipmapLevel(),e.renderObjectFunction=n.getRenderObjectFunction(),e.pixelRatio=n.getPixelRatio(),e.mrt=n.getMRT(),e.clearColor=n.getClearColor(e.clearColor||new Gn),e.clearAlpha=n.getClearAlpha(),e.autoClear=n.autoClear,e.scissorTest=n.getScissorTest(),e}function qG(n,e){return e=kG(n,e),n.setMRT(null),n.setRenderObjectFunction(null),n.setClearColor(0,1),n.autoClear=!0,e}function UG(n,e){n.toneMapping=e.toneMapping,n.toneMappingExposure=e.toneMappingExposure,n.outputColorSpace=e.outputColorSpace,n.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),n.setRenderObjectFunction(e.renderObjectFunction),n.setPixelRatio(e.pixelRatio),n.setMRT(e.mrt),n.setClearColor(e.clearColor,e.clearAlpha),n.autoClear=e.autoClear,n.setScissorTest(e.scissorTest)}function GG(n,e={}){return e.background=n.background,e.backgroundNode=n.backgroundNode,e.overrideMaterial=n.overrideMaterial,e}function VG(n,e){return e=GG(n,e),n.background=null,n.backgroundNode=null,n.overrideMaterial=null,e}function zG(n,e){n.background=e.background,n.backgroundNode=e.backgroundNode,n.overrideMaterial=e.overrideMaterial}function jG(n,e,t){return t=qG(n,t),t=VG(e,t),t}function $G(n,e,t){UG(n,t),zG(e,t)}const u3=new WeakMap,q6=ie(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{let r=_t(n,e.xy).setName("t_basic");return n.isArrayTexture&&(r=r.depth(t)),r.compare(e.z)}),U6=ie(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:r})=>{const i=(R,C)=>{let B=_t(n,R);return n.isArrayTexture&&(B=B.depth(r)),B.compare(C)},s=Xt("mapSize","vec2",t).setGroup(qe),o=Xt("radius","float",t).setGroup(qe),a=ge(1).div(s),c=a.x.negate().mul(o),f=a.y.negate().mul(o),p=a.x.mul(o),g=a.y.mul(o),v=c.div(2),x=f.div(2),T=p.div(2),S=g.div(2);return Pn(i(e.xy.add(ge(c,f)),e.z),i(e.xy.add(ge(0,f)),e.z),i(e.xy.add(ge(p,f)),e.z),i(e.xy.add(ge(v,x)),e.z),i(e.xy.add(ge(0,x)),e.z),i(e.xy.add(ge(T,x)),e.z),i(e.xy.add(ge(c,0)),e.z),i(e.xy.add(ge(v,0)),e.z),i(e.xy,e.z),i(e.xy.add(ge(T,0)),e.z),i(e.xy.add(ge(p,0)),e.z),i(e.xy.add(ge(v,S)),e.z),i(e.xy.add(ge(0,S)),e.z),i(e.xy.add(ge(T,S)),e.z),i(e.xy.add(ge(c,g)),e.z),i(e.xy.add(ge(0,g)),e.z),i(e.xy.add(ge(p,g)),e.z)).mul(1/17)}),G6=ie(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:r})=>{const i=(g,v)=>{let x=_t(n,g);return n.isArrayTexture&&(x=x.depth(r)),x.compare(v)},s=Xt("mapSize","vec2",t).setGroup(qe),o=ge(1).div(s),a=o.x,c=o.y,f=e.xy,p=Xs(f.mul(s).add(.5));return f.subAssign(p.mul(o)),Pn(i(f,e.z),i(f.add(ge(a,0)),e.z),i(f.add(ge(0,c)),e.z),i(f.add(o),e.z),Nt(i(f.add(ge(a.negate(),0)),e.z),i(f.add(ge(a.mul(2),0)),e.z),p.x),Nt(i(f.add(ge(a.negate(),c)),e.z),i(f.add(ge(a.mul(2),c)),e.z),p.x),Nt(i(f.add(ge(0,c.negate())),e.z),i(f.add(ge(0,c.mul(2))),e.z),p.y),Nt(i(f.add(ge(a,c.negate())),e.z),i(f.add(ge(a,c.mul(2))),e.z),p.y),Nt(Nt(i(f.add(ge(a.negate(),c.negate())),e.z),i(f.add(ge(a.mul(2),c.negate())),e.z),p.x),Nt(i(f.add(ge(a.negate(),c.mul(2))),e.z),i(f.add(ge(a.mul(2),c.mul(2))),e.z),p.x),p.y)).mul(1/9)}),V6=ie(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{const r=z(1).toVar();let i=_t(n).sample(e.xy);n.isArrayTexture&&(i=i.depth(t)),i=i.rg;const s=of(e.z,i.x);return We(s.notEqual(z(1)),()=>{const o=e.z.sub(i.x),a=_n(0,i.y.mul(i.y));let c=a.div(a.add(o.mul(o)));c=_i(vt(c,.3).div(.95-.3)),r.assign(_i(_n(s,c)))}),r}),HG=ie(([n,e,t])=>{let r=cs.sub(n).length();return r=r.sub(e).div(t.sub(e)),r=r.saturate(),r}),WG=n=>{const e=n.shadow.camera,t=Xt("near","float",e).setGroup(qe),r=Xt("far","float",e).setGroup(qe),i=w8(n);return HG(i,t,r)},z6=n=>{let e=u3.get(n);if(e===void 0){const t=n.isPointLight?WG(n):null;e=new En,e.colorNode=Ge(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,u3.set(n,e)}return e},A3=new Gi,el=[],j6=(n,e,t,r)=>{el[0]=n,el[1]=e;let i=A3.get(el);return(i===void 0||i.shadowType!==t||i.useVelocity!==r)&&(i=(s,o,a,c,f,p,...g)=>{(s.castShadow===!0||s.receiveShadow&&t===A0)&&(r&&(L4(s).useVelocity=!0),s.onBeforeShadow(n,s,a,e.camera,c,o.overrideMaterial,p),n.renderObject(s,o,a,c,f,p,...g),s.onAfterShadow(n,s,a,e.camera,c,o.overrideMaterial,p))},i.shadowType=t,i.useVelocity=r,A3.set(el,i)),el[0]=null,el[1]=null,i},QG=ie(({samples:n,radius:e,size:t,shadowPass:r,depthLayer:i})=>{const s=z(0).toVar("meanVertical"),o=z(0).toVar("squareMeanVertical"),a=n.lessThanEqual(z(1)).select(z(0),z(2).div(n.sub(1))),c=n.lessThanEqual(z(1)).select(z(0),z(-1));Vt({start:X(0),end:X(n),type:"int",condition:"<"},({i:p})=>{const g=c.add(z(p).mul(a));let v=r.sample(Pn(VA.xy,ge(0,g).mul(e)).div(t));r.value.isArrayTexture&&(v=v.depth(i)),v=v.x,s.addAssign(v),o.addAssign(v.mul(v))}),s.divAssign(n),o.divAssign(n);const f=bs(o.sub(s.mul(s)));return ge(s,f)}),XG=ie(({samples:n,radius:e,size:t,shadowPass:r,depthLayer:i})=>{const s=z(0).toVar("meanHorizontal"),o=z(0).toVar("squareMeanHorizontal"),a=n.lessThanEqual(z(1)).select(z(0),z(2).div(n.sub(1))),c=n.lessThanEqual(z(1)).select(z(0),z(-1));Vt({start:X(0),end:X(n),type:"int",condition:"<"},({i:p})=>{const g=c.add(z(p).mul(a));let v=r.sample(Pn(VA.xy,ge(g,0).mul(e)).div(t));r.value.isArrayTexture&&(v=v.depth(i)),s.addAssign(v.x),o.addAssign(Pn(v.y.mul(v.y),v.x.mul(v.x)))}),s.divAssign(n),o.divAssign(n);const f=bs(o.sub(s.mul(s)));return ge(s,f)}),YG=[q6,U6,G6,V6];let jd;const Ic=new gf;class $6 extends IG{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:r,shadowCoord:i,shadow:s,depthLayer:o}){const a=i.x.greaterThanEqual(0).and(i.x.lessThanEqual(1)).and(i.y.greaterThanEqual(0)).and(i.y.lessThanEqual(1)).and(i.z.lessThanEqual(1)),c=t({depthTexture:r,shadowCoord:i,shadow:s,depthLayer:o});return a.select(c,z(1))}setupShadowCoord(e,t){const{shadow:r}=this,{renderer:i}=e,s=Xt("bias","float",r).setGroup(qe);let o=t,a;if(r.camera.isOrthographicCamera||i.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),a=o.z,i.coordinateSystem===Yl&&(a=a.mul(2).sub(1));else{const c=o.w;o=o.xy.div(c);const f=Xt("near","float",r.camera).setGroup(qe),p=Xt("far","float",r.camera).setGroup(qe);a=X1(c.negate(),f,p)}return o=re(o.x,o.y.oneMinus(),a.add(s)),o}getShadowFilterFn(e){return YG[e]}setupRenderTarget(e,t){const r=new qi(e.mapSize.width,e.mapSize.height);r.name="ShadowDepthTexture",r.compareFunction=Sg;const i=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return i.texture.name="ShadowMap",i.texture.type=e.mapType,i.depthTexture=r,{shadowMap:i,depthTexture:r}}setupShadow(e){const{renderer:t}=e,{light:r,shadow:i}=this,s=t.shadowMap.type,{depthTexture:o,shadowMap:a}=this.setupRenderTarget(i,e);if(i.camera.updateProjectionMatrix(),s===A0&&i.isPointLightShadow!==!0){o.compareFunction=null,a.depth>1?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTarget(i.mapSize.width,i.mapSize.height,{format:ca,type:wr,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTarget(i.mapSize.width,i.mapSize.height,{format:ca,type:wr,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(i.mapSize.width,i.mapSize.height,{format:ca,type:wr,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(i.mapSize.width,i.mapSize.height,{format:ca,type:wr,depthBuffer:!1}));let C=_t(o);o.isArrayTexture&&(C=C.depth(this.depthLayer));let B=_t(this.vsmShadowMapVertical.texture);o.isArrayTexture&&(B=B.depth(this.depthLayer));const D=Xt("blurSamples","float",i).setGroup(qe),F=Xt("radius","float",i).setGroup(qe),I=Xt("mapSize","vec2",i).setGroup(qe);let q=this.vsmMaterialVertical||(this.vsmMaterialVertical=new En);q.fragmentNode=QG({samples:D,radius:F,size:I,shadowPass:C,depthLayer:this.depthLayer}).context(e.getSharedContext()),q.name="VSMVertical",q=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new En),q.fragmentNode=XG({samples:D,radius:F,size:I,shadowPass:B,depthLayer:this.depthLayer}).context(e.getSharedContext()),q.name="VSMHorizontal"}const c=Xt("intensity","float",i).setGroup(qe),f=Xt("normalBias","float",i).setGroup(qe),p=vf(r).mul(p2.add(Fo.mul(f))),g=this.setupShadowCoord(e,p),v=i.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(v===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const x=s===A0&&i.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:o,T=this.setupShadowFilter(e,{filterFn:v,shadowTexture:a.texture,depthTexture:x,shadowCoord:g,shadow:i,depthLayer:this.depthLayer});let S=_t(a.texture,g);o.isArrayTexture&&(S=S.depth(this.depthLayer));const R=Nt(1,T.rgb.mix(S,1),c.mul(S.a)).toVar();return this.shadowMap=a,this.shadow.map=a,R}setup(e){if(e.renderer.shadowMap.enabled!==!1)return ie(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode,e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:r,light:i}=this,{renderer:s,scene:o}=e;t.updateMatrices(i),r.setSize(t.mapSize.width,t.mapSize.height,r.depth),s.render(o,t.camera)}updateShadow(e){const{shadowMap:t,light:r,shadow:i}=this,{renderer:s,scene:o,camera:a}=e,c=s.shadowMap.type,f=t.depthTexture.version;this._depthVersionCached=f;const p=i.camera.layers.mask;(i.camera.layers.mask&4294967294)===0&&(i.camera.layers.mask=a.layers.mask);const g=s.getRenderObjectFunction(),v=s.getMRT(),x=v?v.has("velocity"):!1;jd=jG(s,o,jd),o.overrideMaterial=z6(r),s.setRenderObjectFunction(j6(s,i,c,x)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(g),c===A0&&i.isPointLightShadow!==!0&&this.vsmPass(s),i.camera.layers.mask=p,$G(s,o,jd)}vsmPass(e){const{shadow:t}=this,r=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,r),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,r),e.setRenderTarget(this.vsmShadowMapVertical),Ic.material=this.vsmMaterialVertical,Ic.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),Ic.material=this.vsmMaterialHorizontal,Ic.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let r=t.needsUpdate||t.autoUpdate;r&&(this._cameraFrameId[e.camera]===e.frameId&&(r=!1),this._cameraFrameId[e.camera]=e.frameId),r&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const H6=(n,e)=>pe(new $6(n,e)),KG=new Gn,Pi=ie(([n,e])=>{const t=n.toVar(),r=tn(t),i=Kr(1,_n(r.x,_n(r.y,r.z)));r.mulAssign(i),t.mulAssign(i.mul(e.mul(2).oneMinus()));const s=ge(t.xy).toVar(),a=e.mul(1.5).oneMinus();return We(r.z.greaterThanEqual(a),()=>{We(t.z.greaterThan(0),()=>{s.x.assign(vt(4,t.x))})}).ElseIf(r.x.greaterThanEqual(a),()=>{const c=RA(t.x);s.x.assign(t.z.mul(c).add(c.mul(2)))}).ElseIf(r.y.greaterThanEqual(a),()=>{const c=RA(t.y);s.x.assign(t.x.add(c.mul(2)).add(2)),s.y.assign(t.z.mul(c).sub(2))}),ge(.125,.25).mul(s).add(ge(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),W6=ie(({depthTexture:n,bd3D:e,dp:t,texelSize:r})=>_t(n,Pi(e,r.y)).compare(t)),Q6=ie(({depthTexture:n,bd3D:e,dp:t,texelSize:r,shadow:i})=>{const s=Xt("radius","float",i).setGroup(qe),o=ge(-1,1).mul(s).mul(r.y);return _t(n,Pi(e.add(o.xyy),r.y)).compare(t).add(_t(n,Pi(e.add(o.yyy),r.y)).compare(t)).add(_t(n,Pi(e.add(o.xyx),r.y)).compare(t)).add(_t(n,Pi(e.add(o.yyx),r.y)).compare(t)).add(_t(n,Pi(e,r.y)).compare(t)).add(_t(n,Pi(e.add(o.xxy),r.y)).compare(t)).add(_t(n,Pi(e.add(o.yxy),r.y)).compare(t)).add(_t(n,Pi(e.add(o.xxx),r.y)).compare(t)).add(_t(n,Pi(e.add(o.yxx),r.y)).compare(t)).mul(1/9)}),ZG=ie(({filterFn:n,depthTexture:e,shadowCoord:t,shadow:r})=>{const i=t.xyz.toVar(),s=i.length(),o=Ue("float").setGroup(qe).onRenderUpdate(()=>r.camera.near),a=Ue("float").setGroup(qe).onRenderUpdate(()=>r.camera.far),c=Xt("bias","float",r).setGroup(qe),f=Ue(r.mapSize).setGroup(qe),p=z(1).toVar();return We(s.sub(a).lessThanEqual(0).and(s.sub(o).greaterThanEqual(0)),()=>{const g=s.sub(o).div(a.sub(o)).toVar();g.addAssign(c);const v=i.normalize(),x=ge(1).div(f.mul(ge(4,2)));p.assign(n({depthTexture:e,bd3D:v,dp:g,texelSize:x,shadow:r}))}),p}),c3=new Ft,tl=new ht,Ru=new ht;class JG extends $6{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===KR?W6:Q6}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:r,depthTexture:i,shadowCoord:s,shadow:o}){return ZG({filterFn:t,shadowTexture:r,depthTexture:i,shadowCoord:s,shadow:o})}renderShadow(e){const{shadow:t,shadowMap:r,light:i}=this,{renderer:s,scene:o}=e,a=t.getFrameExtents();Ru.copy(t.mapSize),Ru.multiply(a),r.setSize(Ru.width,Ru.height),tl.copy(t.mapSize);const c=s.autoClear,f=s.getClearColor(KG),p=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha),s.clear();const g=t.getViewportCount();for(let v=0;v<g;v++){const x=t.getViewport(v),T=tl.x*x.x,S=Ru.y-tl.y-tl.y*x.y;c3.set(T,S,tl.x*x.z,tl.y*x.w),r.viewport.copy(c3),t.updateMatrices(i,v),s.render(o,t.camera)}s.autoClear=c,s.setClearColor(f,p)}}const X6=(n,e)=>pe(new JG(n,e));class Ba extends eu{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Gn,this.colorNode=e&&e.colorNode||Ue(this.color).setGroup(qe),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=ot.FRAME}getHash(){return this.light.uuid}getLightVector(e){return h2(this.light).sub(e.context.positionView||Sn)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return H6(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let r=this.shadowColorNode;if(r===null){const i=this.light.shadow.shadowNode;let s;i!==void 0?s=pe(i):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=r=this.colorNode.mul(s),this.baseColorNode=this.colorNode}this.colorNode=r}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),r=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),r&&e.lightsNode.setupDirectRectAreaLight(e,this,r)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const m2=ie(({lightDistance:n,cutoffDistance:e,decayExponent:t})=>{const r=n.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(r.mul(n.div(e).pow4().oneMinus().clamp().pow2()),r)}),Y6=({color:n,lightVector:e,cutoffDistance:t,decayExponent:r})=>{const i=e.normalize(),s=e.length(),o=m2({lightDistance:s,cutoffDistance:t,decayExponent:r}),a=n.mul(o);return{lightDirection:i,lightColor:a}};class eV extends Ba{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Ue(0).setGroup(qe),this.decayExponentNode=Ue(2).setGroup(qe)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return X6(this.light)}setupDirect(e){return Y6({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const tV=ie(([n=Wt()])=>{const e=n.mul(2),t=e.x.floor(),r=e.y.floor();return t.add(r).mod(2).sign()}),nV=ie(([n=Wt()],{renderer:e,material:t})=>{const r=T1(n.mul(2).sub(1));let i;if(t.alphaToCoverage&&e.samples>1){const s=z(r.fwidth()).toVar();i=ps(s.oneMinus(),s.add(1),r).oneMinus()}else i=Xn(r.greaterThan(1),0,1);return i}),iA=ie(([n,e,t])=>{const r=z(t).toVar(),i=z(e).toVar(),s=yi(n).toVar();return Xn(s,i,r)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),Ch=ie(([n,e])=>{const t=yi(e).toVar(),r=z(n).toVar();return Xn(t,r.negate(),r)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),Mn=ie(([n])=>{const e=z(n).toVar();return X(us(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),ln=ie(([n,e])=>{const t=z(n).toVar();return e.assign(Mn(t)),t.sub(z(e))}),rV=ie(([n,e,t,r,i,s])=>{const o=z(s).toVar(),a=z(i).toVar(),c=z(r).toVar(),f=z(t).toVar(),p=z(e).toVar(),g=z(n).toVar(),v=z(vt(1,a)).toVar();return vt(1,o).mul(g.mul(v).add(p.mul(a))).add(o.mul(f.mul(v).add(c.mul(a))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),iV=ie(([n,e,t,r,i,s])=>{const o=z(s).toVar(),a=z(i).toVar(),c=re(r).toVar(),f=re(t).toVar(),p=re(e).toVar(),g=re(n).toVar(),v=z(vt(1,a)).toVar();return vt(1,o).mul(g.mul(v).add(p.mul(a))).add(o.mul(f.mul(v).add(c.mul(a))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),K6=sr([rV,iV]),sV=ie(([n,e,t,r,i,s,o,a,c,f,p])=>{const g=z(p).toVar(),v=z(f).toVar(),x=z(c).toVar(),T=z(a).toVar(),S=z(o).toVar(),R=z(s).toVar(),C=z(i).toVar(),B=z(r).toVar(),D=z(t).toVar(),F=z(e).toVar(),I=z(n).toVar(),q=z(vt(1,x)).toVar(),k=z(vt(1,v)).toVar();return z(vt(1,g)).toVar().mul(k.mul(I.mul(q).add(F.mul(x))).add(v.mul(D.mul(q).add(B.mul(x))))).add(g.mul(k.mul(C.mul(q).add(R.mul(x))).add(v.mul(S.mul(q).add(T.mul(x))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),oV=ie(([n,e,t,r,i,s,o,a,c,f,p])=>{const g=z(p).toVar(),v=z(f).toVar(),x=z(c).toVar(),T=re(a).toVar(),S=re(o).toVar(),R=re(s).toVar(),C=re(i).toVar(),B=re(r).toVar(),D=re(t).toVar(),F=re(e).toVar(),I=re(n).toVar(),q=z(vt(1,x)).toVar(),k=z(vt(1,v)).toVar();return z(vt(1,g)).toVar().mul(k.mul(I.mul(q).add(F.mul(x))).add(v.mul(D.mul(q).add(B.mul(x))))).add(g.mul(k.mul(C.mul(q).add(R.mul(x))).add(v.mul(S.mul(q).add(T.mul(x))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),Z6=sr([sV,oV]),aV=ie(([n,e,t])=>{const r=z(t).toVar(),i=z(e).toVar(),s=De(n).toVar(),o=De(s.bitAnd(De(7))).toVar(),a=z(iA(o.lessThan(De(4)),i,r)).toVar(),c=z(Je(2,iA(o.lessThan(De(4)),r,i))).toVar();return Ch(a,yi(o.bitAnd(De(1)))).add(Ch(c,yi(o.bitAnd(De(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),lV=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=z(e).toVar(),a=De(n).toVar(),c=De(a.bitAnd(De(15))).toVar(),f=z(iA(c.lessThan(De(8)),o,s)).toVar(),p=z(iA(c.lessThan(De(4)),s,iA(c.equal(De(12)).or(c.equal(De(14))),o,i))).toVar();return Ch(f,yi(c.bitAnd(De(1)))).add(Ch(p,yi(c.bitAnd(De(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Qn=sr([aV,lV]),uV=ie(([n,e,t])=>{const r=z(t).toVar(),i=z(e).toVar(),s=Kl(n).toVar();return re(Qn(s.x,i,r),Qn(s.y,i,r),Qn(s.z,i,r))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),AV=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=z(e).toVar(),a=Kl(n).toVar();return re(Qn(a.x,o,s,i),Qn(a.y,o,s,i),Qn(a.z,o,s,i))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),oi=sr([uV,AV]),cV=ie(([n])=>{const e=z(n).toVar();return Je(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),hV=ie(([n])=>{const e=z(n).toVar();return Je(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),fV=ie(([n])=>{const e=re(n).toVar();return Je(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),J6=sr([cV,fV]),dV=ie(([n])=>{const e=re(n).toVar();return Je(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),e5=sr([hV,dV]),Hr=ie(([n,e])=>{const t=X(e).toVar(),r=De(n).toVar();return r.shiftLeft(t).bitOr(r.shiftRight(X(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),t5=ie(([n,e,t])=>{n.subAssign(t),n.bitXorAssign(Hr(t,X(4))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Hr(n,X(6))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Hr(e,X(8))),e.addAssign(n),n.subAssign(t),n.bitXorAssign(Hr(t,X(16))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Hr(n,X(19))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Hr(e,X(4))),e.addAssign(n)}),QA=ie(([n,e,t])=>{const r=De(t).toVar(),i=De(e).toVar(),s=De(n).toVar();return r.bitXorAssign(i),r.subAssign(Hr(i,X(14))),s.bitXorAssign(r),s.subAssign(Hr(r,X(11))),i.bitXorAssign(s),i.subAssign(Hr(s,X(25))),r.bitXorAssign(i),r.subAssign(Hr(i,X(16))),s.bitXorAssign(r),s.subAssign(Hr(r,X(4))),i.bitXorAssign(s),i.subAssign(Hr(s,X(14))),r.bitXorAssign(i),r.subAssign(Hr(i,X(24))),r}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),fr=ie(([n])=>{const e=De(n).toVar();return z(e).div(z(De(X(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),hs=ie(([n])=>{const e=z(n).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),pV=ie(([n])=>{const e=X(n).toVar(),t=De(De(1)).toVar(),r=De(De(X(3735928559)).add(t.shiftLeft(De(2))).add(De(13))).toVar();return QA(r.add(De(e)),r,r)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),mV=ie(([n,e])=>{const t=X(e).toVar(),r=X(n).toVar(),i=De(De(2)).toVar(),s=De().toVar(),o=De().toVar(),a=De().toVar();return s.assign(o.assign(a.assign(De(X(3735928559)).add(i.shiftLeft(De(2))).add(De(13))))),s.addAssign(De(r)),o.addAssign(De(t)),QA(s,o,a)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),gV=ie(([n,e,t])=>{const r=X(t).toVar(),i=X(e).toVar(),s=X(n).toVar(),o=De(De(3)).toVar(),a=De().toVar(),c=De().toVar(),f=De().toVar();return a.assign(c.assign(f.assign(De(X(3735928559)).add(o.shiftLeft(De(2))).add(De(13))))),a.addAssign(De(s)),c.addAssign(De(i)),f.addAssign(De(r)),QA(a,c,f)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),yV=ie(([n,e,t,r])=>{const i=X(r).toVar(),s=X(t).toVar(),o=X(e).toVar(),a=X(n).toVar(),c=De(De(4)).toVar(),f=De().toVar(),p=De().toVar(),g=De().toVar();return f.assign(p.assign(g.assign(De(X(3735928559)).add(c.shiftLeft(De(2))).add(De(13))))),f.addAssign(De(a)),p.addAssign(De(o)),g.addAssign(De(s)),t5(f,p,g),f.addAssign(De(i)),QA(f,p,g)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),_V=ie(([n,e,t,r,i])=>{const s=X(i).toVar(),o=X(r).toVar(),a=X(t).toVar(),c=X(e).toVar(),f=X(n).toVar(),p=De(De(5)).toVar(),g=De().toVar(),v=De().toVar(),x=De().toVar();return g.assign(v.assign(x.assign(De(X(3735928559)).add(p.shiftLeft(De(2))).add(De(13))))),g.addAssign(De(f)),v.addAssign(De(c)),x.addAssign(De(a)),t5(g,v,x),g.addAssign(De(o)),v.addAssign(De(s)),QA(g,v,x)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),Ut=sr([pV,mV,gV,yV,_V]),vV=ie(([n,e])=>{const t=X(e).toVar(),r=X(n).toVar(),i=De(Ut(r,t)).toVar(),s=Kl().toVar();return s.x.assign(i.bitAnd(X(255))),s.y.assign(i.shiftRight(X(8)).bitAnd(X(255))),s.z.assign(i.shiftRight(X(16)).bitAnd(X(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),bV=ie(([n,e,t])=>{const r=X(t).toVar(),i=X(e).toVar(),s=X(n).toVar(),o=De(Ut(s,i,r)).toVar(),a=Kl().toVar();return a.x.assign(o.bitAnd(X(255))),a.y.assign(o.shiftRight(X(8)).bitAnd(X(255))),a.z.assign(o.shiftRight(X(16)).bitAnd(X(255))),a}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),ai=sr([vV,bV]),xV=ie(([n])=>{const e=ge(n).toVar(),t=X().toVar(),r=X().toVar(),i=z(ln(e.x,t)).toVar(),s=z(ln(e.y,r)).toVar(),o=z(hs(i)).toVar(),a=z(hs(s)).toVar(),c=z(K6(Qn(Ut(t,r),i,s),Qn(Ut(t.add(X(1)),r),i.sub(1),s),Qn(Ut(t,r.add(X(1))),i,s.sub(1)),Qn(Ut(t.add(X(1)),r.add(X(1))),i.sub(1),s.sub(1)),o,a)).toVar();return J6(c)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),TV=ie(([n])=>{const e=re(n).toVar(),t=X().toVar(),r=X().toVar(),i=X().toVar(),s=z(ln(e.x,t)).toVar(),o=z(ln(e.y,r)).toVar(),a=z(ln(e.z,i)).toVar(),c=z(hs(s)).toVar(),f=z(hs(o)).toVar(),p=z(hs(a)).toVar(),g=z(Z6(Qn(Ut(t,r,i),s,o,a),Qn(Ut(t.add(X(1)),r,i),s.sub(1),o,a),Qn(Ut(t,r.add(X(1)),i),s,o.sub(1),a),Qn(Ut(t.add(X(1)),r.add(X(1)),i),s.sub(1),o.sub(1),a),Qn(Ut(t,r,i.add(X(1))),s,o,a.sub(1)),Qn(Ut(t.add(X(1)),r,i.add(X(1))),s.sub(1),o,a.sub(1)),Qn(Ut(t,r.add(X(1)),i.add(X(1))),s,o.sub(1),a.sub(1)),Qn(Ut(t.add(X(1)),r.add(X(1)),i.add(X(1))),s.sub(1),o.sub(1),a.sub(1)),c,f,p)).toVar();return e5(g)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),g2=sr([xV,TV]),wV=ie(([n])=>{const e=ge(n).toVar(),t=X().toVar(),r=X().toVar(),i=z(ln(e.x,t)).toVar(),s=z(ln(e.y,r)).toVar(),o=z(hs(i)).toVar(),a=z(hs(s)).toVar(),c=re(K6(oi(ai(t,r),i,s),oi(ai(t.add(X(1)),r),i.sub(1),s),oi(ai(t,r.add(X(1))),i,s.sub(1)),oi(ai(t.add(X(1)),r.add(X(1))),i.sub(1),s.sub(1)),o,a)).toVar();return J6(c)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),SV=ie(([n])=>{const e=re(n).toVar(),t=X().toVar(),r=X().toVar(),i=X().toVar(),s=z(ln(e.x,t)).toVar(),o=z(ln(e.y,r)).toVar(),a=z(ln(e.z,i)).toVar(),c=z(hs(s)).toVar(),f=z(hs(o)).toVar(),p=z(hs(a)).toVar(),g=re(Z6(oi(ai(t,r,i),s,o,a),oi(ai(t.add(X(1)),r,i),s.sub(1),o,a),oi(ai(t,r.add(X(1)),i),s,o.sub(1),a),oi(ai(t.add(X(1)),r.add(X(1)),i),s.sub(1),o.sub(1),a),oi(ai(t,r,i.add(X(1))),s,o,a.sub(1)),oi(ai(t.add(X(1)),r,i.add(X(1))),s.sub(1),o,a.sub(1)),oi(ai(t,r.add(X(1)),i.add(X(1))),s,o.sub(1),a.sub(1)),oi(ai(t.add(X(1)),r.add(X(1)),i.add(X(1))),s.sub(1),o.sub(1),a.sub(1)),c,f,p)).toVar();return e5(g)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),XA=sr([wV,SV]),EV=ie(([n])=>{const e=z(n).toVar(),t=X(Mn(e)).toVar();return fr(Ut(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),RV=ie(([n])=>{const e=ge(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar();return fr(Ut(t,r))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),NV=ie(([n])=>{const e=re(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar(),i=X(Mn(e.z)).toVar();return fr(Ut(t,r,i))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),CV=ie(([n])=>{const e=Ge(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar(),i=X(Mn(e.z)).toVar(),s=X(Mn(e.w)).toVar();return fr(Ut(t,r,i,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),MV=sr([EV,RV,NV,CV]),PV=ie(([n])=>{const e=z(n).toVar(),t=X(Mn(e)).toVar();return re(fr(Ut(t,X(0))),fr(Ut(t,X(1))),fr(Ut(t,X(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),BV=ie(([n])=>{const e=ge(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar();return re(fr(Ut(t,r,X(0))),fr(Ut(t,r,X(1))),fr(Ut(t,r,X(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),DV=ie(([n])=>{const e=re(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar(),i=X(Mn(e.z)).toVar();return re(fr(Ut(t,r,i,X(0))),fr(Ut(t,r,i,X(1))),fr(Ut(t,r,i,X(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),LV=ie(([n])=>{const e=Ge(n).toVar(),t=X(Mn(e.x)).toVar(),r=X(Mn(e.y)).toVar(),i=X(Mn(e.z)).toVar(),s=X(Mn(e.w)).toVar();return re(fr(Ut(t,r,i,s,X(0))),fr(Ut(t,r,i,s,X(1))),fr(Ut(t,r,i,s,X(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),bf=sr([PV,BV,DV,LV]),Mh=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=X(e).toVar(),a=re(n).toVar(),c=z(0).toVar(),f=z(1).toVar();return Vt(o,()=>{c.addAssign(f.mul(g2(a))),f.mulAssign(i),a.mulAssign(s)}),c}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),xf=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=X(e).toVar(),a=re(n).toVar(),c=re(0).toVar(),f=z(1).toVar();return Vt(o,()=>{c.addAssign(f.mul(XA(a))),f.mulAssign(i),a.mulAssign(s)}),c}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),OV=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=X(e).toVar(),a=re(n).toVar();return ge(Mh(a,o,s,i),Mh(a.add(re(X(19),X(193),X(17))),o,s,i))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),FV=ie(([n,e,t,r])=>{const i=z(r).toVar(),s=z(t).toVar(),o=X(e).toVar(),a=re(n).toVar(),c=re(xf(a,o,s,i)).toVar(),f=z(Mh(a.add(re(X(19),X(193),X(17))),o,s,i)).toVar();return Ge(c,f)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),IV=ie(([n,e,t,r,i,s,o])=>{const a=X(o).toVar(),c=z(s).toVar(),f=X(i).toVar(),p=X(r).toVar(),g=X(t).toVar(),v=X(e).toVar(),x=ge(n).toVar(),T=re(bf(ge(v.add(p),g.add(f)))).toVar(),S=ge(T.x,T.y).toVar();S.subAssign(.5),S.mulAssign(c),S.addAssign(.5);const R=ge(ge(z(v),z(g)).add(S)).toVar(),C=ge(R.sub(x)).toVar();return We(a.equal(X(2)),()=>tn(C.x).add(tn(C.y))),We(a.equal(X(3)),()=>_n(tn(C.x),tn(C.y))),Lo(C,C)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),kV=ie(([n,e,t,r,i,s,o,a,c])=>{const f=X(c).toVar(),p=z(a).toVar(),g=X(o).toVar(),v=X(s).toVar(),x=X(i).toVar(),T=X(r).toVar(),S=X(t).toVar(),R=X(e).toVar(),C=re(n).toVar(),B=re(bf(re(R.add(x),S.add(v),T.add(g)))).toVar();B.subAssign(.5),B.mulAssign(p),B.addAssign(.5);const D=re(re(z(R),z(S),z(T)).add(B)).toVar(),F=re(D.sub(C)).toVar();return We(f.equal(X(2)),()=>tn(F.x).add(tn(F.y)).add(tn(F.z))),We(f.equal(X(3)),()=>_n(tn(F.x),tn(F.y),tn(F.z))),Lo(F,F)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),nu=sr([IV,kV]),qV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=ge(n).toVar(),o=X().toVar(),a=X().toVar(),c=ge(ln(s.x,o),ln(s.y,a)).toVar(),f=z(1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:p})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:g})=>{const v=z(nu(c,p,g,o,a,i,r)).toVar();f.assign(Fr(f,v))})}),We(r.equal(X(0)),()=>{f.assign(bs(f))}),f}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),UV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=ge(n).toVar(),o=X().toVar(),a=X().toVar(),c=ge(ln(s.x,o),ln(s.y,a)).toVar(),f=ge(1e6,1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:p})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:g})=>{const v=z(nu(c,p,g,o,a,i,r)).toVar();We(v.lessThan(f.x),()=>{f.y.assign(f.x),f.x.assign(v)}).ElseIf(v.lessThan(f.y),()=>{f.y.assign(v)})})}),We(r.equal(X(0)),()=>{f.assign(bs(f))}),f}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),GV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=ge(n).toVar(),o=X().toVar(),a=X().toVar(),c=ge(ln(s.x,o),ln(s.y,a)).toVar(),f=re(1e6,1e6,1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:p})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:g})=>{const v=z(nu(c,p,g,o,a,i,r)).toVar();We(v.lessThan(f.x),()=>{f.z.assign(f.y),f.y.assign(f.x),f.x.assign(v)}).ElseIf(v.lessThan(f.y),()=>{f.z.assign(f.y),f.y.assign(v)}).ElseIf(v.lessThan(f.z),()=>{f.z.assign(v)})})}),We(r.equal(X(0)),()=>{f.assign(bs(f))}),f}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),VV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=re(n).toVar(),o=X().toVar(),a=X().toVar(),c=X().toVar(),f=re(ln(s.x,o),ln(s.y,a),ln(s.z,c)).toVar(),p=z(1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:g})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:v})=>{Vt({start:-1,end:X(1),name:"z",condition:"<="},({z:x})=>{const T=z(nu(f,g,v,x,o,a,c,i,r)).toVar();p.assign(Fr(p,T))})})}),We(r.equal(X(0)),()=>{p.assign(bs(p))}),p}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),zV=sr([qV,VV]),jV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=re(n).toVar(),o=X().toVar(),a=X().toVar(),c=X().toVar(),f=re(ln(s.x,o),ln(s.y,a),ln(s.z,c)).toVar(),p=ge(1e6,1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:g})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:v})=>{Vt({start:-1,end:X(1),name:"z",condition:"<="},({z:x})=>{const T=z(nu(f,g,v,x,o,a,c,i,r)).toVar();We(T.lessThan(p.x),()=>{p.y.assign(p.x),p.x.assign(T)}).ElseIf(T.lessThan(p.y),()=>{p.y.assign(T)})})})}),We(r.equal(X(0)),()=>{p.assign(bs(p))}),p}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),$V=sr([UV,jV]),HV=ie(([n,e,t])=>{const r=X(t).toVar(),i=z(e).toVar(),s=re(n).toVar(),o=X().toVar(),a=X().toVar(),c=X().toVar(),f=re(ln(s.x,o),ln(s.y,a),ln(s.z,c)).toVar(),p=re(1e6,1e6,1e6).toVar();return Vt({start:-1,end:X(1),name:"x",condition:"<="},({x:g})=>{Vt({start:-1,end:X(1),name:"y",condition:"<="},({y:v})=>{Vt({start:-1,end:X(1),name:"z",condition:"<="},({z:x})=>{const T=z(nu(f,g,v,x,o,a,c,i,r)).toVar();We(T.lessThan(p.x),()=>{p.z.assign(p.y),p.y.assign(p.x),p.x.assign(T)}).ElseIf(T.lessThan(p.y),()=>{p.z.assign(p.y),p.y.assign(T)}).ElseIf(T.lessThan(p.z),()=>{p.z.assign(T)})})})}),We(r.equal(X(0)),()=>{p.assign(bs(p))}),p}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),y2=sr([GV,HV]),WV=ie(([n,e,t,r,i,s,o,a,c,f,p])=>{const g=X(n).toVar(),v=ge(e).toVar(),x=ge(t).toVar(),T=ge(r).toVar(),S=z(i).toVar(),R=z(s).toVar(),C=z(o).toVar(),B=yi(a).toVar(),D=X(c).toVar(),F=z(f).toVar(),I=z(p).toVar(),q=v.mul(x).add(T),k=z(0).toVar();return We(g.equal(X(0)),()=>{k.assign(XA(q))}),We(g.equal(X(1)),()=>{k.assign(bf(q))}),We(g.equal(X(2)),()=>{k.assign(y2(q,S,X(0)))}),We(g.equal(X(3)),()=>{k.assign(xf(re(q,0),D,F,I))}),k.assign(k.mul(C.sub(R)).add(R)),We(B,()=>{k.assign(_i(k,R,C))}),k}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),QV=ie(([n,e,t,r,i,s,o,a,c,f,p])=>{const g=X(n).toVar(),v=re(e).toVar(),x=re(t).toVar(),T=re(r).toVar(),S=z(i).toVar(),R=z(s).toVar(),C=z(o).toVar(),B=yi(a).toVar(),D=X(c).toVar(),F=z(f).toVar(),I=z(p).toVar(),q=v.mul(x).add(T),k=z(0).toVar();return We(g.equal(X(0)),()=>{k.assign(XA(q))}),We(g.equal(X(1)),()=>{k.assign(bf(q))}),We(g.equal(X(2)),()=>{k.assign(y2(q,S,X(0)))}),We(g.equal(X(3)),()=>{k.assign(xf(q,D,F,I))}),k.assign(k.mul(C.sub(R)).add(R)),We(B,()=>{k.assign(_i(k,R,C))}),k}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),XV=ie(([n])=>{const e=n.y,t=n.z,r=re().toVar();return We(e.lessThan(1e-4),()=>{r.assign(re(t,t,t))}).Else(()=>{let i=n.x;i=i.sub(us(i)).mul(6).toVar();const s=X(b1(i)),o=i.sub(z(s)),a=t.mul(e.oneMinus()),c=t.mul(e.mul(o).oneMinus()),f=t.mul(e.mul(o.oneMinus()).oneMinus());We(s.equal(X(0)),()=>{r.assign(re(t,f,a))}).ElseIf(s.equal(X(1)),()=>{r.assign(re(c,t,a))}).ElseIf(s.equal(X(2)),()=>{r.assign(re(a,t,f))}).ElseIf(s.equal(X(3)),()=>{r.assign(re(a,c,t))}).ElseIf(s.equal(X(4)),()=>{r.assign(re(f,a,t))}).Else(()=>{r.assign(re(t,a,c))})}),r}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),YV=ie(([n])=>{const e=re(n).toVar(),t=z(e.x).toVar(),r=z(e.y).toVar(),i=z(e.z).toVar(),s=z(Fr(t,Fr(r,i))).toVar(),o=z(_n(t,_n(r,i))).toVar(),a=z(o.sub(s)).toVar(),c=z().toVar(),f=z().toVar(),p=z().toVar();return p.assign(o),We(o.greaterThan(0),()=>{f.assign(a.div(o))}).Else(()=>{f.assign(0)}),We(f.lessThanEqual(0),()=>{c.assign(0)}).Else(()=>{We(t.greaterThanEqual(o),()=>{c.assign(r.sub(i).div(a))}).ElseIf(r.greaterThanEqual(o),()=>{c.assign(Pn(2,i.sub(t).div(a)))}).Else(()=>{c.assign(Pn(4,t.sub(r).div(a)))}),c.mulAssign(1/6),We(c.lessThan(0),()=>{c.addAssign(1)})}),re(c,f,p)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),KV=ie(([n])=>{const e=re(n).toVar(),t=o1(p1(e,re(.04045))).toVar(),r=re(e.div(12.92)).toVar(),i=re(Ai(_n(e.add(re(.055)),re(0)).div(1.055),re(2.4))).toVar();return Nt(r,i,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),n5=(n,e)=>{n=z(n),e=z(e);const t=ge(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return ps(n.sub(t),n.add(t),e)},r5=(n,e,t,r)=>Nt(n,e,t[r].clamp()),ZV=(n,e,t=Wt())=>r5(n,e,t,"x"),JV=(n,e,t=Wt())=>r5(n,e,t,"y"),ez=(n,e,t,r,i=Wt())=>{const s=i.x.clamp(),o=i.y.clamp(),a=Nt(n,e,s),c=Nt(t,r,s);return Nt(a,c,o)},i5=(n,e,t,r,i)=>Nt(n,e,n5(t,r[i])),tz=(n,e,t,r=Wt())=>i5(n,e,t,r,"x"),nz=(n,e,t,r=Wt())=>i5(n,e,t,r,"y"),rz=(n=1,e=0,t=Wt())=>t.mul(n).add(e),iz=(n,e=1)=>(n=z(n),n.abs().pow(e).mul(n.sign())),sz=(n,e=1,t=.5)=>z(n).sub(t).mul(e).add(t),oz=(n=Wt(),e=1,t=0)=>g2(n.convert("vec2|vec3")).mul(e).add(t),az=(n=Wt(),e=1,t=0)=>XA(n.convert("vec2|vec3")).mul(e).add(t),lz=(n=Wt(),e=1,t=0)=>(n=n.convert("vec2|vec3"),Ge(XA(n),g2(n.add(ge(19,73)))).mul(e).add(t)),uz=(n,e=Wt(),t=ge(1,1),r=ge(0,0),i=1,s=0,o=1,a=!1,c=1,f=2,p=.5)=>WV(n,e.convert("vec2|vec3"),t,r,i,s,o,a,c,f,p),Az=(n,e=Wt(),t=ge(1,1),r=ge(0,0),i=1,s=0,o=1,a=!1,c=1,f=2,p=.5)=>QV(n,e.convert("vec2|vec3"),t,r,i,s,o,a,c,f,p),cz=(n=Wt(),e=1)=>zV(n.convert("vec2|vec3"),e,X(1)),hz=(n=Wt(),e=1)=>$V(n.convert("vec2|vec3"),e,X(1)),fz=(n=Wt(),e=1)=>y2(n.convert("vec2|vec3"),e,X(1)),dz=(n=Wt())=>MV(n.convert("vec2|vec3")),pz=(n=Wt(),e=3,t=2,r=.5,i=1)=>Mh(n,X(e),t,r).mul(i),mz=(n=Wt(),e=3,t=2,r=.5,i=1)=>OV(n,X(e),t,r).mul(i),gz=(n=Wt(),e=3,t=2,r=.5,i=1)=>xf(n,X(e),t,r).mul(i),yz=(n=Wt(),e=3,t=2,r=.5,i=1)=>FV(n,X(e),t,r).mul(i),_z=(n,e=z(0))=>Pn(n,e),vz=(n,e=z(0))=>vt(n,e),bz=(n,e=z(1))=>Je(n,e),xz=(n,e=z(1))=>Kr(n,e),Tz=(n,e=z(1))=>kA(n,e),wz=(n,e=z(1))=>Ai(n,e),Sz=(n=z(0),e=z(1))=>sf(n,e),Ez=()=>tu,Rz=()=>g6,Nz=(n,e=z(1))=>vt(e,n),Cz=(n,e,t,r)=>n.greaterThan(e).mix(t,r),Mz=(n,e,t,r)=>n.greaterThanEqual(e).mix(t,r),Pz=(n,e,t,r)=>n.equal(e).mix(t,r),Bz=(n,e=null)=>{if(typeof e=="string"){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},r=e.replace(/^out/,"").toLowerCase();if(t[r]!==void 0)return n.element(t[r])}if(typeof e=="number")return n.element(e);if(typeof e=="string"&&e.length===1){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(t[e]!==void 0)return n.element(t[e])}return n},Dz=(n,e=ge(.5,.5),t=ge(1,1),r=z(0),i=ge(0,0))=>{let s=n;if(e&&(s=s.sub(e)),t&&(s=s.mul(t)),r){const o=r.mul(Math.PI/180),a=o.cos(),c=o.sin();s=ge(s.x.mul(a).sub(s.y.mul(c)),s.x.mul(c).add(s.y.mul(a)))}return e&&(s=s.add(e)),i&&(s=s.add(i)),s},Lz=(n,e)=>{n=ge(n),e=z(e);const t=e.mul(Math.PI/180);return $A(n,t)},Oz=(n,e,t)=>{n=re(n),e=z(e),t=re(t);const r=e.mul(Math.PI/180),i=t.normalize(),s=r.cos(),o=r.sin(),a=z(1).sub(s);return n.mul(s).add(i.cross(n).mul(o)).add(i.mul(i.dot(n)).mul(a))},Fz=(n,e)=>(n=re(n),e=z(e),V1(n,e)),Iz=ie(([n,e,t])=>{const r=$s(n).toVar(),i=vt(z(.5).mul(e.sub(t)),cs).div(r).toVar(),s=vt(z(-.5).mul(e.sub(t)),cs).div(r).toVar(),o=re().toVar();o.x=r.x.greaterThan(z(0)).select(i.x,s.x),o.y=r.y.greaterThan(z(0)).select(i.y,s.y),o.z=r.z.greaterThan(z(0)).select(i.z,s.z);const a=Fr(o.x,o.y,o.z).toVar();return cs.add(r.mul(a)).toVar().sub(t)}),s5=ie(([n,e])=>{const t=n.x,r=n.y,i=n.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(r)),s=s.add(e.element(2).mul(2*.511664).mul(i)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(5).mul(2*.429043).mul(r).mul(i)),s=s.add(e.element(6).mul(i.mul(i).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(i)),s=s.add(e.element(8).mul(.429043).mul(Je(t,t).sub(Je(r,r)))),s});var N=Object.freeze({__proto__:null,BRDF_GGX:Gm,BRDF_Lambert:Na,BasicPointShadowFilter:W6,BasicShadowFilter:q6,Break:Bw,Const:t8,Continue:zF,DFGApprox:e2,D_GGX:Kw,Discard:g8,EPSILON:TT,F_Schlick:$l,Fn:ie,INFINITY:gO,If:We,Loop:Vt,NodeAccess:nr,NodeShaderStage:Vu,NodeType:UL,NodeUpdateType:ot,OnMaterialUpdate:Kq,OnObjectUpdate:Yq,PCFShadowFilter:U6,PCFSoftShadowFilter:G6,PI:wh,PI2:yO,PointShadowFilter:Q6,Return:LO,Schlick_to_F0:Jw,ScriptableNodeResources:N0,ShaderNode:_l,Stack:Kh,Switch:lO,TBNViewMatrix:ma,VSMShadowFilter:V6,V_GGX_SmithCorrelated:Yw,Var:e8,VarIntent:n8,abs:tn,acesFilmicToneMapping:M6,acos:y1,add:Pn,addMethodChaining:de,addNodeElement:IO,agxToneMapping:P6,all:wT,alphaT:bh,and:lT,anisotropy:po,anisotropyB:ba,anisotropyT:Ju,any:ST,append:hO,array:tT,arrayBuffer:AO,asin:CT,assign:nT,atan:sf,atan2:YT,atomicAdd:nG,atomicAnd:oG,atomicFunc:Ts,atomicLoad:eG,atomicMax:iG,atomicMin:sG,atomicOr:aG,atomicStore:tG,atomicSub:rG,atomicXor:lG,attenuationColor:c1,attenuationDistance:A1,attribute:Ws,attributeArray:Jq,backgroundBlurriness:b6,backgroundIntensity:Wm,backgroundRotation:x6,batch:Cw,bentNormalView:W8,billboarding:Dq,bitAnd:hT,bitNot:fT,bitOr:dT,bitXor:pT,bitangentGeometry:xF,bitangentLocal:TF,bitangentView:$8,bitangentWorld:wF,bitcast:fq,blendBurn:kw,blendColor:oI,blendDodge:qw,blendOverlay:Gw,blendScreen:Uw,blur:s6,bool:yi,buffer:GA,bufferAttribute:UA,builtin:Ys,bumpMap:V1,burn:lI,bvec2:$4,bvec3:o1,bvec4:X4,bypass:f8,cache:tA,call:rT,cameraFar:yo,cameraIndex:Oo,cameraNear:go,cameraNormalMatrix:KO,cameraPosition:T8,cameraProjectionMatrix:Zl,cameraProjectionMatrixInverse:XO,cameraViewMatrix:wi,cameraViewport:ZO,cameraWorldMatrix:YO,cbrt:$T,cdl:pU,ceil:rf,checker:tV,cineonToneMapping:C6,clamp:_i,clearcoat:vh,clearcoatNormalView:pa,clearcoatRoughness:SA,code:yf,color:z4,colorSpaceToWorking:lf,colorToDirection:yI,compute:h8,computeKernel:P1,computeSkinning:GF,context:qA,convert:K4,convertColorSpace:SO,convertToTexture:$q,cos:Cs,cross:af,cubeTexture:jl,cubeTextureBase:G1,cubeToUV:Pi,dFdx:_1,dFdy:v1,dashSize:v0,debug:_8,decrement:bT,decrementBefore:_T,defaultBuildStages:Rm,defaultShaderStages:I4,defined:bA,degrees:RT,deltaTime:Eq,densityFog:IU,densityFogFactor:u2,depth:Y1,depthPass:vU,determinant:FT,difference:GT,diffuseColor:Mt,directPointLight:Y6,directionToColor:zw,directionToFaceDirection:Jl,dispersion:h1,distance:UT,div:Kr,dodge:uI,dot:Lo,drawIndex:Ew,dynamicBufferAttribute:c8,element:Y4,emissive:Pm,equal:d1,equals:kT,equirectUV:K1,exp:m1,exp2:Vl,expression:Hs,faceDirection:k1,faceForward:E1,faceforward:_O,float:z,floatBitsToInt:dq,floatBitsToUint:pq,floor:us,fog:NA,fract:Xs,frameGroup:eT,frameId:g6,frontFacing:R8,fwidth:LT,gain:_q,gapSize:Bm,getConstNodeType:V4,getCurrentStack:Yh,getDirection:r6,getDistanceAttenuation:m2,getGeometryRoughness:Xw,getNormalFromDepth:Wq,getParallaxCorrectNormal:Iz,getRoughness:J1,getScreenPosition:Hq,getShIrradianceAt:s5,getShadowMaterial:z6,getShadowRenderObjectFunction:j6,getTextureIndex:p6,getViewPosition:Al,globalId:zU,glsl:CU,glslFn:MU,grayscale:cU,greaterThan:p1,greaterThanEqual:aT,hash:yq,highpModelNormalViewMatrix:Om,highpModelViewMatrix:Lm,hue:dU,increment:vT,incrementBefore:yT,instance:LF,instanceIndex:Ro,instancedArray:eU,instancedBufferAttribute:Sh,instancedDynamicBufferAttribute:Dm,instancedMesh:Nw,int:X,intBitsToFloat:mq,inverse:IT,inverseSqrt:g1,inversesqrt:vO,invocationLocalIndex:DF,invocationSubgroupIndex:BF,ior:eA,iridescence:ef,iridescenceIOR:a1,iridescenceThickness:l1,ivec2:Un,ivec3:H4,ivec4:W4,js:RU,label:JT,length:As,lengthSq:T1,lessThan:sT,lessThanEqual:oT,lightPosition:c2,lightProjectionUV:I6,lightShadowMatrix:vf,lightTargetDirection:f2,lightTargetPosition:k6,lightViewPosition:h2,lightingContext:Lw,lights:FG,linearDepth:Rh,linearToneMapping:R6,localId:jU,log:nf,log2:ls,logarithmicDepthToViewZ:ZF,luminance:a2,mat2:Zh,mat3:pr,mat4:va,matcapUV:l6,materialAO:ww,materialAlphaTest:Q8,materialAnisotropy:uw,materialAnisotropyVector:ul,materialAttenuationColor:gw,materialAttenuationDistance:mw,materialClearcoat:rw,materialClearcoatNormal:sw,materialClearcoatRoughness:iw,materialColor:X8,materialDispersion:Tw,materialEmissive:K8,materialEnvIntensity:T0,materialEnvRotation:U1,materialIOR:pw,materialIridescence:Aw,materialIridescenceIOR:cw,materialIridescenceThickness:hw,materialLightMap:j1,materialLineDashOffset:bw,materialLineDashSize:_w,materialLineGapSize:vw,materialLineScale:yw,materialLineWidth:MF,materialMetalness:tw,materialNormal:nw,materialOpacity:z1,materialPointSize:xw,materialReference:Bs,materialReflectivity:w0,materialRefractionRatio:P8,materialRotation:ow,materialRoughness:ew,materialSheen:aw,materialSheenRoughness:lw,materialShininess:Y8,materialSpecular:Z8,materialSpecularColor:J8,materialSpecularIntensity:Um,materialSpecularStrength:nA,materialThickness:dw,materialTransmission:fw,max:_n,maxMipLevel:B1,mediumpModelViewMatrix:E8,metalness:wA,min:Fr,mix:Nt,mixElement:WT,mod:kA,modInt:xT,modelDirection:iF,modelNormalMatrix:S8,modelPosition:sF,modelRadius:lF,modelScale:oF,modelViewMatrix:Pa,modelViewPosition:aF,modelViewProjection:$1,modelWorldMatrix:ci,modelWorldMatrixInverse:uF,morphReference:Dw,mrt:m6,mul:Je,mx_aastep:n5,mx_add:_z,mx_atan2:Sz,mx_cell_noise_float:dz,mx_contrast:sz,mx_divide:xz,mx_fractal_noise_float:pz,mx_fractal_noise_vec2:mz,mx_fractal_noise_vec3:gz,mx_fractal_noise_vec4:yz,mx_frame:Rz,mx_heighttonormal:Fz,mx_hsvtorgb:XV,mx_ifequal:Pz,mx_ifgreater:Cz,mx_ifgreatereq:Mz,mx_invert:Nz,mx_modulo:Tz,mx_multiply:bz,mx_noise_float:oz,mx_noise_vec3:az,mx_noise_vec4:lz,mx_place2d:Dz,mx_power:wz,mx_ramp4:ez,mx_ramplr:ZV,mx_ramptb:JV,mx_rgbtohsv:YV,mx_rotate2d:Lz,mx_rotate3d:Oz,mx_safepower:iz,mx_separate:Bz,mx_splitlr:tz,mx_splittb:nz,mx_srgb_texture_to_lin_rec709:KV,mx_subtract:vz,mx_timer:Ez,mx_transform_uv:rz,mx_unifiednoise2d:uz,mx_unifiednoise3d:Az,mx_worley_noise_float:cz,mx_worley_noise_vec2:hz,mx_worley_noise_vec3:fz,negate:MT,neutralToneMapping:B6,nodeArray:_a,nodeImmutable:Me,nodeObject:pe,nodeObjectIntent:zu,nodeObjects:Xh,nodeProxy:Ye,nodeProxyIntent:Ne,normalFlat:N8,normalGeometry:uf,normalLocal:Ir,normalMap:qm,normalView:Gt,normalViewGeometry:zl,normalWorld:Fo,normalWorldGeometry:C8,normalize:$s,not:AT,notEqual:iT,numWorkgroups:GU,objectDirection:JO,objectGroup:f1,objectPosition:w8,objectRadius:rF,objectScale:tF,objectViewPosition:nF,objectWorldMatrix:eF,oneMinus:PT,or:uT,orthographicDepthToViewZ:KF,oscSawtooth:Mq,oscSine:Rq,oscSquare:Nq,oscTriangle:Cq,output:Rl,outputStruct:cq,overlay:cI,overloadingFn:sr,parabola:Hm,parallaxDirection:H8,parallaxUV:SF,parameter:sq,pass:yU,passTexture:_U,pcurve:vq,perspectiveDepthToViewZ:Q1,pmremTexture:i2,pointShadow:X6,pointUV:nU,pointWidth:fO,positionGeometry:zA,positionLocal:wn,positionPrevious:Eh,positionView:Sn,positionViewDirection:sn,positionWorld:cs,positionWorldDirection:I1,posterize:gU,pow:Ai,pow2:x1,pow3:VT,pow4:zT,premultiplyAlpha:Vw,property:Is,quadBroadcast:DG,quadSwapDiagonal:RG,quadSwapX:SG,quadSwapY:EG,radians:ET,rand:HT,range:qU,rangeFog:FU,rangeFogFactor:l2,reciprocal:DT,reference:Xt,referenceBuffer:Fm,reflect:qT,reflectVector:L8,reflectView:B8,reflector:Uq,refract:S1,refractVector:O8,refractView:D8,reinhardToneMapping:N6,remap:p8,remapClamp:m8,renderGroup:qe,renderOutput:y8,rendererReference:l8,rotate:$A,rotateUV:Pq,roughness:ns,round:BT,rtt:_6,sRGBTransferEOTF:i8,sRGBTransferOETF:s8,sample:Xq,sampler:VO,samplerComparison:zO,saturate:w1,saturation:hU,screen:AI,screenCoordinate:VA,screenDPR:b8,screenSize:Ra,screenUV:ks,scriptable:OU,scriptableValue:R0,select:Xn,setCurrentStack:xA,setName:R1,shaderStages:Nm,shadow:H6,shadowPositionWorld:p2,shapeCircle:nV,sharedUniformGroup:tf,sheen:da,sheenRoughness:Jh,shiftLeft:mT,shiftRight:gT,shininess:xh,sign:RA,sin:Qr,sinc:bq,skinning:Pw,smoothstep:ps,smoothstepElement:QT,specularColor:Cr,specularF90:EA,spherizeUV:Bq,split:cO,spritesheetUV:Fq,sqrt:bs,stack:S0,step:of,stepElement:XT,storage:xa,storageBarrier:QU,storageObject:UF,storageTexture:T6,string:uO,struct:Aq,sub:vt,subBuild:Nl,subgroupAdd:cG,subgroupAll:xG,subgroupAnd:gG,subgroupAny:TG,subgroupBallot:AG,subgroupBroadcast:NG,subgroupBroadcastFirst:wG,subgroupElect:uG,subgroupExclusiveAdd:fG,subgroupExclusiveMul:mG,subgroupInclusiveAdd:hG,subgroupInclusiveMul:pG,subgroupIndex:PF,subgroupMax:bG,subgroupMin:vG,subgroupMul:dG,subgroupOr:yG,subgroupShuffle:CG,subgroupShuffleDown:BG,subgroupShuffleUp:PG,subgroupShuffleXor:MG,subgroupSize:$U,subgroupXor:_G,tan:NT,tangentGeometry:cf,tangentLocal:jA,tangentView:hf,tangentWorld:j8,texture:_t,texture3D:w6,textureBarrier:XU,textureBicubic:GI,textureBicubicLevel:t2,textureCubeUV:i6,textureLoad:bn,textureSize:Eo,textureStore:iU,thickness:u1,time:tu,toneMapping:u8,toneMappingExposure:A8,toonOutlinePass:xU,transformDirection:jT,transformNormal:M8,transformNormalToView:q1,transformedClearcoatNormalView:fF,transformedNormalView:cF,transformedNormalWorld:hF,transmission:Th,transpose:OT,triNoise3D:Tq,triplanarTexture:Iq,triplanarTextures:y6,trunc:b1,uint:De,uintBitsToFloat:gq,uniform:Ue,uniformArray:cr,uniformCubeTexture:pF,uniformFlow:ZT,uniformGroup:J4,uniformTexture:GO,unpremultiplyAlpha:aI,userData:lU,uv:Wt,uvec2:j4,uvec3:Kl,uvec4:Q4,varying:xs,varyingProperty:TA,vec2:ge,vec3:re,vec4:Ge,vectorComponents:Ca,velocity:AU,vertexColor:Iw,vertexIndex:Sw,vertexStage:r8,vibrance:fU,viewZToLogarithmicDepth:X1,viewZToOrthographicDepth:Cl,viewZToPerspectiveDepth:Ow,viewport:O1,viewportCoordinate:x8,viewportDepthTexture:W1,viewportLinearDepth:JF,viewportMipTexture:H1,viewportResolution:QO,viewportSafeUV:Lq,viewportSharedTexture:gI,viewportSize:F1,viewportTexture:XF,viewportUV:WO,wgsl:NU,wgslFn:PU,workgroupArray:ZU,workgroupBarrier:WU,workgroupId:VU,workingToColorSpace:o8,xor:cT});const Ei=new s2;class kz extends Io{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,r){const i=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(s===null)i._clearColor.getRGB(Ei),Ei.a=i._clearColor.a;else if(s.isColor===!0)s.getRGB(Ei),Ei.a=1,o=!0;else if(s.isNode===!0){const c=this.get(e),f=s;Ei.copy(i._clearColor);let p=c.backgroundMesh;if(p===void 0){let S=function(){s.removeEventListener("dispose",S),p.material.dispose(),p.geometry.dispose()};const v=qA(Ge(f).mul(Wm),{getUV:()=>x6.mul(C8),getTextureLevel:()=>b6});let x=$1;x=x.setZ(x.w);const T=new En;T.name="Background.material",T.side=hr,T.depthTest=!1,T.depthWrite=!1,T.allowOverride=!1,T.fog=!1,T.lights=!1,T.vertexNode=x,T.colorNode=v,c.backgroundMeshNode=v,c.backgroundMesh=p=new hn(new Bo(1,32,32),T),p.frustumCulled=!1,p.name="Background.mesh",p.onBeforeRender=function(R,C,B){this.matrixWorld.copyPosition(B.matrixWorld)},s.addEventListener("dispose",S)}const g=f.getCacheKey();c.backgroundCacheKey!==g&&(c.backgroundMeshNode.node=Ge(f).mul(Wm),c.backgroundMeshNode.needsUpdate=!0,p.material.needsUpdate=!0,c.backgroundCacheKey=g),t.unshift(p,p.geometry,p.material,0,0,null,null)}const a=i.xr.getEnvironmentBlendMode();if(a==="additive"?Ei.set(0,0,0,1):a==="alpha-blend"&&Ei.set(0,0,0,0),i.autoClear===!0||o===!0){const c=r.clearColorValue;c.r=Ei.r,c.g=Ei.g,c.b=Ei.b,c.a=Ei.a,(i.backend.isWebGLBackend===!0||i.alpha===!0)&&(c.r*=c.a,c.g*=c.a,c.b*=c.a),r.depthClearValue=i._clearDepth,r.stencilClearValue=i._clearStencil,r.clearColor=i.autoClearColor===!0,r.clearDepth=i.autoClearDepth===!0,r.clearStencil=i.autoClearStencil===!0}else r.clearColor=!1,r.clearDepth=!1,r.clearStencil=!1}}let qz=0;class Qm{constructor(e="",t=[],r=0,i=[]){this.name=e,this.bindings=t,this.index=r,this.bindingsReference=i,this.id=qz++}}class Uz{constructor(e,t,r,i,s,o,a,c,f,p=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=r,this.transforms=p,this.nodeAttributes=i,this.bindings=s,this.updateNodes=o,this.updateBeforeNodes=a,this.updateAfterNodes=c,this.observer=f,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const i=new Qm(t.name,[],t.index,t.bindingsReference);e.push(i);for(const s of t.bindings)i.bindings.push(s.clone())}else e.push(t);return e}}class h3{constructor(e,t,r=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=r}}class Gz{constructor(e,t,r){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=r}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class o5{constructor(e,t,r=!1,i=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=r,this.count=i}}class Vz extends o5{constructor(e,t,r=null,i=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=r,this.interpolationSampling=i}}class zz{constructor(e,t,r=""){this.name=e,this.type=t,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})}}let jz=0;class $d{constructor(e=null){this.id=jz++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class $z{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class ko{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Hz extends ko{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class Wz extends ko{constructor(e,t=new ht){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Qz extends ko{constructor(e,t=new we){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class Xz extends ko{constructor(e,t=new Ft){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class Yz extends ko{constructor(e,t=new Gn){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Kz extends ko{constructor(e,t=new nx){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class Zz extends ko{constructor(e,t=new DA){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class Jz extends ko{constructor(e,t=new gn){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class ej extends Hz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class tj extends Wz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class nj extends Qz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class rj extends Xz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class ij extends Yz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class sj extends Kz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class oj extends Zz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class aj extends Jz{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const f3=new WeakMap,lj=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),kc=n=>/e/g.test(n)?String(n).replace(/\+/g,""):(n=Number(n),n+(n%1?"":".0"));class a5{constructor(e,t,r){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=S0(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new $d,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.currentStack=null,this.subBuildFn=null}getBindGroupsCache(){let e=f3.get(this.renderer);return e===void 0&&(e=new Gi,f3.set(this.renderer,e)),e}createRenderTarget(e,t,r){return new Do(e,t,r)}createCubeRenderTarget(e,t){return new jw(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const r=this.getBindGroupsCache(),i=[];let s=!0;for(const a of t)i.push(a),s=s&&a.groupNode.shared!==!0;let o;return s?(o=r.get(i),o===void 0&&(o=new Qm(e,i,this.bindingsIndexes[e].group,i),r.set(i,o))):o=new Qm(e,i,this.bindingsIndexes[e].group,i),o}getBindGroupArray(e,t){const r=this.bindings[t];let i=r[e];return i===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),r[e]=i=[]),i}getBindings(){let e=this.bindGroups;if(e===null){const t={},r=this.bindings;for(const i of Nm)for(const s in r[i]){const o=r[i][s];(t[s]||(t[s]=[])).push(...o)}e=[];for(const i in t){const s=t[i],o=this._getBindGroup(i,s);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,r)=>t.bindings[0].groupNode.order-r.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const r=e[t];this.bindingsIndexes[r.name].group=t,r.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==ot.NONE&&this.updateNodes.push(e);for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),r=e.getUpdateAfterType();t!==ot.NONE&&this.updateBeforeNodes.push(e),r!==ot.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===qs||e.magFilter===yp||e.magFilter===aA||e.magFilter===ga||e.minFilter===qs||e.minFilter===yp||e.minFilter===aA||e.minFilter===ga}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const r=this.getDataFromNode(e);return r.cache===void 0&&(r.cache=new $d(t?this.getCache():null)),r.cache}isAvailable(){return!1}getVertexIndex(){}getInstanceIndex(){}getDrawIndex(){}getFrontFacing(){}getFragCoord(){}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){}generateTextureLod(){}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,r=null){let i=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const o=r?r[s]:null;o!==null?i+=o.build(this,e):i+=this.generateConst(e),s<t-1&&(i+=", ")}return i+=" )",i}generateStruct(e,t,r=null){const i=[];for(const s of t){const{name:o,type:a}=s;r&&r[o]&&r[o].isNode?i.push(r[o].build(this,a)):i.push(this.generateConst(a))}return e+"( "+i.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Gn:e==="vec2"?t=new ht:e==="vec3"?t=new we:e==="vec4"&&(t=new Ft)),e==="float")return kc(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${kc(t.r)}, ${kc(t.g)}, ${kc(t.b)} )`;const r=this.getTypeLength(e),i=this.getComponentType(e),s=o=>this.generateConst(i,o);if(r===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(r===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(r===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(r>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(r>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const r=this.attributes;for(const s of r)if(s.name===e)return s;const i=new h3(e,t);return this.registerDeclaration(i),r.push(i),i}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===vr)return"int";if(t===Ln)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let r=B4(e);const i=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(r=r.replace("vec","mat")),i+r}getTypeFromArray(e){return lj.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const r=t.array,i=e.itemSize,s=e.normalized;let o;return!(e instanceof tx)&&s!==!0&&(o=this.getTypeFromArray(r)),this.getTypeFromLength(i,o)}getTypeLength(e){const t=this.getVectorType(e),r=/vec([2-4])/.exec(t);return r!==null?Number(r[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){this.stack=S0(this.stack);const e=Yh();return this.stacks.push(e),xA(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,xA(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,r=null){r=r===null?e.isGlobal(this)?this.globalCache:this.cache:r;let i=r.getData(e);i===void 0&&(i={},r.setData(e,i)),i[t]===void 0&&(i[t]={});let s=i[t];const o=i.any?i.any.subBuilds:null,a=this.getClosestSubBuild(o);return a&&(s.subBuildsCache===void 0&&(s.subBuildsCache={}),s=s.subBuildsCache[a]||(s.subBuildsCache[a]={}),s.subBuilds=o),s}getNodeProperties(e,t="any"){const r=this.getDataFromNode(e,t);return r.properties||(r.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const r=this.getDataFromNode(e);let i=r.bufferAttribute;if(i===void 0){const s=this.uniforms.index++;i=new h3("nodeAttribute"+s,t,e),this.bufferAttributes.push(i),r.bufferAttribute=i}return i}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,r=null,i=this.shaderStage){const s=this.getDataFromNode(e,i,this.globalCache);let o=s.structType;if(o===void 0){const a=this.structs.index++;r===null&&(r="StructType"+a),o=new $z(r,t),this.structs[i].push(o),this.types[i][r]=e,s.structType=o}return o}getOutputStructTypeFromNode(e,t){const r=this.getStructTypeFromNode(e,t,"OutputType","fragment");return r.output=!0,r}getUniformFromNode(e,t,r=this.shaderStage,i=null){const s=this.getDataFromNode(e,r,this.globalCache);let o=s.uniform;if(o===void 0){const a=this.uniforms.index++;o=new Gz(i||"nodeUniform"+a,t,e),this.uniforms[r].push(o),this.registerDeclaration(o),s.uniform=o}return o}getVarFromNode(e,t=null,r=e.getNodeType(this),i=this.shaderStage,s=!1){const o=this.getDataFromNode(e,i),a=this.getSubBuildProperty("variable",o.subBuilds);let c=o[a];if(c===void 0){const f=s?"_const":"_var",p=this.vars[i]||(this.vars[i]=[]),g=this.vars[f]||(this.vars[f]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+g,this.vars[f]++),a!=="variable"&&(t=this.getSubBuildProperty(t,o.subBuilds));const v=e.getArrayCount(this);c=new o5(t,r,s,v),s||p.push(c),this.registerDeclaration(c),o[a]=c}return c}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,r=e.getNodeType(this),i=null,s=null){const o=this.getDataFromNode(e,"any"),a=this.getSubBuildProperty("varying",o.subBuilds);let c=o[a];if(c===void 0){const f=this.varyings,p=f.length;t===null&&(t="nodeVarying"+p),a!=="varying"&&(t=this.getSubBuildProperty(t,o.subBuilds)),c=new Vz(t,r,i,s),f.push(c),this.registerDeclaration(c),o[a]=c}return c}registerDeclaration(e){const t=this.shaderStage,r=this.declarations[t]||(this.declarations[t]={}),i=this.getPropertyName(e);let s=1,o=i;for(;r[o]!==void 0;)o=i+"_"+s++;s>1&&(e.name=o),r[o]=e}getCodeFromNode(e,t,r=this.shaderStage){const i=this.getDataFromNode(e);let s=i.code;if(s===void 0){const o=this.codes[r]||(this.codes[r]=[]),a=o.length;s=new zz("nodeCode"+a,t),o.push(s),i.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:r,flowCodeBlock:i}=this.getDataFromNode(e);let s=!0,o=t;for(;o;){if(i.get(o)===!0){s=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(s)for(const a of r)this.addLineFlowCode(a)}addLineFlowCodeBlock(e,t,r){const i=this.getDataFromNode(e),s=i.flowCodes||(i.flowCodes=[]),o=i.flowCodeBlock||(i.flowCodeBlock=new WeakMap);s.push(t),o.set(r,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),r=this.flowChildNode(e,t);return this.flowsData.set(e,r),r}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new D6,r=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=r,t}flowShaderNode(e){const t=e.layout,r={[Symbol.iterator](){let o=0;const a=Object.values(this);return{next:()=>({value:a[o],done:o++>=a.length})}}};for(const o of t.inputs)r[o.name]=new f6(o.type,o.name);e.layout=null;const i=e.call(r),s=this.flowStagesNode(i,t.type);return e.layout=t,s}flowBuildStage(e,t,r=null){const i=this.getBuildStage();this.setBuildStage(t);const s=e.build(this,r);return this.setBuildStage(i),s}flowStagesNode(e,t=null){const r=this.flow,i=this.vars,s=this.declarations,o=this.cache,a=this.buildStage,c=this.stack,f={code:""};this.flow=f,this.vars={},this.declarations={},this.cache=new $d,this.stack=S0();for(const p of Rm)this.setBuildStage(p),f.result=e.build(this,t);return f.vars=this.getVars(this.shaderStage),this.flow=r,this.vars=i,this.declarations=s,this.cache=o,this.stack=c,this.setBuildStage(a),f}getFunctionOperator(){return null}buildFunctionCode(){}flowChildNode(e,t=null){const r=this.flow,i={code:""};return this.flow=i,i.result=e.build(this,t),this.flow=r,i}flowNodeFromShaderStage(e,t,r=null,i=null){const s=this.tab,o=this.cache,a=this.shaderStage,c=this.context;this.setShaderStage(e);const f={...this.context};delete f.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=f;let p=null;if(this.buildStage==="generate"){const g=this.flowChildNode(t,r);i!==null&&(g.code+=`${this.tab+i} = ${g.result};
`),this.flowCode[e]=this.flowCode[e]+g.code,p=g}else p=t.build(this);return this.setShaderStage(a),this.cache=o,this.tab=s,this.context=c,p}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){}getVaryings(){}getVar(e,t,r=null){return`${r!==null?this.generateArrayDeclaration(e,r):this.getType(e)} ${t}`}getVars(e){let t="";const r=this.vars[e];if(r!==void 0)for(const i of r)t+=`${this.getVar(i.type,i.name)}; `;return t}getUniforms(){}getCodes(e){const t=this.codes[e];let r="";if(t!==void 0)for(const i of t)r+=i.code+`
`;return r}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(e&&e.isNode?e.isShaderCallNodeInternal?t=e.shaderNode.subBuilds:e.isStackNode?t=[e.subBuild]:t=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?t=[...e]:t=e,!t)return null;const r=this.subBuildLayers;for(let i=t.length-1;i>=0;i--){const s=t[i];if(r.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let r;t!==null?r=this.getClosestSubBuild(t):r=this.subBuildFn;let i;return r?i=e?r+"_"+e:r:i=e,i}build(){const{object:e,material:t,renderer:r}=this;if(t!==null){let i=r.library.fromMaterial(t);i===null&&(i=new En),i.build(this)}else this.addFlow("compute",e);for(const i of Rm){this.setBuildStage(i),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of Nm){this.setShaderStage(s);const o=this.flowNodes[s];for(const a of o)i==="generate"?this.flowNode(a):a.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new ej(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new tj(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new nj(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new rj(e);if(t==="color")return new ij(e);if(t==="mat2")return new sj(e);if(t==="mat3")return new oj(e);if(t==="mat4")return new aj(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,r){if(t=this.getVectorType(t),r=this.getVectorType(r),t===r||r===null||this.isReference(r))return e;const i=this.getTypeLength(t),s=this.getTypeLength(r);return i===16&&s===9?`${this.getType(r)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:i===9&&s===4?`${this.getType(r)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:i>4||s>4||s===0?e:i===s?`${this.getType(r)}( ${e} )`:i>s?(e=r==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),r)):s===4&&i>1?`${this.getType(r)}( ${this.format(e,t,"vec3")}, 1.0 )`:i===2?`${this.getType(r)}( ${this.format(e,t,"vec2")}, 0.0 )`:(i===1&&s>1&&t!==this.getComponentType(r)&&(e=`${this.getType(this.getComponentType(r))}( ${e} )`),`${this.getType(r)}( ${e} )`)}getSignature(){return`// Three.js r${Tg} - Node System
`}}class d3{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let r=e.get(t);return r===void 0&&(r={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,r)),r}updateBeforeNode(e){const t=e.getUpdateBeforeType(),r=e.updateReference(this);if(t===ot.FRAME){const{frameMap:i}=this._getMaps(this.updateBeforeMap,r);i.get(r)!==this.frameId&&e.updateBefore(this)!==!1&&i.set(r,this.frameId)}else if(t===ot.RENDER){const{renderMap:i}=this._getMaps(this.updateBeforeMap,r);i.get(r)!==this.renderId&&e.updateBefore(this)!==!1&&i.set(r,this.renderId)}else t===ot.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),r=e.updateReference(this);if(t===ot.FRAME){const{frameMap:i}=this._getMaps(this.updateAfterMap,r);i.get(r)!==this.frameId&&e.updateAfter(this)!==!1&&i.set(r,this.frameId)}else if(t===ot.RENDER){const{renderMap:i}=this._getMaps(this.updateAfterMap,r);i.get(r)!==this.renderId&&e.updateAfter(this)!==!1&&i.set(r,this.renderId)}else t===ot.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),r=e.updateReference(this);if(t===ot.FRAME){const{frameMap:i}=this._getMaps(this.updateMap,r);i.get(r)!==this.frameId&&e.update(this)!==!1&&i.set(r,this.frameId)}else if(t===ot.RENDER){const{renderMap:i}=this._getMaps(this.updateMap,r);i.get(r)!==this.renderId&&e.update(this)!==!1&&i.set(r,this.renderId)}else t===ot.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class _2{constructor(e,t,r=null,i="",s=!1){this.type=e,this.name=t,this.count=r,this.qualifier=i,this.isConst=s}}_2.isNodeFunctionInput=!0;class uj extends Ba{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:f2(this.light),lightColor:e}}}const Hd=new gn,qc=new gn;let Nu=null;class Aj extends Ba{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Ue(new we).setGroup(qe),this.halfWidth=Ue(new we).setGroup(qe),this.updateType=ot.RENDER}update(e){super.update(e);const{light:t}=this,r=e.camera.matrixWorldInverse;qc.identity(),Hd.copy(t.matrixWorld),Hd.premultiply(r),qc.extractRotation(Hd),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(qc),this.halfHeight.value.applyMatrix4(qc)}setupDirectRectArea(e){let t,r;e.isAvailable("float32Filterable")?(t=_t(Nu.LTC_FLOAT_1),r=_t(Nu.LTC_FLOAT_2)):(t=_t(Nu.LTC_HALF_1),r=_t(Nu.LTC_HALF_2));const{colorNode:i,light:s}=this,o=h2(s);return{lightColor:i,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:r}}static setLTC(e){Nu=e}}class v2 extends Ba{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Ue(0).setGroup(qe),this.penumbraCosNode=Ue(0).setGroup(qe),this.cutoffDistanceNode=Ue(0).setGroup(qe),this.decayExponentNode=Ue(0).setGroup(qe),this.colorNode=Ue(this.color).setGroup(qe)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:r,penumbraCosNode:i}=this;return ps(r,i,t)}getLightCoord(e){const t=e.getNodeProperties(this);let r=t.projectionUV;return r===void 0&&(r=I6(this.light,e.context.positionWorld),t.projectionUV=r),r}setupDirect(e){const{colorNode:t,cutoffDistanceNode:r,decayExponentNode:i,light:s}=this,o=this.getLightVector(e),a=o.normalize(),c=a.dot(f2(s)),f=this.getSpotAttenuation(e,c),p=o.length(),g=m2({lightDistance:p,cutoffDistance:r,decayExponent:i});let v=t.mul(f).mul(g),x,T;return s.colorNode?(T=this.getLightCoord(e),x=s.colorNode(T)):s.map&&(T=this.getLightCoord(e),x=_t(s.map,T.xy).onRenderUpdate(()=>s.map)),x&&(v=T.mul(2).sub(1).abs().lessThan(1).all().select(v.mul(x),v)),{lightColor:v,lightDirection:a}}}class cj extends v2{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const r=this.light.iesMap;let i=null;if(r&&r.isTexture===!0){const s=t.acos().mul(1/Math.PI);i=_t(r,ge(s,0),0).r}else i=super.getSpotAttenuation(t);return i}}const hj=ie(([n,e])=>{const t=n.abs().sub(e);return As(_n(t,0)).add(Fr(_n(t.x,t.y),0))});class fj extends v2{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let r=1;t.map!==null&&(r=t.map.width/t.map.height),t.shadow.aspect=r}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=z(0),r=this.penumbraCosNode,i=vf(this.light).mul(e.context.positionWorld||cs);return We(i.w.greaterThan(0),()=>{const s=i.xyz.div(i.w),o=hj(s.xy.sub(ge(.5)),ge(.5)),a=Kr(-1,vt(1,y1(r)).sub(1));t.assign(w1(o.mul(-2).mul(a)))}),t}}class dj extends Ba{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class pj extends Ba{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=c2(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Ue(new Gn).setGroup(qe)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:r,lightDirectionNode:i}=this,o=Fo.dot(i).mul(.5).add(.5),a=Nt(r,t,o);e.context.irradiance.addAssign(a)}}class mj extends Ba{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let r=0;r<9;r++)t.push(new we);this.lightProbe=cr(t)}update(e){const{light:t}=this;super.update(e);for(let r=0;r<9;r++)this.lightProbe.array[r].copy(t.sh.coefficients[r]).multiplyScalar(t.intensity)}setup(e){const t=s5(Fo,this.lightProbe);e.context.irradiance.addAssign(t)}}class l5{parseFunction(){}}class b2{constructor(e,t,r="",i=""){this.type=e,this.inputs=t,this.name=r,this.precision=i}getCode(){}}b2.isNodeFunction=!0;const gj=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,yj=/[a-z_0-9]+/ig,p3="#pragma main",_j=n=>{n=n.trim();const e=n.indexOf(p3),t=e!==-1?n.slice(e+p3.length):n,r=t.match(gj);if(r!==null&&r.length===5){const i=r[4],s=[];let o=null;for(;(o=yj.exec(i))!==null;)s.push(o);const a=[];let c=0;for(;c<s.length;){const T=s[c][0]==="const";T===!0&&c++;let S=s[c][0];S==="in"||S==="out"||S==="inout"?c++:S="";const R=s[c++][0];let C=Number.parseInt(s[c][0]);Number.isNaN(C)===!1?c++:C=null;const B=s[c++][0];a.push(new _2(R,B,C,S,T))}const f=t.substring(r[0].length),p=r[3]!==void 0?r[3]:"",g=r[2],v=r[1]!==void 0?r[1]:"",x=e!==-1?n.slice(0,e):"";return{type:g,inputs:a,name:p,precision:v,inputsCode:i,blockCode:f,headerCode:x}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class vj extends b2{constructor(e){const{type:t,inputs:r,name:i,precision:s,inputsCode:o,blockCode:a,headerCode:c}=_j(e);super(t,r,i,s),this.inputsCode=o,this.blockCode=a,this.headerCode=c}getCode(e=this.name){let t;const r=this.blockCode;if(r!==""){const{type:i,inputsCode:s,headerCode:o,precision:a}=this;let c=`${i} ${e} ( ${s.trim()} )`;a!==""&&(c=`${a} ${c}`),t=o+c+r}else t="";return t}}class bj extends l5{parseFunction(e){return new vj(e)}}const m3=new WeakMap,Xi=[],Jo=[];class xj extends Io{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new d3,this.nodeBuilderCache=new Map,this.callHashCache=new Gi,this.groupsData=new Gi,this.cacheLib={}}updateGroup(e){const t=e.groupNode,r=t.name;if(r===f1.name)return!0;if(r===qe.name){const s=this.get(e),o=this.nodeFrame.renderId;return s.renderId!==o?(s.renderId=o,!0):!1}if(r===eT.name){const s=this.get(e),o=this.nodeFrame.frameId;return s.frameId!==o?(s.frameId=o,!0):!1}Xi[0]=t,Xi[1]=e;let i=this.groupsData.get(Xi);return i===void 0&&this.groupsData.set(Xi,i={}),Xi.length=0,i.version!==t.version?(i.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let r=t.nodeBuilderState;if(r===void 0){const{nodeBuilderCache:i}=this,s=this.getForRenderCacheKey(e);if(r=i.get(s),r===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&o.enableMultiview(),o.build(),r=this._createNodeBuilderState(o),i.set(s,r)}r.usedTimes++,t.nodeBuilderState=r}return r}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let r=t.nodeBuilderState;if(r===void 0){const i=this.backend.createNodeBuilder(e,this.renderer);i.build(),r=this._createNodeBuilderState(i),t.nodeBuilderState=r}return r}_createNodeBuilderState(e){return new Uz(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const r=this.get(e);r.environmentNode&&(t=r.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const r=this.get(e);r.backgroundNode&&(t=r.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Xi[0]=e,Xi[1]=t;const r=this.renderer.info.calls,i=this.callHashCache.get(Xi)||{};if(i.callId!==r){const s=this.getEnvironmentNode(e),o=this.getFogNode(e);t&&Jo.push(t.getCacheKey(!0)),s&&Jo.push(s.getCacheKey()),o&&Jo.push(o.getCacheKey()),Jo.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),Jo.push(this.renderer.shadowMap.enabled?1:0),i.callId=r,i.cacheKey=Hh(Jo),this.callHashCache.set(Xi,i),Jo.length=0}return Xi.length=0,i.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),r=e.background;if(r){const i=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==r||i){const s=this.getCacheNode("background",r,()=>{if(r.isCubeTexture===!0||r.mapping===yg||r.mapping===_g||r.mapping===gp){if(e.backgroundBlurriness>0||r.mapping===gp)return i2(r);{let o;return r.isCubeTexture===!0?o=jl(r):o=_t(r),Hw(o)}}else{if(r.isTexture===!0)return _t(r,ks.flipY()).setUpdateMatrix(!0);r.isColor}},i);t.backgroundNode=s,t.background=r,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,r,i=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=s.get(t);return(o===void 0||i)&&(o=r(),s.set(t,o)),o}updateFog(e){const t=this.get(e),r=e.fog;if(r){if(t.fog!==r){const i=this.getCacheNode("fog",r,()=>{if(r.isFogExp2){const s=Xt("color","color",r).setGroup(qe),o=Xt("density","float",r).setGroup(qe);return NA(s,u2(o))}else if(r.isFog){const s=Xt("color","color",r).setGroup(qe),o=Xt("near","float",r).setGroup(qe),a=Xt("far","float",r).setGroup(qe);return NA(s,l2(o,a))}});t.fogNode=i,t.fog=r}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),r=e.environment;if(r){if(t.environment!==r){const i=this.getCacheNode("environment",r,()=>{if(r.isCubeTexture===!0)return jl(r);if(r.isTexture===!0)return _t(r)});t.environmentNode=i,t.environment=r}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,r=null,i=null,s=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=r,o.camera=i,o.material=s,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return m3.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,r=this.getOutputCacheKey(),i=e.isArrayTexture?w6(e,re(ks,Ys("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):_t(e,ks).renderOutput(t.toneMapping,t.currentColorSpace);return m3.set(e,r),i}updateBefore(e){const t=e.getNodeBuilderState();for(const r of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(r)}updateAfter(e){const t=e.getNodeBuilderState();for(const r of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(r)}updateForCompute(e){const t=this.getNodeFrame(),r=this.getForCompute(e);for(const i of r.updateNodes)t.updateNode(i)}updateForRender(e){const t=this.getNodeFrameForRender(e),r=e.getNodeBuilderState();for(const i of r.updateNodes)t.updateNode(i)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new d3,this.nodeBuilderCache=new Map,this.cacheLib={}}}const Wd=new xg;class Ph{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new DA,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,r){const i=e.length;for(let s=0;s<i;s++){Wd.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=t[r+s],a=Wd.normal;o.x=-a.x,o.y=-a.y,o.z=-a.z,o.w=Wd.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let r=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const i=t.clippingPlanes,s=i.length;let o,a;if(this.clipIntersection?(o=this.intersectionPlanes,a=e.intersectionPlanes.length):(o=this.unionPlanes,a=e.unionPlanes.length),o.length!==a+s){o.length=a+s;for(let c=0;c<s;c++)o[a+c]=new Ft;r=!0}this.projectPlanes(i,o,a),r&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new Ph(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class Tj{constructor(e,t){this.bundleGroup=e,this.camera=t}}const Cu=[];class wj{constructor(){this.bundles=new Gi}get(e,t){const r=this.bundles;Cu[0]=e,Cu[1]=t;let i=r.get(Cu);return i===void 0&&(i=new Tj(e,t),r.set(Cu,i)),Cu.length=0,i}dispose(){this.bundles=new Gi}}class u5{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const r=this.getMaterialNodeClass(e.type);if(r!==null){t=new r;for(const i in e)t[i]=e[i]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,r){if(!r.has(t)){if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);r.set(t,e)}}addClass(e,t,r){if(!r.has(t)){if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);r.set(t,e)}}}const Sj=new d2,Mu=[];class Ej extends Gi{constructor(){super()}createNode(e=[]){return new d2().setLights(e)}getNode(e,t){if(e.isQuadMesh)return Sj;Mu[0]=e,Mu[1]=t;let r=this.get(Mu);return r===void 0&&(r=this.createNode(),this.set(Mu,r)),Mu.length=0,r}}class ju extends Do{constructor(e=1,t=1,r={}){super(e,t,r),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const g3=new we,y3=new we;class Rj extends gg{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new oA,this._cameraL.viewport=new Ft,this._cameraR=new oA,this._cameraR.viewport=new Ft,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new nR,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding=typeof XRWebGLBinding<"u",this._frameBufferTargets=null,this._createXRLayer=Dj.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new ht,this._onSessionEvent=Mj.bind(this),this._onSessionEnd=Pj.bind(this),this._onInputSourcesChange=Bj.bind(this),this._onAnimationFrame=Lj.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getBinding(){return this._glBinding===null&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,r,i,s,o,a,c={}){const f=new rR(e,t),p=new ju(s,o,{format:Li,type:Xr,depthTexture:new qi(s,o,c.stencil?To:Ln,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?wo:So),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});p._autoAllocateDepthBuffer=!0;const g=new ts({color:16777215,side:$u});g.map=p.texture,g.map.offset.y=1,g.map.repeat.y=-1;const v=new hn(f,g);v.position.copy(r),v.quaternion.copy(i);const x={type:"quad",width:e,height:t,translation:r,quaternion:i,pixelwidth:s,pixelheight:o,plane:v,material:g,rendercall:a,renderTarget:p};if(this._layers.push(x),this._session!==null){x.plane.material=new ts({color:16777215,side:$u}),x.plane.material.blending=Hu,x.plane.material.blendEquation=Ps,x.plane.material.blendSrc=ho,x.plane.material.blendDst=ho,x.xrlayer=this._createXRLayer(x);const T=this._session.renderState.layers;T.unshift(x.xrlayer),this._session.updateRenderState({layers:T})}else p.isXRRenderTarget=!1;return v}createCylinderLayer(e,t,r,i,s,o,a,c,f={}){const p=new xb(e,e,e*t/r,64,64,!0,Math.PI-t/2,t),g=new ju(o,a,{format:Li,type:Xr,depthTexture:new qi(o,a,f.stencil?To:Ln,void 0,void 0,void 0,void 0,void 0,void 0,f.stencil?wo:So),stencilBuffer:f.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});g._autoAllocateDepthBuffer=!0;const v=new ts({color:16777215,side:hr});v.map=g.texture,v.map.offset.y=1,v.map.repeat.y=-1;const x=new hn(p,v);x.position.copy(i),x.quaternion.copy(s);const T={type:"cylinder",radius:e,centralAngle:t,aspectratio:r,translation:i,quaternion:s,pixelwidth:o,pixelheight:a,plane:x,material:v,rendercall:c,renderTarget:g};if(this._layers.push(T),this._session!==null){T.plane.material=new ts({color:16777215,side:hr}),T.plane.material.blending=Hu,T.plane.material.blendEquation=Ps,T.plane.material.blendSrc=ho,T.plane.material.blendDst=ho,T.xrlayer=this._createXRLayer(T);const S=this._session.renderState.layers;S.unshift(T.xrlayer),this._session.updateRenderState({layers:S})}else g.isXRRenderTarget=!1;return x}renderLayers(){const e=new we,t=new Ml,r=this._renderer,i=this.isPresenting,s=r.getOutputRenderTarget(),o=r._frameBufferTarget;this.isPresenting=!1;const a=new ht;r.getSize(a);const c=r._quad;for(const f of this._layers)if(f.renderTarget.isXRRenderTarget=this._session!==null,f.renderTarget._hasExternalTextures=f.renderTarget.isXRRenderTarget,f.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){f.xrlayer.transform=new XRRigidTransform(f.plane.getWorldPosition(e),f.plane.getWorldQuaternion(t));const p=this._glBinding.getSubImage(f.xrlayer,this._xrFrame);r.backend.setXRRenderTargetTextures(f.renderTarget,p.colorTexture,void 0),r._setXRLayerSize(f.renderTarget.width,f.renderTarget.height),r.setOutputRenderTarget(f.renderTarget),r.setRenderTarget(null),r._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:g,quad:v}=this._frameBufferTargets.get(f.renderTarget)||{frameBufferTarget:null,quad:null};g?(r._frameBufferTarget=g,r._quad=v):(r._quad=new gf(new En),this._frameBufferTargets.set(f.renderTarget,{frameBufferTarget:r._getFrameBufferTarget(),quad:r._quad})),f.rendercall(),r._frameBufferTarget=null}else r.setRenderTarget(f.renderTarget),f.rendercall();r.setRenderTarget(null),r.setOutputRenderTarget(s),r._frameBufferTarget=o,r._setXRLayerSize(a.x,a.y),r._quad=c,this.isPresenting=i}getSession(){return this._session}async setSession(e){const t=this._renderer,r=t.backend;this._gl=t.getContext();const i=this._gl,s=i.getContextAttributes();if(this._session=e,e!==null){if(r.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await r.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._supportsLayers===!0){let o=null,a=null,c=null;t.depth&&(c=t.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,o=t.stencil?wo:So,a=t.stencil?To:Ln);const f={colorFormat:i.RGBA8,depthFormat:c,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(f.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const p=this._glBinding.createProjectionLayer(f),g=[p];this._glProjLayer=p,t.setPixelRatio(1),t._setXRLayerSize(p.textureWidth,p.textureHeight);const v=this._useMultiview?2:1,x=new qi(p.textureWidth,p.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,o,v);if(this._xrRenderTarget=new ju(p.textureWidth,p.textureHeight,{format:Li,type:Xr,colorSpace:t.outputColorSpace,depthTexture:x,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const T of this._layers)T.plane.material=new ts({color:16777215,side:T.type==="cylinder"?hr:$u}),T.plane.material.blending=Hu,T.plane.material.blendEquation=Ps,T.plane.material.blendSrc=ho,T.plane.material.blendDst=ho,T.xrlayer=this._createXRLayer(T),g.unshift(T.xrlayer);e.updateRenderState({layers:g})}else{const o={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},a=new XRWebGLLayer(e,i,o);this._glBaseLayer=a,e.updateRenderState({baseLayer:a}),t.setPixelRatio(1),t._setXRLayerSize(a.framebufferWidth,a.framebufferHeight),this._xrRenderTarget=new ju(a.framebufferWidth,a.framebufferHeight,{format:Li,type:Xr,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:a.ignoreDepthValues===!1,resolveStencilBuffer:a.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const r=e.near,i=e.far,s=this._cameraXR,o=this._cameraL,a=this._cameraR;s.near=a.near=o.near=r,s.far=a.far=o.far=i,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),s.layers.mask=e.layers.mask|6,o.layers.mask=s.layers.mask&3,a.layers.mask=s.layers.mask&5;const c=e.parent,f=s.cameras;_3(s,c);for(let p=0;p<f.length;p++)_3(f[p],c);f.length===2?Nj(s,o,a):s.projectionMatrix.copy(o.projectionMatrix),Cj(e,s,c)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new iR,this._controllers[e]=t),t}}function Nj(n,e,t){g3.setFromMatrixPosition(e.matrixWorld),y3.setFromMatrixPosition(t.matrixWorld);const r=g3.distanceTo(y3),i=e.projectionMatrix.elements,s=t.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),c=(i[9]+1)/i[5],f=(i[9]-1)/i[5],p=(i[8]-1)/i[0],g=(s[8]+1)/s[0],v=o*p,x=o*g,T=r/(-p+g),S=T*-p;if(e.matrixWorld.decompose(n.position,n.quaternion,n.scale),n.translateX(S),n.translateZ(T),n.matrixWorld.compose(n.position,n.quaternion,n.scale),n.matrixWorldInverse.copy(n.matrixWorld).invert(),i[10]===-1)n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const R=o+T,C=a+T,B=v-S,D=x+(r-S),F=c*a/C*R,I=f*a/C*R;n.projectionMatrix.makePerspective(B,D,F,I,R,C),n.projectionMatrixInverse.copy(n.projectionMatrix).invert()}}function _3(n,e){e===null?n.matrixWorld.copy(n.matrix):n.matrixWorld.multiplyMatrices(e.matrixWorld,n.matrix),n.matrixWorldInverse.copy(n.matrixWorld).invert()}function Cj(n,e,t){t===null?n.matrix.copy(e.matrixWorld):(n.matrix.copy(t.matrixWorld),n.matrix.invert(),n.matrix.multiply(e.matrixWorld)),n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld(!0),n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse),n.isPerspectiveCamera&&(n.fov=xR*2*Math.atan(1/n.projectionMatrix.elements[5]),n.zoom=1)}function Mj(n){const e=this._controllerInputSources.indexOf(n.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const r=this.getReferenceSpace();t.update(n.inputSource,n.frame,r),t.dispatchEvent({type:n.type,data:n.inputSource})}}function Pj(){const n=this._session,e=this._renderer;n.removeEventListener("select",this._onSessionEvent),n.removeEventListener("selectstart",this._onSessionEvent),n.removeEventListener("selectend",this._onSessionEvent),n.removeEventListener("squeeze",this._onSessionEvent),n.removeEventListener("squeezestart",this._onSessionEvent),n.removeEventListener("squeezeend",this._onSessionEvent),n.removeEventListener("end",this._onSessionEnd),n.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const r=this._controllerInputSources[t];r!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(r))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._sessionUsesLayers===!0)for(const t of this._layers)t.renderTarget=new ju(t.pixelwidth,t.pixelheight,{format:Li,type:Xr,depthTexture:new qi(t.pixelwidth,t.pixelheight,t.stencilBuffer?To:Ln,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?wo:So),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function Bj(n){const e=this._controllers,t=this._controllerInputSources;for(let r=0;r<n.removed.length;r++){const i=n.removed[r],s=t.indexOf(i);s>=0&&(t[s]=null,e[s].disconnect(i))}for(let r=0;r<n.added.length;r++){const i=n.added[r];let s=t.indexOf(i);if(s===-1){for(let a=0;a<e.length;a++)if(a>=t.length){t.push(i),s=a;break}else if(t[a]===null){t[a]=i,s=a;break}if(s===-1)break}const o=e[s];o&&o.connect(i)}}function Dj(n){return n.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(n.translation,n.quaternion),width:n.width/2,height:n.height/2,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(n.translation,n.quaternion),radius:n.radius,centralAngle:n.centralAngle,aspectRatio:n.aspectRatio,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight,clearOnAccess:!1})}function Lj(n,e){if(e===void 0)return;const t=this._cameraXR,r=this._renderer,i=r.backend,s=this._glBaseLayer,o=this.getReferenceSpace(),a=e.getViewerPose(o);if(this._xrFrame=e,a!==null){const c=a.views;this._glBaseLayer!==null&&i.setXRTarget(s.framebuffer);let f=!1;c.length!==t.cameras.length&&(t.cameras.length=0,f=!0);for(let p=0;p<c.length;p++){const g=c[p];let v;if(this._supportsLayers===!0){const T=this._glBinding.getViewSubImage(this._glProjLayer,g);v=T.viewport,p===0&&i.setXRRenderTargetTextures(this._xrRenderTarget,T.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:T.depthStencilTexture)}else v=s.getViewport(g);let x=this._cameras[p];x===void 0&&(x=new oA,x.layers.enable(p),x.viewport=new Ft,this._cameras[p]=x),x.matrix.fromArray(g.transform.matrix),x.matrix.decompose(x.position,x.quaternion,x.scale),x.projectionMatrix.fromArray(g.projectionMatrix),x.projectionMatrixInverse.copy(x.projectionMatrix).invert(),x.viewport.set(v.x,v.y,v.width,v.height),p===0&&(t.matrix.copy(x.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),f===!0&&t.cameras.push(x)}r.setOutputRenderTarget(this._xrRenderTarget)}for(let c=0;c<this._controllers.length;c++){const f=this._controllerInputSources[c],p=this._controllers[c];f!==null&&p!==void 0&&p.update(f,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(n,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const v3=new Ih,nl=new ht,Qd=new Ft,Xd=new yb,Yd=new $E,Uc=new gn,Rs=new Ft;class Oj{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:r=!1,alpha:i=!0,depth:s=!0,stencil:o=!1,antialias:a=!1,samples:c=0,getFallback:f=null,colorBufferType:p=wr,multiview:g=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=c||a===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=i,this.logarithmicDepthBuffer=r,this.outputColorSpace=BA,this.toneMapping=Tl,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=o,this.info=new zk,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new u5,this.lighting=new Ej,this._getFallback=f,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Ft(0,0,this._width,this._height),this._scissor=new Ft(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new gf(new En),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const v=this.alpha===!0?0:1;this._clearColor=new s2(0,0,0,v),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=p,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:jE},this.xr=new Rj(this,g),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(x,T,S)=>{await this.compileAsync(x,T);const R=this._renderLists.get(x,T),C=this._renderContexts.get(x,T,this._renderTarget),B=x.overrideMaterial||S.material,D=this._objects.get(S,B,x,T,R.lightsNode,C,C.clippingContext),{fragmentShader:F,vertexShader:I}=D.getNodeBuilderState();return{fragmentShader:F,vertexShader:I}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let r=this.backend;try{await r.init(this)}catch(i){if(this._getFallback!==null)try{this.backend=r=this._getFallback(i),await r.init(this)}catch(s){t(s);return}else{t(i);return}}this._nodes=new xj(this,r),this._animation=new Lk(this._nodes,this.info),this._attributes=new Gk(r),this._background=new kz(this,this._nodes),this._geometries=new Vk(this._attributes,this.info),this._textures=new iq(this,r,this.info),this._pipelines=new Wk(r,this._nodes),this._bindings=new Qk(r,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new kk(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new Kk(this.lighting),this._bundles=new wj,this._renderContexts=new nq,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,r=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const i=this._nodes.nodeFrame,s=i.renderId,o=this._currentRenderContext,a=this._currentRenderObjectFunction,c=this._compilationPromises,f=e.isScene===!0?e:v3;r===null&&(r=e);const p=this._renderTarget,g=this._renderContexts.get(r,t,p),v=this._activeMipmapLevel,x=[];this._currentRenderContext=g,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=x,i.renderId++,i.update(),g.depth=this.depth,g.stencil=this.stencil,g.clippingContext||(g.clippingContext=new Ph),g.clippingContext.updateGlobal(f,t),f.onBeforeRender(this,e,t,p);const T=this._renderLists.get(e,t);if(T.begin(),this._projectObject(e,t,0,T,g.clippingContext),r!==e&&r.traverseVisible(function(D){D.isLight&&D.layers.test(t.layers)&&T.pushLight(D)}),T.finish(),p!==null){this._textures.updateRenderTarget(p,v);const D=this._textures.get(p);g.textures=D.textures,g.depthTexture=D.depthTexture}else g.textures=null,g.depthTexture=null;this._background.update(f,T,g);const S=T.opaque,R=T.transparent,C=T.transparentDoublePass,B=T.lightsNode;this.opaque===!0&&S.length>0&&this._renderObjects(S,t,f,B),this.transparent===!0&&R.length>0&&this._renderTransparents(R,C,t,f,B),i.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=a,this._compilationPromises=c,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(x)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=Lm,this.overrideNodes.modelNormalViewMatrix=Om):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===Lm&&this.overrideNodes.modelNormalViewMatrix===Om}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),this._isDeviceLost=!0}_renderBundle(e,t,r){const{bundleGroup:i,camera:s,renderList:o}=e,a=this._currentRenderContext,c=this._bundles.get(i,s),f=this.backend.get(c);f.renderContexts===void 0&&(f.renderContexts=new Set);const p=i.version!==f.version,g=f.renderContexts.has(a)===!1||p;if(f.renderContexts.add(a),g){this.backend.beginBundle(a),(f.renderObjects===void 0||p)&&(f.renderObjects=[]),this._currentRenderBundle=c;const{transparentDoublePass:v,transparent:x,opaque:T}=o;this.opaque===!0&&T.length>0&&this._renderObjects(T,s,t,r),this.transparent===!0&&x.length>0&&this._renderTransparents(x,v,s,t,r),this._currentRenderBundle=null,this.backend.finishBundle(a,c),f.version=i.version}else{const{renderObjects:v}=f;for(let x=0,T=v.length;x<T;x++){const S=v[x];this._nodes.needsRefresh(S)&&(this._nodes.updateBefore(S),this._nodes.updateForRender(S),this._bindings.updateForRender(S),this._nodes.updateAfter(S))}}this.backend.addBundle(a,c)}render(e,t){if(this._initialized===!1)return this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,r=e!==Tl,i=t!==Tn.workingColorSpace;if(r===!1&&i===!1)return null;const{width:s,height:o}=this.getDrawingBufferSize(nl),{depth:a,stencil:c}=this;let f=this._frameBufferTarget;f===null&&(f=new Do(s,o,{depthBuffer:a,stencilBuffer:c,type:this._colorBufferType,format:Li,colorSpace:Tn.workingColorSpace,generateMipmaps:!1,minFilter:qs,magFilter:qs,samples:this.samples}),f.isPostProcessingRenderTarget=!0,this._frameBufferTarget=f);const p=this.getOutputRenderTarget();return f.depthBuffer=a,f.stencilBuffer=c,p!==null?f.setSize(p.width,p.height,p.depth):f.setSize(s,o,1),f.viewport.copy(this._viewport),f.scissor.copy(this._scissor),f.viewport.multiplyScalar(this._pixelRatio),f.scissor.multiplyScalar(this._pixelRatio),f.scissorTest=this._scissorTest,f.multiview=p!==null?p.multiview:!1,f.resolveDepthBuffer=p!==null?p.resolveDepthBuffer:!0,f._autoAllocateDepthBuffer=p!==null?p._autoAllocateDepthBuffer:!1,f}_renderScene(e,t,r=!0){if(this._isDeviceLost===!0)return;const i=r?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,c=this._currentRenderObjectFunction,f=e.isScene===!0?e:v3,p=this._renderTarget||this._outputRenderTarget,g=this._activeCubeFace,v=this._activeMipmapLevel;let x;i!==null?(x=i,this.setRenderTarget(x)):x=p;const T=this._renderContexts.get(e,t,x);this._currentRenderContext=T,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls;const S=this.coordinateSystem,R=this.xr;if(t.coordinateSystem!==S&&R.isPresenting===!1&&(t.coordinateSystem=S,t.updateProjectionMatrix(),t.isArrayCamera))for(const Z of t.cameras)Z.coordinateSystem=S,Z.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),R.enabled===!0&&R.isPresenting===!0&&(R.cameraAutoUpdate===!0&&R.updateCamera(t),t=R.getCamera());let C=this._viewport,B=this._scissor,D=this._pixelRatio;x!==null&&(C=x.viewport,B=x.scissor,D=1),this.getDrawingBufferSize(nl),Qd.set(0,0,nl.width,nl.height);const F=C.minDepth===void 0?0:C.minDepth,I=C.maxDepth===void 0?1:C.maxDepth;T.viewportValue.copy(C).multiplyScalar(D).floor(),T.viewportValue.width>>=v,T.viewportValue.height>>=v,T.viewportValue.minDepth=F,T.viewportValue.maxDepth=I,T.viewport=T.viewportValue.equals(Qd)===!1,T.scissorValue.copy(B).multiplyScalar(D).floor(),T.scissor=this._scissorTest&&T.scissorValue.equals(Qd)===!1,T.scissorValue.width>>=v,T.scissorValue.height>>=v,T.clippingContext||(T.clippingContext=new Ph),T.clippingContext.updateGlobal(f,t),f.onBeforeRender(this,e,t,x);const q=t.isArrayCamera?Yd:Xd;t.isArrayCamera||(Uc.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),q.setFromProjectionMatrix(Uc,t.coordinateSystem,t.reversedDepth));const k=this._renderLists.get(e,t);if(k.begin(),this._projectObject(e,t,0,k,T.clippingContext),k.finish(),this.sortObjects===!0&&k.sort(this._opaqueSort,this._transparentSort),x!==null){this._textures.updateRenderTarget(x,v);const Z=this._textures.get(x);T.textures=Z.textures,T.depthTexture=Z.depthTexture,T.width=Z.width,T.height=Z.height,T.renderTarget=x,T.depth=x.depthBuffer,T.stencil=x.stencilBuffer}else T.textures=null,T.depthTexture=null,T.width=nl.width,T.height=nl.height,T.depth=this.depth,T.stencil=this.stencil;T.width>>=v,T.height>>=v,T.activeCubeFace=g,T.activeMipmapLevel=v,T.occlusionQueryCount=k.occlusionQueryCount,T.scissorValue.max(Rs.set(0,0,0,0)),T.scissorValue.x+T.scissorValue.width>T.width&&(T.scissorValue.width=Math.max(T.width-T.scissorValue.x,0)),T.scissorValue.y+T.scissorValue.height>T.height&&(T.scissorValue.height=Math.max(T.height-T.scissorValue.y,0)),this._background.update(f,k,T),T.camera=t,this.backend.beginRender(T);const{bundles:G,lightsNode:j,transparentDoublePass:ee,transparent:Q,opaque:Y}=k;return G.length>0&&this._renderBundles(G,f,j),this.opaque===!0&&Y.length>0&&this._renderObjects(Y,t,f,j),this.transparent===!0&&Q.length>0&&this._renderTransparents(Q,ee,t,f,j),this.backend.finishRender(T),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=c,i!==null&&(this.setRenderTarget(p,g,v),this._renderOutput(x)),f.onAfterRender(this,e,t,x),T}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const r=this.autoClear,i=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=r,this.xr.enabled=i}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,r){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=r,this.domElement.width=Math.floor(e*r),this.domElement.height=Math.floor(t*r),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,r=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),r===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,r,i){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,r,i)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,r,i,s=0,o=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,r,i),a.minDepth=s,a.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,r=!0){if(this._initialized===!1)return this.clearAsync(e,t,r);const i=this._renderTarget||this._getFrameBufferTarget();let s=null;if(i!==null){this._textures.updateRenderTarget(i);const o=this._textures.get(i);s=this._renderContexts.getForClear(i),s.textures=o.textures,s.depthTexture=o.depthTexture,s.width=o.width,s.height=o.height,s.renderTarget=i,s.depth=i.depthBuffer,s.stencil=i.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,r,s),i!==null&&this._renderTarget===null&&this._renderOutput(i)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,r=!0){this._initialized===!1&&await this.init(),this.clear(e,t,r)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:Tl}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Tn.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this._initialized===!0&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,r=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=r}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return this.computeAsync(e);const r=this._nodes.nodeFrame,i=r.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,r.renderId=this.info.calls;const s=this.backend,o=this._pipelines,a=this._bindings,c=this._nodes,f=Array.isArray(e)?e:[e];if(f[0]===void 0||f[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const p of f){if(o.has(p)===!1){const x=()=>{p.removeEventListener("dispose",x),o.delete(p),a.delete(p),c.delete(p)};p.addEventListener("dispose",x);const T=p.onInitFunction;T!==null&&T.call(p,{renderer:this})}c.updateForCompute(p),a.updateForCompute(p);const g=a.getForCompute(p),v=o.getForCompute(p,g);s.compute(e,p,g,v,t)}s.finishCompute(e),r.renderId=i}async computeAsync(e,t=null){this._initialized===!1&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?!1:this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized,this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=Rs.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=Rs.copy(t).floor();else return;else t=Rs.set(0,0,e.image.width,e.image.height);let r=this._currentRenderContext,i;r!==null?i=r.renderTarget:(i=this._renderTarget||this._getFrameBufferTarget(),i!==null&&(this._textures.updateRenderTarget(i),r=this._textures.get(i))),this._textures.updateTexture(e,{renderTarget:i}),this.backend.copyFramebufferToTexture(e,r,t)}copyTextureToTexture(e,t,r=null,i=null,s=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,r,i,s,o)}async readRenderTargetPixelsAsync(e,t,r,i,s,o=0,a=0){return this.backend.copyTextureToBuffer(e.textures[o],t,r,i,s,a)}_projectObject(e,t,r,i,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)r=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)i.pushLight(e);else if(e.isSprite){const c=t.isArrayCamera?Yd:Xd;if(!e.frustumCulled||c.intersectsSprite(e,t)){this.sortObjects===!0&&Rs.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Uc);const{geometry:f,material:p}=e;p.visible&&i.push(e,f,p,r,Rs.z,null,s)}}else if(!e.isLineLoop){if(e.isMesh||e.isLine||e.isPoints){const c=t.isArrayCamera?Yd:Xd;if(!e.frustumCulled||c.intersectsObject(e,t)){const{geometry:f,material:p}=e;if(this.sortObjects===!0&&(f.boundingSphere===null&&f.computeBoundingSphere(),Rs.copy(f.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(Uc)),Array.isArray(p)){const g=f.groups;for(let v=0,x=g.length;v<x;v++){const T=g[v],S=p[T.materialIndex];S&&S.visible&&i.push(e,f,S,r,Rs.z,T,s)}}else p.visible&&i.push(e,f,p,r,Rs.z,null,s)}}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const c=i;i=this._renderLists.get(e,t),i.begin(),c.pushBundle({bundleGroup:e,camera:t,renderList:i}),i.finish()}const a=e.children;for(let c=0,f=a.length;c<f;c++)this._projectObject(a[c],t,r,i,s)}_renderBundles(e,t,r){for(const i of e)this._renderBundle(i,t,r)}_renderTransparents(e,t,r,i,s){if(t.length>0){for(const{material:o}of t)o.side=hr;this._renderObjects(t,r,i,s,"backSide");for(const{material:o}of t)o.side=$u;this._renderObjects(e,r,i,s);for(const{material:o}of t)o.side=fi}else this._renderObjects(e,r,i,s)}_renderObjects(e,t,r,i,s=null){for(let o=0,a=e.length;o<a;o++){const{object:c,geometry:f,material:p,group:g,clippingContext:v}=e[o];this._currentRenderObjectFunction(c,r,t,f,p,g,i,v,s)}}renderObject(e,t,r,i,s,o,a,c=null,f=null){let p,g,v;if(e.onBeforeRender(this,t,r,i,s,o),s.allowOverride===!0&&t.overrideMaterial!==null){const x=t.overrideMaterial;s.positionNode&&s.positionNode.isNode&&(p=x.positionNode,x.positionNode=s.positionNode),x.alphaTest=s.alphaTest,x.alphaMap=s.alphaMap,x.transparent=s.transparent||s.transmission>0,x.isShadowPassMaterial&&(x.side=s.shadowSide===null?s.side:s.shadowSide,s.depthNode&&s.depthNode.isNode&&(v=x.depthNode,x.depthNode=s.depthNode),s.castShadowNode&&s.castShadowNode.isNode&&(g=x.colorNode,x.colorNode=s.castShadowNode),s.castShadowPositionNode&&s.castShadowPositionNode.isNode&&(p=x.positionNode,x.positionNode=s.castShadowPositionNode)),s=x}s.transparent===!0&&s.side===fi&&s.forceSinglePass===!1?(s.side=hr,this._handleObjectFunction(e,s,t,r,a,o,c,"backSide"),s.side=$u,this._handleObjectFunction(e,s,t,r,a,o,c,f),s.side=fi):this._handleObjectFunction(e,s,t,r,a,o,c,f),p!==void 0&&(t.overrideMaterial.positionNode=p),v!==void 0&&(t.overrideMaterial.depthNode=v),g!==void 0&&(t.overrideMaterial.colorNode=g),e.onAfterRender(this,t,r,i,s,o)}_renderObjectDirect(e,t,r,i,s,o,a,c){const f=this._objects.get(e,t,r,i,s,this._currentRenderContext,a,c);f.drawRange=e.geometry.drawRange,f.group=o;const p=this._nodes.needsRefresh(f);p&&(this._nodes.updateBefore(f),this._geometries.updateForRender(f),this._nodes.updateForRender(f),this._bindings.updateForRender(f)),this._pipelines.updateForRender(f),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(f),f.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(f,this.info),p&&this._nodes.updateAfter(f)}_createObjectPipeline(e,t,r,i,s,o,a,c){const f=this._objects.get(e,t,r,i,s,this._currentRenderContext,a,c);f.drawRange=e.geometry.drawRange,f.group=o,this._nodes.updateBefore(f),this._geometries.updateForRender(f),this._nodes.updateForRender(f),this._bindings.updateForRender(f),this._pipelines.getForRender(f,this._compilationPromises),this._nodes.updateAfter(f)}get compile(){return this.compileAsync}}class A5{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function Fj(n){return n+(_o-n%_o)%_o}class c5 extends A5{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return Fj(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class h5 extends c5{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let Ij=0;class f5 extends h5{constructor(e,t){super("UniformBuffer_"+Ij++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class kj extends h5{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let r=0,i=this.uniforms.length;r<i;r++){const s=this.uniforms[r],o=s.boundary,a=s.itemSize*e,c=t%_o,f=c%o,p=c+f;t+=f,p!==0&&_o-p<a&&(t+=_o-p),s.offset=t/e,t+=a}return Math.ceil(t/_o)*_o}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e)}updateNumber(e){let t=!1;const r=this.values,i=e.getValue(),s=e.offset,o=e.getType();if(r[s]!==i){const a=this._getBufferForType(o);a[s]=r[s]=i,t=!0}return t}updateVector2(e){let t=!1;const r=this.values,i=e.getValue(),s=e.offset,o=e.getType();if(r[s+0]!==i.x||r[s+1]!==i.y){const a=this._getBufferForType(o);a[s+0]=r[s+0]=i.x,a[s+1]=r[s+1]=i.y,t=!0}return t}updateVector3(e){let t=!1;const r=this.values,i=e.getValue(),s=e.offset,o=e.getType();if(r[s+0]!==i.x||r[s+1]!==i.y||r[s+2]!==i.z){const a=this._getBufferForType(o);a[s+0]=r[s+0]=i.x,a[s+1]=r[s+1]=i.y,a[s+2]=r[s+2]=i.z,t=!0}return t}updateVector4(e){let t=!1;const r=this.values,i=e.getValue(),s=e.offset,o=e.getType();if(r[s+0]!==i.x||r[s+1]!==i.y||r[s+2]!==i.z||r[s+4]!==i.w){const a=this._getBufferForType(o);a[s+0]=r[s+0]=i.x,a[s+1]=r[s+1]=i.y,a[s+2]=r[s+2]=i.z,a[s+3]=r[s+3]=i.w,t=!0}return t}updateColor(e){let t=!1;const r=this.values,i=e.getValue(),s=e.offset;if(r[s+0]!==i.r||r[s+1]!==i.g||r[s+2]!==i.b){const o=this.buffer;o[s+0]=r[s+0]=i.r,o[s+1]=r[s+1]=i.g,o[s+2]=r[s+2]=i.b,t=!0}return t}updateMatrix3(e){let t=!1;const r=this.values,i=e.getValue().elements,s=e.offset;if(r[s+0]!==i[0]||r[s+1]!==i[1]||r[s+2]!==i[2]||r[s+4]!==i[3]||r[s+5]!==i[4]||r[s+6]!==i[5]||r[s+8]!==i[6]||r[s+9]!==i[7]||r[s+10]!==i[8]){const o=this.buffer;o[s+0]=r[s+0]=i[0],o[s+1]=r[s+1]=i[1],o[s+2]=r[s+2]=i[2],o[s+4]=r[s+4]=i[3],o[s+5]=r[s+5]=i[4],o[s+6]=r[s+6]=i[5],o[s+8]=r[s+8]=i[6],o[s+9]=r[s+9]=i[7],o[s+10]=r[s+10]=i[8],t=!0}return t}updateMatrix4(e){let t=!1;const r=this.values,i=e.getValue().elements,s=e.offset;return Uj(r,i,s)===!1&&(this.buffer.set(i,s),qj(r,i,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function qj(n,e,t){for(let r=0,i=e.length;r<i;r++)n[t+r]=e[r]}function Uj(n,e,t){for(let r=0,i=e.length;r<i;r++)if(n[t+r]!==e[r])return!1;return!0}let Gj=0;class d5 extends kj{constructor(e,t){super(e),this.id=Gj++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class p5 extends A5{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.generation=null,this.isSampler=!0}set texture(e){if(this._texture===e)return;const t=()=>{this._texture=null,this.generation=null,this.version=0};this._texture&&this._texture.removeEventListener("dispose",t),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",t)}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}clone(){const e=super.clone();return e._texture=null,e.texture=this.texture,e}}let Vj=0;class zj extends p5{constructor(e,t){super(e,t),this.id=Vj++,this.store=!1,this.isSampledTexture=!0}}class Tf extends zj{constructor(e,t,r,i=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r,this.access=i}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class m5 extends Tf{constructor(e,t,r,i=null){super(e,t,r,i),this.isSampledCubeTexture=!0}}class Xm extends Tf{constructor(e,t,r,i=null){super(e,t,r,i),this.isSampledTexture3D=!0}}const b3={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint"},jj={low:"lowp",medium:"mediump",high:"highp"},x3={swizzleAssign:!0,storageBuffer:!1},T3={perspective:"smooth",linear:"noperspective"},w3={centroid:"centroid"},S3=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class $j extends a5{constructor(e,t){super(e,t,new bj),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Pl}getMethod(e){return b3[e]||e}getBitcastMethod(e,t){return b3[`bitcast_${t}_${e}`]}getTernary(e,t,r){return`${e} ? ${t} : ${r}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),i=[];for(const o of t.inputs)i.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${i.join(", ")} ) {

	${r.vars}

${r.code}
	return ${r.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const r=t.array,i=t.count*t.itemSize,{itemSize:s}=t,o=t.array.constructor.name.toLowerCase().includes("int");let a=o?Ng:Rg;s===2?a=o?Cg:ca:s===3?a=o?jR:Eg:s===4&&(a=o?Mg:Li);const c={Float32Array:ui,Uint8Array:Xr,Uint16Array:fl,Uint32Array:Ln,Int8Array:Wu,Int16Array:Qu,Int32Array:vr,Uint8ClampedArray:Xr},f=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(i/s))));let p=Math.ceil(i/s/f);f*p*s<i&&p++;const g=f*p*s,v=new r.constructor(g);v.set(r,0),t.array=v;const x=new fR(t.array,f,p,a,c[t.array.constructor.name]||ui);x.needsUpdate=!0,x.isPBOTexture=!0;const T=new ms(x,null,null);T.setPrecision("high"),t.pboNode=T,t.pbo=T.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:r}=e,i=t.value;if(this.renderer.backend.has(i)){const p=this.renderer.backend.get(i);p.pbo=i.pbo}const s=this.getUniformFromNode(i.pboNode,"texture",this.shaderStage,this.context.nodeName),o=this.getPropertyName(s);this.increaseUsage(r);const a=r.build(this,"uint"),c=this.getDataFromNode(e);let f=c.propertyName;if(f===void 0){const p=this.getVarFromNode(e);f=this.getPropertyName(p);const g=this.getDataFromNode(t);let v=g.propertySizeName;v===void 0&&(v=f+"Size",this.getVarFromNode(t,v,"uint"),this.addLineFlowCode(`${v} = uint( textureSize( ${o}, 0 ).x )`,e),g.propertySizeName=v);const{itemSize:x}=i,T="."+Ca.join("").slice(0,x),S=`ivec2(${a} % ${v}, ${a} / ${v})`,R=this.generateTextureLoad(null,o,S,null,null,"0");let C="vec4";i.pbo.type===Ln?C="uvec4":i.pbo.type===vr&&(C="ivec4"),this.addLineFlowCode(`${f} = ${C}(${R})${T}`,e),c.propertyName=f}return f}generateTextureLoad(e,t,r,i,s,o="0"){let a;return i?s?a=`texelFetchOffset( ${t}, ivec3( ${r}, ${i} ), ${o}, ${s} )`:a=`texelFetch( ${t}, ivec3( ${r}, ${i} ), ${o} )`:s?a=`texelFetchOffset( ${t}, ${r}, ${o}, ${s} )`:a=`texelFetch( ${t}, ${r}, ${o} )`,e!==null&&e.isDepthTexture&&(a+=".x"),a}generateTexture(e,t,r,i,s){return i&&(r=`vec3( ${r}, ${i} )`),e.isDepthTexture?s?`textureOffset( ${t}, ${r}, ${s} ).x`:`texture( ${t}, ${r} ).x`:s?`textureOffset( ${t}, ${r}, ${s} )`:`texture( ${t}, ${r} )`}generateTextureLevel(e,t,r,i,s){return s?`textureLodOffset( ${t}, ${r}, ${i}, ${s} )`:`textureLod( ${t}, ${r}, ${i} )`}generateTextureBias(e,t,r,i,s){return s?`textureOffset( ${t}, ${r}, ${s}, ${i} )`:`texture( ${t}, ${r}, ${i} )`}generateTextureGrad(e,t,r,i,s){return s?`textureGradOffset( ${t}, ${r}, ${i[0]}, ${i[1]}, ${s} )`:`textureGrad( ${t}, ${r}, ${i[0]}, ${i[1]} )`}generateTextureCompare(e,t,r,i,s,o,a=this.shaderStage){if(a==="fragment")return s?o?`textureOffset( ${t}, vec4( ${r}, ${s}, ${i} ), ${o} )`:`texture( ${t}, vec4( ${r}, ${s}, ${i} ) )`:o?`textureOffset( ${t}, vec3( ${r}, ${i} ), ${o} )`:`texture( ${t}, vec3( ${r}, ${i} ) )`}getVars(e){const t=[],r=this.vars[e];if(r!==void 0)for(const i of r)t.push(`${this.getVar(i.type,i.name,i.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],r=[],i={};for(const o of t){let a=null,c=!1;if(o.type==="texture"||o.type==="texture3D"){const p=o.node.value;let g="";(p.isDataTexture===!0||p.isData3DTexture===!0)&&(p.type===Ln?g="u":p.type===vr&&(g="i")),o.type==="texture3D"&&p.isArrayTexture===!1?a=`${g}sampler3D ${o.name};`:p.compareFunction?p.isArrayTexture===!0?a=`sampler2DArrayShadow ${o.name};`:a=`sampler2DShadow ${o.name};`:p.isArrayTexture===!0||p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0?a=`${g}sampler2DArray ${o.name};`:a=`${g}sampler2D ${o.name};`}else if(o.type==="cubeTexture")a=`samplerCube ${o.name};`;else if(o.type==="buffer"){const p=o.node,g=this.getType(p.bufferType),v=p.bufferCount,x=v>0?v:"";a=`${p.name} {
	${g} ${o.name}[${x}];
};
`}else a=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,c=!0;const f=o.node.precision;if(f!==null&&(a=jj[f]+" "+a),c){a="	"+a;const p=o.groupNode.name;(i[p]||(i[p]=[])).push(a)}else a="uniform "+a,r.push(a)}let s="";for(const o in i){const a=i[o];s+=this._getGLSLUniformStruct(e+"_"+o,a.join(`
`))+`
`}return s+=r.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==vr){let r=e;e.isInterleavedBufferAttribute&&(r=e.data);const i=r.array;i instanceof Uint32Array||i instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const r=this.getAttributesArray();let i=0;for(const s of r)t+=`layout( location = ${i++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const r of e.members)t.push(`	${r.type} ${r.name};`);return t.join(`
`)}getStructs(e){const t=[],r=this.structs[e],i=[];for(const s of r)if(s.output)for(const o of s.members)i.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+s.name+` {
`;o+=this.getStructMembers(s),o+=`
};
`,t.push(o)}return i.length===0&&i.push("layout( location = 0 ) out vec4 fragColor;"),`
`+i.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const r=this.varyings;if(e==="vertex"||e==="compute")for(const i of r){e==="compute"&&(i.needsInterpolation=!0);const s=this.getType(i.type);if(i.needsInterpolation)if(i.interpolationType){const o=T3[i.interpolationType]||i.interpolationType,a=w3[i.interpolationSampling]||"";t+=`${o} ${a} out ${s} ${i.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}out ${s} ${i.name};
`}else t+=`${s} ${i.name};
`}else if(e==="fragment"){for(const i of r)if(i.needsInterpolation){const s=this.getType(i.type);if(i.interpolationType){const o=T3[i.interpolationType]||i.interpolationType,a=w3[i.interpolationSampling]||"";t+=`${o} ${a} in ${s} ${i.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}in ${s} ${i.name};
`}}}for(const i of this.builtins[e])t+=`${i};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((r,i)=>r*i,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,r=this.shaderStage){const i=this.extensions[r]||(this.extensions[r]=new Map);i.has(e)===!1&&i.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const i=this.renderer.backend.extensions;this.object.isBatchedMesh&&i.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const r=this.extensions[e];if(r!==void 0)for(const{name:i,behavior:s}of r.values())t.push(`#extension ${i} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=x3[e];if(t===void 0){let r;switch(t=!1,e){case"float32Filterable":r="OES_texture_float_linear";break;case"clipDistance":r="WEBGL_clip_cull_distance";break}if(r!==void 0){const i=this.renderer.backend.extensions;i.has(r)&&(i.get(r),t=!0)}x3[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let r=0;r<e.length;r++){const i=e[r],s=this.getPropertyName(i.attributeNode);s&&(t+=`${i.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${S3}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${S3}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let r=`// code

`;r+=this.flowCode[t];const i=this.flowNodes[t],s=i[i.length-1];for(const a of i){const c=this.getFlowData(a),f=a.name;f&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${f}
	`),r+=`${c.code}
	`,a===s&&t!=="compute"&&(r+=`// result
	`,t==="vertex"?(r+="gl_Position = ",r+=`${c.result};`):t==="fragment"&&(a.outputNode.isOutputStructNode||(r+="fragColor = ",r+=`${c.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=r}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,r,i=null){const s=super.getUniformFromNode(e,t,r,i),o=this.getDataFromNode(e,r,this.globalCache);let a=o.uniformGPU;if(a===void 0){const c=e.groupNode,f=c.name,p=this.getBindGroupArray(f,r);if(t==="texture")a=new Tf(s.name,s.node,c),p.push(a);else if(t==="cubeTexture")a=new m5(s.name,s.node,c),p.push(a);else if(t==="texture3D")a=new Xm(s.name,s.node,c),p.push(a);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,s.name=`buffer${e.id}`;const g=new f5(e,c);g.name=e.name,p.push(g),a=g}else{const g=this.uniformGroups[r]||(this.uniformGroups[r]={});let v=g[f];v===void 0&&(v=new d5(r+"_"+f,c),g[f]=v,p.push(v)),a=this.getNodeUniform(s,t),v.addUniform(a)}o.uniformGPU=a}return s}}let Kd=null,rl=null;class g5{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}getTimestampUID(e){const t=this.get(e);let r=e.isComputeNode===!0?"c":"r";return r+=":"+t.frameCalls+":"+e.id,r}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){ki("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){ki(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const r=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=r,r}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return Kd=Kd||new ht,this.renderer.getDrawingBufferSize(Kd)}setScissorTest(){}getClearColor(){const e=this.renderer;return rl=rl||new s2,e.getClearColor(rl),rl.getRGB(rl),rl}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:sR(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Tg} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let Hj=0;class Wj{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class Qj{constructor(e){this.backend=e}createAttribute(e,t){const r=this.backend,{gl:i}=r,s=e.array,o=e.usage||i.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,c=r.get(a);let f=c.bufferGPU;f===void 0&&(f=this._createBuffer(i,t,s,o),c.bufferGPU=f,c.bufferType=t,c.version=a.version);let p;if(s instanceof Float32Array)p=i.FLOAT;else if(typeof Float16Array<"u"&&s instanceof Float16Array)p=i.HALF_FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?p=i.HALF_FLOAT:p=i.UNSIGNED_SHORT;else if(s instanceof Int16Array)p=i.SHORT;else if(s instanceof Uint32Array)p=i.UNSIGNED_INT;else if(s instanceof Int32Array)p=i.INT;else if(s instanceof Int8Array)p=i.BYTE;else if(s instanceof Uint8Array)p=i.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)p=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let g={bufferGPU:f,bufferType:t,type:p,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:p===i.INT||p===i.UNSIGNED_INT||e.gpuType===vr,id:Hj++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const v=this._createBuffer(i,t,s,o);g=new Wj(g,v)}r.set(e,g)}updateAttribute(e){const t=this.backend,{gl:r}=t,i=e.array,s=e.isInterleavedBufferAttribute?e.data:e,o=t.get(s),a=o.bufferType,c=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(r.bindBuffer(a,o.bufferGPU),c.length===0)r.bufferSubData(a,0,i);else{for(let f=0,p=c.length;f<p;f++){const g=c[f];r.bufferSubData(a,g.start*i.BYTES_PER_ELEMENT,i,g.start,g.count)}s.clearUpdateRanges()}r.bindBuffer(a,null),o.version=s.version}destroyAttribute(e){const t=this.backend,{gl:r}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const i=t.get(e);r.deleteBuffer(i.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:r}=t,i=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(i),o=e.array,a=o.byteLength;r.bindBuffer(r.COPY_READ_BUFFER,s);const c=r.createBuffer();r.bindBuffer(r.COPY_WRITE_BUFFER,c),r.bufferData(r.COPY_WRITE_BUFFER,a,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const f=new e.array.constructor(o.length);return r.bindBuffer(r.COPY_WRITE_BUFFER,c),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,f),r.deleteBuffer(c),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),f.buffer}_createBuffer(e,t,r,i){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,r,i),e.bindBuffer(t,null),s}}let Zd,Pu;class Xj{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;Zd={[Ps]:e.FUNC_ADD,[Bb]:e.FUNC_SUBTRACT,[Pb]:e.FUNC_REVERSE_SUBTRACT},Pu={[ho]:e.ZERO,[Vb]:e.ONE,[Gb]:e.SRC_COLOR,[Ub]:e.SRC_ALPHA,[qb]:e.SRC_ALPHA_SATURATE,[kb]:e.DST_COLOR,[Ib]:e.DST_ALPHA,[Fb]:e.ONE_MINUS_SRC_COLOR,[Ob]:e.ONE_MINUS_SRC_ALPHA,[Lb]:e.ONE_MINUS_DST_COLOR,[Db]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),r=e.getParameter(e.VIEWPORT);this.currentScissor=new Ft().fromArray(t),this.currentViewport=new Ft().fromArray(r),this._tempVec4=new Ft}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==aR?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===lR?t.cullFace(t.BACK):e===uR?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:r}=this;e!==t&&(r.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,r,i,s,o,a,c){const{gl:f}=this;if(e===Bl){this.currentBlendingEnabled===!0&&(this.disable(f.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(f.BLEND),this.currentBlendingEnabled=!0),e!==Hu){if(e!==this.currentBlending||c!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Ps||this.currentBlendEquationAlpha!==Ps)&&(f.blendEquation(f.FUNC_ADD),this.currentBlendEquation=Ps,this.currentBlendEquationAlpha=Ps),c)switch(e){case Ls:f.blendFuncSeparate(f.ONE,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);break;case D0:f.blendFunc(f.ONE,f.ONE);break;case B0:f.blendFuncSeparate(f.ZERO,f.ONE_MINUS_SRC_COLOR,f.ZERO,f.ONE);break;case P0:f.blendFuncSeparate(f.DST_COLOR,f.ONE_MINUS_SRC_ALPHA,f.ZERO,f.ONE);break;default:break}else switch(e){case Ls:f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);break;case D0:f.blendFuncSeparate(f.SRC_ALPHA,f.ONE,f.ONE,f.ONE);break;case B0:break;case P0:break;default:break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=c}return}s=s||t,o=o||r,a=a||i,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(f.blendEquationSeparate(Zd[t],Zd[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(r!==this.currentBlendSrc||i!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||a!==this.currentBlendDstAlpha)&&(f.blendFuncSeparate(Pu[r],Pu[i],Pu[o],Pu[a]),this.currentBlendSrc=r,this.currentBlendDst=i,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case Yb:t.depthFunc(t.NEVER);break;case Xb:t.depthFunc(t.ALWAYS);break;case Qb:t.depthFunc(t.LESS);break;case Wb:t.depthFunc(t.LEQUAL);break;case Hb:t.depthFunc(t.EQUAL);break;case $b:t.depthFunc(t.GEQUAL);break;case jb:t.depthFunc(t.GREATER);break;case zb:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,r,i){const s=this._tempVec4.set(e,t,r,i);if(this.currentScissor.equals(s)===!1){const{gl:o}=this;o.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,r,i){const s=this._tempVec4.set(e,t,r,i);if(this.currentViewport.equals(s)===!1){const{gl:o}=this;o.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,r){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==r)&&(this.gl.stencilFunc(e,t,r),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=r)}setStencilOp(e,t,r){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==r)&&(this.gl.stencilOp(e,t,r),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=r)}setMaterial(e,t,r){const{gl:i}=this;e.side===fi?this.disable(i.CULL_FACE):this.enable(i.CULL_FACE);let s=e.side===hr;t&&(s=!s),this.setFlipSided(s),e.blending===Ls&&e.transparent===!1?this.setBlending(Bl):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(i.SAMPLE_ALPHA_TO_COVERAGE):this.disable(i.SAMPLE_ALPHA_TO_COVERAGE),r>0&&this.currentClippingPlanes!==r)for(let c=0;c<8;c++)c<r?this.enable(12288+c):this.disable(12288+c)}setPolygonOffset(e,t,r){const{gl:i}=this;e?(this.enable(i.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==r)&&(i.polygonOffset(t,r),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=r)):this.disable(i.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const r=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(r.bindVertexArray(e),t!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:r,currentBoundFramebuffers:i}=this;return i[e]!==t?(r.bindFramebuffer(e,t),i[e]=t,e===r.DRAW_FRAMEBUFFER&&(i[r.FRAMEBUFFER]=t),e===r.FRAMEBUFFER&&(i[r.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:r}=this;let i=[],s=!1;if(e.textures!==null){i=this.currentDrawbuffers.get(t),i===void 0&&(i=[],this.currentDrawbuffers.set(t,i));const o=e.textures;if(i.length!==o.length||i[0]!==r.COLOR_ATTACHMENT0){for(let a=0,c=o.length;a<c;a++)i[a]=r.COLOR_ATTACHMENT0+a;i.length=o.length,s=!0}}else i[0]!==r.BACK&&(i[0]=r.BACK,s=!0);s&&r.drawBuffers(i)}activeTexture(e){const{gl:t,currentTextureSlot:r,maxTextures:i}=this;e===void 0&&(e=t.TEXTURE0+i-1),r!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,r){const{gl:i,currentTextureSlot:s,currentBoundTextures:o,maxTextures:a}=this;r===void 0&&(s===null?r=i.TEXTURE0+a-1:r=s);let c=o[r];c===void 0&&(c={type:void 0,texture:void 0},o[r]=c),(c.type!==e||c.texture!==t)&&(s!==r&&(i.activeTexture(r),this.currentTextureSlot=r),i.bindTexture(e,t),c.type=e,c.texture=t)}bindBufferBase(e,t,r){const{gl:i}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==r?(i.bindBufferBase(e,t,r),this.currentBoundBufferBases[s]=r,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:r}=this,i=r[t];i!==void 0&&i.type!==void 0&&(e.bindTexture(i.type,null),i.type=void 0,i.texture=void 0)}}class Yj{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Pl){const{gl:r,extensions:i}=this;let s;const o=Tn.getTransfer(t);if(e===Xr)return r.UNSIGNED_BYTE;if(e===AR)return r.UNSIGNED_SHORT_4_4_4_4;if(e===cR)return r.UNSIGNED_SHORT_5_5_5_1;if(e===Kb)return r.UNSIGNED_INT_5_9_9_9_REV;if(e===Zb)return r.UNSIGNED_INT_10F_11F_11F_REV;if(e===Wu)return r.BYTE;if(e===Qu)return r.SHORT;if(e===fl)return r.UNSIGNED_SHORT;if(e===vr)return r.INT;if(e===Ln)return r.UNSIGNED_INT;if(e===ui)return r.FLOAT;if(e===wr)return r.HALF_FLOAT;if(e===hR)return r.ALPHA;if(e===Eg)return r.RGB;if(e===Li)return r.RGBA;if(e===So)return r.DEPTH_COMPONENT;if(e===wo)return r.DEPTH_STENCIL;if(e===Rg)return r.RED;if(e===Ng)return r.RED_INTEGER;if(e===ca)return r.RG;if(e===Cg)return r.RG_INTEGER;if(e===Mg)return r.RGBA_INTEGER;if(e===o0||e===a0||e===l0||e===u0)if(o===ct)if(s=i.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===o0)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===a0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===l0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===u0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=i.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===o0)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===a0)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===l0)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===u0)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===Iy||e===ky||e===qy||e===Uy)if(s=i.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===Iy)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ky)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===qy)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Uy)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===_p||e===vp||e===bp)if(s=i.get("WEBGL_compressed_texture_etc"),s!==null){if(e===_p||e===vp)return o===ct?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===bp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===xp||e===Tp||e===wp||e===Sp||e===Ep||e===Rp||e===Np||e===Cp||e===Mp||e===Pp||e===Bp||e===Dp||e===Lp||e===Op)if(s=i.get("WEBGL_compressed_texture_astc"),s!==null){if(e===xp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===Tp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===wp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===Sp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===Ep)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Rp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Np)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Cp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Mp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Pp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Bp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Dp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Lp)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Op)return o===ct?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Fp)if(s=i.get("EXT_texture_compression_bptc"),s!==null){if(e===Fp)return o===ct?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===Ip||e===kp||e===qp||e===Up)if(s=i.get("EXT_texture_compression_rgtc"),s!==null){if(e===Ip)return s.COMPRESSED_RED_RGTC1_EXT;if(e===kp)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===qp)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===Up)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===To?r.UNSIGNED_INT_24_8:r[e]!==void 0?r[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((r,i)=>{function s(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),i();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),r()}s()})}}let E3=!1,Gc,Jd,R3;class Kj{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},E3===!1&&(this._init(),E3=!0)}_init(){const e=this.gl;Gc={[qh]:e.REPEAT,[wg]:e.CLAMP_TO_EDGE,[kh]:e.MIRRORED_REPEAT},Jd={[Bi]:e.NEAREST,[Tb]:e.NEAREST_MIPMAP_NEAREST,[aA]:e.NEAREST_MIPMAP_LINEAR,[qs]:e.LINEAR,[yp]:e.LINEAR_MIPMAP_NEAREST,[ga]:e.LINEAR_MIPMAP_LINEAR},R3={[Mb]:e.NEVER,[Cb]:e.ALWAYS,[Sg]:e.LESS,[Nb]:e.LEQUAL,[Rb]:e.EQUAL,[Eb]:e.GEQUAL,[Sb]:e.GREATER,[wb]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let r;return e.isCubeTexture===!0?r=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?r=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?r=t.TEXTURE_3D:r=t.TEXTURE_2D,r}getInternalFormat(e,t,r,i,s=!1){const{gl:o,extensions:a}=this;if(e!==null&&o[e]!==void 0)return o[e];let c=t;if(t===o.RED&&(r===o.FLOAT&&(c=o.R32F),r===o.HALF_FLOAT&&(c=o.R16F),r===o.UNSIGNED_BYTE&&(c=o.R8),r===o.UNSIGNED_SHORT&&(c=o.R16),r===o.UNSIGNED_INT&&(c=o.R32UI),r===o.BYTE&&(c=o.R8I),r===o.SHORT&&(c=o.R16I),r===o.INT&&(c=o.R32I)),t===o.RED_INTEGER&&(r===o.UNSIGNED_BYTE&&(c=o.R8UI),r===o.UNSIGNED_SHORT&&(c=o.R16UI),r===o.UNSIGNED_INT&&(c=o.R32UI),r===o.BYTE&&(c=o.R8I),r===o.SHORT&&(c=o.R16I),r===o.INT&&(c=o.R32I)),t===o.RG&&(r===o.FLOAT&&(c=o.RG32F),r===o.HALF_FLOAT&&(c=o.RG16F),r===o.UNSIGNED_BYTE&&(c=o.RG8),r===o.UNSIGNED_SHORT&&(c=o.RG16),r===o.UNSIGNED_INT&&(c=o.RG32UI),r===o.BYTE&&(c=o.RG8I),r===o.SHORT&&(c=o.RG16I),r===o.INT&&(c=o.RG32I)),t===o.RG_INTEGER&&(r===o.UNSIGNED_BYTE&&(c=o.RG8UI),r===o.UNSIGNED_SHORT&&(c=o.RG16UI),r===o.UNSIGNED_INT&&(c=o.RG32UI),r===o.BYTE&&(c=o.RG8I),r===o.SHORT&&(c=o.RG16I),r===o.INT&&(c=o.RG32I)),t===o.RGB){const f=s?Fy:Tn.getTransfer(i);r===o.FLOAT&&(c=o.RGB32F),r===o.HALF_FLOAT&&(c=o.RGB16F),r===o.UNSIGNED_BYTE&&(c=o.RGB8),r===o.UNSIGNED_SHORT&&(c=o.RGB16),r===o.UNSIGNED_INT&&(c=o.RGB32UI),r===o.BYTE&&(c=o.RGB8I),r===o.SHORT&&(c=o.RGB16I),r===o.INT&&(c=o.RGB32I),r===o.UNSIGNED_BYTE&&(c=f===ct?o.SRGB8:o.RGB8),r===o.UNSIGNED_SHORT_5_6_5&&(c=o.RGB565),r===o.UNSIGNED_SHORT_5_5_5_1&&(c=o.RGB5_A1),r===o.UNSIGNED_SHORT_4_4_4_4&&(c=o.RGB4),r===o.UNSIGNED_INT_5_9_9_9_REV&&(c=o.RGB9_E5),r===o.UNSIGNED_INT_10F_11F_11F_REV&&(c=o.R11F_G11F_B10F)}if(t===o.RGB_INTEGER&&(r===o.UNSIGNED_BYTE&&(c=o.RGB8UI),r===o.UNSIGNED_SHORT&&(c=o.RGB16UI),r===o.UNSIGNED_INT&&(c=o.RGB32UI),r===o.BYTE&&(c=o.RGB8I),r===o.SHORT&&(c=o.RGB16I),r===o.INT&&(c=o.RGB32I)),t===o.RGBA){const f=s?Fy:Tn.getTransfer(i);r===o.FLOAT&&(c=o.RGBA32F),r===o.HALF_FLOAT&&(c=o.RGBA16F),r===o.UNSIGNED_BYTE&&(c=o.RGBA8),r===o.UNSIGNED_SHORT&&(c=o.RGBA16),r===o.UNSIGNED_INT&&(c=o.RGBA32UI),r===o.BYTE&&(c=o.RGBA8I),r===o.SHORT&&(c=o.RGBA16I),r===o.INT&&(c=o.RGBA32I),r===o.UNSIGNED_BYTE&&(c=f===ct?o.SRGB8_ALPHA8:o.RGBA8),r===o.UNSIGNED_SHORT_4_4_4_4&&(c=o.RGBA4),r===o.UNSIGNED_SHORT_5_5_5_1&&(c=o.RGB5_A1)}return t===o.RGBA_INTEGER&&(r===o.UNSIGNED_BYTE&&(c=o.RGBA8UI),r===o.UNSIGNED_SHORT&&(c=o.RGBA16UI),r===o.UNSIGNED_INT&&(c=o.RGBA32UI),r===o.BYTE&&(c=o.RGBA8I),r===o.SHORT&&(c=o.RGBA16I),r===o.INT&&(c=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(r===o.UNSIGNED_SHORT&&(c=o.DEPTH_COMPONENT16),r===o.UNSIGNED_INT&&(c=o.DEPTH_COMPONENT24),r===o.FLOAT&&(c=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&r===o.UNSIGNED_INT_24_8&&(c=o.DEPTH24_STENCIL8),(c===o.R16F||c===o.R32F||c===o.RG16F||c===o.RG32F||c===o.RGBA16F||c===o.RGBA32F)&&a.get("EXT_color_buffer_float"),c}setTextureParameters(e,t){const{gl:r,extensions:i,backend:s}=this,o=Tn.getPrimaries(Tn.workingColorSpace),a=t.colorSpace===Pl?null:Tn.getPrimaries(t.colorSpace),c=t.colorSpace===Pl||o===a?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,t.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,c),r.texParameteri(e,r.TEXTURE_WRAP_S,Gc[t.wrapS]),r.texParameteri(e,r.TEXTURE_WRAP_T,Gc[t.wrapT]),(e===r.TEXTURE_3D||e===r.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||r.texParameteri(e,r.TEXTURE_WRAP_R,Gc[t.wrapR])),r.texParameteri(e,r.TEXTURE_MAG_FILTER,Jd[t.magFilter]);const f=t.mipmaps!==void 0&&t.mipmaps.length>0,p=t.minFilter===qs&&f?ga:t.minFilter;if(r.texParameteri(e,r.TEXTURE_MIN_FILTER,Jd[p]),t.compareFunction&&(r.texParameteri(e,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(e,r.TEXTURE_COMPARE_FUNC,R3[t.compareFunction])),i.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Bi||t.minFilter!==aA&&t.minFilter!==ga||t.type===ui&&i.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const g=i.get("EXT_texture_filter_anisotropic");r.texParameterf(e,g.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:r,defaultTextures:i}=this,s=this.getGLTextureType(e);let o=i[s];o===void 0&&(o=t.createTexture(),r.state.bindTexture(s,o),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),i[s]=o),r.set(e,{textureGPU:o,glTextureType:s,isDefault:!0})}createTexture(e,t){const{gl:r,backend:i}=this,{levels:s,width:o,height:a,depth:c}=t,f=i.utils.convert(e.format,e.colorSpace),p=i.utils.convert(e.type),g=this.getInternalFormat(e.internalFormat,f,p,e.colorSpace,e.isVideoTexture),v=r.createTexture(),x=this.getGLTextureType(e);i.state.bindTexture(x,v),this.setTextureParameters(x,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?r.texStorage3D(r.TEXTURE_2D_ARRAY,s,g,o,a,c):e.isData3DTexture?r.texStorage3D(r.TEXTURE_3D,s,g,o,a,c):e.isVideoTexture||r.texStorage2D(x,s,g,o,a),i.set(e,{textureGPU:v,glTextureType:x,glFormat:f,glType:p,glInternalFormat:g})}copyBufferToTexture(e,t){const{gl:r,backend:i}=this,{textureGPU:s,glTextureType:o,glFormat:a,glType:c}=i.get(t),{width:f,height:p}=t.source.data;r.bindBuffer(r.PIXEL_UNPACK_BUFFER,e),i.state.bindTexture(o,s),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texSubImage2D(o,0,0,0,f,p,a,c,0),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),i.state.unbindTexture()}updateTexture(e,t){const{gl:r}=this,{width:i,height:s}=t,{textureGPU:o,glTextureType:a,glFormat:c,glType:f,glInternalFormat:p}=this.backend.get(e);if(!(e.isRenderTargetTexture||o===void 0))if(this.backend.state.bindTexture(a,o),this.setTextureParameters(a,e),e.isCompressedTexture){const g=e.mipmaps,v=t.image;for(let x=0;x<g.length;x++){const T=g[x];e.isCompressedArrayTexture?e.format!==r.RGBA?c!==null&&r.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,x,0,0,0,T.width,T.height,v.depth,c,T.data):r.texSubImage3D(r.TEXTURE_2D_ARRAY,x,0,0,0,T.width,T.height,v.depth,c,f,T.data):c!==null&&r.compressedTexSubImage2D(r.TEXTURE_2D,x,0,0,T.width,T.height,c,T.data)}}else if(e.isCubeTexture){const g=t.images,v=e.mipmaps;for(let x=0;x<6;x++){const T=Vc(g[x]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+x,0,0,0,i,s,c,f,T);for(let S=0;S<v.length;S++){const R=v[S],C=Vc(R.images[x]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+x,S+1,0,0,C.width,C.height,c,f,C)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const g=t.image;if(e.layerUpdates.size>0){const v=oR(g.width,g.height,e.format,e.type);for(const x of e.layerUpdates){const T=g.data.subarray(x*v/g.data.BYTES_PER_ELEMENT,(x+1)*v/g.data.BYTES_PER_ELEMENT);r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,x,g.width,g.height,1,c,f,T)}e.clearLayerUpdates()}else r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,g.width,g.height,g.depth,c,f,g.data)}else if(e.isData3DTexture){const g=t.image;r.texSubImage3D(r.TEXTURE_3D,0,0,0,0,g.width,g.height,g.depth,c,f,g.data)}else if(e.isVideoTexture)e.update(),r.texImage2D(a,0,p,c,f,t.image);else{const g=e.mipmaps;if(g.length>0)for(let v=0,x=g.length;v<x;v++){const T=g[v],S=Vc(T);r.texSubImage2D(a,v,0,0,T.width,T.height,c,f,S)}else{const v=Vc(t.image);r.texSubImage2D(a,0,0,0,i,s,c,f,v)}}}generateMipmaps(e){const{gl:t,backend:r}=this,{textureGPU:i,glTextureType:s}=r.get(e);r.state.bindTexture(s,i),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:r}=this;if(e){const i=r.get(e);if(i.renderBufferStorageSetup=void 0,i.framebuffers){for(const s in i.framebuffers)t.deleteFramebuffer(i.framebuffers[s]);delete i.framebuffers}if(i.depthRenderbuffer&&(t.deleteRenderbuffer(i.depthRenderbuffer),delete i.depthRenderbuffer),i.stencilRenderbuffer&&(t.deleteRenderbuffer(i.stencilRenderbuffer),delete i.stencilRenderbuffer),i.msaaFrameBuffer&&(t.deleteFramebuffer(i.msaaFrameBuffer),delete i.msaaFrameBuffer),i.msaaRenderbuffers){for(let s=0;s<i.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(i.msaaRenderbuffers[s]);delete i.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:r}=this,{textureGPU:i,renderTarget:s}=r.get(e);this.deallocateRenderBuffers(s),t.deleteTexture(i),r.delete(e)}copyTextureToTexture(e,t,r=null,i=null,s=0,o=0){const{gl:a,backend:c}=this,{state:f}=this.backend,{textureGPU:p,glTextureType:g,glType:v,glFormat:x}=c.get(t);f.bindTexture(g,p);let T,S,R,C,B,D,F,I,q;const k=e.isCompressedTexture?e.mipmaps[o]:e.image;if(r!==null)T=r.max.x-r.min.x,S=r.max.y-r.min.y,R=r.isBox3?r.max.z-r.min.z:1,C=r.min.x,B=r.min.y,D=r.isBox3?r.min.z:0;else{const oe=Math.pow(2,-s);T=Math.floor(k.width*oe),S=Math.floor(k.height*oe),e.isDataArrayTexture||e.isArrayTexture?R=k.depth:e.isData3DTexture?R=Math.floor(k.depth*oe):R=1,C=0,B=0,D=0}i!==null?(F=i.x,I=i.y,q=i.z):(F=0,I=0,q=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const G=a.getParameter(a.UNPACK_ROW_LENGTH),j=a.getParameter(a.UNPACK_IMAGE_HEIGHT),ee=a.getParameter(a.UNPACK_SKIP_PIXELS),Q=a.getParameter(a.UNPACK_SKIP_ROWS),Y=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,k.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,k.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,C),a.pixelStorei(a.UNPACK_SKIP_ROWS,B),a.pixelStorei(a.UNPACK_SKIP_IMAGES,D);const Z=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const oe=c.get(e),K=c.get(t),ae=c.get(oe.renderTarget),he=c.get(K.renderTarget),be=ae.framebuffers[oe.cacheKey],ye=he.framebuffers[K.cacheKey];f.bindFramebuffer(a.READ_FRAMEBUFFER,be),f.bindFramebuffer(a.DRAW_FRAMEBUFFER,ye);let Be=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(Be=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(C,B,T,S,F,I,T,S,Be,a.NEAREST),f.bindFramebuffer(a.READ_FRAMEBUFFER,null),f.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else Z?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(g,o,F,I,q,T,S,R,x,v,k.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(g,o,F,I,q,T,S,R,x,k.data):a.texSubImage3D(g,o,F,I,q,T,S,R,x,v,k):e.isDataTexture?a.texSubImage2D(g,o,F,I,T,S,x,v,k.data):e.isCompressedTexture?a.compressedTexSubImage2D(g,o,F,I,k.width,k.height,x,k.data):a.texSubImage2D(g,o,F,I,T,S,x,v,k);a.pixelStorei(a.UNPACK_ROW_LENGTH,G),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,j),a.pixelStorei(a.UNPACK_SKIP_PIXELS,ee),a.pixelStorei(a.UNPACK_SKIP_ROWS,Q),a.pixelStorei(a.UNPACK_SKIP_IMAGES,Y),o===0&&t.generateMipmaps&&a.generateMipmap(g),f.unbindTexture()}copyFramebufferToTexture(e,t,r){const{gl:i}=this,{state:s}=this.backend,{textureGPU:o}=this.backend.get(e),{x:a,y:c,z:f,w:p}=r,g=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,v=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(g){const x=a!==0||c!==0;let T,S;if(e.isDepthTexture===!0?(T=i.DEPTH_BUFFER_BIT,S=i.DEPTH_ATTACHMENT,t.stencil&&(T|=i.STENCIL_BUFFER_BIT)):(T=i.COLOR_BUFFER_BIT,S=i.COLOR_ATTACHMENT0),x){const R=this.backend.get(t.renderTarget),C=R.framebuffers[t.getCacheKey()],B=R.msaaFrameBuffer;s.bindFramebuffer(i.DRAW_FRAMEBUFFER,C),s.bindFramebuffer(i.READ_FRAMEBUFFER,B);const D=v-c-p;i.blitFramebuffer(a,D,a+f,D+p,a,D,a+f,D+p,T,i.NEAREST),s.bindFramebuffer(i.READ_FRAMEBUFFER,C),s.bindTexture(i.TEXTURE_2D,o),i.copyTexSubImage2D(i.TEXTURE_2D,0,0,0,a,D,f,p),s.unbindTexture()}else{const R=i.createFramebuffer();s.bindFramebuffer(i.DRAW_FRAMEBUFFER,R),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,S,i.TEXTURE_2D,o,0),i.blitFramebuffer(0,0,f,p,0,0,f,p,T,i.NEAREST),i.deleteFramebuffer(R)}}else s.bindTexture(i.TEXTURE_2D,o),i.copyTexSubImage2D(i.TEXTURE_2D,0,0,0,a,v-p-c,f,p),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,r,i=!1){const{gl:s}=this,o=t.renderTarget,{depthTexture:a,depthBuffer:c,stencilBuffer:f,width:p,height:g}=o;if(s.bindRenderbuffer(s.RENDERBUFFER,e),c&&!f){let v=s.DEPTH_COMPONENT24;i===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,o.samples,v,p,g):r>0?(a&&a.isDepthTexture&&a.type===s.FLOAT&&(v=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,r,v,p,g)):s.renderbufferStorage(s.RENDERBUFFER,v,p,g),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else c&&f&&(r>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,r,s.DEPTH24_STENCIL8,p,g):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,p,g),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e));s.bindRenderbuffer(s.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,r,i,s,o){const{backend:a,gl:c}=this,{textureGPU:f,glFormat:p,glType:g}=this.backend.get(e),v=c.createFramebuffer();c.bindFramebuffer(c.READ_FRAMEBUFFER,v);const x=e.isCubeTexture?c.TEXTURE_CUBE_MAP_POSITIVE_X+o:c.TEXTURE_2D;c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,x,f,0);const T=this._getTypedArrayType(g),S=this._getBytesPerTexel(g,p),C=i*s*S,B=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,B),c.bufferData(c.PIXEL_PACK_BUFFER,C,c.STREAM_READ),c.readPixels(t,r,i,s,p,g,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const D=new T(C/T.BYTES_PER_ELEMENT);return c.bindBuffer(c.PIXEL_PACK_BUFFER,B),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,D),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.deleteFramebuffer(v),D}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:r}=this;let i=0;if(e===r.UNSIGNED_BYTE&&(i=1),(e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5||e===r.UNSIGNED_SHORT||e===r.HALF_FLOAT)&&(i=2),(e===r.UNSIGNED_INT||e===r.FLOAT)&&(i=4),t===r.RGBA)return i*4;if(t===r.RGB)return i*3;if(t===r.ALPHA)return i}}function Vc(n){return n.isDataTexture?n.image.data:typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?n:n.data}class Zj{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class Jj{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const r=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const N3={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class e${constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:r,mode:i,object:s,type:o,info:a,index:c}=this;c!==0?r.drawElements(i,t,o,e):r.drawArrays(i,e,t),a.update(s,t,1)}renderInstances(e,t,r){const{gl:i,mode:s,type:o,index:a,object:c,info:f}=this;r!==0&&(a!==0?i.drawElementsInstanced(s,t,o,e,r):i.drawArraysInstanced(s,e,t,r),f.update(c,t,r))}renderMultiDraw(e,t,r){const{extensions:i,mode:s,object:o,info:a}=this;if(r===0)return;const c=i.get("WEBGL_multi_draw");if(c===null)for(let f=0;f<r;f++)this.render(e[f],t[f]);else{this.index!==0?c.multiDrawElementsWEBGL(s,t,0,this.type,e,0,r):c.multiDrawArraysWEBGL(s,e,0,t,0,r);let f=0;for(let p=0;p<r;p++)f+=t[p];a.update(o,f,1)}}renderMultiDrawInstances(e,t,r,i){const{extensions:s,mode:o,object:a,info:c}=this;if(r===0)return;const f=s.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<r;p++)this.renderInstances(e[p],t[p],i[p]);else{this.index!==0?f.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,i,0,r):f.multiDrawArraysInstancedWEBGL(o,e,0,t,0,i,0,r);let p=0;for(let g=0;g<r;g++)p+=t[g]*i[g];c.update(a,p,1)}}}class y5{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class t$ extends y5{constructor(e,t,r=2048){if(super(r),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){this.trackTimestamp=!1;return}this.queries=[];for(let i=0;i<this.maxQueries;i++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return ki(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t==null||this.activeQuery!==null)return;const r=this.queries[t];if(r)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,r),this.activeQuery=t,this.queryStates.set(t,"started"))}catch{this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch{this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[i,s]of this.queryStates)if(s==="ended"){const o=this.queries[i];e.push(this.resolveQuery(o))}if(e.length===0)return this.lastValue;const r=(await Promise.all(e)).reduce((i,s)=>i+s,0);return this.lastValue=r,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,r}catch{return this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let r,i=!1;const s=()=>{r&&(clearTimeout(r),r=null)},o=c=>{i||(i=!0,s(),t(c))},a=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){r=setTimeout(a,1);return}const p=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(p)/1e6)}catch{t(this.lastValue)}};a()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class C3 extends g5{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},i=t.context!==void 0?t.context:e.domElement.getContext("webgl2",r);function s(o){o.preventDefault();const a={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(a)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=i,this.extensions=new Zj(this),this.capabilities=new Jj(this),this.attributeUtils=new Qj(this),this.textureUtils=new Kj(this),this.bufferRenderer=new e$(this),this.state=new Xj(this),this.utils=new Yj(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return M0}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,r=null){const i=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:i.RGBA8}),r!==null){const s=e.stencilBuffer?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:r,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview,e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new t$(this.gl,e,2048));const r=this.timestampQueryPool[e];r.allocateQueriesForContext(t)!==null&&r.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,r=this.get(e);if(r.frameCalls=this.renderer.info.render.frameCalls,e.viewport)this.updateViewport(e);else{const{width:s,height:o}=this.getDrawingBufferSize();t.viewport(0,0,s,o)}if(e.scissor){const{x:s,y:o,width:a,height:c}=e.scissorValue;t.scissor(s,e.height-c-o,a,c)}this.initTimestampQuery(cl.RENDER,this.getTimestampUID(e)),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const i=e.occlusionQueryCount;i>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(i),r.occlusionQueryObjects=new Array(i),r.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:r}=this,i=this.get(e),s=i.previousContext;r.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>i.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(a!==null)for(let c=0;c<a.length;c++){const f=a[c];f.generateMipmaps&&this.generateMipmaps(f)}if(this._currentContext=s,this._resolveRenderTarget(e),s!==null)if(this._setFramebuffer(s),s.viewport)this.updateViewport(s);else{const{width:c,height:f}=this.getDrawingBufferSize();r.viewport(0,0,c,f)}this.prepareTimestampBuffer(cl.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:r,currentOcclusionQueryObjects:i}=t;if(r&&i){const s=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const a=()=>{let c=0;for(let f=0;f<r.length;f++){const p=r[f];p!==null&&o.getQueryParameter(p,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(p,o.QUERY_RESULT)===0&&s.add(i[f]),r[f]=null,o.deleteQuery(p),c++)}c<r.length?requestAnimationFrame(a):t.occluded=s};a()}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:r,y:i,width:s,height:o}=e.viewportValue;t.viewport(r,e.height-o-i,s,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,r,i=null,s=!0,o=!0){const{gl:a,renderer:c}=this;i===null&&(i={textures:null,clearColorValue:this.getClearColor()});let f=0;if(e&&(f|=a.COLOR_BUFFER_BIT),t&&(f|=a.DEPTH_BUFFER_BIT),r&&(f|=a.STENCIL_BUFFER_BIT),f!==0){let p;i.clearColorValue?p=i.clearColorValue:p=this.getClearColor();const g=c.getClearDepth(),v=c.getClearStencil();if(t&&this.state.setDepthMask(!0),i.textures===null)a.clearColor(p.r,p.g,p.b,p.a),a.clear(f);else{if(s&&this._setFramebuffer(i),e)for(let x=0;x<i.textures.length;x++)x===0?a.clearBufferfv(a.COLOR,x,[p.r,p.g,p.b,p.a]):a.clearBufferfv(a.COLOR,x,[0,0,0,1]);t&&r?a.clearBufferfi(a.DEPTH_STENCIL,0,g,v):t?a.clearBufferfv(a.DEPTH,0,[g]):r&&a.clearBufferiv(a.STENCIL,0,[v]),s&&o&&this._resolveRenderTarget(i)}}}beginCompute(e){const{state:t,gl:r}=this,i=this.get(e);i.frameCalls=this.renderer.info.compute.frameCalls,t.bindFramebuffer(r.FRAMEBUFFER,null),this.initTimestampQuery(cl.COMPUTE,this.getTimestampUID(e))}compute(e,t,r,i,s=null){const{state:o,gl:a}=this;this.discard===!1&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:c,transformBuffers:f,attributes:p}=this.get(i),g=this._getVaoKey(p),v=this.vaoCache[g];v===void 0?this.vaoCache[g]=this._createVao(p):o.setVertexState(v),o.useProgram(c),this._bindUniforms(r);const x=this._getTransformFeedback(f);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,x),a.beginTransformFeedback(a.POINTS),s=s!==null?s:t.count,Array.isArray(s)&&(ki("WebGLBackend.compute(): The count parameter must be a single number, not an array."),s=s[0]),p[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,s):a.drawArrays(a.POINTS,0,s),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let T=0;T<f.length;T++){const S=f[T];S.pbo&&this.has(S.pbo)&&this.textureUtils.copyBufferToTexture(S.transformBuffer,S.pbo),S.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(cl.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:r,material:i,context:s,hardwareClippingPlanes:o}=e,{programGPU:a}=this.get(r),{gl:c,state:f}=this,p=this.get(s),g=e.getDrawParameters();if(g===null)return;this._bindUniforms(e.getBindings());const v=t.isMesh&&t.matrixWorld.determinant()<0;f.setMaterial(i,v,o),f.useProgram(a);const x=e.getAttributes(),T=this.get(x);let S=T.vaoGPU;if(S===void 0){const G=this._getVaoKey(x);S=this.vaoCache[G],S===void 0&&(S=this._createVao(x),this.vaoCache[G]=S,T.vaoGPU=S)}const R=e.getIndex(),C=R!==null?this.get(R).bufferGPU:null;f.setVertexState(S,C);const B=p.lastOcclusionObject;if(B!==t&&B!==void 0){if(B!==null&&B.occlusionTest===!0&&(c.endQuery(c.ANY_SAMPLES_PASSED),p.occlusionQueryIndex++),t.occlusionTest===!0){const G=c.createQuery();c.beginQuery(c.ANY_SAMPLES_PASSED,G),p.occlusionQueries[p.occlusionQueryIndex]=G,p.occlusionQueryObjects[p.occlusionQueryIndex]=t}p.lastOcclusionObject=t}const D=this.bufferRenderer;t.isPoints?D.mode=c.POINTS:t.isLineSegments?D.mode=c.LINES:t.isLine?D.mode=c.LINE_STRIP:t.isLineLoop?D.mode=c.LINE_LOOP:i.wireframe===!0?(f.setLineWidth(i.wireframeLinewidth*this.renderer.getPixelRatio()),D.mode=c.LINES):D.mode=c.TRIANGLES;const{vertexCount:F,instanceCount:I}=g;let{firstVertex:q}=g;if(D.object=t,R!==null){q*=R.array.BYTES_PER_ELEMENT;const G=this.get(R);D.index=R.count,D.type=G.type}else D.index=0;const k=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(ki("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),D.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?D.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):ki("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):I>1?D.renderInstances(q,F,I):D.render(q,F)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const G=this.get(e.camera),j=e.camera.cameras,ee=e.getBindingGroup("cameraIndex").bindings[0];if(G.indexesGPU===void 0||G.indexesGPU.length!==j.length){const ae=new Uint32Array([0,0,0,0]),he=[];for(let be=0,ye=j.length;be<ye;be++){const Be=c.createBuffer();ae[0]=be,c.bindBuffer(c.UNIFORM_BUFFER,Be),c.bufferData(c.UNIFORM_BUFFER,ae,c.STATIC_DRAW),he.push(Be)}G.indexesGPU=he}const Q=this.get(ee),Y=this.renderer.getPixelRatio(),Z=this._currentContext.renderTarget,oe=this._isRenderCameraDepthArray(this._currentContext),K=this._currentContext.activeCubeFace;if(oe){const ae=this.get(Z.depthTexture);if(ae.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){ae.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:he}=Z;for(let be=0,ye=j.length;be<ye;be++)this.renderer._activeCubeFace=be,this._currentContext.activeCubeFace=be,this._setFramebuffer(this._currentContext),this.clear(!1,!0,he,this._currentContext,!1,!1);this.renderer._activeCubeFace=K,this._currentContext.activeCubeFace=K}}for(let ae=0,he=j.length;ae<he;ae++){const be=j[ae];if(t.layers.test(be.layers)){oe&&(this.renderer._activeCubeFace=ae,this._currentContext.activeCubeFace=ae,this._setFramebuffer(this._currentContext));const ye=be.viewport;if(ye!==void 0){const Be=ye.x*Y,ke=ye.y*Y,Xe=ye.width*Y,Qe=ye.height*Y;f.viewport(Math.floor(Be),Math.floor(e.context.height-Qe-ke),Math.floor(Xe),Math.floor(Qe))}f.bindBufferBase(c.UNIFORM_BUFFER,Q.index,G.indexesGPU[ae]),k()}this._currentContext.activeCubeFace=K,this.renderer._activeCubeFace=K}}else k()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,i,s,o){return this.textureUtils.copyTextureToBuffer(e,t,r,i,s,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new $j(e,t)}createProgram(e){const t=this.gl,{stage:r,code:i}=e,s=r==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,i),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const r=this.gl,i=e.pipeline,{fragmentProgram:s,vertexProgram:o}=i,a=r.createProgram(),c=this.get(s).shaderGPU,f=this.get(o).shaderGPU;if(r.attachShader(a,c),r.attachShader(a,f),r.linkProgram(a),this.set(i,{programGPU:a,fragmentShader:c,vertexShader:f}),t!==null&&this.parallel){const p=new Promise(g=>{const v=this.parallel,x=()=>{r.getProgramParameter(a,v.COMPLETION_STATUS_KHR)?(this._completeCompile(e,i),g()):requestAnimationFrame(x)};x()});t.push(p);return}this._completeCompile(e,i)}_handleSource(e,t){const r=e.split(`
`),i=[],s=Math.max(t-6,0),o=Math.min(t+6,r.length);for(let a=s;a<o;a++){const c=a+1;i.push(`${c===t?">":" "} ${c}: ${r[a]}`)}return i.join(`
`)}_getShaderErrors(e,t,r){const i=e.getShaderParameter(t,e.COMPILE_STATUS),o=(e.getShaderInfoLog(t)||"").trim();if(i&&o==="")return"";const a=/ERROR: 0:(\d+)/.exec(o);if(a){const c=parseInt(a[1]);return r.toUpperCase()+`

`+o+`

`+this._handleSource(e.getShaderSource(t),c)}else return o}_logProgramError(e,t,r){if(this.renderer.debug.checkShaderErrors){const i=this.gl,o=(i.getProgramInfoLog(e)||"").trim();if(i.getProgramParameter(e,i.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(i,e,r,t);else{const a=this._getShaderErrors(i,r,"vertex"),c=this._getShaderErrors(i,t,"fragment")}}}_completeCompile(e,t){const{state:r,gl:i}=this,s=this.get(t),{programGPU:o,fragmentShader:a,vertexShader:c}=s;i.getProgramParameter(o,i.LINK_STATUS)===!1&&this._logProgramError(o,a,c),r.useProgram(o);const f=e.getBindings();this._setupBindings(f,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:r,gl:i}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:o}=e,a=i.createProgram(),c=this.get(s).shaderGPU,f=this.get(o).shaderGPU,p=o.transforms,g=[],v=[];for(let R=0;R<p.length;R++){const C=p[R];g.push(C.varyingName),v.push(C.attributeNode)}i.attachShader(a,c),i.attachShader(a,f),i.transformFeedbackVaryings(a,g,i.SEPARATE_ATTRIBS),i.linkProgram(a),i.getProgramParameter(a,i.LINK_STATUS)===!1&&this._logProgramError(a,c,f),r.useProgram(a),this._setupBindings(t,a);const x=o.attributes,T=[],S=[];for(let R=0;R<x.length;R++){const C=x[R].node.attribute;T.push(C),this.has(C)||this.attributeUtils.createAttribute(C,i.ARRAY_BUFFER)}for(let R=0;R<v.length;R++){const C=v[R].attribute;this.has(C)||this.attributeUtils.createAttribute(C,i.ARRAY_BUFFER);const B=this.get(C);S.push(B)}this.set(e,{programGPU:a,transformBuffers:S,attributes:T})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let r=0,i=0;for(const s of t){this.set(s,{textures:i,uniformBuffers:r});for(const o of s.bindings)o.isUniformBuffer&&r++,o.isSampledTexture&&i++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,r=this.get(e);let i=r.uniformBuffers,s=r.textures;for(const o of e.bindings){const a=this.get(o);if(o.isUniformsGroup||o.isUniformBuffer){const c=o.buffer;let{bufferGPU:f}=this.get(c);f===void 0?(f=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,f),t.bufferData(t.UNIFORM_BUFFER,c,t.DYNAMIC_DRAW),this.set(c,{bufferGPU:f})):(t.bindBuffer(t.UNIFORM_BUFFER,f),t.bufferSubData(t.UNIFORM_BUFFER,0,c)),a.index=i++,a.bufferGPU=f,this.set(o,a)}else if(o.isSampledTexture){const{textureGPU:c,glTextureType:f}=this.get(o.texture);a.index=s++,a.textureGPU=c,a.glTextureType=f,this.set(o,a)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const i=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,i),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(N3).filter(i=>N3[i]===e),r=this.extensions;for(let i=0;i<t.length;i++)if(r.has(t[i]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,r=null,i=null,s=0,o=0){this.textureUtils.copyTextureToTexture(e,t,r,i,s,o)}copyFramebufferToTexture(e,t,r){this.textureUtils.copyFramebufferToTexture(e,t,r)}_setFramebuffer(e){const{gl:t,state:r}=this;let i=null;if(e.textures!==null){const s=e.renderTarget,o=this.get(s),{samples:a,depthBuffer:c,stencilBuffer:f}=s,p=s.isWebGLCubeRenderTarget===!0,g=s.isRenderTarget3D===!0,v=s.depth>1,x=s.isXRRenderTarget===!0,T=x===!0&&s._hasExternalTextures===!0;let S=o.msaaFrameBuffer,R=o.depthRenderbuffer;const C=this.extensions.get("WEBGL_multisampled_render_to_texture"),B=this.extensions.get("OVR_multiview2"),D=this._useMultisampledExtension(s),F=h6(e);let I;if(p?(o.cubeFramebuffers||(o.cubeFramebuffers={}),I=o.cubeFramebuffers[F]):x&&T===!1?I=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),I=o.framebuffers[F]),I===void 0){I=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,I);const q=e.textures,k=[];if(p){o.cubeFramebuffers[F]=I;const{textureGPU:j}=this.get(q[0]),ee=this.renderer._activeCubeFace,Q=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ee,j,Q)}else{o.framebuffers[F]=I;for(let j=0;j<q.length;j++){const ee=q[j],Q=this.get(ee);Q.renderTarget=e.renderTarget,Q.cacheKey=F;const Y=t.COLOR_ATTACHMENT0+j;if(s.multiview)B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Y,Q.textureGPU,0,a,0,2);else if(g||v){const Z=this.renderer._activeCubeFace,oe=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,Y,Q.textureGPU,oe,Z)}else if(D)C.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Y,t.TEXTURE_2D,Q.textureGPU,0,a);else{const Z=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,Y,t.TEXTURE_2D,Q.textureGPU,Z)}}}const G=f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const j=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(j,e,0,D),o.xrDepthRenderbuffer=j,k.push(f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,j),t.framebufferRenderbuffer(t.FRAMEBUFFER,G,t.RENDERBUFFER,j)}else if(e.depthTexture!==null){k.push(f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const j=this.get(e.depthTexture);if(j.renderTarget=e.renderTarget,j.cacheKey=F,s.multiview)B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,G,j.textureGPU,0,a,0,2);else if(T&&D)C.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,G,t.TEXTURE_2D,j.textureGPU,0,a);else if(e.depthTexture.isArrayTexture){const ee=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,G,j.textureGPU,0,ee)}else t.framebufferTexture2D(t.FRAMEBUFFER,G,t.TEXTURE_2D,j.textureGPU,0)}o.depthInvalidationArray=k}else{if(this._isRenderCameraDepthArray(e)){r.bindFramebuffer(t.FRAMEBUFFER,I);const k=this.renderer._activeCubeFace,G=this.get(e.depthTexture),j=f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,j,G.textureGPU,0,k)}if((x||D||s.multiview)&&s._isOpaqueFramebuffer!==!0){r.bindFramebuffer(t.FRAMEBUFFER,I);const k=this.get(e.textures[0]);s.multiview?B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,k.textureGPU,0,a,0,2):D?C.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,k.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,k.textureGPU,0);const G=f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const j=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,j),t.framebufferRenderbuffer(t.FRAMEBUFFER,G,t.RENDERBUFFER,j)}else{const j=this.get(e.depthTexture);s.multiview?B.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,G,j.textureGPU,0,a,0,2):D?C.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,G,t.TEXTURE_2D,j.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,G,t.TEXTURE_2D,j.textureGPU,0)}}}if(a>0&&D===!1&&!s.multiview){if(S===void 0){const q=[];S=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,S);const k=[],G=e.textures;for(let j=0;j<G.length;j++){k[j]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,k[j]),q.push(t.COLOR_ATTACHMENT0+j);const ee=e.textures[j],Q=this.get(ee);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,Q.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+j,t.RENDERBUFFER,k[j])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),o.msaaFrameBuffer=S,o.msaaRenderbuffers=k,c&&R===void 0){R=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(R,e,a),o.depthRenderbuffer=R;const j=f?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;q.push(j)}o.invalidationArray=q}i=o.msaaFrameBuffer}else i=I;r.drawBuffers(e,I)}r.bindFramebuffer(t.FRAMEBUFFER,i)}_getVaoKey(e){let t="";for(let r=0;r<e.length;r++){const i=this.get(e[r]);t+=":"+i.id}return t}_createVao(e){const{gl:t}=this,r=t.createVertexArray();t.bindVertexArray(r);for(let i=0;i<e.length;i++){const s=e[i],o=this.get(s);t.bindBuffer(t.ARRAY_BUFFER,o.bufferGPU),t.enableVertexAttribArray(i);let a,c;s.isInterleavedBufferAttribute===!0?(a=s.data.stride*o.bytesPerElement,c=s.offset*o.bytesPerElement):(a=0,c=0),o.isInteger?t.vertexAttribIPointer(i,s.itemSize,o.type,a,c):t.vertexAttribPointer(i,s.itemSize,o.type,s.normalized,a,c),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(i,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(i,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),r}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let r=this.transformFeedbackCache[t];if(r!==void 0)return r;const{gl:i}=this;r=i.createTransformFeedback(),i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,r);for(let s=0;s<e.length;s++){const o=e[s];i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,s,o.transformBuffer)}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=r,r}_setupBindings(e,t){const r=this.gl;for(const i of e)for(const s of i.bindings){const a=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const c=r.getUniformBlockIndex(t,s.name);r.uniformBlockBinding(t,c,a)}else if(s.isSampledTexture){const c=r.getUniformLocation(t,s.name);r.uniform1i(c,a)}}}_bindUniforms(e){const{gl:t,state:r}=this;for(const i of e)for(const s of i.bindings){const o=this.get(s),a=o.index;s.isUniformsGroup||s.isUniformBuffer?r.bindBufferBase(t.UNIFORM_BUFFER,a,o.bufferGPU):s.isSampledTexture&&r.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+a)}}_resolveRenderTarget(e){const{gl:t,state:r}=this,i=e.renderTarget;if(e.textures!==null&&i){const s=this.get(i);if(i.samples>0&&this._useMultisampledExtension(i)===!1){const o=s.framebuffers[e.getCacheKey()];let a=t.COLOR_BUFFER_BIT;i.resolveDepthBuffer&&(i.depthBuffer&&(a|=t.DEPTH_BUFFER_BIT),i.stencilBuffer&&i.resolveStencilBuffer&&(a|=t.STENCIL_BUFFER_BIT));const c=s.msaaFrameBuffer,f=s.msaaRenderbuffers,p=e.textures,g=p.length>1;if(r.bindFramebuffer(t.READ_FRAMEBUFFER,c),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,o),g)for(let v=0;v<p.length;v++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+v,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+v,t.TEXTURE_2D,null,0);for(let v=0;v<p.length;v++){if(g){const{textureGPU:x}=this.get(p[v]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,f[v]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,x,0)}if(e.scissor){const{x,y:T,width:S,height:R}=e.scissorValue,C=e.height-R-T;t.blitFramebuffer(x,C,x+S,C+R,x,C,x+S,C+R,a,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,a,t.NEAREST)}if(g)for(let v=0;v<p.length;v++){const{textureGPU:x}=this.get(p[v]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+v,t.RENDERBUFFER,f[v]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+v,t.TEXTURE_2D,x,0)}this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,s.invalidationArray)}else if(i.resolveDepthBuffer===!1&&s.framebuffers){const o=s.framebuffers[e.getCacheKey()];r.bindFramebuffer(t.DRAW_FRAMEBUFFER,o),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,s.depthInvalidationArray)}}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const xl={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},Zn={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},_r={Store:"store"},Lt={Load:"load",Clear:"clear"},M3={CCW:"ccw",CW:"cw"},P3={None:"none",Back:"back"},Hl={Uint16:"uint16",Uint32:"uint32"},J={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},ep={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},aa={Linear:"linear",Nearest:"nearest"},wt={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},ea={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},B3={None:0,All:15},lo={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},tp={Storage:"storage",ReadOnlyStorage:"read-only-storage"},np={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},D3={NonFiltering:"non-filtering",Comparison:"comparison"},ta={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},L3={TwoD:"2d",ThreeD:"3d"},Dn={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},n$={All:"all"},zc={Vertex:"vertex",Instance:"instance"},Ym={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"};class r$ extends p5{constructor(e,t,r){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r}update(){this.texture=this.textureNode.value}}class i$ extends c5{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let s$=0;class o$ extends i${constructor(e,t){super("StorageBuffer_"+s$++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:nr.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class a$ extends Io{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:aa.Linear}),this.flipYSampler=e.createSampler({minFilter:aa.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:r}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:i})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:xl.TriangleStrip,stripIndexFormat:Hl.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:xl.TriangleStrip,stripIndexFormat:Hl.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,r=0){const i=t.format,{width:s,height:o}=t.size,a=this.getTransferPipeline(i),c=this.getFlipYPipeline(i),f=this.device.createTexture({size:{width:s,height:o,depthOrArrayLayers:1},format:i,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),p=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dn.TwoD,baseArrayLayer:r}),g=f.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dn.TwoD,baseArrayLayer:0}),v=this.device.createCommandEncoder({}),x=(T,S,R)=>{const C=T.getBindGroupLayout(0),B=this.device.createBindGroup({layout:C,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:S}]}),D=v.beginRenderPass({colorAttachments:[{view:R,loadOp:Lt.Clear,storeOp:_r.Store,clearValue:[0,0,0,0]}]});D.setPipeline(T),D.setBindGroup(0,B),D.draw(4,1,0,0),D.end()};x(a,p,g),x(c,g,p),this.device.queue.submit([v.finish()]),f.destroy()}generateMipmaps(e,t,r=0){const i=this.get(e);i.useCount===void 0&&(i.useCount=0,i.layers=[]);const s=i.layers[r]||this._mipmapCreateBundles(e,t,r),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,s),this.device.queue.submit([o.finish()]),i.useCount!==0&&(i.layers[r]=s),i.useCount++}_mipmapCreateBundles(e,t,r){const i=this.getTransferPipeline(t.format),s=i.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dn.TwoD,baseArrayLayer:r});const a=[];for(let c=1;c<t.mipLevelCount;c++){const f=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),p=e.createView({baseMipLevel:c,mipLevelCount:1,dimension:Dn.TwoD,baseArrayLayer:r}),g={colorAttachments:[{view:p,loadOp:Lt.Clear,storeOp:_r.Store,clearValue:[0,0,0,0]}]},v=this.device.createRenderBundleEncoder({colorFormats:[t.format]});v.setPipeline(i),v.setBindGroup(0,f),v.draw(4,1,0,0),a.push({renderBundles:[v.finish()],passDescriptor:g}),o=p}return a}_mipmapRunBundles(e,t){const r=t.length;for(let i=0;i<r;i++){const s=t[i],o=e.beginRenderPass(s.passDescriptor);o.executeBundles(s.renderBundles),o.end()}}}const l$={[Mb]:"never",[Sg]:"less",[Rb]:"equal",[Nb]:"less-equal",[Sb]:"greater",[Eb]:"greater-equal",[Cb]:"always",[wb]:"not-equal"},u$=[0,1,3,2,4,5];class A${constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new qi,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,r=t.device,i=t.get(e),s={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};s.magFilter===aa.Linear&&s.minFilter===aa.Linear&&s.mipmapFilter===aa.Linear&&(s.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(s.compare=l$[e.compareFunction]),i.sampler=r.createSampler(s)}createDefaultTexture(e){let t;const r=Km(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(r):t=this._getDefaultTextureGPU(r),this.backend.get(e).texture=t}createTexture(e,t={}){const r=this.backend,i=r.get(e);if(i.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){i.texture=e.sourceTexture,i.initialized=!0;return}t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:o,depth:a,levels:c}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const f=this._getDimension(e),p=e.internalFormat||t.format||Km(e,r.device);i.format=p;const{samples:g,primarySamples:v,isMSAA:x}=r.utils.getTextureSampleData(e);let T=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(T|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&p!==J.RGB9E5UFloat&&(T|=GPUTextureUsage.RENDER_ATTACHMENT);const S={label:e.name,size:{width:s,height:o,depthOrArrayLayers:a},mipLevelCount:c,sampleCount:v,dimension:f,format:p,usage:T};if(p===void 0){this.createDefaultTexture(e);return}if(e.isCubeTexture&&(S.textureBindingViewDimension=Dn.Cube),i.texture=r.device.createTexture(S),x){const R=Object.assign({},S);R.label=R.label+"-msaa",R.sampleCount=g,R.mipLevelCount=1,i.msaaTexture=r.device.createTexture(R)}i.initialized=!0,i.textureDescriptorGPU=S}destroyTexture(e){const t=this.backend,r=t.get(e);r.texture!==void 0&&r.texture.destroy(),r.msaaTexture!==void 0&&r.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const r=this.backend.get(e);delete r.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let r=0;r<6;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r);else{const r=e.image.depth||1;for(let i=0;i<r;i++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,i)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:r}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const r=this.backend,{width:i,height:s}=r.getDrawingBufferSize(),o=this.depthTexture,a=r.get(o).texture;let c,f;if(t?(c=wo,f=To):e&&(c=So,f=Ln),a!==void 0){if(o.image.width===i&&o.image.height===s&&o.format===c&&o.type===f)return a;this.destroyTexture(o)}return o.name="depthBuffer",o.format=c,o.type=f,o.image.width=i,o.image.height=s,this.createTexture(o,{width:i,height:s}),r.get(o).texture}updateTexture(e,t){const r=this.backend.get(e),i=e.mipmaps,{textureDescriptorGPU:s}=r;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)if(i.length>0)for(let o=0,a=i.length;o<a;o++){const c=i[o];this._copyBufferToTexture(c,r.texture,s,0,e.flipY,0,o)}else this._copyBufferToTexture(t.image,r.texture,s,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let o=0;o<t.image.depth;o++)this._copyBufferToTexture(t.image,r.texture,s,o,e.flipY,o);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,r.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,r.texture,s);else if(i.length>0)for(let o=0,a=i.length;o<a;o++){const c=i[o];this._copyImageToTexture(c,r.texture,s,0,e.flipY,e.premultiplyAlpha,o)}else this._copyImageToTexture(t.image,r.texture,s,0,e.flipY,e.premultiplyAlpha);r.version=e.version}}async copyTextureToBuffer(e,t,r,i,s,o){const a=this.backend.device,c=this.backend.get(e),f=c.texture,p=c.textureDescriptorGPU.format,g=this._getBytesPerTexel(p);let v=i*g;v=Math.ceil(v/256)*256;const x=a.createBuffer({size:(s-1)*v+i*g,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),T=a.createCommandEncoder();T.copyTextureToBuffer({texture:f,origin:{x:t,y:r,z:o}},{buffer:x,bytesPerRow:v},{width:i,height:s});const S=this._getTypedArrayType(p);a.queue.submit([T.finish()]),await x.mapAsync(GPUMapMode.READ);const R=x.getMappedRange();return new S(R)}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const r=new bg;r.minFilter=Bi,r.magFilter=Bi,this.createTexture(r,{width:1,height:1,format:e}),this.defaultTexture[e]=t=r}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const r=new vg;r.minFilter=Bi,r.magFilter=Bi,this.createTexture(r,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=r}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,r){const i=e.images,s=e.mipmaps;for(let o=0;o<6;o++){const a=i[o],c=e.flipY===!0?u$[o]:o;a.isDataTexture?this._copyBufferToTexture(a.image,t,r,c,e.flipY):this._copyImageToTexture(a,t,r,c,e.flipY,e.premultiplyAlpha);for(let f=0;f<s.length;f++){const g=s[f].images[o];g.isDataTexture?this._copyBufferToTexture(g.image,t,r,c,e.flipY,0,f+1):this._copyImageToTexture(g,t,r,c,e.flipY,e.premultiplyAlpha,f+1)}}}_copyImageToTexture(e,t,r,i,s,o,a=0){const c=this.backend.device,f=a>0?e.width:r.size.width,p=a>0?e.height:r.size.height;c.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:a,origin:{x:0,y:0,z:i},premultipliedAlpha:o},{width:f,height:p,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new a$(this.backend.device)),e}_generateMipmaps(e,t,r=0){this._getPassUtils().generateMipmaps(e,t,r)}_flipY(e,t,r=0){this._getPassUtils().flipY(e,t,r)}_copyBufferToTexture(e,t,r,i,s,o=0,a=0){const c=this.backend.device,f=e.data,p=this._getBytesPerTexel(r.format),g=e.width*p;c.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:i}},f,{offset:e.width*e.height*p*o,bytesPerRow:g},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,r,i)}_copyCompressedBufferToTexture(e,t,r){const i=this.backend.device,s=this._getBlockData(r.format),o=r.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const c=e[a],f=c.width,p=c.height,g=o?r.size.depthOrArrayLayers:1,v=Math.ceil(f/s.width)*s.byteLength,x=v*Math.ceil(p/s.height);for(let T=0;T<g;T++)i.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:T}},c.data,{offset:T*x,bytesPerRow:v,rowsPerImage:Math.ceil(p/s.height)},{width:Math.ceil(f/s.width)*s.width,height:Math.ceil(p/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===J.BC1RGBAUnorm||e===J.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===J.BC2RGBAUnorm||e===J.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===J.BC3RGBAUnorm||e===J.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===J.BC4RUnorm||e===J.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===J.BC5RGUnorm||e===J.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===J.BC6HRGBUFloat||e===J.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===J.BC7RGBAUnorm||e===J.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===J.ETC2RGB8Unorm||e===J.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===J.ETC2RGB8A1Unorm||e===J.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===J.ETC2RGBA8Unorm||e===J.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===J.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===J.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===J.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===J.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===J.ASTC4x4Unorm||e===J.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===J.ASTC5x4Unorm||e===J.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===J.ASTC5x5Unorm||e===J.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===J.ASTC6x5Unorm||e===J.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===J.ASTC6x6Unorm||e===J.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===J.ASTC8x5Unorm||e===J.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===J.ASTC8x6Unorm||e===J.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===J.ASTC8x8Unorm||e===J.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===J.ASTC10x5Unorm||e===J.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===J.ASTC10x6Unorm||e===J.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===J.ASTC10x8Unorm||e===J.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===J.ASTC10x10Unorm||e===J.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===J.ASTC12x10Unorm||e===J.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===J.ASTC12x12Unorm||e===J.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=ep.ClampToEdge;return e===qh?t=ep.Repeat:e===kh&&(t=ep.MirrorRepeat),t}_convertFilterMode(e){let t=aa.Linear;return(e===Bi||e===Tb||e===aA)&&(t=aa.Nearest),t}_getBytesPerTexel(e){if(e===J.R8Unorm||e===J.R8Snorm||e===J.R8Uint||e===J.R8Sint)return 1;if(e===J.R16Uint||e===J.R16Sint||e===J.R16Float||e===J.RG8Unorm||e===J.RG8Snorm||e===J.RG8Uint||e===J.RG8Sint)return 2;if(e===J.R32Uint||e===J.R32Sint||e===J.R32Float||e===J.RG16Uint||e===J.RG16Sint||e===J.RG16Float||e===J.RGBA8Unorm||e===J.RGBA8UnormSRGB||e===J.RGBA8Snorm||e===J.RGBA8Uint||e===J.RGBA8Sint||e===J.BGRA8Unorm||e===J.BGRA8UnormSRGB||e===J.RGB9E5UFloat||e===J.RGB10A2Unorm||e===J.RG11B10UFloat||e===J.Depth32Float||e===J.Depth24Plus||e===J.Depth24PlusStencil8||e===J.Depth32FloatStencil8)return 4;if(e===J.RG32Uint||e===J.RG32Sint||e===J.RG32Float||e===J.RGBA16Uint||e===J.RGBA16Sint||e===J.RGBA16Float)return 8;if(e===J.RGBA32Uint||e===J.RGBA32Sint||e===J.RGBA32Float)return 16}_getTypedArrayType(e){if(e===J.R8Uint)return Uint8Array;if(e===J.R8Sint)return Int8Array;if(e===J.R8Unorm)return Uint8Array;if(e===J.R8Snorm)return Int8Array;if(e===J.RG8Uint)return Uint8Array;if(e===J.RG8Sint)return Int8Array;if(e===J.RG8Unorm)return Uint8Array;if(e===J.RG8Snorm)return Int8Array;if(e===J.RGBA8Uint)return Uint8Array;if(e===J.RGBA8Sint)return Int8Array;if(e===J.RGBA8Unorm||e===J.RGBA8UnormSRGB)return Uint8Array;if(e===J.RGBA8Snorm)return Int8Array;if(e===J.R16Uint)return Uint16Array;if(e===J.R16Sint)return Int16Array;if(e===J.RG16Uint)return Uint16Array;if(e===J.RG16Sint)return Int16Array;if(e===J.RGBA16Uint)return Uint16Array;if(e===J.RGBA16Sint)return Int16Array;if(e===J.R16Float||e===J.RG16Float||e===J.RGBA16Float)return Uint16Array;if(e===J.R32Uint)return Uint32Array;if(e===J.R32Sint)return Int32Array;if(e===J.R32Float)return Float32Array;if(e===J.RG32Uint)return Uint32Array;if(e===J.RG32Sint)return Int32Array;if(e===J.RG32Float)return Float32Array;if(e===J.RGBA32Uint)return Uint32Array;if(e===J.RGBA32Sint)return Int32Array;if(e===J.RGBA32Float)return Float32Array;if(e===J.BGRA8Unorm||e===J.BGRA8UnormSRGB)return Uint8Array;if(e===J.RGB10A2Unorm||e===J.RGB9E5UFloat||e===J.RG11B10UFloat)return Uint32Array;if(e===J.Depth32Float)return Float32Array;if(e===J.Depth24Plus||e===J.Depth24PlusStencil8)return Uint32Array;if(e===J.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.is3DTexture||e.isData3DTexture?t=L3.ThreeD:t=L3.TwoD,t}}function Km(n,e=null){const t=n.format,r=n.type,i=n.colorSpace,s=Tn.getTransfer(i);let o;if(n.isCompressedTexture===!0||n.isCompressedArrayTexture===!0)switch(t){case o0:case a0:o=s===ct?J.BC1RGBAUnormSRGB:J.BC1RGBAUnorm;break;case l0:o=s===ct?J.BC2RGBAUnormSRGB:J.BC2RGBAUnorm;break;case u0:o=s===ct?J.BC3RGBAUnormSRGB:J.BC3RGBAUnorm;break;case Ip:o=J.BC4RUnorm;break;case kp:o=J.BC4RSnorm;break;case qp:o=J.BC5RGUnorm;break;case Up:o=J.BC5RGSnorm;break;case Fp:o=s===ct?J.BC7RGBAUnormSRGB:J.BC7RGBAUnorm;break;case vp:case _p:o=s===ct?J.ETC2RGB8UnormSRGB:J.ETC2RGB8Unorm;break;case bp:o=s===ct?J.ETC2RGBA8UnormSRGB:J.ETC2RGBA8Unorm;break;case xp:o=s===ct?J.ASTC4x4UnormSRGB:J.ASTC4x4Unorm;break;case Tp:o=s===ct?J.ASTC5x4UnormSRGB:J.ASTC5x4Unorm;break;case wp:o=s===ct?J.ASTC5x5UnormSRGB:J.ASTC5x5Unorm;break;case Sp:o=s===ct?J.ASTC6x5UnormSRGB:J.ASTC6x5Unorm;break;case Ep:o=s===ct?J.ASTC6x6UnormSRGB:J.ASTC6x6Unorm;break;case Rp:o=s===ct?J.ASTC8x5UnormSRGB:J.ASTC8x5Unorm;break;case Np:o=s===ct?J.ASTC8x6UnormSRGB:J.ASTC8x6Unorm;break;case Cp:o=s===ct?J.ASTC8x8UnormSRGB:J.ASTC8x8Unorm;break;case Mp:o=s===ct?J.ASTC10x5UnormSRGB:J.ASTC10x5Unorm;break;case Pp:o=s===ct?J.ASTC10x6UnormSRGB:J.ASTC10x6Unorm;break;case Bp:o=s===ct?J.ASTC10x8UnormSRGB:J.ASTC10x8Unorm;break;case Dp:o=s===ct?J.ASTC10x10UnormSRGB:J.ASTC10x10Unorm;break;case Lp:o=s===ct?J.ASTC12x10UnormSRGB:J.ASTC12x10Unorm;break;case Op:o=s===ct?J.ASTC12x12UnormSRGB:J.ASTC12x12Unorm;break;case Li:o=s===ct?J.RGBA8UnormSRGB:J.RGBA8Unorm;break;default:}else switch(t){case Li:switch(r){case Wu:o=J.RGBA8Snorm;break;case Qu:o=J.RGBA16Sint;break;case fl:o=J.RGBA16Uint;break;case Ln:o=J.RGBA32Uint;break;case vr:o=J.RGBA32Sint;break;case Xr:o=s===ct?J.RGBA8UnormSRGB:J.RGBA8Unorm;break;case wr:o=J.RGBA16Float;break;case ui:o=J.RGBA32Float;break;default:}break;case Eg:switch(r){case Kb:o=J.RGB9E5UFloat;break;case Zb:o=J.RG11B10UFloat;break;default:}break;case Rg:switch(r){case Wu:o=J.R8Snorm;break;case Qu:o=J.R16Sint;break;case fl:o=J.R16Uint;break;case Ln:o=J.R32Uint;break;case vr:o=J.R32Sint;break;case Xr:o=J.R8Unorm;break;case wr:o=J.R16Float;break;case ui:o=J.R32Float;break;default:}break;case ca:switch(r){case Wu:o=J.RG8Snorm;break;case Qu:o=J.RG16Sint;break;case fl:o=J.RG16Uint;break;case Ln:o=J.RG32Uint;break;case vr:o=J.RG32Sint;break;case Xr:o=J.RG8Unorm;break;case wr:o=J.RG16Float;break;case ui:o=J.RG32Float;break;default:}break;case So:switch(r){case fl:o=J.Depth16Unorm;break;case Ln:o=J.Depth24Plus;break;case ui:o=J.Depth32Float;break;default:}break;case wo:switch(r){case To:o=J.Depth24PlusStencil8;break;case ui:e&&e.features.has(Ym.Depth32FloatStencil8),o=J.Depth32FloatStencil8;break;default:}break;case Ng:switch(r){case vr:o=J.R32Sint;break;case Ln:o=J.R32Uint;break;default:}break;case Cg:switch(r){case vr:o=J.RG32Sint;break;case Ln:o=J.RG32Uint;break;default:}break;case Mg:switch(r){case vr:o=J.RGBA32Sint;break;case Ln:o=J.RGBA32Uint;break;default:}break;default:}return o}const c$=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,h$=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,O3={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},f$=n=>{n=n.trim();const e=n.match(c$);if(e!==null&&e.length===4){const t=e[2],r=[];let i=null;for(;(i=h$.exec(t))!==null;)r.push({name:i[1],type:i[2]});const s=[];for(let p=0;p<r.length;p++){const{name:g,type:v}=r[p];let x=v;x.startsWith("ptr")?x="pointer":(x.startsWith("texture")&&(x=v.split("<")[0]),x=O3[x]),s.push(new _2(x,g))}const o=n.substring(e[0].length),a=e[3]||"void",c=e[1]!==void 0?e[1]:"";return{type:O3[a]||a,inputs:s,name:c,inputsCode:t,blockCode:o,outputType:a}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class d$ extends b2{constructor(e){const{type:t,inputs:r,name:i,inputsCode:s,blockCode:o,outputType:a}=f$(e);super(t,r,i),this.inputsCode=s,this.blockCode=o,this.outputType=a}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class p$ extends l5{parseFunction(e){return new d$(e)}}const il=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},m$={[nr.READ_ONLY]:"read",[nr.WRITE_ONLY]:"write",[nr.READ_WRITE]:"read_write"},F3={[qh]:"repeat",[wg]:"clamp",[kh]:"mirror"},jc={vertex:il?il.VERTEX:1,fragment:il?il.FRAGMENT:2,compute:il?il.COMPUTE:4},I3={instance:!0,swizzleAssign:!1,storageBuffer:!0},g$={"^^":"tsl_xor"},y$={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},k3={},Bu={tsl_xor:new ur("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new ur("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new ur("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new ur("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new ur("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new ur("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new ur("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new ur("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new ur("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new ur("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new ur("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new ur("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new ur(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},_$={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};let _5="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(_5+=`diagnostic( off, derivative_uniformity );
`);class v$ extends a5{constructor(e,t){super(e,t,new p$),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,r,i,s,o=this.shaderStage){return o==="fragment"?i?s?`textureSample( ${t}, ${t}_sampler, ${r}, ${i}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${r}, ${i} )`:s?`textureSample( ${t}, ${t}_sampler, ${r}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${r} )`:this.generateTextureSampleLevel(e,t,r,"0",i)}generateTextureSampleLevel(e,t,r,i,s,o){return this.isUnfilterable(e)===!1?o?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${i}, ${o} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,o,i):this.generateTextureLod(e,t,r,s,o,i)}generateWrapFunction(e){const t=`tsl_coord_${F3[e.wrapS]}S_${F3[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let r=k3[t];if(r===void 0){const i=[],s=e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const a=(c,f)=>{c===qh?(i.push(Bu.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${f} )`):c===wg?(i.push(Bu.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${f} )`):c===kh?(i.push(Bu.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${f} )`):o+=`		coord.${f}`};a(e.wrapS,"x"),o+=`,
`,a(e.wrapT,"y"),e.isData3DTexture&&(o+=`,
`,a(e.wrapR,"z")),o+=`
	);

}
`,k3[t]=r=new ur(o,i)}return r.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,r){const i=this.getDataFromNode(e,this.shaderStage,this.globalCache);i.dimensionsSnippet===void 0&&(i.dimensionsSnippet={});let s=i.dimensionsSnippet[r];if(i.dimensionsSnippet[r]===void 0){let o,a;const{primarySamples:c}=this.renderer.backend.utils.getTextureSampleData(e),f=c>1;e.isData3DTexture?a="vec3<u32>":a="vec2<u32>",f||e.isStorageTexture?o=t:o=`${t}${r?`, u32( ${r} )`:""}`,s=new b0(new x0(`textureDimensions( ${o} )`,a)),i.dimensionsSnippet[r]=s,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(i.arrayLayerCount=new b0(new x0(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(i.cubeFaceCount=new b0(new x0("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,r,i,s="0u"){this._include("biquadraticTexture");const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,s);return i&&(r=`${r} + vec2<f32>(${i}) / ${a}`),`tsl_biquadraticTexture( ${t}, ${o}( ${r} ), ${a}, u32( ${s} ) )`}generateTextureLod(e,t,r,i,s,o="0u"){const a=this.generateWrapFunction(e),c=this.generateTextureDimension(e,t,o),f=e.isData3DTexture?"vec3":"vec2";s&&(r=`${r} + ${f}<f32>(${s}) / ${f}<f32>( ${c} )`);const p=`${f}<u32>( ${a}( ${r} ) * ${f}<f32>( ${c} ) )`;return this.generateTextureLoad(e,t,p,i,null,o)}generateTextureLoad(e,t,r,i,s,o="0u"){let a;return s&&(r=`${r} + ${s}`),i?a=`textureLoad( ${t}, ${r}, ${i}, u32( ${o} ) )`:(a=`textureLoad( ${t}, ${r}, u32( ${o} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,r,i,s){let o;return i?o=`textureStore( ${t}, ${r}, ${i}, ${s} )`:o=`textureStore( ${t}, ${r}, ${s} )`,o}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===ui||this.isSampleCompare(e)===!1&&e.minFilter===Bi&&e.magFilter===Bi||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,r,i,s,o=this.shaderStage){let a=null;return this.isUnfilterable(e)?a=this.generateTextureLod(e,t,r,i,s,"0",o):a=this._generateTextureSample(e,t,r,i,s,o),a}generateTextureGrad(e,t,r,i,s,o,a=this.shaderStage){if(a==="fragment")return o?`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${i[0]}, ${i[1]}, ${o} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${i[0]}, ${i[1]} )`}generateTextureCompare(e,t,r,i,s,o,a=this.shaderStage){if(a==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?o?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s}, ${i}, ${o} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s}, ${i} )`:o?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i}, ${o} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i} )`}generateTextureLevel(e,t,r,i,s,o){return this.isUnfilterable(e)===!1?o?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${i}, ${o} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,o,i):this.generateTextureLod(e,t,r,s,o,i)}generateTextureBias(e,t,r,i,s,o,a=this.shaderStage){if(a==="fragment")return o?`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${i}, ${o} )`:`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${i} )`}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const r=e.name,i=e.type;return i==="texture"||i==="cubeTexture"||i==="storageTexture"||i==="texture3D"?r:i==="buffer"||i==="storageBuffer"||i==="indirectStorageBuffer"?this.isCustomStruct(e)?r:r+".value":e.groupNode.name+"."+r}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=g$[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?e.isAtomic===!0?nr.READ_WRITE:nr.READ_ONLY:e.access}getStorageAccess(e,t){return m$[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,r,i=null){const s=super.getUniformFromNode(e,t,r,i),o=this.getDataFromNode(e,r,this.globalCache);if(o.uniformGPU===void 0){let a;const c=e.groupNode,f=c.name,p=this.getBindGroupArray(f,r);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let g=null;const v=this.getNodeAccess(e,r);if(t==="texture"||t==="storageTexture"?e.value.is3DTexture===!0?g=new Xm(s.name,s.node,c,v):g=new Tf(s.name,s.node,c,v):t==="cubeTexture"?g=new m5(s.name,s.node,c,v):t==="texture3D"&&(g=new Xm(s.name,s.node,c,v)),g.store=e.isStorageTextureNode===!0,g.setVisibility(jc[r]),this.isUnfilterable(e.value)===!1&&g.store===!1){const x=new r$(`${s.name}_sampler`,s.node,c);x.setVisibility(jc[r]),p.push(x,g),a=[x,g]}else p.push(g),a=[g]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const g=t==="buffer"?f5:o$,v=new g(e,c);v.setVisibility(jc[r]),p.push(v),a=v,s.name=i||"NodeBuffer_"+s.id}else{const g=this.uniformGroups[r]||(this.uniformGroups[r]={});let v=g[f];v===void 0&&(v=new d5(f,c),v.setVisibility(jc[r]),g[f]=v,p.push(v)),a=this.getNodeUniform(s,t),v.addUniform(a)}o.uniformGPU=a}return s}getBuiltin(e,t,r,i=this.shaderStage){const s=this.builtins[i]||(this.builtins[i]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:r}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),i=[];for(const o of t.inputs)i.push(o.name+" : "+this.getType(o.type));let s=`fn ${t.name}( ${i.join(", ")} ) -> ${this.getType(t.type)} {
${r.vars}
${r.code}
`;return r.result&&(s+=`	return ${r.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],r=this.directives[e];if(r!==void 0)for(const i of r)t.push(`enable ${i};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],r=this.builtins[e];if(r!==void 0)for(const{name:i,property:s,type:o}of r.values())t.push(`@builtin( ${i} ) ${s} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,r,i){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:r,bufferCount:i}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:r,scope:i,bufferType:s,bufferCount:o}of this.scopedArrays.values()){const a=this.getType(s);t.push(`var<${i}> ${r}: array< ${a}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const r=this.getBuiltins("attribute");r&&t.push(r);const i=this.getAttributesArray();for(let s=0,o=i.length;s<o;s++){const a=i[s],c=a.name,f=this.getType(a.type);t.push(`@location( ${s} ) ${c} : ${f}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const r of e.members){const i=e.output?"@location( "+r.index+" ) ":"";let s=this.getType(r.type);r.atomic&&(s="atomic< "+s+" >"),t.push(`	${i+r.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const r=this.structs[e];if(r.length>0){const i=[];for(const s of r){let o=`struct ${s.name} {
`;o+=this.getStructMembers(s),o+=`
};`,i.push(o)}t=`
`+i.join(`

`)+`
`}return t}getVar(e,t,r=null){let i=`var ${t} : `;return r!==null?i+=this.generateArrayDeclaration(e,r):i+=this.getType(e),i}getVars(e){const t=[],r=this.vars[e];if(r!==void 0)for(const i of r)t.push(`	${this.getVar(i.type,i.name,i.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,o=this.vars[e];for(let a=0;a<s.length;a++){const c=s[a];if(c.needsInterpolation){let f=`@location( ${a} )`;if(c.interpolationType){const p=c.interpolationSampling!==null?`, ${c.interpolationSampling} )`:" )";f+=` @interpolate( ${c.interpolationType}${p}`}else/^(int|uint|ivec|uvec)/.test(c.type)&&(f+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${f} ${c.name} : ${this.getType(c.type)}`)}else e==="vertex"&&o.includes(c)===!1&&o.push(c)}}const r=this.getBuiltins(e);r&&t.push(r);const i=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+i):i}isCustomStruct(e){const t=e.value,r=e.node,i=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&r.structTypeNode!==null,s=r.value&&r.value.array&&typeof r.value.itemSize=="number"&&r.value.array.length>r.value.itemSize;return i&&!s}getUniforms(e){const t=this.uniforms[e],r=[],i=[],s=[],o={};for(const c of t){const f=c.groupNode.name,p=this.bindingsIndexes[f];if(c.type==="texture"||c.type==="cubeTexture"||c.type==="storageTexture"||c.type==="texture3D"){const g=c.node.value;this.isUnfilterable(g)===!1&&c.node.isStorageTextureNode!==!0&&(this.isSampleCompare(g)?r.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name}_sampler : sampler_comparison;`):r.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name}_sampler : sampler;`));let v,x="";const{primarySamples:T}=this.renderer.backend.utils.getTextureSampleData(g);if(T>1&&(x="_multisampled"),g.isCubeTexture===!0)v="texture_cube<f32>";else if(g.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&g.compareFunction===null?v=`texture${x}_2d<f32>`:v=`texture_depth${x}_2d${g.isArrayTexture===!0?"_array":""}`;else if(c.node.isStorageTextureNode===!0){const S=Km(g),R=this.getStorageAccess(c.node,e),C=c.node.value.is3DTexture,B=c.node.value.isArrayTexture;v=`texture_storage_${C?"3d":`2d${B?"_array":""}`}<${S}, ${R}>`}else if(g.isArrayTexture===!0||g.isDataArrayTexture===!0||g.isCompressedArrayTexture===!0)v="texture_2d_array<f32>";else if(g.is3DTexture===!0||g.isData3DTexture===!0)v="texture_3d<f32>";else{const S=this.getComponentTypeFromTexture(g).charAt(0);v=`texture${x}_2d<${S}32>`}r.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name} : ${v};`)}else if(c.type==="buffer"||c.type==="storageBuffer"||c.type==="indirectStorageBuffer"){const g=c.node,v=this.getType(g.getNodeType(this)),x=g.bufferCount,T=x>0&&c.type==="buffer"?", "+x:"",S=g.isStorageBufferNode?`storage, ${this.getStorageAccess(g,e)}`:"uniform";if(this.isCustomStruct(c))i.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var<${S}> ${c.name} : ${v};`);else{const C=`	value : array< ${g.isAtomic?`atomic<${v}>`:`${v}`}${T} >`;i.push(this._getWGSLStructBinding(c.name,C,S,p.binding++,p.group))}}else{const g=this.getType(this.getVectorType(c.type)),v=c.groupNode.name;(o[v]||(o[v]={index:p.binding++,id:p.group,snippets:[]})).snippets.push(`	${c.name} : ${g}`)}}for(const c in o){const f=o[c];s.push(this._getWGSLStructBinding(c,f.snippets.join(`,
`),"uniform",f.index,f.id))}let a=r.join(`
`);return a+=i.join(`
`),a+=s.join(`
`),a}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const r=e[t];r.uniforms=this.getUniforms(t),r.attributes=this.getAttributes(t),r.varyings=this.getVaryings(t),r.structs=this.getStructs(t),r.vars=this.getVars(t),r.codes=this.getCodes(t),r.directives=this.getDirectives(t),r.scopedArrays=this.getScopedArrays(t);let i=`// code

`;i+=this.flowCode[t];const s=this.flowNodes[t],o=s[s.length-1],a=o.outputNode,c=a!==void 0&&a.isOutputStructNode===!0;for(const f of s){const p=this.getFlowData(f),g=f.name;if(g&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${g}
`),i+=`${p.code}
	`,f===o&&t!=="compute"){if(i+=`// result

	`,t==="vertex")i+=`varyings.Vertex = ${p.result};`;else if(t==="fragment")if(c)r.returnType=a.getNodeType(this),r.structs+="var<private> output : "+r.returnType+";",i+=`return ${p.result};`;else{let v="	@location(0) color: vec4<f32>";const x=this.getBuiltins("output");x&&(v+=`,
	`+x),r.returnType="OutputStruct",r.structs+=this._getWGSLStruct("OutputStruct",v),r.structs+=`
var<private> output : OutputStruct;`,i+=`output.color = ${p.result};

	return output;`}}}r.flow=i}if(this.shaderStage=null,this.material!==null)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let r;return t!==null&&(r=this._getWGSLMethod(e+"_"+t)),r===void 0&&(r=this._getWGSLMethod(e)),r||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getTernary(e,t,r){return`select( ${r}, ${t}, ${e} )`}getType(e){return y$[e]||e}isAvailable(e){let t=I3[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),I3[e]=t),t}_getWGSLMethod(e){return Bu[e]!==void 0&&this._include(e),_$[e]}_include(e){const t=Bu[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${_5}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){const[r,i,s]=t;return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${r}, ${i}, ${s} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x
		+ globalId.y * ( ${r} * numWorkgroups.x )
		+ globalId.z * ( ${r} * numWorkgroups.x ) * ( ${i} * numWorkgroups.y );

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,r,i=0,s=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${i} ) @group( ${s} )
var<${r}> ${e} : ${o};`}}class b${constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=J.Depth24PlusStencil8:e.depth&&(t=J.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,o=s.getRenderTarget();t=o?o.samples:s.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const r=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:r?1:t,isMSAA:r}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return xl.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return xl.LineList;if(e.isLine)return xl.LineStrip;if(e.isMesh)return xl.TriangleList}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===Xr)return J.BGRA8Unorm;if(e===wr)return J.RGBA16Float;throw new Error("Unsupported outputType")}}const v5=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&v5.set(Float16Array,["float16"]);const x$=new Map([[tx,["float16"]]]),T$=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class w${constructor(e){this.backend=e}createAttribute(e,t){const r=this._getBufferAttribute(e),i=this.backend,s=i.get(r);let o=s.buffer;if(o===void 0){const a=i.device;let c=r.array;if(e.normalized===!1){if(c.constructor===Int16Array||c.constructor===Int8Array)c=new Int32Array(c);else if((c.constructor===Uint16Array||c.constructor===Uint8Array)&&(c=new Uint32Array(c),t&GPUBufferUsage.INDEX))for(let g=0;g<c.length;g++)c[g]===65535&&(c[g]=4294967295)}if(r.array=c,(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&r.itemSize===3){c=new c.constructor(r.count*4);for(let g=0;g<r.count;g++)c.set(r.array.subarray(g*3,g*3+3),g*4);r.itemSize=4,r.array=c,s._force3to4BytesAlignment=!0}const f=c.byteLength,p=f+(4-f%4)%4;o=a.createBuffer({label:r.name,size:p,usage:t,mappedAtCreation:!0}),new c.constructor(o.getMappedRange()).set(c),o.unmap(),s.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),r=this.backend,i=r.device,s=r.get(t),o=r.get(t).buffer;let a=t.array;if(s._force3to4BytesAlignment===!0){a=new a.constructor(t.count*4);for(let p=0;p<t.count;p++)a.set(t.array.subarray(p*3,p*3+3),p*4);t.array=a}const c=this._isTypedArray(a),f=t.updateRanges;if(f.length===0)i.queue.writeBuffer(o,0,a,0);else{const p=c?1:a.BYTES_PER_ELEMENT;for(let g=0,v=f.length;g<v;g++){const x=f[g];let T,S;if(s._force3to4BytesAlignment===!0){const C=Math.floor(x.start/3),B=Math.ceil(x.count/3);T=C*4*p,S=B*4*p}else T=x.start*p,S=x.count*p;const R=T*(c?a.BYTES_PER_ELEMENT:1);i.queue.writeBuffer(o,R,a,T,S)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),r=new Map;for(let i=0;i<t.length;i++){const s=t[i],o=s.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(s);let c=r.get(a);if(c===void 0){let g,v;s.isInterleavedBufferAttribute===!0?(g=s.data.stride*o,v=s.data.isInstancedInterleavedBuffer?zc.Instance:zc.Vertex):(g=s.itemSize*o,v=s.isInstancedBufferAttribute?zc.Instance:zc.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(g=4),c={arrayStride:g,attributes:[],stepMode:v},r.set(a,c)}const f=this._getVertexFormat(s),p=s.isInterleavedBufferAttribute===!0?s.offset*o:0;c.attributes.push({shaderLocation:i,offset:p,format:f})}return Array.from(r.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,r=t.device,s=t.get(this._getBufferAttribute(e)).buffer,o=s.size,a=r.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c=r.createCommandEncoder({label:`readback_encoder_${e.name}`});c.copyBufferToBuffer(s,0,a,0,o);const f=c.finish();r.queue.submit([f]),await a.mapAsync(GPUMapMode.READ);const p=a.getMappedRange(),g=new e.array.constructor(p.slice(0));return a.unmap(),g.buffer}_getVertexFormat(e){const{itemSize:t,normalized:r}=e,i=e.array.constructor,s=e.constructor;let o;if(t===1)o=T$.get(i);else{const c=(x$.get(s)||v5.get(i))[r?1:0];if(c){const f=i.BYTES_PER_ELEMENT*t,g=Math.floor((f+3)/4)*4/i.BYTES_PER_ELEMENT;if(g%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${c}x${g}`}}return o}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class S${constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,r=t.device,i=[];let s=0;for(const o of e.bindings){const a={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const c={};o.isStorageBuffer&&(o.visibility&4&&(o.access===nr.READ_WRITE||o.access===nr.WRITE_ONLY)?c.type=tp.Storage:c.type=tp.ReadOnlyStorage),a.buffer=c}else if(o.isSampledTexture&&o.store){const c={};c.format=this.backend.get(o.texture).texture.format;const f=o.access;f===nr.READ_WRITE?c.access=np.ReadWrite:f===nr.WRITE_ONLY?c.access=np.WriteOnly:c.access=np.ReadOnly,o.texture.isArrayTexture?c.viewDimension=Dn.TwoDArray:o.texture.is3DTexture&&(c.viewDimension=Dn.ThreeD),a.storageTexture=c}else if(o.isSampledTexture){const c={},{primarySamples:f}=t.utils.getTextureSampleData(o.texture);if(f>1&&(c.multisampled=!0,o.texture.isDepthTexture||(c.sampleType=ta.UnfilterableFloat)),o.texture.isDepthTexture)t.compatibilityMode&&o.texture.compareFunction===null?c.sampleType=ta.UnfilterableFloat:c.sampleType=ta.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const p=o.texture.type;p===vr?c.sampleType=ta.SInt:p===Ln?c.sampleType=ta.UInt:p===ui&&(this.backend.hasFeature("float32-filterable")?c.sampleType=ta.Float:c.sampleType=ta.UnfilterableFloat)}o.isSampledCubeTexture?c.viewDimension=Dn.Cube:o.texture.isArrayTexture||o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?c.viewDimension=Dn.TwoDArray:o.isSampledTexture3D&&(c.viewDimension=Dn.ThreeD),a.texture=c}else if(o.isSampler){const c={};o.texture.isDepthTexture&&(o.texture.compareFunction!==null?c.type=D3.Comparison:t.compatibilityMode&&(c.type=D3.NonFiltering)),a.sampler=c}i.push(a)}return r.createBindGroupLayout({entries:i})}createBindings(e,t,r,i=0){const{backend:s,bindGroupLayoutCache:o}=this,a=s.get(e);let c=o.get(e.bindingsReference);c===void 0&&(c=this.createBindingsLayout(e),o.set(e.bindingsReference,c));let f;r>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[r]===i&&(f=a.groups[r])),f===void 0&&(f=this.createBindGroup(e,c),r>0&&(a.groups[r]=f,a.versions[r]=i)),a.group=f,a.layout=c}updateBinding(e){const t=this.backend,r=t.device,i=e.buffer,s=t.get(e).buffer;r.queue.writeBuffer(s,0,i,0)}createBindGroupIndex(e,t){const i=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],a=i.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:s});i.queue.writeBuffer(a,0,e,0);const c=[{binding:0,resource:{buffer:a}}];return i.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:t,entries:c})}createBindGroup(e,t){const r=this.backend,i=r.device;let s=0;const o=[];for(const a of e.bindings){if(a.isUniformBuffer){const c=r.get(a);if(c.buffer===void 0){const f=a.byteLength,p=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,g=i.createBuffer({label:"bindingBuffer_"+a.name,size:f,usage:p});c.buffer=g}o.push({binding:s,resource:{buffer:c.buffer}})}else if(a.isStorageBuffer){const c=r.get(a);if(c.buffer===void 0){const f=a.attribute;c.buffer=r.get(f).buffer}o.push({binding:s,resource:{buffer:c.buffer}})}else if(a.isSampledTexture){const c=r.get(a.texture);let f;if(c.externalTexture!==void 0)f=i.importExternalTexture({source:c.externalTexture});else{const p=a.store?1:c.texture.mipLevelCount;let g=`view-${c.texture.width}-${c.texture.height}`;if(c.texture.depthOrArrayLayers>1&&(g+=`-${c.texture.depthOrArrayLayers}`),g+=`-${p}`,f=c[g],f===void 0){const v=n$.All;let x;a.isSampledCubeTexture?x=Dn.Cube:a.isSampledTexture3D?x=Dn.ThreeD:a.texture.isArrayTexture||a.texture.isDataArrayTexture||a.texture.isCompressedArrayTexture?x=Dn.TwoDArray:x=Dn.TwoD,f=c[g]=c.texture.createView({aspect:v,dimension:x,mipLevelCount:p})}}o.push({binding:s,resource:f})}else if(a.isSampler){const c=r.get(a.texture);o.push({binding:s,resource:c.sampler})}s++}return i.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class E${constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:r,material:i,geometry:s,pipeline:o}=e,{vertexProgram:a,fragmentProgram:c}=o,f=this.backend,p=f.device,g=f.utils,v=f.get(o),x=[];for(const Z of e.getBindings()){const oe=f.get(Z);x.push(oe.layout)}const T=f.attributeUtils.createShaderVertexBuffers(e);let S;i.blending!==Bl&&(i.blending!==Ls||i.transparent!==!1)&&(S=this._getBlending(i));let R={};i.stencilWrite===!0&&(R={compare:this._getStencilCompare(i),failOp:this._getStencilOperation(i.stencilFail),depthFailOp:this._getStencilOperation(i.stencilZFail),passOp:this._getStencilOperation(i.stencilZPass)});const C=this._getColorWriteMask(i),B=[];if(e.context.textures!==null){const Z=e.context.textures;for(let oe=0;oe<Z.length;oe++){const K=g.getTextureFormatGPU(Z[oe]);B.push({format:K,blend:S,writeMask:C})}}else{const Z=g.getCurrentColorFormat(e.context);B.push({format:Z,blend:S,writeMask:C})}const D=f.get(a).module,F=f.get(c).module,I=this._getPrimitiveState(r,s,i),q=this._getDepthCompare(i),k=g.getCurrentDepthStencilFormat(e.context),G=this._getSampleCount(e.context),j={label:`renderPipeline_${i.name||i.type}_${i.id}`,vertex:Object.assign({},D,{buffers:T}),fragment:Object.assign({},F,{targets:B}),primitive:I,multisample:{count:G,alphaToCoverageEnabled:i.alphaToCoverage&&G>1},layout:p.createPipelineLayout({bindGroupLayouts:x})},ee={},Q=e.context.depth,Y=e.context.stencil;if((Q===!0||Y===!0)&&(Q===!0&&(ee.format=k,ee.depthWriteEnabled=i.depthWrite,ee.depthCompare=q),Y===!0&&(ee.stencilFront=R,ee.stencilBack={},ee.stencilReadMask=i.stencilFuncMask,ee.stencilWriteMask=i.stencilWriteMask),i.polygonOffset===!0&&(ee.depthBias=i.polygonOffsetUnits,ee.depthBiasSlopeScale=i.polygonOffsetFactor,ee.depthBiasClamp=0),j.depthStencil=ee),t===null)v.pipeline=p.createRenderPipeline(j);else{const Z=new Promise(oe=>{p.createRenderPipelineAsync(j).then(K=>{v.pipeline=K,oe()})});t.push(Z)}}createBundleEncoder(e,t="renderBundleEncoder"){const r=this.backend,{utils:i,device:s}=r,o=i.getCurrentDepthStencilFormat(e),a=i.getCurrentColorFormat(e),c=this._getSampleCount(e),f={label:t,colorFormats:[a],depthStencilFormat:o,sampleCount:c};return s.createRenderBundleEncoder(f)}createComputePipeline(e,t){const r=this.backend,i=r.device,s=r.get(e.computeProgram).module,o=r.get(e),a=[];for(const c of t){const f=r.get(c);a.push(f.layout)}o.pipeline=i.createComputePipeline({compute:s,layout:i.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,r;const i=e.blending,s=e.blendSrc,o=e.blendDst,a=e.blendEquation;if(i===Hu){const c=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,f=e.blendDstAlpha!==null?e.blendDstAlpha:o,p=e.blendEquationAlpha!==null?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(a)},r={srcFactor:this._getBlendFactor(c),dstFactor:this._getBlendFactor(f),operation:this._getBlendOperation(p)}}else{const c=e.premultipliedAlpha,f=(p,g,v,x)=>{t={srcFactor:p,dstFactor:g,operation:ea.Add},r={srcFactor:v,dstFactor:x,operation:ea.Add}};if(c)switch(i){case Ls:f(wt.One,wt.OneMinusSrcAlpha,wt.One,wt.OneMinusSrcAlpha);break;case D0:f(wt.One,wt.One,wt.One,wt.One);break;case B0:f(wt.Zero,wt.OneMinusSrc,wt.Zero,wt.One);break;case P0:f(wt.Dst,wt.OneMinusSrcAlpha,wt.Zero,wt.One);break}else switch(i){case Ls:f(wt.SrcAlpha,wt.OneMinusSrcAlpha,wt.One,wt.OneMinusSrcAlpha);break;case D0:f(wt.SrcAlpha,wt.One,wt.One,wt.One);break;case B0:break;case P0:break}}if(t!==void 0&&r!==void 0)return{color:t,alpha:r}}_getBlendFactor(e){let t;switch(e){case ho:t=wt.Zero;break;case Vb:t=wt.One;break;case Gb:t=wt.Src;break;case Fb:t=wt.OneMinusSrc;break;case Ub:t=wt.SrcAlpha;break;case Ob:t=wt.OneMinusSrcAlpha;break;case kb:t=wt.Dst;break;case Lb:t=wt.OneMinusDst;break;case Ib:t=wt.DstAlpha;break;case Db:t=wt.OneMinusDstAlpha;break;case qb:t=wt.SrcAlphaSaturated;break;case qk:t=wt.Constant;break;case Uk:t=wt.OneMinusConstant;break;default:}return t}_getStencilCompare(e){let t;switch(e.stencilFunc){case DR:t=Zn.Never;break;case BR:t=Zn.Always;break;case PR:t=Zn.Less;break;case MR:t=Zn.LessEqual;break;case CR:t=Zn.Equal;break;case NR:t=Zn.GreaterEqual;break;case RR:t=Zn.Greater;break;case ER:t=Zn.NotEqual;break;default:}return t}_getStencilOperation(e){let t;switch(e){case GR:t=lo.Keep;break;case UR:t=lo.Zero;break;case qR:t=lo.Replace;break;case kR:t=lo.Invert;break;case IR:t=lo.IncrementClamp;break;case FR:t=lo.DecrementClamp;break;case OR:t=lo.IncrementWrap;break;case LR:t=lo.DecrementWrap;break;default:}return t}_getBlendOperation(e){let t;switch(e){case Ps:t=ea.Add;break;case Bb:t=ea.Subtract;break;case Pb:t=ea.ReverseSubtract;break;case zR:t=ea.Min;break;case VR:t=ea.Max;break;default:}return t}_getPrimitiveState(e,t,r){const i={},s=this.backend.utils;i.topology=s.getPrimitiveTopology(e,r),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(i.stripIndexFormat=t.index.array instanceof Uint16Array?Hl.Uint16:Hl.Uint32);let o=r.side===hr;return e.isMesh&&e.matrixWorld.determinant()<0&&(o=!o),i.frontFace=o===!0?M3.CW:M3.CCW,i.cullMode=r.side===fi?P3.None:P3.Back,i}_getColorWriteMask(e){return e.colorWrite===!0?B3.All:B3.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=Zn.Always;else switch(e.depthFunc){case Yb:t=Zn.Never;break;case Xb:t=Zn.Always;break;case Qb:t=Zn.Less;break;case Wb:t=Zn.LessEqual;break;case Hb:t=Zn.Equal;break;case $b:t=Zn.GreaterEqual;break;case jb:t=Zn.Greater;break;case zb:t=Zn.NotEqual;break;default:}return t}}class R$ extends y5{constructor(e,t,r=2048){super(r),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const i=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return ki(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,r=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const i=this.device.createCommandEncoder();i.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),i.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r);const s=i.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,r),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,r));let a=0;for(const[,c]of e){const f=o[c],p=o[c+1],g=Number(p-f)/1e6;a+=g}return this.resultBuffer.unmap(),this.lastValue=a,a}catch{return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch{}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch{}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class N$ extends g5{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new b$(this),this.attributeUtils=new w$(this),this.bindingUtils=new S$(this),this.pipelineUtils=new E$(this),this.textureUtils=new A$(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let r;if(t.device===void 0){const a={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},c=typeof navigator<"u"?await navigator.gpu.requestAdapter(a):null;if(c===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const f=Object.values(Ym),p=[];for(const v of f)c.features.has(v)&&p.push(v);const g={requiredFeatures:p,requiredLimits:t.requiredLimits};r=await c.requestDevice(g)}else r=t.device;r.lost.then(a=>{const c={api:"WebGPU",message:a.message||"Unknown reason",reason:a.reason||null,originalEvent:a};e.onDeviceLost(c)});const i=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=r,this.context=i;const s=t.alpha?"premultiplied":"opaque",o=Tn.getToneMappingMode(this.renderer.outputColorSpace);this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s,toneMapping:{mode:o}}),this.trackTimestamp=this.trackTimestamp&&this.hasFeature(Ym.TimestampQuery),this.updateSize()}get coordinateSystem(){return Yl}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const r=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(r.depth,r.stencil).createView()});const i=e.colorAttachments[0];this.renderer.samples>0?i.view=this.colorBuffer.createView():i.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const r=e.renderTarget,i=this.get(r);let s=i.descriptors;(s===void 0||i.width!==r.width||i.height!==r.height||i.samples!==r.samples)&&(s={},i.descriptors=s);const o=e.getCacheKey();let a=s[o];if(a===void 0){const f=e.textures,p=[];let g;const v=this._isRenderCameraDepthArray(e);for(let x=0;x<f.length;x++){const T=this.get(f[x]),S={label:`colorAttachment_${x}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Dn.TwoD};if(r.isRenderTarget3D)g=e.activeCubeFace,S.baseArrayLayer=0,S.dimension=Dn.ThreeD,S.depthOrArrayLayers=f[x].image.depth;else if(r.isRenderTarget&&f[x].image.depth>1)if(v===!0){const R=e.camera.cameras;for(let C=0;C<R.length;C++){const B={...S,baseArrayLayer:C,arrayLayerCount:1,dimension:Dn.TwoD},D=T.texture.createView(B);p.push({view:D,resolveTarget:void 0,depthSlice:void 0})}}else S.dimension=Dn.TwoDArray,S.depthOrArrayLayers=f[x].image.depth;if(v!==!0){const R=T.texture.createView(S);let C,B;T.msaaTexture!==void 0?(C=T.msaaTexture.createView(),B=R):(C=R,B=void 0),p.push({view:C,resolveTarget:B,depthSlice:g})}}if(a={textureViews:p},e.depth){const x=this.get(e.depthTexture),T={};e.depthTexture.isArrayTexture&&(T.dimension=Dn.TwoD,T.arrayLayerCount=1,T.baseArrayLayer=e.activeCubeFace),a.depthStencilView=x.texture.createView(T)}s[o]=a,i.width=r.width,i.height=r.height,i.samples=r.samples,i.activeMipmapLevel=e.activeMipmapLevel,i.activeCubeFace=e.activeCubeFace}const c={colorAttachments:[]};for(let f=0;f<a.textureViews.length;f++){const p=a.textureViews[f];let g={r:0,g:0,b:0,a:1};f===0&&t.clearValue&&(g=t.clearValue),c.colorAttachments.push({view:p.view,depthSlice:p.depthSlice,resolveTarget:p.resolveTarget,loadOp:t.loadOp||Lt.Load,storeOp:t.storeOp||_r.Store,clearValue:g})}return a.depthStencilView&&(c.depthStencilAttachment={view:a.depthStencilView}),c}beginRender(e){const t=this.get(e);t.frameCalls=this.renderer.info.render.frameCalls;const r=this.device,i=e.occlusionQueryCount;let s;i>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=r.createQuerySet({type:"occlusion",count:i,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(i),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:Lt.Load}),this.initTimestampQuery(cl.RENDER,this.getTimestampUID(e),o),o.occlusionQuerySet=s;const a=o.depthStencilAttachment;if(e.textures!==null){const f=o.colorAttachments;for(let p=0;p<f.length;p++){const g=f[p];e.clearColor?(g.clearValue=p===0?e.clearColorValue:{r:0,g:0,b:0,a:1},g.loadOp=Lt.Clear):g.loadOp=Lt.Load,g.storeOp=_r.Store}}else{const f=o.colorAttachments[0];e.clearColor?(f.clearValue=e.clearColorValue,f.loadOp=Lt.Clear):f.loadOp=Lt.Load,f.storeOp=_r.Store}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=Lt.Clear):a.depthLoadOp=Lt.Load,a.depthStoreOp=_r.Store),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=Lt.Clear):a.stencilLoadOp=Lt.Load,a.stencilStoreOp=_r.Store);const c=r.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const f=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==f.length?this._createDepthLayerDescriptors(e,t,o,f):this._updateDepthLayerDescriptors(e,t,f),t.bundleEncoders=[],t.bundleSets=[];for(let p=0;p<f.length;p++){const g=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+p),v={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(g),t.bundleSets.push(v)}t.currentPass=null}else{const f=c.beginRenderPass(o);if(t.currentPass=f,e.viewport&&this.updateViewport(e),e.scissor){const{x:p,y:g,width:v,height:x}=e.scissorValue;f.setScissorRect(p,g,v,x)}}t.descriptor=o,t.encoder=c,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,r,i){const s=r.depthStencilAttachment;t.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let a=0;a<i.length;a++){const c={...r,colorAttachments:[{...r.colorAttachments[0],view:r.colorAttachments[a].view}]};if(r.depthStencilAttachment){const f=a;o.viewCache[f]||(o.viewCache[f]=o.texture.createView({dimension:Dn.TwoD,baseArrayLayer:a,arrayLayerCount:1})),c.depthStencilAttachment={view:o.viewCache[f],depthLoadOp:s.depthLoadOp||Lt.Clear,depthStoreOp:s.depthStoreOp||_r.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(c.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,c.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,c.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else c.depthStencilAttachment={...s};t.layerDescriptors.push(c)}}_updateDepthLayerDescriptors(e,t,r){for(let i=0;i<r.length;i++){const s=t.layerDescriptors[i];if(s.depthStencilAttachment){const o=s.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=Lt.Clear):o.depthLoadOp=Lt.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=Lt.Clear):o.stencilLoadOp=Lt.Load)}}}finishRender(e){const t=this.get(e),r=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),r>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const i=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let o=0;o<t.bundleEncoders.length;o++){const a=t.bundleEncoders[o];s.push(a.finish())}for(let o=0;o<t.layerDescriptors.length;o++)if(o<s.length){const a=t.layerDescriptors[o],c=i.beginRenderPass(a);if(e.viewport){const{x:f,y:p,width:g,height:v,minDepth:x,maxDepth:T}=e.viewportValue;c.setViewport(f,p,g,v,x,T)}if(e.scissor){const{x:f,y:p,width:g,height:v}=e.scissorValue;c.setScissorRect(f,p,g,v)}c.executeBundles([s[o]]),c.end()}}else t.currentPass&&t.currentPass.end();if(r>0){const s=r*8;let o=this.occludedResolveCache.get(s);o===void 0&&(o=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,o));const a=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,r,o,0),t.encoder.copyBufferToBuffer(o,0,a,0,s),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let o=0;o<s.length;o++){const a=s[o];a.generateMipmaps===!0&&this.textureUtils.generateMipmaps(a)}}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:r,currentOcclusionQueryObjects:i}=t;if(r&&i){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await r.mapAsync(GPUMapMode.READ);const o=r.getMappedRange(),a=new BigUint64Array(o);for(let c=0;c<i.length;c++)a[c]===BigInt(0)&&s.add(i[c]);r.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:r,y:i,width:s,height:o,minDepth:a,maxDepth:c}=e.viewportValue;t.setViewport(r,i,s,o,a,c)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,r,i=null){const s=this.device,o=this.renderer;let a=[],c,f,p,g;if(e){const T=this.getClearColor();f={r:T.r,g:T.g,b:T.b,a:T.a}}if(i===null){p=o.depth,g=o.stencil;const T=this._getDefaultRenderPassDescriptor();if(e){a=T.colorAttachments;const S=a[0];S.clearValue=f,S.loadOp=Lt.Clear,S.storeOp=_r.Store}(p||g)&&(c=T.depthStencilAttachment)}else{p=i.depth,g=i.stencil;const T={loadOp:e?Lt.Clear:Lt.Load,clearValue:e?f:void 0};p&&(T.depthLoadOp=t?Lt.Clear:Lt.Load,T.depthClearValue=t?o.getClearDepth():void 0,T.depthStoreOp=_r.Store),g&&(T.stencilLoadOp=r?Lt.Clear:Lt.Load,T.stencilClearValue=r?o.getClearStencil():void 0,T.stencilStoreOp=_r.Store);const S=this._getRenderPassDescriptor(i,T);a=S.colorAttachments,c=S.depthStencilAttachment}p&&c&&(t?(c.depthLoadOp=Lt.Clear,c.depthClearValue=o.getClearDepth(),c.depthStoreOp=_r.Store):(c.depthLoadOp=Lt.Load,c.depthStoreOp=_r.Store)),g&&c&&(r?(c.stencilLoadOp=Lt.Clear,c.stencilClearValue=o.getClearStencil(),c.stencilStoreOp=_r.Store):(c.stencilLoadOp=Lt.Load,c.stencilStoreOp=_r.Store));const v=s.createCommandEncoder({label:"clear"});v.beginRenderPass({colorAttachments:a,depthStencilAttachment:c}).end(),s.queue.submit([v.finish()])}beginCompute(e){const t=this.get(e);t.frameCalls=this.renderer.info.compute.frameCalls;const r={label:"computeGroup_"+e.id};this.initTimestampQuery(cl.COMPUTE,this.getTimestampUID(e),r),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(r)}compute(e,t,r,i,s=null){const o=this.get(t),{passEncoderGPU:a}=this.get(e),c=this.get(i).pipeline;this.pipelineUtils.setPipeline(a,c);for(let p=0,g=r.length;p<g;p++){const v=r[p],x=this.get(v);a.setBindGroup(p,x.group)}let f;if(s===null&&(s=t.count),typeof s=="number"){const p=s;if(o.dispatchSize===void 0||o.count!==p){o.dispatchSize=[0,1,1],o.count=p;const g=t.workgroupSize;let v=g[0];for(let S=1;S<g.length;S++)v*=g[S];const x=Math.ceil(p/v),T=this.device.limits.maxComputeWorkgroupsPerDimension;f=[x,1,1],x>T&&(f[0]=Math.min(x,T),f[1]=Math.ceil(x/T)),o.dispatchSize=f}f=o.dispatchSize}else f=s;a.dispatchWorkgroups(f[0],f[1]||1,f[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:r,material:i,context:s,pipeline:o}=e,a=e.getBindings(),c=this.get(s),f=this.get(o).pipeline,p=e.getIndex(),g=p!==null,v=e.getDrawParameters();if(v===null)return;const x=(S,R)=>{this.pipelineUtils.setPipeline(S,f),R.pipeline=f;const C=R.bindingGroups;for(let D=0,F=a.length;D<F;D++){const I=a[D],q=this.get(I);C[I.index]!==I.id&&(S.setBindGroup(I.index,q.group),C[I.index]=I.id)}if(g===!0&&R.index!==p){const D=this.get(p).buffer,F=p.array instanceof Uint16Array?Hl.Uint16:Hl.Uint32;S.setIndexBuffer(D,F),R.index=p}const B=e.getVertexBuffers();for(let D=0,F=B.length;D<F;D++){const I=B[D];if(R.attributes[D]!==I){const q=this.get(I).buffer;S.setVertexBuffer(D,q),R.attributes[D]=I}}s.stencil===!0&&i.stencilWrite===!0&&c.currentStencilRef!==i.stencilRef&&(S.setStencilReference(i.stencilRef),c.currentStencilRef=i.stencilRef)},T=(S,R)=>{if(x(S,R),r.isBatchedMesh===!0){const C=r._multiDrawStarts,B=r._multiDrawCounts,D=r._multiDrawCount,F=r._multiDrawInstances;F!==null&&ki("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let I=0;I<D;I++){const q=F?F[I]:1,k=q>1?0:I;g===!0?S.drawIndexed(B[I],q,C[I]/p.array.BYTES_PER_ELEMENT,0,k):S.draw(B[I],q,C[I],k),t.update(r,B[I],q)}}else if(g===!0){const{vertexCount:C,instanceCount:B,firstVertex:D}=v,F=e.getIndirect();if(F!==null){const I=this.get(F).buffer;S.drawIndexedIndirect(I,0)}else S.drawIndexed(C,B,D,0,0);t.update(r,C,B)}else{const{vertexCount:C,instanceCount:B,firstVertex:D}=v,F=e.getIndirect();if(F!==null){const I=this.get(F).buffer;S.drawIndirect(I,0)}else S.draw(C,B,D,0);t.update(r,C,B)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const S=this.get(e.camera),R=e.camera.cameras,C=e.getBindingGroup("cameraIndex");if(S.indexesGPU===void 0||S.indexesGPU.length!==R.length){const D=this.get(C),F=[],I=new Uint32Array([0,0,0,0]);for(let q=0,k=R.length;q<k;q++){I[0]=q;const G=this.bindingUtils.createBindGroupIndex(I,D.layout);F.push(G)}S.indexesGPU=F}const B=this.renderer.getPixelRatio();for(let D=0,F=R.length;D<F;D++){const I=R[D];if(r.layers.test(I.layers)){const q=I.viewport;let k=c.currentPass,G=c.currentSets;if(c.bundleEncoders){const j=c.bundleEncoders[D],ee=c.bundleSets[D];k=j,G=ee}q&&k.setViewport(Math.floor(q.x*B),Math.floor(q.y*B),Math.floor(q.width*B),Math.floor(q.height*B),s.viewportValue.minDepth,s.viewportValue.maxDepth),C&&S.indexesGPU&&(k.setBindGroup(C.index,S.indexesGPU[D]),G.bindingGroups[C.index]=C.id),T(k,G)}}}else if(c.currentPass){if(c.occlusionQuerySet!==void 0){const S=c.lastOcclusionObject;S!==r&&(S!==null&&S.occlusionTest===!0&&(c.currentPass.endOcclusionQuery(),c.occlusionQueryIndex++),r.occlusionTest===!0&&(c.currentPass.beginOcclusionQuery(c.occlusionQueryIndex),c.occlusionQueryObjects[c.occlusionQueryIndex]=r),c.lastOcclusionObject=r)}T(c.currentPass,c.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:r,material:i}=e,s=this.utils,o=s.getSampleCountRenderContext(e.context),a=s.getCurrentColorSpace(e.context),c=s.getCurrentColorFormat(e.context),f=s.getCurrentDepthStencilFormat(e.context),p=s.getPrimitiveTopology(r,i);let g=!1;return(t.material!==i||t.materialVersion!==i.version||t.transparent!==i.transparent||t.blending!==i.blending||t.premultipliedAlpha!==i.premultipliedAlpha||t.blendSrc!==i.blendSrc||t.blendDst!==i.blendDst||t.blendEquation!==i.blendEquation||t.blendSrcAlpha!==i.blendSrcAlpha||t.blendDstAlpha!==i.blendDstAlpha||t.blendEquationAlpha!==i.blendEquationAlpha||t.colorWrite!==i.colorWrite||t.depthWrite!==i.depthWrite||t.depthTest!==i.depthTest||t.depthFunc!==i.depthFunc||t.stencilWrite!==i.stencilWrite||t.stencilFunc!==i.stencilFunc||t.stencilFail!==i.stencilFail||t.stencilZFail!==i.stencilZFail||t.stencilZPass!==i.stencilZPass||t.stencilFuncMask!==i.stencilFuncMask||t.stencilWriteMask!==i.stencilWriteMask||t.side!==i.side||t.alphaToCoverage!==i.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==a||t.colorFormat!==c||t.depthStencilFormat!==f||t.primitiveTopology!==p||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=i,t.materialVersion=i.version,t.transparent=i.transparent,t.blending=i.blending,t.premultipliedAlpha=i.premultipliedAlpha,t.blendSrc=i.blendSrc,t.blendDst=i.blendDst,t.blendEquation=i.blendEquation,t.blendSrcAlpha=i.blendSrcAlpha,t.blendDstAlpha=i.blendDstAlpha,t.blendEquationAlpha=i.blendEquationAlpha,t.colorWrite=i.colorWrite,t.depthWrite=i.depthWrite,t.depthTest=i.depthTest,t.depthFunc=i.depthFunc,t.stencilWrite=i.stencilWrite,t.stencilFunc=i.stencilFunc,t.stencilFail=i.stencilFail,t.stencilZFail=i.stencilZFail,t.stencilZPass=i.stencilZPass,t.stencilFuncMask=i.stencilFuncMask,t.stencilWriteMask=i.stencilWriteMask,t.side=i.side,t.alphaToCoverage=i.alphaToCoverage,t.sampleCount=o,t.colorSpace=a,t.colorFormat=c,t.depthStencilFormat=f,t.primitiveTopology=p,t.clippingContextCacheKey=e.clippingContextCacheKey,g=!0),g}getRenderCacheKey(e){const{object:t,material:r}=e,i=this.utils,s=e.context,o=t.isMesh&&t.matrixWorld.determinant()<0;return[r.transparent,r.blending,r.premultipliedAlpha,r.blendSrc,r.blendDst,r.blendEquation,r.blendSrcAlpha,r.blendDstAlpha,r.blendEquationAlpha,r.colorWrite,r.depthWrite,r.depthTest,r.depthFunc,r.stencilWrite,r.stencilFunc,r.stencilFail,r.stencilZFail,r.stencilZPass,r.stencilFuncMask,r.stencilWriteMask,r.side,o,i.getSampleCountRenderContext(s),i.getCurrentColorSpace(s),i.getCurrentColorFormat(s),i.getCurrentDepthStencilFormat(s),i.getPrimitiveTopology(t,r),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,i,s,o){return this.textureUtils.copyTextureToBuffer(e,t,r,i,s,o)}initTimestampQuery(e,t,r){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new R$(this.device,e,2048));const i=this.timestampQueryPool[e],s=i.allocateQueriesForContext(t);r.timestampWrites={querySet:i.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new v$(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const r=this.get(e),s=r.currentPass.finish();this.get(t).bundleGPU=s,r.currentSets=r._currentSets,r.currentPass=r._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,r,i){this.bindingUtils.createBindings(e,t,r,i)}updateBindings(e,t,r,i){this.bindingUtils.createBindings(e,t,r,i)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,r=null,i=null,s=0,o=0){let a=0,c=0,f=0,p=0,g=0,v=0,x=e.image.width,T=e.image.height,S=1;r!==null&&(r.isBox3===!0?(p=r.min.x,g=r.min.y,v=r.min.z,x=r.max.x-r.min.x,T=r.max.y-r.min.y,S=r.max.z-r.min.z):(p=r.min.x,g=r.min.y,x=r.max.x-r.min.x,T=r.max.y-r.min.y,S=1)),i!==null&&(a=i.x,c=i.y,f=i.z||0);const R=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),C=this.get(e).texture,B=this.get(t).texture;R.copyTextureToTexture({texture:C,mipLevel:s,origin:{x:p,y:g,z:v}},{texture:B,mipLevel:o,origin:{x:a,y:c,z:f}},[x,T,S]),this.device.queue.submit([R.finish()]),o===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,r){const i=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format!==o.format)return;let a;if(i.currentPass?(i.currentPass.end(),a=i.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:s,origin:[r.x,r.y,0]},{texture:o},[r.z,r.w]),i.currentPass){const{descriptor:c}=i;for(let f=0;f<c.colorAttachments.length;f++)c.colorAttachments[f].loadOp=Lt.Load;if(t.depth&&(c.depthStencilAttachment.depthLoadOp=Lt.Load),t.stencil&&(c.depthStencilAttachment.stencilLoadOp=Lt.Load),i.currentPass=a.beginRenderPass(c),i.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:f,y:p,width:g,height:v}=t.scissorValue;i.currentPass.setScissorRect(f,p,g,v)}}else this.device.queue.submit([a.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class C$ extends pg{constructor(e,t,r,i,s,o){super(e,t,r,i,s,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class M$ extends pg{constructor(e,t,r,i,s,o){super(e,t,r,i,s,o),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class P$ extends u5{constructor(){super(),this.addMaterial(BI,"MeshPhongMaterial"),this.addMaterial(a6,"MeshStandardMaterial"),this.addMaterial(yk,"MeshPhysicalMaterial"),this.addMaterial(xk,"MeshToonMaterial"),this.addMaterial(SI,"MeshBasicMaterial"),this.addMaterial(MI,"MeshLambertMaterial"),this.addMaterial(vI,"MeshNormalMaterial"),this.addMaterial(wk,"MeshMatcapMaterial"),this.addMaterial(fI,"LineBasicMaterial"),this.addMaterial(pI,"LineDashedMaterial"),this.addMaterial(Ck,"PointsMaterial"),this.addMaterial(u6,"SpriteMaterial"),this.addMaterial(Dk,"ShadowMaterial"),this.addLight(eV,HE),this.addLight(uj,vb),this.addLight(Aj,WE),this.addLight(v2,pg),this.addLight(dj,bb),this.addLight(pj,QE),this.addLight(mj,XE),this.addLight(cj,C$),this.addLight(fj,M$),this.addToneMapping(R6,YE),this.addToneMapping(N6,KE),this.addToneMapping(C6,ZE),this.addToneMapping(M6,JE),this.addToneMapping(P6,eR),this.addToneMapping(B6,tR)}}class b5 extends Oj{constructor(e={}){let t;e.forceWebGL?t=C3:(t=N$,e.getFallback=()=>new C3(e));const r=new t(e);super(r,e),this.library=new P$,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}N.BRDF_GGX;N.BRDF_Lambert;N.BasicPointShadowFilter;N.BasicShadowFilter;N.Break;N.Const;N.Continue;N.DFGApprox;N.D_GGX;N.Discard;N.EPSILON;N.F_Schlick;const B$=N.Fn;N.INFINITY;const D$=N.If,L$=N.Loop;N.NodeAccess;N.NodeShaderStage;N.NodeType;N.NodeUpdateType;N.PCFShadowFilter;N.PCFSoftShadowFilter;N.PI;N.PI2;N.PointShadowFilter;N.Return;N.Schlick_to_F0;N.ScriptableNodeResources;N.ShaderNode;N.Stack;N.Switch;N.TBNViewMatrix;N.VSMShadowFilter;N.V_GGX_SmithCorrelated;N.Var;N.VarIntent;N.abs;N.acesFilmicToneMapping;N.acos;N.add;N.addMethodChaining;N.addNodeElement;N.agxToneMapping;N.all;N.alphaT;N.and;N.anisotropy;N.anisotropyB;N.anisotropyT;N.any;N.append;N.array;N.arrayBuffer;const O$=N.asin;N.assign;N.atan;N.atan2;N.atomicAdd;N.atomicAnd;N.atomicFunc;N.atomicLoad;N.atomicMax;N.atomicMin;N.atomicOr;N.atomicStore;N.atomicSub;N.atomicXor;N.attenuationColor;N.attenuationDistance;N.attribute;N.attributeArray;N.backgroundBlurriness;N.backgroundIntensity;N.backgroundRotation;N.batch;N.bentNormalView;N.billboarding;N.bitAnd;N.bitNot;N.bitOr;N.bitXor;N.bitangentGeometry;N.bitangentLocal;N.bitangentView;N.bitangentWorld;N.bitcast;N.blendBurn;N.blendColor;N.blendDodge;N.blendOverlay;N.blendScreen;N.blur;N.bool;N.buffer;N.bufferAttribute;N.bumpMap;N.burn;N.builtin;N.bvec2;N.bvec3;N.bvec4;N.bypass;N.cache;N.call;N.cameraFar;N.cameraIndex;N.cameraNear;N.cameraNormalMatrix;N.cameraPosition;N.cameraProjectionMatrix;N.cameraProjectionMatrixInverse;N.cameraViewMatrix;N.cameraViewport;N.cameraWorldMatrix;N.cbrt;N.cdl;N.ceil;N.checker;N.cineonToneMapping;N.clamp;N.clearcoat;N.clearcoatNormalView;N.clearcoatRoughness;N.code;N.color;N.colorSpaceToWorking;N.colorToDirection;N.compute;N.computeKernel;N.computeSkinning;N.context;N.convert;N.convertColorSpace;N.convertToTexture;const F$=N.cos;N.cross;N.cubeTexture;N.cubeTextureBase;N.cubeToUV;N.dFdx;N.dFdy;N.dashSize;N.debug;N.decrement;N.decrementBefore;N.defaultBuildStages;N.defaultShaderStages;N.defined;N.degrees;N.deltaTime;N.densityFog;N.densityFogFactor;N.depth;N.depthPass;N.determinant;N.difference;N.diffuseColor;N.directPointLight;N.directionToColor;N.directionToFaceDirection;N.dispersion;N.distance;N.div;N.dodge;N.dot;N.drawIndex;N.dynamicBufferAttribute;N.element;N.emissive;N.equal;N.equals;N.equirectUV;const I$=N.exp;N.exp2;N.expression;N.faceDirection;N.faceForward;N.faceforward;const k$=N.float;N.floatBitsToInt;N.floatBitsToUint;N.floor;N.fog;N.fract;N.frameGroup;N.frameId;N.frontFacing;N.fwidth;N.gain;N.gapSize;N.getConstNodeType;N.getCurrentStack;N.getDirection;N.getDistanceAttenuation;N.getGeometryRoughness;N.getNormalFromDepth;N.getParallaxCorrectNormal;N.getRoughness;N.getScreenPosition;N.getShIrradianceAt;N.getShadowMaterial;N.getShadowRenderObjectFunction;N.getTextureIndex;N.getViewPosition;N.globalId;N.glsl;N.glslFn;N.grayscale;N.greaterThan;N.greaterThanEqual;N.hash;N.highpModelNormalViewMatrix;N.highpModelViewMatrix;N.hue;N.increment;N.incrementBefore;N.instance;const q$=N.instanceIndex;N.instancedArray;N.instancedBufferAttribute;N.instancedDynamicBufferAttribute;N.instancedMesh;N.int;N.intBitsToFloat;N.inverse;N.inverseSqrt;N.inversesqrt;N.invocationLocalIndex;N.invocationSubgroupIndex;N.ior;N.iridescence;N.iridescenceIOR;N.iridescenceThickness;N.ivec2;N.ivec3;N.ivec4;N.js;N.label;N.length;N.lengthSq;N.lessThan;N.lessThanEqual;N.lightPosition;N.lightProjectionUV;N.lightShadowMatrix;N.lightTargetDirection;N.lightTargetPosition;N.lightViewPosition;N.lightingContext;N.lights;N.linearDepth;N.linearToneMapping;N.localId;N.log;N.log2;N.logarithmicDepthToViewZ;N.luminance;N.mat2;N.mat3;N.mat4;N.matcapUV;N.materialAO;N.materialAlphaTest;N.materialAnisotropy;N.materialAnisotropyVector;N.materialAttenuationColor;N.materialAttenuationDistance;N.materialClearcoat;N.materialClearcoatNormal;N.materialClearcoatRoughness;N.materialColor;N.materialDispersion;N.materialEmissive;N.materialEnvIntensity;N.materialEnvRotation;N.materialIOR;N.materialIridescence;N.materialIridescenceIOR;N.materialIridescenceThickness;N.materialLightMap;N.materialLineDashOffset;N.materialLineDashSize;N.materialLineGapSize;N.materialLineScale;N.materialLineWidth;N.materialMetalness;N.materialNormal;N.materialOpacity;N.materialPointSize;N.materialReference;N.materialReflectivity;N.materialRefractionRatio;N.materialRotation;N.materialRoughness;N.materialSheen;N.materialSheenRoughness;N.materialShininess;N.materialSpecular;N.materialSpecularColor;N.materialSpecularIntensity;N.materialSpecularStrength;N.materialThickness;N.materialTransmission;N.max;N.maxMipLevel;N.mediumpModelViewMatrix;N.metalness;N.min;N.mix;N.mixElement;N.mod;N.modInt;N.modelDirection;N.modelNormalMatrix;N.modelPosition;N.modelRadius;N.modelScale;N.modelViewMatrix;N.modelViewPosition;N.modelViewProjection;N.modelWorldMatrix;N.modelWorldMatrixInverse;N.morphReference;N.mrt;N.mul;N.mx_aastep;N.mx_add;N.mx_atan2;N.mx_cell_noise_float;N.mx_contrast;N.mx_divide;N.mx_fractal_noise_float;N.mx_fractal_noise_vec2;N.mx_fractal_noise_vec3;N.mx_fractal_noise_vec4;N.mx_frame;N.mx_heighttonormal;N.mx_hsvtorgb;N.mx_ifequal;N.mx_ifgreater;N.mx_ifgreatereq;N.mx_invert;N.mx_modulo;N.mx_multiply;N.mx_noise_float;N.mx_noise_vec3;N.mx_noise_vec4;N.mx_place2d;N.mx_power;N.mx_ramp4;N.mx_ramplr;N.mx_ramptb;N.mx_rgbtohsv;N.mx_rotate2d;N.mx_rotate3d;N.mx_safepower;N.mx_separate;N.mx_splitlr;N.mx_splittb;N.mx_srgb_texture_to_lin_rec709;N.mx_subtract;N.mx_timer;N.mx_transform_uv;N.mx_unifiednoise2d;N.mx_unifiednoise3d;N.mx_worley_noise_float;N.mx_worley_noise_vec2;N.mx_worley_noise_vec3;const U$=N.negate;N.neutralToneMapping;N.nodeArray;N.nodeImmutable;N.nodeObject;N.nodeObjectIntent;N.nodeObjects;N.nodeProxy;N.nodeProxyIntent;N.normalFlat;N.normalGeometry;N.normalLocal;N.normalMap;N.normalView;N.normalViewGeometry;N.normalWorld;N.normalWorldGeometry;N.normalize;N.not;N.notEqual;N.numWorkgroups;N.objectDirection;N.objectGroup;N.objectPosition;N.objectRadius;N.objectScale;N.objectViewPosition;N.objectWorldMatrix;N.OnObjectUpdate;N.OnMaterialUpdate;N.oneMinus;N.or;N.orthographicDepthToViewZ;N.oscSawtooth;N.oscSine;N.oscSquare;N.oscTriangle;N.output;N.outputStruct;N.overlay;N.overloadingFn;N.parabola;N.parallaxDirection;N.parallaxUV;N.parameter;N.pass;N.passTexture;N.pcurve;N.perspectiveDepthToViewZ;N.pmremTexture;N.pointShadow;N.pointUV;N.pointWidth;N.positionGeometry;N.positionLocal;N.positionPrevious;N.positionView;N.positionViewDirection;N.positionWorld;N.positionWorldDirection;N.posterize;N.pow;N.pow2;N.pow3;N.pow4;N.premultiplyAlpha;N.property;N.radians;N.rand;N.range;N.rangeFog;N.rangeFogFactor;N.reciprocal;N.reference;N.referenceBuffer;N.reflect;N.reflectVector;N.reflectView;N.reflector;N.refract;N.refractVector;N.refractView;N.reinhardToneMapping;N.remap;N.remapClamp;N.renderGroup;N.renderOutput;N.rendererReference;N.rotate;N.rotateUV;N.roughness;N.round;N.rtt;N.sRGBTransferEOTF;N.sRGBTransferOETF;N.sample;N.sampler;N.samplerComparison;N.saturate;N.saturation;N.screen;N.screenCoordinate;N.screenDPR;N.screenSize;N.screenUV;N.scriptable;N.scriptableValue;N.select;N.setCurrentStack;N.setName;N.shaderStages;N.shadow;N.shadowPositionWorld;N.shapeCircle;N.sharedUniformGroup;N.sheen;N.sheenRoughness;N.shiftLeft;N.shiftRight;N.shininess;N.sign;const G$=N.sin;N.sinc;N.skinning;N.smoothstep;N.smoothstepElement;N.specularColor;N.specularF90;N.spherizeUV;N.split;N.spritesheetUV;const V$=N.sqrt;N.stack;N.step;N.stepElement;const z$=N.storage;N.storageBarrier;N.storageObject;N.storageTexture;N.string;N.struct;N.sub;N.subgroupAdd;N.subgroupAll;N.subgroupAnd;N.subgroupAny;N.subgroupBallot;N.subgroupBroadcast;N.subgroupBroadcastFirst;N.subBuild;N.subgroupElect;N.subgroupExclusiveAdd;N.subgroupExclusiveMul;N.subgroupInclusiveAdd;N.subgroupInclusiveMul;N.subgroupIndex;N.subgroupMax;N.subgroupMin;N.subgroupMul;N.subgroupOr;N.subgroupShuffle;N.subgroupShuffleDown;N.subgroupShuffleUp;N.subgroupShuffleXor;N.subgroupSize;N.subgroupXor;N.tan;N.tangentGeometry;N.tangentLocal;N.tangentView;N.tangentWorld;N.texture;N.texture3D;N.textureBarrier;N.textureBicubic;N.textureBicubicLevel;N.textureCubeUV;N.textureLoad;N.textureSize;N.textureStore;N.thickness;N.time;N.toneMapping;N.toneMappingExposure;N.toonOutlinePass;N.transformDirection;N.transformNormal;N.transformNormalToView;N.transformedClearcoatNormalView;N.transformedNormalView;N.transformedNormalWorld;N.transmission;N.transpose;N.triNoise3D;N.triplanarTexture;N.triplanarTextures;N.trunc;N.uint;N.uintBitsToFloat;const j$=N.uniform;N.uniformArray;N.uniformCubeTexture;N.uniformGroup;N.uniformFlow;N.uniformTexture;N.unpremultiplyAlpha;N.userData;N.uv;N.uvec2;N.uvec3;N.uvec4;N.varying;N.varyingProperty;N.vec2;N.vec3;N.vec4;N.vectorComponents;N.velocity;N.vertexColor;N.vertexIndex;N.vertexStage;N.vibrance;N.viewZToLogarithmicDepth;N.viewZToOrthographicDepth;N.viewZToPerspectiveDepth;N.viewport;N.viewportCoordinate;N.viewportDepthTexture;N.viewportLinearDepth;N.viewportMipTexture;N.viewportResolution;N.viewportSafeUV;N.viewportSharedTexture;N.viewportSize;N.viewportTexture;N.viewportUV;N.wgsl;N.wgslFn;N.workgroupArray;N.workgroupBarrier;N.workgroupId;N.workingToColorSpace;N.xor;const q3=new Gh,$c=new we;class x5 extends nN{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],r=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(r),this.setAttribute("position",new fs(e,3)),this.setAttribute("uv",new fs(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),r.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const r=new F0(t,6,1);return this.setAttribute("instanceStart",new vo(r,3,0)),this.setAttribute("instanceEnd",new vo(r,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const r=new F0(t,6,1);return this.setAttribute("instanceColorStart",new vo(r,3,0)),this.setAttribute("instanceColorEnd",new vo(r,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new rN(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gh);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),q3.setFromBufferAttribute(t),this.boundingBox.union(q3))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Bg),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const r=this.boundingSphere.center;this.boundingBox.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)$c.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared($c)),$c.fromBufferAttribute(t,s),i=Math.max(i,r.distanceToSquared($c));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)}}toJSON(){}}h0.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ht(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};c0.line={uniforms:Dg.merge([h0.common,h0.fog,h0.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			float alpha = opacity;
			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class x2 extends Ll{constructor(e){super({type:"LineMaterial",uniforms:Dg.clone(c0.line.uniforms),vertexShader:c0.line.vertexShader,fragmentShader:c0.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const rp=new Ft,U3=new we,G3=new we,Jn=new Ft,er=new Ft,Yi=new Ft,ip=new we,sp=new gn,tr=new iN,V3=new we,Hc=new Gh,Wc=new Bg,Ki=new Ft;let rs,Ta;function z3(n,e,t){return Ki.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),Ki.multiplyScalar(1/Ki.w),Ki.x=Ta/t.width,Ki.y=Ta/t.height,Ki.applyMatrix4(n.projectionMatrixInverse),Ki.multiplyScalar(1/Ki.w),Math.abs(Math.max(Ki.x,Ki.y))}function $$(n,e){const t=n.matrixWorld,r=n.geometry,i=r.attributes.instanceStart,s=r.attributes.instanceEnd,o=Math.min(r.instanceCount,i.count);for(let a=0,c=o;a<c;a++){tr.start.fromBufferAttribute(i,a),tr.end.fromBufferAttribute(s,a),tr.applyMatrix4(t);const f=new we,p=new we;rs.distanceSqToSegment(tr.start,tr.end,p,f),p.distanceTo(f)<Ta*.5&&e.push({point:p,pointOnLine:f,distance:rs.origin.distanceTo(p),object:n,face:null,faceIndex:a,uv:null,uv1:null})}}function H$(n,e,t){const r=e.projectionMatrix,s=n.material.resolution,o=n.matrixWorld,a=n.geometry,c=a.attributes.instanceStart,f=a.attributes.instanceEnd,p=Math.min(a.instanceCount,c.count),g=-e.near;rs.at(1,Yi),Yi.w=1,Yi.applyMatrix4(e.matrixWorldInverse),Yi.applyMatrix4(r),Yi.multiplyScalar(1/Yi.w),Yi.x*=s.x/2,Yi.y*=s.y/2,Yi.z=0,ip.copy(Yi),sp.multiplyMatrices(e.matrixWorldInverse,o);for(let v=0,x=p;v<x;v++){if(Jn.fromBufferAttribute(c,v),er.fromBufferAttribute(f,v),Jn.w=1,er.w=1,Jn.applyMatrix4(sp),er.applyMatrix4(sp),Jn.z>g&&er.z>g)continue;if(Jn.z>g){const D=Jn.z-er.z,F=(Jn.z-g)/D;Jn.lerp(er,F)}else if(er.z>g){const D=er.z-Jn.z,F=(er.z-g)/D;er.lerp(Jn,F)}Jn.applyMatrix4(r),er.applyMatrix4(r),Jn.multiplyScalar(1/Jn.w),er.multiplyScalar(1/er.w),Jn.x*=s.x/2,Jn.y*=s.y/2,er.x*=s.x/2,er.y*=s.y/2,tr.start.copy(Jn),tr.start.z=0,tr.end.copy(er),tr.end.z=0;const S=tr.closestPointToPointParameter(ip,!0);tr.at(S,V3);const R=Dl.lerp(Jn.z,er.z,S),C=R>=-1&&R<=1,B=ip.distanceTo(V3)<Ta*.5;if(C&&B){tr.start.fromBufferAttribute(c,v),tr.end.fromBufferAttribute(f,v),tr.start.applyMatrix4(o),tr.end.applyMatrix4(o);const D=new we,F=new we;rs.distanceSqToSegment(tr.start,tr.end,F,D),t.push({point:F,pointOnLine:D,distance:rs.origin.distanceTo(F),object:n,face:null,faceIndex:v,uv:null,uv1:null})}}}class W$ extends hn{constructor(e=new x5,t=new x2({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,r=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let o=0,a=0,c=t.count;o<c;o++,a+=2)U3.fromBufferAttribute(t,o),G3.fromBufferAttribute(r,o),i[a]=a===0?0:i[a-1],i[a+1]=i[a]+U3.distanceTo(G3);const s=new F0(i,2,1);return e.setAttribute("instanceDistanceStart",new vo(s,1,0)),e.setAttribute("instanceDistanceEnd",new vo(s,1,1)),this}raycast(e,t){const r=this.material.worldUnits,i=e.camera,s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;rs=e.ray;const o=this.matrixWorld,a=this.geometry,c=this.material;Ta=c.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),Wc.copy(a.boundingSphere).applyMatrix4(o);let f;if(r)f=Ta*.5;else{const g=Math.max(i.near,Wc.distanceToPoint(rs.origin));f=z3(i,g,c.resolution)}if(Wc.radius+=f,rs.intersectsSphere(Wc)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Hc.copy(a.boundingBox).applyMatrix4(o);let p;if(r)p=Ta*.5;else{const g=Math.max(i.near,Hc.distanceToPoint(rs.origin));p=z3(i,g,c.resolution)}Hc.expandByScalar(p),rs.intersectsBox(Hc)!==!1&&(r?$$(this,t):H$(this,i,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(rp),this.material.uniforms.resolution.value.set(rp.z,rp.w))}}class T5 extends x5{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,r=new Float32Array(2*t);for(let i=0;i<t;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return super.setPositions(r),this}setColors(e){const t=e.length-3,r=new Float32Array(2*t);for(let i=0;i<t;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return super.setColors(r),this}setFromPoints(e){const t=e.length-1,r=new Float32Array(6*t);for(let i=0;i<t;i++)r[6*i]=e[i].x,r[6*i+1]=e[i].y,r[6*i+2]=e[i].z||0,r[6*i+3]=e[i+1].x,r[6*i+4]=e[i+1].y,r[6*i+5]=e[i+1].z||0;return super.setPositions(r),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Q$ extends W${constructor(e=new T5,t=new x2({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class j3 extends sN{constructor(e,t={}){const r=t.font;if(r===void 0)super();else{const i=r.generateShapes(e,t.size);t.depth===void 0&&(t.depth=50),t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(i,t)}this.type="TextGeometry"}}class X${constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const r=[],i=Y$(e,t,this.data);for(let s=0,o=i.length;s<o;s++)r.push(...i[s].toShapes());return r}}function Y$(n,e,t){const r=Array.from(n),i=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*i,o=[];let a=0,c=0;for(let f=0;f<r.length;f++){const p=r[f];if(p===`
`)a=0,c-=s;else{const g=K$(p,i,a,c,t);a+=g.offsetX,o.push(g.path)}}return o}function K$(n,e,t,r,i){const s=i.glyphs[n]||i.glyphs["?"];if(!s)return;const o=new oN;let a,c,f,p,g,v,x,T;if(s.o){const S=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let R=0,C=S.length;R<C;)switch(S[R++]){case"m":a=S[R++]*e+t,c=S[R++]*e+r,o.moveTo(a,c);break;case"l":a=S[R++]*e+t,c=S[R++]*e+r,o.lineTo(a,c);break;case"q":f=S[R++]*e+t,p=S[R++]*e+r,g=S[R++]*e+t,v=S[R++]*e+r,o.quadraticCurveTo(g,v,f,p);break;case"b":f=S[R++]*e+t,p=S[R++]*e+r,g=S[R++]*e+t,v=S[R++]*e+r,x=S[R++]*e+t,T=S[R++]*e+r,o.bezierCurveTo(g,v,x,T,f,p);break}}return{offsetX:s.ha*e,path:o}}function Zm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function Z$(n){if(Array.isArray(n))return n}function J$(n){if(Array.isArray(n))return Zm(n)}function w5(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function eH(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function $3(n,e,t,r,i,s,o){try{var a=n[s](o),c=a.value}catch(f){return void t(f)}a.done?e(c):Promise.resolve(c).then(r,i)}function tH(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function o(c){$3(s,r,i,o,a,"next",c)}function a(c){$3(s,r,i,o,a,"throw",c)}o(void 0)})}}function wf(n,e,t){return e=Wl(e),AH(n,w2()?Reflect.construct(e,t||[],Wl(n).constructor):e.apply(n,t))}function nH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sf(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Du(n,e){return n.get(w5(n,e))}function op(n,e,t){nH(n,e),e.set(n,t)}function ap(n,e,t){return n.set(w5(n,e),t),t}function T2(n,e,t){if(w2())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(n.bind.apply(n,r));return i}function rH(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,S5(r.key),r)}}function Ef(n,e,t){return e&&rH(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Yn(n,e,t){return(e=S5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Jm(){return Jm=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=cH(n,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?n:t):i.value}},Jm.apply(null,arguments)}function Wl(n){return Wl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wl(n)}function Rf(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&tg(n,e)}function w2(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(w2=function(){return!!n})()}function iH(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function sH(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function oH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H3(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function qt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?H3(Object(t),!0).forEach(function(r){Yn(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):H3(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function lH(n,e){if(n==null)return{};var t,r,i=uH(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function uH(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function AH(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eH(n)}function eg(){var n,e,t=typeof Symbol=="function"?Symbol:{},r=t.iterator||"@@iterator",i=t.toStringTag||"@@toStringTag";function s(x,T,S,R){var C=T&&T.prototype instanceof a?T:a,B=Object.create(C.prototype);return zr(B,"_invoke",(function(D,F,I){var q,k,G,j=0,ee=I||[],Q=!1,Y={p:0,n:0,v:n,a:Z,f:Z.bind(n,4),d:function(oe,K){return q=oe,k=0,G=n,Y.n=K,o}};function Z(oe,K){for(k=oe,G=K,e=0;!Q&&j&&!ae&&e<ee.length;e++){var ae,he=ee[e],be=Y.p,ye=he[2];oe>3?(ae=ye===K)&&(G=he[(k=he[4])?5:(k=3,3)],he[4]=he[5]=n):he[0]<=be&&((ae=oe<2&&be<he[1])?(k=0,Y.v=K,Y.n=he[1]):be<ye&&(ae=oe<3||he[0]>K||K>ye)&&(he[4]=oe,he[5]=K,Y.n=ye,k=0))}if(ae||oe>1)return o;throw Q=!0,K}return function(oe,K,ae){if(j>1)throw TypeError("Generator is already running");for(Q&&K===1&&Z(K,ae),k=K,G=ae;(e=k<2?n:G)||!Q;){q||(k?k<3?(k>1&&(Y.n=-1),Z(k,G)):Y.n=G:Y.v=G);try{if(j=2,q){if(k||(oe="next"),e=q[oe]){if(!(e=e.call(q,G)))throw TypeError("iterator result is not an object");if(!e.done)return e;G=e.value,k<2&&(k=0)}else k===1&&(e=q.return)&&e.call(q),k<2&&(G=TypeError("The iterator does not provide a '"+oe+"' method"),k=1);q=n}else if((e=(Q=Y.n<0)?G:D.call(F,Y))!==o)break}catch(he){q=n,k=1,G=he}finally{j=1}}return{value:e,done:Q}}})(x,S,R),!0),B}var o={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(zr(e={},r,function(){return this}),e),g=f.prototype=a.prototype=Object.create(p);function v(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,f):(x.__proto__=f,zr(x,i,"GeneratorFunction")),x.prototype=Object.create(g),x}return c.prototype=f,zr(g,"constructor",f),zr(f,"constructor",c),c.displayName="GeneratorFunction",zr(f,i,"GeneratorFunction"),zr(g),zr(g,i,"Generator"),zr(g,r,function(){return this}),zr(g,"toString",function(){return"[object Generator]"}),(eg=function(){return{w:s,m:v}})()}function zr(n,e,t,r){var i=Object.defineProperty;try{i({},"",{})}catch{i=0}zr=function(s,o,a,c){function f(p,g){zr(s,p,function(v){return this._invoke(p,g,v)})}o?i?i(s,o,{value:a,enumerable:!c,configurable:!c,writable:!c}):s[o]=a:(f("next",0),f("throw",1),f("return",2))},zr(n,e,t,r)}function tg(n,e){return tg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},tg(n,e)}function an(n,e){return Z$(n)||sH(n,e)||E5(n,e)||oH()}function cH(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=Wl(n))!==null;);return n}function lp(n,e,t,r){var i=Jm(Wl(n.prototype),e,t);return typeof i=="function"?function(s){return i.apply(t,s)}:i}function Ht(n){return J$(n)||iH(n)||E5(n)||aH()}function hH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function S5(n){var e=hH(n,"string");return typeof e=="symbol"?e:e+""}function E5(n,e){if(n){if(typeof n=="string")return Zm(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Zm(n,e):void 0}}var R5=function(e){e instanceof Array?e.forEach(R5):(e.map&&e.map.dispose(),e.dispose())},S2=function(e){e.geometry&&e.geometry.dispose(),e.material&&R5(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(S2)},Kt=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),S2(t)}};function Sr(n,e){var t=new e;return{linkProp:function(i){return{default:t[i](),onChange:function(o,a){a[n][i](o)},triggerUpdate:!1}},linkMethod:function(i){return function(s){for(var o=s[n],a=arguments.length,c=new Array(a>1?a-1:0),f=1;f<a;f++)c[f-1]=arguments[f];var p=o[i].apply(o,c);return p===o?this:p}}}}var nn=100;function W3(){return nn}function bi(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=(90-n)*Math.PI/180,i=(90-e)*Math.PI/180,s=nn*(1+t),o=Math.sin(r);return{x:s*o*Math.cos(i),y:s*Math.cos(r),z:s*o*Math.sin(i)}}function N5(n){var e=n.x,t=n.y,r=n.z,i=Math.sqrt(e*e+t*t+r*r),s=Math.acos(t/i),o=Math.atan2(r,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:i/nn-1}}function la(n){return n*Math.PI/180}var CA=window.THREE?window.THREE:{BackSide:hr,BufferAttribute:Ii,Color:Gn,Mesh:hn,ShaderMaterial:Ll},fH=`
uniform float hollowRadius;

varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {    
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  
  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);
  vCameraDistanceToObjCenter = length(objCenterViewPosition);
  
  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);
  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));
  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;

  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,dH=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
uniform float hollowRadius;

varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {
  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius
  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius

  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`;function pH(n,e,t,r){return new CA.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:fH,fragmentShader:dH,uniforms:{coefficient:{value:n},color:{value:new CA.Color(e)},power:{value:t},hollowRadius:{value:r}}})}function mH(n,e){for(var t=n.clone(),r=new Float32Array(n.attributes.position.count*3),i=0,s=r.length;i<s;i++){var o=n.attributes.normal.array[i],a=n.attributes.position.array[i];r[i]=a+o*e}return t.setAttribute("position",new CA.BufferAttribute(r,3)),t}var gH=(function(n){function e(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.color,o=s===void 0?"gold":s,a=i.size,c=a===void 0?2:a,f=i.coefficient,p=f===void 0?.5:f,g=i.power,v=g===void 0?1:g,x=i.hollowRadius,T=x===void 0?0:x,S=i.backside,R=S===void 0?!0:S;Sf(this,e),r=wf(this,e);var C=mH(t,c),B=pH(p,o,v,T);return R&&(B.side=CA.BackSide),r.geometry=C,r.material=B,r}return Rf(e,n),Ef(e)})(CA.Mesh),Zi=window.THREE?window.THREE:{Color:Gn,Group:vs,LineBasicMaterial:Uh,LineSegments:ox,Mesh:hn,MeshPhongMaterial:Jb,SphereGeometry:Bo,SRGBColorSpace:BA,TextureLoader:dg},C5=Vn({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeCurvatureResolution:{default:4},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return t!==void 0?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){Kt(e.globeObj),Kt(e.tileEngine),Kt(e.graticulesObj)}},stateInit:function(){var e=new Zi.MeshPhongMaterial({color:0}),t=new Zi.Mesh(void 0,e);t.rotation.y=-Math.PI/2;var r=new eP(nn),i=new Zi.Group;i.__globeObjType="globe",i.add(t),i.add(r);var s=new Zi.LineSegments(new l4(yM(),nn,2),new Zi.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeGroup:i,globeObj:t,graticulesObj:s,defaultGlobeMaterial:e,tileEngine:r}},init:function(e,t){Kt(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var r=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeCurvatureResolution")){var i;(i=e.globeObj.geometry)===null||i===void 0||i.dispose();var s=Math.max(4,Math.round(360/e.globeCurvatureResolution));e.globeObj.geometry=new Zi.SphereGeometry(nn,s,s/2),e.tileEngine.curvatureResolution=e.globeCurvatureResolution}if(t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new Zi.TextureLoader().load(e.globeImageUrl,function(a){a.colorSpace=Zi.SRGBColorSpace,r.map=a,r.color=null,r.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!r.color&&(r.color=new Zi.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new Zi.TextureLoader().load(e.bumpImageUrl,function(a){r.bumpMap=a,r.needsUpdate=!0}):(r.bumpMap=null,r.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),Kt(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var o=e.atmosphereObj=new gH(e.globeObj.geometry,{color:e.atmosphereColor,size:nn*e.atmosphereAltitude,hollowRadius:nn,coefficient:.1,power:3.5});o.visible=!!e.showAtmosphere,o.__globeObjType="atmosphere",e.scene.add(o)}!e.ready&&(!e.globeImageUrl||e.globeTileEngineUrl)&&(e.ready=!0,e.onReady())}}),ys=function(e){return isNaN(e)?parseInt(He(e).toHex(),16):e},Ui=function(e){return e&&isNaN(e)?wa(e).opacity:1},Po=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i,s=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var a=o.slice(1),c=an(a,4),f=c[0],p=c[1],g=c[2],v=c[3];i=new Gn("rgb(".concat(+f,",").concat(+p,",").concat(+g,")")),s=Math.min(+v,1)}else i=new Gn(e);r&&i.convertLinearToSRGB();var x=i.toArray();return t?[].concat(Ht(x),[s]):x};function yH(n,e,t){return n.opacity=e,n.transparent=e<1,n.depthWrite=e>=1,n}var Q3=window.THREE?window.THREE:{BufferAttribute:Ii};function _s(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float32Array;if(e===1)return new Q3.BufferAttribute(new t(n),e);for(var r=new Q3.BufferAttribute(new t(n.length*e),e),i=0,s=n.length;i<s;i++)r.set(n[i],i*e);return r}function _H(n){for(var e=n.itemSize,t=[],r=0;r<n.count;r++)t.push(n.array.slice(r*e,(r+1)*e));return t}var up=new WeakMap,Qc=new WeakMap,Xc=new WeakMap,kr=(function(n){function e(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.dataBindAttr,o=s===void 0?"__data":s,a=i.objBindAttr,c=a===void 0?"__threeObj":a,f=i.removeDelay,p=f===void 0?0:f;return Sf(this,e),r=wf(this,e),Yn(r,"scene",void 0),op(r,up,void 0),op(r,Qc,void 0),op(r,Xc,void 0),r.scene=t,ap(up,r,o),ap(Qc,r,c),ap(Xc,r,p),r.onRemoveObj(function(){}),r}return Rf(e,n),Ef(e,[{key:"onCreateObj",value:function(r){var i=this;return lp(e,"onCreateObj",this)([function(s){var o=r(s);return s[Du(Qc,i)]=o,o[Du(up,i)]=s,i.scene.add(o),o}]),this}},{key:"onRemoveObj",value:function(r){var i=this;return lp(e,"onRemoveObj",this)([function(s,o){var a=lp(e,"getData",i)([s]);r(s,o);var c=function(){i.scene.remove(s),Kt(s),delete a[Du(Qc,i)]};Du(Xc,i)?setTimeout(c,Du(Xc,i)):c()}]),this}}])})(CB),Ri=window.THREE?window.THREE:{BufferGeometry:Zr,CylinderGeometry:xb,Matrix4:gn,Mesh:hn,MeshLambertMaterial:Qs,Object3D:Fh,Vector3:we},X3=Object.assign({},Qg),Y3=X3.BufferGeometryUtils||X3,M5=Vn({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var r=ve(e.pointLat),i=ve(e.pointLng),s=ve(e.pointAltitude),o=ve(e.pointRadius),a=ve(e.pointColor),c=new Ri.CylinderGeometry(1,1,1,e.pointResolution);c.applyMatrix4(new Ri.Matrix4().makeRotationX(Math.PI/2)),c.applyMatrix4(new Ri.Matrix4().makeTranslation(0,0,-.5));var f=2*Math.PI*nn/360,p={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&Kt(e.scene),e.dataMapper.scene=e.pointsMerge?new Ri.Object3D:e.scene,e.dataMapper.onCreateObj(x).onUpdateObj(T).digest(e.pointsData),e.pointsMerge){var g=e.pointsData.length?(Y3.mergeGeometries||Y3.mergeBufferGeometries)(e.pointsData.map(function(S){var R=e.dataMapper.getObj(S),C=R.geometry.clone();R.updateMatrix(),C.applyMatrix4(R.matrix);var B=Po(a(S));return C.setAttribute("color",_s(Array(C.getAttribute("position").count).fill(B),4)),C})):new Ri.BufferGeometry,v=new Ri.Mesh(g,new Ri.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));v.__globeObjType="points",v.__data=e.pointsData,e.dataMapper.clear(),Kt(e.scene),e.scene.add(v)}function x(){var S=new Ri.Mesh(c);return S.__globeObjType="point",S}function T(S,R){var C=function(G){var j=S.__currentTargetD=G,ee=j.r,Q=j.alt,Y=j.lat,Z=j.lng;Object.assign(S.position,bi(Y,Z));var oe=e.pointsMerge?new Ri.Vector3(0,0,0):e.scene.localToWorld(new Ri.Vector3(0,0,0));S.lookAt(oe),S.scale.x=S.scale.y=Math.min(30,ee)*f,S.scale.z=Math.max(Q*nn,.1)},B={alt:+s(R),r:+o(R),lat:+r(R),lng:+i(R)},D=S.__currentTargetD||Object.assign({},B,{alt:-.001});if(Object.keys(B).some(function(k){return D[k]!==B[k]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?C(B):e.tweenGroup.add(new dr(D).to(B,e.pointsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(C).start())),!e.pointsMerge){var F=a(R),I=F?Ui(F):0,q=!!I;S.visible=q,q&&(p.hasOwnProperty(F)||(p[F]=new Ri.MeshLambertMaterial({color:ys(F),transparent:I<1,opacity:I})),S.material=p[F])}}}}),P5=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    `.concat(cu.common,`
    `).concat(cu.logdepthbuf_pars_vertex,`
  
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  
      `).concat(cu.logdepthbuf_vertex,`
    }
  `),fragmentShader:`
    `.concat(cu.logdepthbuf_pars_fragment,`

    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
  
      `).concat(cu.logdepthbuf_fragment,`
    }
  `)}},ng=function(e){return e.uniforms.uSurfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float uSurfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(uSurfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},vH=function(e){return e.vertexShader=`
    attribute float r;
    
    const float PI = 3.1415926535897932384626433832795;
    float toRad(in float a) {
      return a * PI / 180.0;
    }
    
    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]
      float phi = toRad(90.0 - c.x);
      float theta = toRad(90.0 - c.y);
      float r = c.z;
      return vec3( // x,y,z
        r * sin(phi) * cos(theta),
        r * cos(phi),
        r * sin(phi) * sin(theta)
      );
    }
    
    vec2 Cartesian2Polar(in vec3 p) {
      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);
      float phi = acos(p.y / r);
      float theta = atan(p.z, p.x);
      return vec2( // lat,lng
        90.0 - phi * 180.0 / PI,
        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)
      );
    }
    `.concat(e.vertexShader.replace("}",`                  
        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `),`
  `),e},E2=function(e,t){return e.onBeforeCompile=function(r){e.userData.shader=t(r)},e},bH=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(i){return i};if(e.userData.shader)t(e.userData.shader.uniforms);else{var r=e.onBeforeCompile;e.onBeforeCompile=function(i){r(i),t(i.uniforms)}}},xH=["stroke"],Ni=window.THREE?window.THREE:{BufferGeometry:Zr,CubicBezierCurve3:uN,Curve:AN,Group:vs,Line:Lg,Mesh:hn,NormalBlending:Ls,ShaderMaterial:Ll,TubeGeometry:lN,Vector3:we},TH=Ul.default||Ul,B5=Vn({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcStartAltitude:{default:0},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcEndAltitude:{default:0},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new TH,sharedMaterial:new Ni.ShaderMaterial(qt(qt({},P5()),{},{transparent:!0,blending:Ni.NormalBlending}))}},init:function(e,t){Kt(e),t.scene=e,t.dataMapper=new kr(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var r=new Ni.Group;return r.__globeObjType="arc",r}),t.ticker.onTick.add(function(r,i){t.dataMapper.entries().map(function(s){var o=an(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*i,c=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=c+a})})},update:function(e){var t=ve(e.arcStartLat),r=ve(e.arcStartLng),i=ve(e.arcStartAltitude),s=ve(e.arcEndLat),o=ve(e.arcEndLng),a=ve(e.arcEndAltitude),c=ve(e.arcAltitude),f=ve(e.arcAltitudeAutoScale),p=ve(e.arcStroke),g=ve(e.arcColor),v=ve(e.arcDashLength),x=ve(e.arcDashGap),T=ve(e.arcDashInitialGap),S=ve(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(D,F){var I=p(F),q=I!=null;if(!D.children.length||q!==(D.children[0].type==="Mesh")){Kt(D);var k=q?new Ni.Mesh:new Ni.Line(new Ni.BufferGeometry);k.material=e.sharedMaterial.clone(),D.add(k)}var G=D.children[0];Object.assign(G.material.uniforms,{dashSize:{value:v(F)},gapSize:{value:x(F)},dashOffset:{value:T(F)}});var j=S(F);G.__dashAnimateStep=j>0?1e3/j:0;var ee=C(g(F),e.arcCurveResolution,q?e.arcCircularResolution+1:1),Q=B(e.arcCurveResolution,q?e.arcCircularResolution+1:1,!0);G.geometry.setAttribute("color",ee),G.geometry.setAttribute("relDistance",Q);var Y=function(ae){var he=D.__currentTargetD=ae,be=he.stroke,ye=lH(he,xH),Be=R(ye);q?(G.geometry&&G.geometry.dispose(),G.geometry=new Ni.TubeGeometry(Be,e.arcCurveResolution,be/2,e.arcCircularResolution),G.geometry.setAttribute("color",ee),G.geometry.setAttribute("relDistance",Q)):G.geometry.setFromPoints(Be.getPoints(e.arcCurveResolution))},Z={stroke:I,alt:c(F),altAutoScale:+f(F),startLat:+t(F),startLng:+r(F),startAlt:+i(F),endLat:+s(F),endLng:+o(F),endAlt:+a(F)},oe=D.__currentTargetD||Object.assign({},Z,{altAutoScale:-.001});Object.keys(Z).some(function(K){return oe[K]!==Z[K]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?Y(Z):e.tweenGroup.add(new dr(oe).to(Z,e.arcsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(Y).start()))}).digest(e.arcsData);function R(D){var F=D.alt,I=D.altAutoScale,q=D.startLat,k=D.startLng,G=D.startAlt,j=D.endLat,ee=D.endLng,Q=D.endAlt,Y=function(Pt){var zt=an(Pt,3),Nn=zt[0],In=zt[1],dn=zt[2],pn=bi(In,Nn,dn),Cn=pn.x,kn=pn.y,qr=pn.z;return new Ni.Vector3(Cn,kn,qr)},Z=[k,q],oe=[ee,j],K=F;if(K==null&&(K=No(Z,oe)/2*I+Math.max(G,Q)),K||G||Q){var ae=zg(Z,oe),he=function(Pt,zt){return zt+(zt-Pt)*(Pt<zt?.5:.25)},be=[.25,.75].map(function(pt){return[].concat(Ht(ae(pt)),[he(pt<.5?G:Q,K)])}),ye=an(be,2),Be=ye[0],ke=ye[1],Xe=T2(Ni.CubicBezierCurve3,Ht([[].concat(Z,[G]),Be,ke,[].concat(oe,[Q])].map(Y)));return Xe}else{var Qe=.001;return Dt.apply(void 0,Ht([[].concat(Z,[Qe]),[].concat(oe,[Qe])].map(Y)))}function Dt(pt,Pt){var zt=pt.angleTo(Pt),Nn=zt===0?function(){return pt.clone()}:function(dn){return new Ni.Vector3().addVectors(pt.clone().multiplyScalar(Math.sin((1-dn)*zt)),Pt.clone().multiplyScalar(Math.sin(dn*zt))).divideScalar(Math.sin(zt))},In=new Ni.Curve;return In.getPoint=Nn,In}}function C(D,F){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,q=F+1,k;if(D instanceof Array||D instanceof Function){var G=D instanceof Array?Us().domain(D.map(function(K,ae){return ae/(D.length-1)})).range(D):D;k=function(ae){return Po(G(ae),!0,!0)}}else{var j=Po(D,!0,!0);k=function(){return j}}for(var ee=[],Q=0,Y=q;Q<Y;Q++)for(var Z=k(Q/(Y-1)),oe=0;oe<I;oe++)ee.push(Z);return _s(ee,4)}function B(D){for(var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,q=D+1,k=[],G=0,j=q;G<j;G++)for(var ee=G/(j-1),Q=0;Q<F;Q++)k.push(ee);return I&&k.reverse(),_s(k,1)}}}),uo=window.THREE?window.THREE:{BufferGeometry:Zr,DoubleSide:fi,Mesh:hn,MeshLambertMaterial:Qs,Object3D:Fh},K3=Object.assign({},Qg),Z3=K3.BufferGeometryUtils||K3,D5=Vn({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var t=e.sumWeight;return t*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var r=ve(e.hexBinPointLat),i=ve(e.hexBinPointLng),s=ve(e.hexBinPointWeight),o=ve(e.hexAltitude),a=ve(e.hexTopColor),c=ve(e.hexSideColor),f=ve(e.hexMargin),p=KD(e.hexBinPointsData.map(function(B){return qt(qt({},B),{},{h3Idx:BL(r(B),i(B),e.hexBinResolution)})}),"h3Idx"),g=Object.entries(p).map(function(B){var D=an(B,2),F=D[0],I=D[1];return{h3Idx:F,points:I,sumWeight:I.reduce(function(q,k){return q+ +s(k)},0)}}),v={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&Kt(e.scene),e.dataMapper.scene=e.hexBinMerge?new uo.Object3D:e.scene,e.dataMapper.id(function(B){return B.h3Idx}).onCreateObj(R).onUpdateObj(C).digest(g),e.hexBinMerge){var x=g.length?(Z3.mergeGeometries||Z3.mergeBufferGeometries)(g.map(function(B){var D=e.dataMapper.getObj(B),F=D.geometry.toNonIndexed();D.updateMatrix(),F.applyMatrix4(D.matrix);var I=Po(a(B)),q=Po(c(B)),k=F.getAttribute("position").count,G=F.groups[0].count;return F.setAttribute("color",_s(Ht(new Array(k)).map(function(j,ee){return ee>=G?I:q}),4)),F})):new uo.BufferGeometry,T=new uo.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:uo.DoubleSide});T.onBeforeCompile=function(B){T.userData.shader=ng(B)};var S=new uo.Mesh(x,T);S.__globeObjType="hexBinPoints",S.__data=g,e.dataMapper.clear(),Kt(e.scene),e.scene.add(S)}function R(B){var D=new uo.Mesh;D.__hexCenter=R4(B.h3Idx),D.__hexGeoJson=N4(B.h3Idx,!0).reverse();var F=D.__hexCenter[1];return D.__hexGeoJson.forEach(function(I){var q=I[0];Math.abs(F-q)>170&&(I[0]+=F>q?360:-360)}),D.__globeObjType="hexbin",D}function C(B,D){var F=function(he,be,ye){return he-(he-be)*ye},I=Math.max(0,Math.min(1,+f(D))),q=an(B.__hexCenter,2),k=q[0],G=q[1],j=I===0?B.__hexGeoJson:B.__hexGeoJson.map(function(ae){var he=an(ae,2),be=he[0],ye=he[1];return[[be,G],[ye,k]].map(function(Be){var ke=an(Be,2),Xe=ke[0],Qe=ke[1];return F(Xe,Qe,I)})}),ee=e.hexTopCurvatureResolution;B.geometry&&B.geometry.dispose(),B.geometry=new Jg([j],0,nn,!1,!0,!0,ee);var Q={alt:+o(D)},Y=function(he){var be=B.__currentTargetD=he,ye=be.alt;B.scale.x=B.scale.y=B.scale.z=1+ye;var Be=nn/(ye+1);B.geometry.setAttribute("surfaceRadius",_s(Array(B.geometry.getAttribute("position").count).fill(Be),1))},Z=B.__currentTargetD||Object.assign({},Q,{alt:-.001});if(Object.keys(Q).some(function(ae){return Z[ae]!==Q[ae]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?Y(Q):e.tweenGroup.add(new dr(Z).to(Q,e.hexTransitionDuration).easing(On.Quadratic.InOut).onUpdate(Y).start())),!e.hexBinMerge){var oe=c(D),K=a(D);[oe,K].forEach(function(ae){if(!v.hasOwnProperty(ae)){var he=Ui(ae);v[ae]=E2(new uo.MeshLambertMaterial({color:ys(ae),transparent:he<1,opacity:he,side:uo.DoubleSide}),ng)}}),B.material=[oe,K].map(function(ae){return v[ae]})}}}}),L5=function(e){return e*e},Ds=function(e){return e*Math.PI/180};function wH(n,e){var t=Math.sqrt,r=Math.cos,i=function(p){return L5(Math.sin(p/2))},s=Ds(n[1]),o=Ds(e[1]),a=Ds(n[0]),c=Ds(e[0]);return 2*Math.asin(t(i(o-s)+r(s)*r(o)*i(c-a)))}var SH=Math.sqrt(2*Math.PI);function EH(n,e){return Math.exp(-L5(n/e)/2)/(e*SH)}var RH=function(e){var t=an(e,2),r=t[0],i=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.lngAccessor,c=a===void 0?function(R){return R[0]}:a,f=o.latAccessor,p=f===void 0?function(R){return R[1]}:f,g=o.weightAccessor,v=g===void 0?function(){return 1}:g,x=o.bandwidth,T=[r,i],S=x*Math.PI/180;return QC(s.map(function(R){var C=v(R);if(!C)return 0;var B=wH(T,[c(R),p(R)]);return EH(B,S)*C}))},NH=(function(){var n=tH(eg().m(function e(t){var r,i,s,o,a,c,f,p,g,v,x,T,S,R,C,B,D,F,I,q,k,G,j,ee,Q,Y,Z,oe,K,ae,he,be,ye,Be,ke,Xe,Qe,Dt,pt,Pt,zt=arguments,Nn,In,dn;return eg().w(function(pn){for(;;)switch(pn.n){case 0:if(i=zt.length>1&&zt[1]!==void 0?zt[1]:[],s=zt.length>2&&zt[2]!==void 0?zt[2]:{},o=s.lngAccessor,a=o===void 0?function(Cn){return Cn[0]}:o,c=s.latAccessor,f=c===void 0?function(Cn){return Cn[1]}:c,p=s.weightAccessor,g=p===void 0?function(){return 1}:p,v=s.bandwidth,(r=navigator)!==null&&r!==void 0&&r.gpu){pn.n=1;break}return pn.a(2,t.map(function(Cn){return RH(Cn,i,{lngAccessor:a,latAccessor:f,weightAccessor:g,bandwidth:v})}));case 1:return x=4,T=B$,S=D$,R=j$,C=z$,B=k$,D=q$,F=L$,I=V$,q=G$,k=F$,G=O$,j=I$,ee=U$,Q=C(new E0(new Float32Array(t.flat().map(Ds)),2),"vec2",t.length),Y=C(new E0(new Float32Array(i.map(function(Cn){return[Ds(a(Cn)),Ds(f(Cn)),g(Cn)]}).flat()),3),"vec3",i.length),Z=new E0(t.length,1),oe=C(Z,"float",t.length),K=B(Math.PI),ae=I(K.mul(2)),he=function(kn){return kn.mul(kn)},be=function(kn){return he(q(kn.div(2)))},ye=function(kn,qr){var Ks=B(kn[1]),Go=B(qr[1]),ei=B(kn[0]),Si=B(qr[0]);return B(2).mul(G(I(be(Go.sub(Ks)).add(k(Ks).mul(k(Go)).mul(be(Si.sub(ei)))))))},Be=function(kn,qr){return j(ee(he(kn.div(qr)).div(2))).div(qr.mul(ae))},ke=R(Ds(v)),Xe=R(Ds(v*x)),Qe=R(i.length),Dt=T(function(){var Cn=Q.element(D),kn=oe.element(D);kn.assign(0),F(Qe,function(qr){var Ks=qr.i,Go=Y.element(Ks),ei=Go.z;S(ei,function(){var Si=ye(Go.xy,Cn.xy);S(Si&&Si.lessThan(Xe),function(){kn.addAssign(Be(Si,ke).mul(ei))})})})}),pt=Dt().compute(t.length),Pt=new b5,pn.n=2,Pt.computeAsync(pt);case 2:return Nn=Array,In=Float32Array,pn.n=3,Pt.getArrayBufferAsync(Z);case 3:return dn=pn.v,pn.a(2,Nn.from.call(Nn,new In(dn)))}},e)}));return function(t){return n.apply(this,arguments)}})(),Yc=window.THREE?window.THREE:{Mesh:hn,MeshLambertMaterial:Qs,SphereGeometry:Bo},CH=3.5,MH=.1,J3=100,PH=function(e){var t=wa(LL(e));return t.opacity=Math.cbrt(e),t.formatRgb()},O5=Vn({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return PH}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var s=new Yc.Mesh(new Yc.SphereGeometry(nn),E2(new Yc.MeshLambertMaterial({vertexColors:!0,transparent:!0}),vH));return s.__globeObjType="heatmap",s})},update:function(e){var t=ve(e.heatmapPoints),r=ve(e.heatmapPointLat),i=ve(e.heatmapPointLng),s=ve(e.heatmapPointWeight),o=ve(e.heatmapBandwidth),a=ve(e.heatmapColorFn),c=ve(e.heatmapColorSaturation),f=ve(e.heatmapBaseAltitude),p=ve(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(g,v){var x=o(v),T=a(v),S=c(v),R=f(v),C=p(v),B=t(v).map(function(k){var G=r(k),j=i(k),ee=bi(G,j),Q=ee.x,Y=ee.y,Z=ee.z;return{x:Q,y:Y,z:Z,lat:G,lng:j,weight:s(k)}}),D=Math.max(MH,x/CH),F=Math.ceil(360/(D||-1));g.geometry.parameters.widthSegments!==F&&(g.geometry.dispose(),g.geometry=new Yc.SphereGeometry(nn,F,F/2));var I=_H(g.geometry.getAttribute("position")),q=I.map(function(k){var G=an(k,3),j=G[0],ee=G[1],Q=G[2],Y=N5({x:j,y:ee,z:Q}),Z=Y.lng,oe=Y.lat;return[Z,oe]});NH(q,B,{latAccessor:function(G){return G.lat},lngAccessor:function(G){return G.lng},weightAccessor:function(G){return G.weight},bandwidth:x}).then(function(k){var G=Ht(new Array(J3)).map(function(Y,Z){return Po(T(Z/(J3-1)))}),j=function(Z){var oe=g.__currentTargetD=Z,K=oe.kdeVals,ae=oe.topAlt,he=oe.saturation,be=$C(K.map(Math.abs))||1e-15,ye=Nx([0,be/he],G);g.geometry.setAttribute("color",_s(K.map(function(ke){return ye(Math.abs(ke))}),4));var Be=Us([0,be],[nn*(1+R),nn*(1+(ae||R))]);g.geometry.setAttribute("r",_s(K.map(Be)))},ee={kdeVals:k,topAlt:C,saturation:S},Q=g.__currentTargetD||Object.assign({},ee,{kdeVals:k.map(function(){return 0}),topAlt:C&&R,saturation:.5});Q.kdeVals.length!==k.length&&(Q.kdeVals=k.slice()),Object.keys(ee).some(function(Y){return Q[Y]!==ee[Y]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?j(ee):e.tweenGroup.add(new dr(Q).to(ee,e.heatmapsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(j).start()))})}).digest(e.heatmapsData)}}),Ao=window.THREE?window.THREE:{DoubleSide:fi,Group:vs,LineBasicMaterial:Uh,LineSegments:ox,Mesh:hn,MeshBasicMaterial:ts},F5=Vn({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjPolygon"}).id(function(s){return s.id}).onCreateObj(function(){var s=new Ao.Group;return s.__defaultSideMaterial=E2(new Ao.MeshBasicMaterial({side:Ao.DoubleSide,depthWrite:!0}),ng),s.__defaultCapMaterial=new Ao.MeshBasicMaterial({side:Ao.DoubleSide,depthWrite:!0}),s.add(new Ao.Mesh(void 0,[s.__defaultSideMaterial,s.__defaultCapMaterial])),s.add(new Ao.LineSegments(void 0,new Ao.LineBasicMaterial)),s.__globeObjType="polygon",s})},update:function(e){var t=ve(e.polygonGeoJsonGeometry),r=ve(e.polygonAltitude),i=ve(e.polygonCapCurvatureResolution),s=ve(e.polygonCapColor),o=ve(e.polygonCapMaterial),a=ve(e.polygonSideColor),c=ve(e.polygonSideMaterial),f=ve(e.polygonStrokeColor),p=[];e.polygonsData.forEach(function(g){var v={data:g,capColor:s(g),capMaterial:o(g),sideColor:a(g),sideMaterial:c(g),strokeColor:f(g),altitude:+r(g),capCurvatureResolution:+i(g)},x=t(g),T=g.__id||"".concat(Math.round(Math.random()*1e9));g.__id=T,x.type==="Polygon"?p.push(qt({id:"".concat(T,"_0"),coords:x.coordinates},v)):x.type==="MultiPolygon"&&p.push.apply(p,Ht(x.coordinates.map(function(S,R){return qt({id:"".concat(T,"_").concat(R),coords:S},v)})))}),e.dataMapper.onUpdateObj(function(g,v){var x=v.coords,T=v.capColor,S=v.capMaterial,R=v.sideColor,C=v.sideMaterial,B=v.strokeColor,D=v.altitude,F=v.capCurvatureResolution,I=an(g.children,2),q=I[0],k=I[1],G=!!B;k.visible=G;var j=!!(T||S),ee=!!(R||C);BH(q.geometry.parameters||{},{polygonGeoJson:x,curvatureResolution:F,closedTop:j,includeSides:ee})||(q.geometry&&q.geometry.dispose(),q.geometry=new Jg(x,0,nn,!1,j,ee,F)),G&&(!k.geometry.parameters||k.geometry.parameters.geoJson.coordinates!==x||k.geometry.parameters.resolution!==F)&&(k.geometry&&k.geometry.dispose(),k.geometry=new l4({type:"Polygon",coordinates:x},nn,F));var Q=ee?0:-1,Y=j?ee?1:0:-1;if(Q>=0&&(q.material[Q]=C||g.__defaultSideMaterial),Y>=0&&(q.material[Y]=S||g.__defaultCapMaterial),[[!C&&R,Q],[!S&&T,Y]].forEach(function(be){var ye=an(be,2),Be=ye[0],ke=ye[1];if(!(!Be||ke<0)){var Xe=q.material[ke],Qe=Ui(Be);Xe.color.set(ys(Be)),Xe.transparent=Qe<1,Xe.opacity=Qe}}),G){var Z=k.material,oe=Ui(B);Z.color.set(ys(B)),Z.transparent=oe<1,Z.opacity=oe}var K={alt:D},ae=function(ye){var Be=g.__currentTargetD=ye,ke=Be.alt;q.scale.x=q.scale.y=q.scale.z=1+ke,G&&(k.scale.x=k.scale.y=k.scale.z=1+ke+1e-4),bH(g.__defaultSideMaterial,function(Xe){return Xe.uSurfaceRadius.value=nn/(ke+1)})},he=g.__currentTargetD||Object.assign({},K,{alt:-.001});Object.keys(K).some(function(be){return he[be]!==K[be]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||he.alt===K.alt?ae(K):e.tweenGroup.add(new dr(he).to(K,e.polygonsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(ae).start()))}).digest(p)}});function BH(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(r,i){return r===i}};return Object.entries(e).every(function(r){var i=an(r,2),s=i[0],o=i[1];return n.hasOwnProperty(s)&&t(s)(n[s],o)})}var sl=window.THREE?window.THREE:{BufferGeometry:Zr,DoubleSide:fi,Mesh:hn,MeshLambertMaterial:Qs,Vector3:we},eb=Object.assign({},Qg),tb=eb.BufferGeometryUtils||eb,I5=Vn({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var s=new sl.Mesh(void 0,new sl.MeshLambertMaterial({side:sl.DoubleSide}));return s.__globeObjType="hexPolygon",s})},update:function(e){var t=ve(e.hexPolygonGeoJsonGeometry),r=ve(e.hexPolygonColor),i=ve(e.hexPolygonAltitude),s=ve(e.hexPolygonResolution),o=ve(e.hexPolygonMargin),a=ve(e.hexPolygonUseDots),c=ve(e.hexPolygonCurvatureResolution),f=ve(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(p,g){var v=t(g),x=s(g),T=i(g),S=Math.max(0,Math.min(1,+o(g))),R=a(g),C=c(g),B=f(g),D=r(g),F=Ui(D);p.material.color.set(ys(D)),p.material.transparent=F<1,p.material.opacity=F;var I={alt:T,margin:S,curvatureResolution:C},q={geoJson:v,h3Res:x},k=p.__currentTargetD||Object.assign({},I,{alt:-.001}),G=p.__currentMemD||q;if(Object.keys(I).some(function(Y){return k[Y]!==I[Y]})||Object.keys(q).some(function(Y){return G[Y]!==q[Y]})){p.__currentMemD=q;var j=[];v.type==="Polygon"?_v(v.coordinates,x,!0).forEach(function(Y){return j.push(Y)}):v.type==="MultiPolygon"&&v.coordinates.forEach(function(Y){return _v(Y,x,!0).forEach(function(Z){return j.push(Z)})});var ee=j.map(function(Y){var Z=R4(Y),oe=N4(Y,!0).reverse(),K=Z[1];return oe.forEach(function(ae){var he=ae[0];Math.abs(K-he)>170&&(ae[0]+=K>he?360:-360)}),{h3Idx:Y,hexCenter:Z,hexGeoJson:oe}}),Q=function(Z){var oe=p.__currentTargetD=Z,K=oe.alt,ae=oe.margin,he=oe.curvatureResolution;p.geometry&&p.geometry.dispose(),p.geometry=ee.length?(tb.mergeGeometries||tb.mergeBufferGeometries)(ee.map(function(be){var ye=an(be.hexCenter,2),Be=ye[0],ke=ye[1];if(R){var Xe=bi(Be,ke,K),Qe=bi(be.hexGeoJson[0][1],be.hexGeoJson[0][0],K),Dt=.85*(1-ae)*new sl.Vector3(Xe.x,Xe.y,Xe.z).distanceTo(new sl.Vector3(Qe.x,Qe.y,Qe.z)),pt=new sx(Dt,B);return pt.rotateX(la(-Be)),pt.rotateY(la(ke)),pt.translate(Xe.x,Xe.y,Xe.z),pt}else{var Pt=function(In,dn,pn){return In-(In-dn)*pn},zt=ae===0?be.hexGeoJson:be.hexGeoJson.map(function(Nn){var In=an(Nn,2),dn=In[0],pn=In[1];return[[dn,ke],[pn,Be]].map(function(Cn){var kn=an(Cn,2),qr=kn[0],Ks=kn[1];return Pt(qr,Ks,ae)})});return new Jg([zt],nn,nn*(1+K),!1,!0,!1,he)}})):new sl.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?Q(I):e.tweenGroup.add(new dr(k).to(I,e.hexPolygonsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(Q).start())}}).digest(e.hexPolygonsData)}}),DH=window.THREE?window.THREE:{Vector3:we};function LH(n,e){var t=function(o,a){var c=o[o.length-1];return[].concat(Ht(o),Ht(Array(a-o.length).fill(c)))},r=Math.max(n.length,e.length),i=A9.apply(void 0,Ht([n,e].map(function(s){return s.map(function(o){var a=o.x,c=o.y,f=o.z;return[a,c,f]})}).map(function(s){return t(s,r)})));return function(s){return s===0?n:s===1?e:i(s).map(function(o){var a=an(o,3),c=a[0],f=a[1],p=a[2];return new DH.Vector3(c,f,p)})}}var na=window.THREE?window.THREE:{BufferGeometry:Zr,Color:Gn,Group:vs,Line:Lg,NormalBlending:Ls,ShaderMaterial:Ll,Vector3:we},OH=Ul.default||Ul,k5=Vn({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new OH,sharedMaterial:new na.ShaderMaterial(qt(qt({},P5()),{},{transparent:!0,blending:na.NormalBlending}))}},init:function(e,t){Kt(e),t.scene=e,t.dataMapper=new kr(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var r=new na.Group;return r.__globeObjType="path",r}),t.ticker.onTick.add(function(r,i){t.dataMapper.entries().map(function(s){var o=an(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*i;if(o.type==="Line"){var c=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=c+a}else if(o.type==="Line2"){for(var f=o.material.dashOffset-a,p=o.material.dashSize+o.material.gapSize;f<=-p;)f+=p;o.material.dashOffset=f}})})},update:function(e){var t=ve(e.pathPoints),r=ve(e.pathPointLat),i=ve(e.pathPointLng),s=ve(e.pathPointAlt),o=ve(e.pathStroke),a=ve(e.pathColor),c=ve(e.pathDashLength),f=ve(e.pathDashGap),p=ve(e.pathDashInitialGap),g=ve(e.pathDashAnimateTime);e.dataMapper.onUpdateObj(function(R,C){var B=o(C),D=B!=null;if(!R.children.length||D===(R.children[0].type==="Line")){Kt(R);var F=D?new Q$(new T5,new x2):new na.Line(new na.BufferGeometry,e.sharedMaterial.clone());R.add(F)}var I=R.children[0],q=x(t(C),r,i,s,e.pathResolution),k=g(C);if(I.__dashAnimateStep=k>0?1e3/k:0,D){I.material.resolution=e.rendererSize;{var ee=c(C),Q=f(C),Y=p(C);I.material.dashed=Q>0,I.material.dashed?I.material.defines.USE_DASH="":delete I.material.defines.USE_DASH,I.material.dashed&&(I.material.dashScale=1/v(q),I.material.dashSize=ee,I.material.gapSize=Q,I.material.dashOffset=-Y)}{var Z=a(C);if(Z instanceof Array){var oe=T(a(C),q.length-1,1,!1);I.geometry.setColors(oe.array),I.material.vertexColors=!0}else{var K=Z,ae=Ui(K);I.material.color=new na.Color(ys(K)),I.material.transparent=ae<1,I.material.opacity=ae,I.material.vertexColors=!1}}I.material.needsUpdate=!0}else{Object.assign(I.material.uniforms,{dashSize:{value:c(C)},gapSize:{value:f(C)},dashOffset:{value:p(C)}});var G=T(a(C),q.length),j=S(q.length,1,!0);I.geometry.setAttribute("color",G),I.geometry.setAttribute("relDistance",j)}var he=LH(R.__currentTargetD&&R.__currentTargetD.points||[q[0]],q),be=function(Xe){var Qe=R.__currentTargetD=Xe,Dt=Qe.stroke,pt=Qe.interpolK,Pt=R.__currentTargetD.points=he(pt);if(D){var zt;I.geometry.setPositions((zt=[]).concat.apply(zt,Ht(Pt.map(function(Nn){var In=Nn.x,dn=Nn.y,pn=Nn.z;return[In,dn,pn]})))),I.material.linewidth=Dt,I.material.dashed&&I.computeLineDistances()}else I.geometry.setFromPoints(Pt),I.geometry.computeBoundingSphere()},ye={stroke:B,interpolK:1},Be=Object.assign({},R.__currentTargetD||ye,{interpolK:0});Object.keys(ye).some(function(ke){return Be[ke]!==ye[ke]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?be(ye):e.tweenGroup.add(new dr(Be).to(ye,e.pathTransitionDuration).easing(On.Quadratic.InOut).onUpdate(be).start()))}).digest(e.pathsData);function v(R){var C=0,B;return R.forEach(function(D){B&&(C+=B.distanceTo(D)),B=D}),C}function x(R,C,B,D,F){var I=function(j,ee,Q){for(var Y=[],Z=1;Z<=Q;Z++)Y.push(j+(ee-j)*Z/(Q+1));return Y},q=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Q=[],Y=null;return j.forEach(function(Z){if(Y){for(;Math.abs(Y[1]-Z[1])>180;)Y[1]+=360*(Y[1]<Z[1]?1:-1);var oe=Math.sqrt(Math.pow(Z[0]-Y[0],2)+Math.pow(Z[1]-Y[1],2));if(oe>ee)for(var K=Math.floor(oe/ee),ae=I(Y[0],Z[0],K),he=I(Y[1],Z[1],K),be=I(Y[2],Z[2],K),ye=0,Be=ae.length;ye<Be;ye++)Q.push([ae[ye],he[ye],be[ye]])}Q.push(Y=Z)}),Q},k=function(j){var ee=an(j,3),Q=ee[0],Y=ee[1],Z=ee[2],oe=bi(Q,Y,Z),K=oe.x,ae=oe.y,he=oe.z;return new na.Vector3(K,ae,he)};return q(R.map(function(G){return[C(G),B(G),D(G)]}),F).map(k)}function T(R,C){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,F=C+1,I;if(R instanceof Array||R instanceof Function){var q=R instanceof Array?Us().domain(R.map(function(Z,oe){return oe/(R.length-1)})).range(R):R;I=function(oe){return Po(q(oe),D,!0)}}else{var k=Po(R,D,!0);I=function(){return k}}for(var G=[],j=0,ee=F;j<ee;j++)for(var Q=I(j/(ee-1)),Y=0;Y<B;Y++)G.push(Q);return _s(G,D?4:3)}function S(R){for(var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=R+1,F=[],I=0,q=D;I<q;I++)for(var k=I/(q-1),G=0;G<C;G++)F.push(k);return B&&F.reverse(),_s(F,1)}}}),Kc=window.THREE?window.THREE:{Euler:lA,Mesh:hn,MeshLambertMaterial:Qs,SphereGeometry:Bo},q5=Vn({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new Kc.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var s=new Kc.Mesh;return s.__globeObjType="tile",s})},update:function(e){var t=ve(e.tileLat),r=ve(e.tileLng),i=ve(e.tileAltitude),s=ve(e.tileWidth),o=ve(e.tileHeight),a=ve(e.tileUseGlobeProjection),c=ve(e.tileMaterial),f=ve(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(p,g){p.material=c(g);var v=a(g),x=f(g),T=function(B){var D=p.__currentTargetD=B,F=D.lat,I=D.lng,q=D.alt,k=D.width,G=D.height,j=ol(I),ee=ol(-F);p.geometry&&p.geometry.dispose(),p.geometry=new Kc.SphereGeometry(nn*(1+q),Math.ceil(k/(x||-1)),Math.ceil(G/(x||-1)),ol(90-k/2)+(v?j:0),ol(k),ol(90-G/2)+(v?ee:0),ol(G)),v||p.setRotationFromEuler(new Kc.Euler(ee,j,0,"YXZ"))},S={lat:+t(g),lng:+r(g),alt:+i(g),width:+s(g),height:+o(g)},R=p.__currentTargetD||Object.assign({},S,{width:0,height:0});Object.keys(S).some(function(C){return R[C]!==S[C]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?T(S):e.tweenGroup.add(new dr(R).to(S,e.tilesTransitionDuration).easing(On.Quadratic.InOut).onUpdate(T).start()))}).digest(e.tilesData)}}),ol=function(e){return e*Math.PI/180},Lu=window.THREE?window.THREE:{BufferGeometry:Zr,Color:Gn,Points:aN,PointsMaterial:ex},U5=Vn({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){Kt(e),t.scene=e,t.dataMapper=new kr(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var r=new Lu.Points(new Lu.BufferGeometry,new Lu.PointsMaterial);return r.__globeObjType="particles",r}).onUpdateObj(function(r,i){var s=ve(t.particlesList),o=ve(t.particleLat),a=ve(t.particleLng),c=ve(t.particleAltitude);r.geometry.setAttribute("position",_s(s(i).map(function(f){return Object.values(bi(o(f),a(f),c(f)))}),3))})},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(a){return t.hasOwnProperty(a)})&&e.dataMapper.digest(e.particlesData);var r=ve(e.particlesColor),i=ve(e.particlesSize),s=ve(e.particlesSizeAttenuation),o=ve(e.particlesTexture);e.dataMapper.entries().forEach(function(a){var c=an(a,2),f=c[0],p=c[1];if(p.material.size=i(f),p.material.sizeAttenuation=s(f),e.particlesTexture)p.material.color=new Lu.Color(16777215),p.material.transparent=!1,p.material.alphaTest=.5,p.material.map=o(f);else{var g=r(f),v=Ui(g);p.material.color=new Lu.Color(ys(g)),p.material.transparent=v<1,p.material.opacity=v,p.material.alphaTest=0}})}}),FH=window.THREE?window.THREE:{BufferGeometry:Zr},IH=(function(n){function e(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;Sf(this,e),t=wf(this,e),t.type="CircleLineGeometry",t.parameters={radius:r,segmentCount:i};for(var s=[],o=0;o<=i;o++){var a=(o/i-.25)*Math.PI*2;s.push({x:Math.cos(a)*r,y:Math.sin(a)*r,z:0})}return t.setFromPoints(s),t}return Rf(e,n),Ef(e)})(FH.BufferGeometry),al=window.THREE?window.THREE:{Color:Gn,Group:vs,Line:Lg,LineBasicMaterial:Uh,Vector3:we},kH=Ul.default||Ul,G5=Vn({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var s=new al.Group;return s.__globeObjType="ring",s}),t.ticker=new kH,t.ticker.onTick.add(function(s){if(t.ringsData.length){var o=ve(t.ringColor),a=ve(t.ringAltitude),c=ve(t.ringMaxRadius),f=ve(t.ringPropagationSpeed),p=ve(t.ringRepeatPeriod);t.dataMapper.entries().filter(function(g){var v=an(g,2),x=v[1];return x}).forEach(function(g){var v=an(g,2),x=v[0],T=v[1];if((T.__nextRingTime||0)<=s){var S=p(x)/1e3;T.__nextRingTime=s+(S<=0?1/0:S);var R=new al.Line(new IH(1,t.ringResolution),new al.LineBasicMaterial),C=o(x),B=C instanceof Array||C instanceof Function,D;B?C instanceof Array?(D=Us().domain(C.map(function(Q,Y){return Y/(C.length-1)})).range(C),R.material.transparent=C.some(function(Q){return Ui(Q)<1})):(D=C,R.material.transparent=!0):(R.material.color=new al.Color(ys(C)),yH(R.material,Ui(C)));var F=nn*(1+a(x)),I=c(x),q=I*Math.PI/180,k=f(x),G=k<=0,j=function(Y){var Z=Y.t,oe=(G?1-Z:Z)*q;if(R.scale.x=R.scale.y=F*Math.sin(oe),R.position.z=F*(1-Math.cos(oe)),B){var K=D(Z);R.material.color=new al.Color(ys(K)),R.material.transparent&&(R.material.opacity=Ui(K))}};if(k===0)j({t:0}),T.add(R);else{var ee=Math.abs(I/k)*1e3;t.tweenGroup.add(new dr({t:0}).to({t:1},ee).onUpdate(j).onStart(function(){return T.add(R)}).onComplete(function(){T.remove(R),S2(R)}).start())}}})}})},update:function(e){var t=ve(e.ringLat),r=ve(e.ringLng),i=ve(e.ringAltitude),s=e.scene.localToWorld(new al.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(o,a){var c=t(a),f=r(a),p=i(a);Object.assign(o.position,bi(c,f,p)),o.lookAt(s)}).digest(e.ringsData)}}),qH={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},UH="normal",GH=1189,VH=-100,zH="normal",jH={yMin:-334,xMin:-111,yMax:1189,xMax:1672},$H=1e3,HH={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},WH=-334,QH="Helvetiker",XH=1522,YH=50,KH={glyphs:qH,cssFontWeight:UH,ascender:GH,underlinePosition:VH,cssFontStyle:zH,boundingBox:jH,resolution:$H,original_font_information:HH,descender:WH,familyName:QH,lineHeight:XH,underlineThickness:YH},Ci=qt(qt({},window.THREE?window.THREE:{BoxGeometry:Pg,CircleGeometry:sx,DoubleSide:fi,Group:vs,Mesh:hn,MeshLambertMaterial:Qs,TextGeometry:j3,Vector3:we}),{},{Font:X$,TextGeometry:j3}),V5=Vn({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:.002},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:KH,onChange:function(e,t){t.font=new Ci.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i;var s=new Ci.CircleGeometry(1,32);t.dataMapper=new kr(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var o=new Ci.MeshLambertMaterial;o.side=fi;var a=new Ci.Group;a.add(new Ci.Mesh(s,o));var c=new Ci.Mesh(void 0,o);a.add(c);var f=new Ci.Mesh;return f.visible=!1,c.add(f),a.__globeObjType="label",a})},update:function(e){var t=ve(e.labelLat),r=ve(e.labelLng),i=ve(e.labelAltitude),s=ve(e.labelText),o=ve(e.labelSize),a=ve(e.labelRotation),c=ve(e.labelColor),f=ve(e.labelIncludeDot),p=ve(e.labelDotRadius),g=ve(e.labelDotOrientation),v=new Set(["right","top","bottom"]),x=2*Math.PI*nn/360;e.dataMapper.onUpdateObj(function(T,S){var R=an(T.children,2),C=R[0],B=R[1],D=an(B.children,1),F=D[0],I=c(S),q=Ui(I);B.material.color.set(ys(I)),B.material.transparent=q<1,B.material.opacity=q;var k=f(S),G=g(S);!k||!v.has(G)&&(G="bottom");var j=k?+p(S)*x:1e-12;C.scale.x=C.scale.y=j;var ee=+o(S)*x;if(B.geometry&&B.geometry.dispose(),B.geometry=new Ci.TextGeometry(s(S),{font:e.font,size:ee,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),F.geometry&&F.geometry.dispose(),B.geometry.computeBoundingBox(),F.geometry=T2(Ci.BoxGeometry,Ht(new Ci.Vector3().subVectors(B.geometry.boundingBox.max,B.geometry.boundingBox.min).clampScalar(0,1/0).toArray())),G!=="right"&&B.geometry.center(),k){var Q=j+ee/2;G==="right"&&(B.position.x=Q),B.position.y={right:-ee/2,top:Q+ee/2,bottom:-Q-ee/2}[G]}var Y=function(ae){var he=T.__currentTargetD=ae,be=he.lat,ye=he.lng,Be=he.alt,ke=he.rot,Xe=he.scale;Object.assign(T.position,bi(be,ye,Be)),T.lookAt(e.scene.localToWorld(new Ci.Vector3(0,0,0))),T.rotateY(Math.PI),T.rotateZ(-ke*Math.PI/180),T.scale.x=T.scale.y=T.scale.z=Xe},Z={lat:+t(S),lng:+r(S),alt:+i(S),rot:+a(S),scale:1},oe=T.__currentTargetD||Object.assign({},Z,{scale:1e-12});Object.keys(Z).some(function(K){return oe[K]!==Z[K]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?Y(Z):e.tweenGroup.add(new dr(oe).to(Z,e.labelsTransitionDuration).easing(On.Quadratic.InOut).onUpdate(Y).start()))}).digest(e.labelsData)}}),ZH=qt(qt({},window.THREE?window.THREE:{}),{},{CSS2DObject:LN}),z5=Vn({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){if(e.dataMapper){var r=t?[t]:e.dataMapper.entries().map(function(i){var s=an(i,2),o=s[1];return o}).filter(function(i){return i});r.forEach(function(i){var s=!e.isBehindGlobe||!e.isBehindGlobe(i.position);e.htmlElementVisibilityModifier?(i.visible=!0,e.htmlElementVisibilityModifier(i.element,s)):i.visible=s})}}},init:function(e,t,r){var i=r.tweenGroup;Kt(e),t.scene=e,t.tweenGroup=i,t.dataMapper=new kr(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(s){var o=ve(t.htmlElement)(s),a=new ZH.CSS2DObject(o);return a.__globeObjType="html",a})},update:function(e,t){var r=this,i=ve(e.htmlLat),s=ve(e.htmlLng),o=ve(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(a,c){var f=function(v){var x=a.__currentTargetD=v,T=x.alt,S=x.lat,R=x.lng;Object.assign(a.position,bi(S,R,T)),r.updateObjVisibility(a)},p={lat:+i(c),lng:+s(c),alt:+o(c)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!a.__currentTargetD?f(p):e.tweenGroup.add(new dr(a.__currentTargetD).to(p,e.htmlTransitionDuration).easing(On.Quadratic.InOut).onUpdate(f).start())}).digest(e.htmlElementsData)}}),Zc=window.THREE?window.THREE:{Group:vs,Mesh:hn,MeshLambertMaterial:Qs,SphereGeometry:Bo},j5=Vn({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new Zc.Mesh(new Zc.SphereGeometry(1,16,8),new Zc.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){Kt(e),t.scene=e,t.dataMapper=new kr(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(r){var i=ve(t.objectThreeObject)(r);t.objectThreeObject===i&&(i=i.clone());var s=new Zc.Group;return s.add(i),s.__globeObjType="object",s})},update:function(e,t){var r=ve(e.objectLat),i=ve(e.objectLng),s=ve(e.objectAltitude),o=ve(e.objectFacesSurface),a=ve(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(c,f){var p=+r(f),g=+i(f),v=+s(f);Object.assign(c.position,bi(p,g,v)),o(f)?c.setRotationFromEuler(new lA(la(-p),la(g),0,"YXZ")):c.rotation.set(0,0,0);var x=c.children[0],T=a(f);T&&x.setRotationFromEuler(new lA(la(T.x||0),la(T.y||0),la(T.z||0)))}).digest(e.objectsData)}}),$5=Vn({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){Kt(e),t.scene=e,t.dataMapper=new kr(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(r){var i=ve(t.customThreeObject)(r,nn);return i&&(t.customThreeObject===i&&(i=i.clone()),i.__globeObjType="custom"),i})},update:function(e,t){e.customThreeObjectUpdate||Kt(e.scene);var r=ve(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(i,s){return r(i,s,nn)}).digest(e.customLayerData)}}),Jc=window.THREE?window.THREE:{Camera:fg,Group:vs,Vector2:ht,Vector3:we},JH=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],H5=Sr("globeLayer",C5),eW=Object.assign.apply(Object,Ht(["globeImageUrl","bumpImageUrl","globeCurvatureResolution","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(n){return Yn({},n,H5.linkProp(n))}))),tW=Object.assign.apply(Object,Ht(["globeMaterial"].map(function(n){return Yn({},n,H5.linkMethod(n))}))),nW=Sr("pointsLayer",M5),rW=Object.assign.apply(Object,Ht(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(n){return Yn({},n,nW.linkProp(n))}))),iW=Sr("arcsLayer",B5),sW=Object.assign.apply(Object,Ht(["arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(n){return Yn({},n,iW.linkProp(n))}))),oW=Sr("hexBinLayer",D5),aW=Object.assign.apply(Object,Ht(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(n){return Yn({},n,oW.linkProp(n))}))),lW=Sr("heatmapsLayer",O5),uW=Object.assign.apply(Object,Ht(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(n){return Yn({},n,lW.linkProp(n))}))),AW=Sr("hexedPolygonsLayer",I5),cW=Object.assign.apply(Object,Ht(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(n){return Yn({},n,AW.linkProp(n))}))),hW=Sr("polygonsLayer",F5),fW=Object.assign.apply(Object,Ht(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(n){return Yn({},n,hW.linkProp(n))}))),dW=Sr("pathsLayer",k5),pW=Object.assign.apply(Object,Ht(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(n){return Yn({},n,dW.linkProp(n))}))),mW=Sr("tilesLayer",q5),gW=Object.assign.apply(Object,Ht(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(n){return Yn({},n,mW.linkProp(n))}))),yW=Sr("particlesLayer",U5),_W=Object.assign.apply(Object,Ht(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(n){return Yn({},n,yW.linkProp(n))}))),vW=Sr("ringsLayer",G5),bW=Object.assign.apply(Object,Ht(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(n){return Yn({},n,vW.linkProp(n))}))),xW=Sr("labelsLayer",V5),TW=Object.assign.apply(Object,Ht(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(n){return Yn({},n,xW.linkProp(n))}))),wW=Sr("htmlElementsLayer",z5),SW=Object.assign.apply(Object,Ht(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(n){return Yn({},n,wW.linkProp(n))}))),EW=Sr("objectsLayer",j5),RW=Object.assign.apply(Object,Ht(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(n){return Yn({},n,EW.linkProp(n))}))),NW=Sr("customLayer",$5),CW=Object.assign.apply(Object,Ht(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return Yn({},n,NW.linkProp(n))}))),MW=Vn({props:qt(qt(qt(qt(qt(qt(qt(qt(qt(qt(qt(qt(qt(qt(qt({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new Jc.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},eW),rW),sW),aW),uW),fW),cW),pW),gW),_W),bW),TW),SW),RW),CW),methods:qt({getGlobeRadius:W3,getCoords:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return bi.apply(void 0,r)},toGeoCoords:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return N5.apply(void 0,r)},setPointOfView:function(e,t){var r=t instanceof Jc.Camera?t.position:t,i=W3(),s=void 0;if(e.scene&&r){var o,a,c,f;s=function(g){o===void 0&&(o=r.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),a===void 0&&(a=o.length()),c===void 0&&(c=Math.sqrt(Math.pow(a,2)-Math.pow(i,2))),f===void 0&&(f=Math.acos(c/a));var v=o.distanceTo(g);if(v<c)return!1;var x=g.length(),T=Math.acos((Math.pow(a,2)+Math.pow(v,2)-Math.pow(x,2))/(2*a*v));return T<f}}e.layersThatNeedUpdatePov.forEach(function(p){return p.updatePov(t)}),e.layersThatNeedBehindGlobeChecker.forEach(function(p){return p.isBehindGlobe(s)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(t){var r;return(r=t.pauseAnimation)===null||r===void 0?void 0:r.call(t)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(t){var r;return(r=t.resumeAnimation)===null||r===void 0?void 0:r.call(t)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(t){return t._destructor()})}},tW),stateInit:function(){var e=new Vh,t={tweenGroup:e},r={globeLayer:C5(t),pointsLayer:M5(t),arcsLayer:B5(t),hexBinLayer:D5(t),heatmapsLayer:O5(t),polygonsLayer:F5(t),hexedPolygonsLayer:I5(t),pathsLayer:k5(t),tilesLayer:q5(t),particlesLayer:U5(t),ringsLayer:G5(t),labelsLayer:V5(t),htmlElementsLayer:z5(t),objectsLayer:j5(t),customLayer:$5(t)};return qt(qt({tweenGroup:e},r),{},{layersThatNeedUpdatePov:Object.values(r).filter(function(i){return i.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(r).filter(function(i){return i.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(r).filter(function(i){return i.hasOwnProperty("_destructor")}),pausableLayers:Object.values(r).filter(function(i){return i.hasOwnProperty("pauseAnimation")})})},init:function(e,t,r){var i=r.animateIn,s=i===void 0?!0:i,o=r.waitForGlobeReady,a=o===void 0?!0:o;Kt(e),t.scene=e,t.scene.visible=!1,JH.forEach(function(f){var p=new Jc.Group;t.scene.add(p),t[f](p)});var c=function(){if(s){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new dr({k:1e-6}).to({k:1},600).easing(On.Quadratic.Out).onUpdate(function(g){var v=g.k;return t.scene.scale.set(v,v,v)}).start());var p=new Jc.Vector3(0,1,0);t.tweenGroup.add(new dr({rot:Math.PI*2}).to({rot:0},1200).easing(On.Quintic.Out).onUpdate(function(g){var v=g.rot;return t.scene.setRotationFromAxisAngle(p,v)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};a?t.globeLayer.onReady(c):c(),this._animationCycle()},update:function(e){}});function PW(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=(function(i){function s(){var o;Sf(this,s);for(var a=arguments.length,c=new Array(a),f=0;f<a;f++)c[f]=arguments[f];return o=wf(this,s,[].concat(c)),o.__kapsuleInstance=T2(n,[].concat(Ht(t?[o]:[]),c)),o}return Rf(s,i),Ef(s)})(e);return Object.keys(n()).forEach(function(i){return r.prototype[i]=function(){var s,o=(s=this.__kapsuleInstance)[i].apply(s,arguments);return o===this.__kapsuleInstance?this:o}}),r}var BW=window.THREE?window.THREE:{Group:vs},W5=PW(MW,BW.Group,!0);const Ap={type:"change"},R2={type:"start"},N2={type:"end"},nb=1e-6,Ot={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},e0=new ht,co=new ht,DW=new we,t0=new we,cp=new we,ll=new Ml,rb=new we,n0=new we,hp=new we,r0=new we;class LW extends Og{constructor(e,t=null){super(e,t),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:di.ROTATE,MIDDLE:di.DOLLY,RIGHT:di.PAN},this.target=new we,this.state=Ot.NONE,this.keyState=Ot.NONE,this._lastPosition=new we,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new we,this._movePrev=new ht,this._moveCurr=new ht,this._lastAxis=new we,this._zoomStart=new ht,this._zoomEnd=new ht,this._panStart=new ht,this._panEnd=new ht,this._pointers=[],this._pointerPositions={},this._onPointerMove=FW.bind(this),this._onPointerDown=OW.bind(this),this._onPointerUp=IW.bind(this),this._onPointerCancel=kW.bind(this),this._onContextMenu=$W.bind(this),this._onMouseWheel=jW.bind(this),this._onKeyDown=UW.bind(this),this._onKeyUp=qW.bind(this),this._onTouchStart=HW.bind(this),this._onTouchMove=WW.bind(this),this._onTouchEnd=QW.bind(this),this._onMouseDown=GW.bind(this),this._onMouseMove=VW.bind(this),this._onMouseUp=zW.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(t),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>nb&&(this.dispatchEvent(Ap),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera&&(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>nb||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(Ap),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom))}reset(){this.state=Ot.NONE,this.keyState=Ot.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(Ap),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(co.copy(this._panEnd).sub(this._panStart),co.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;co.x*=e,co.y*=t}co.multiplyScalar(this._eye.length()*this.panSpeed),t0.copy(this._eye).cross(this.object.up).setLength(co.x),t0.add(DW.copy(this.object.up).setLength(co.y)),this.object.position.add(t0),this.target.add(t0),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(co.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){r0.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=r0.length();e?(this._eye.copy(this.object.position).sub(this.target),rb.copy(this._eye).normalize(),n0.copy(this.object.up).normalize(),hp.crossVectors(n0,rb).normalize(),n0.setLength(this._moveCurr.y-this._movePrev.y),hp.setLength(this._moveCurr.x-this._movePrev.x),r0.copy(n0.add(hp)),cp.crossVectors(r0,this._eye).normalize(),e*=this.rotateSpeed,ll.setFromAxisAngle(cp,e),this._eye.applyQuaternion(ll),this.object.up.applyQuaternion(ll),this._lastAxis.copy(cp),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),ll.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(ll),this.object.up.applyQuaternion(ll)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===Ot.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera&&(this.object.zoom=Dl.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix())):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera&&(this.object.zoom=Dl.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix())),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return e0.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),e0}_getMouseOnCircle(e,t){return e0.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),e0}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new ht,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function OW(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n))}function FW(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function IW(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchEnd(n):this._onMouseUp(),this._removePointer(n),this._pointers.length===0&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function kW(n){this._removePointer(n)}function qW(){this.enabled!==!1&&(this.keyState=Ot.NONE,window.addEventListener("keydown",this._onKeyDown))}function UW(n){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===Ot.NONE&&(n.code===this.keys[Ot.ROTATE]&&!this.noRotate?this.keyState=Ot.ROTATE:n.code===this.keys[Ot.ZOOM]&&!this.noZoom?this.keyState=Ot.ZOOM:n.code===this.keys[Ot.PAN]&&!this.noPan&&(this.keyState=Ot.PAN)))}function GW(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case di.DOLLY:this.state=Ot.ZOOM;break;case di.ROTATE:this.state=Ot.ROTATE;break;case di.PAN:this.state=Ot.PAN;break;default:this.state=Ot.NONE}const t=this.keyState!==Ot.NONE?this.keyState:this.state;t===Ot.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr)):t===Ot.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._zoomEnd.copy(this._zoomStart)):t===Ot.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(R2)}function VW(n){const e=this.keyState!==Ot.NONE?this.keyState:this.state;e===Ot.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY))):e===Ot.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY)):e===Ot.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY))}function zW(){this.state=Ot.NONE,this.dispatchEvent(N2)}function jW(n){if(this.enabled!==!1&&this.noZoom!==!0){switch(n.preventDefault(),n.deltaMode){case 2:this._zoomStart.y-=n.deltaY*.025;break;case 1:this._zoomStart.y-=n.deltaY*.01;break;default:this._zoomStart.y-=n.deltaY*25e-5;break}this.dispatchEvent(R2),this.dispatchEvent(N2)}}function $W(n){this.enabled!==!1&&n.preventDefault()}function HW(n){switch(this._trackPointer(n),this._pointers.length){case 1:this.state=Ot.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=Ot.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const r=(this._pointers[0].pageX+this._pointers[1].pageX)/2,i=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(r,i)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(R2)}function WW(n){switch(this._trackPointer(n),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY));break;default:const e=this._getSecondPointerPosition(n),t=n.pageX-e.x,r=n.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+r*r);const i=(n.pageX+e.x)/2,s=(n.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(i,s));break}}function QW(n){switch(this._pointers.length){case 0:this.state=Ot.NONE;break;case 1:this.state=Ot.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=Ot.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==n.pointerId){const t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(N2)}const ib={type:"change"},C2={type:"start"},Q5={type:"end"},i0=new cN,sb=new xg,XW=Math.cos(70*Dl.DEG2RAD),qn=new we,Nr=2*Math.PI,Yt={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},fp=1e-6;class YW extends Og{constructor(e,t=null){super(e,t),this.state=Yt.NONE,this.target=new we,this.cursor=new we,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:di.ROTATE,MIDDLE:di.DOLLY,RIGHT:di.PAN},this.touches={ONE:dl.ROTATE,TWO:dl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new we,this._lastQuaternion=new Ml,this._lastTargetPosition=new we,this._quat=new Ml().setFromUnitVectors(e.up,new we(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Vy,this._sphericalDelta=new Vy,this._scale=1,this._panOffset=new we,this._rotateStart=new ht,this._rotateEnd=new ht,this._rotateDelta=new ht,this._panStart=new ht,this._panEnd=new ht,this._panDelta=new ht,this._dollyStart=new ht,this._dollyEnd=new ht,this._dollyDelta=new ht,this._dollyDirection=new we,this._mouse=new ht,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ZW.bind(this),this._onPointerDown=KW.bind(this),this._onPointerUp=JW.bind(this),this._onContextMenu=oQ.bind(this),this._onMouseWheel=nQ.bind(this),this._onKeyDown=rQ.bind(this),this._onTouchStart=iQ.bind(this),this._onTouchMove=sQ.bind(this),this._onMouseDown=eQ.bind(this),this._onMouseMove=tQ.bind(this),this._interceptControlDown=aQ.bind(this),this._interceptControlUp=lQ.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(ib),this.update(),this.state=Yt.NONE}update(e=null){const t=this.object.position;qn.copy(t).sub(this.target),qn.applyQuaternion(this._quat),this._spherical.setFromVector3(qn),this.autoRotate&&this.state===Yt.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let r=this.minAzimuthAngle,i=this.maxAzimuthAngle;isFinite(r)&&isFinite(i)&&(r<-Math.PI?r+=Nr:r>Math.PI&&(r-=Nr),i<-Math.PI?i+=Nr:i>Math.PI&&(i-=Nr),r<=i?this._spherical.theta=Math.max(r,Math.min(i,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(r+i)/2?Math.max(r,this._spherical.theta):Math.min(i,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(qn.setFromSpherical(this._spherical),qn.applyQuaternion(this._quatInverse),t.copy(this.target).add(qn),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=qn.length();o=this._clampDistance(a*this._scale);const c=a-o;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),s=!!c}else if(this.object.isOrthographicCamera){const a=new we(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=c!==this.object.zoom;const f=new we(this._mouse.x,this._mouse.y,0);f.unproject(this.object),this.object.position.sub(f).add(a),this.object.updateMatrixWorld(),o=qn.length()}else this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(i0.origin.copy(this.object.position),i0.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(i0.direction))<XW?this.object.lookAt(this.target):(sb.setFromNormalAndCoplanarPoint(this.object.up,this.target),i0.intersectPlane(sb,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>fp||8*(1-this._lastQuaternion.dot(this.object.quaternion))>fp||this._lastTargetPosition.distanceToSquared(this.target)>fp?(this.dispatchEvent(ib),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Nr/60*this.autoRotateSpeed*e:Nr/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){qn.setFromMatrixColumn(t,0),qn.multiplyScalar(-e),this._panOffset.add(qn)}_panUp(e,t){this.screenSpacePanning===!0?qn.setFromMatrixColumn(t,1):(qn.setFromMatrixColumn(t,0),qn.crossVectors(this.object.up,qn)),qn.multiplyScalar(e),this._panOffset.add(qn)}_pan(e,t){const r=this.domElement;if(this.object.isPerspectiveCamera){const i=this.object.position;qn.copy(i).sub(this.target);let s=qn.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/r.clientHeight,this.object.matrix),this._panUp(2*t*s/r.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix)):this.enablePan=!1}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:this.enableZoom=!1}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:this.enableZoom=!1}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const r=this.domElement.getBoundingClientRect(),i=e-r.left,s=t-r.top,o=r.width,a=r.height;this._mouse.x=i/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Nr*this._rotateDelta.x/t.clientHeight),this._rotateUp(Nr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Nr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Nr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Nr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Nr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateStart.set(r,i)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panStart.set(r,i)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y,s=Math.sqrt(r*r+i*i);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const r=this._getSecondPointerPosition(e),i=.5*(e.pageX+r.x),s=.5*(e.pageY+r.y);this._rotateEnd.set(i,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Nr*this._rotateDelta.x/t.clientHeight),this._rotateUp(Nr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panEnd.set(r,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y,s=Math.sqrt(r*r+i*i);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new ht,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(r.deltaY*=10),r}}function KW(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function ZW(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function JW(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Q5),this.state=Yt.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function eQ(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case di.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=Yt.DOLLY;break;case di.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Yt.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Yt.ROTATE}break;case di.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Yt.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Yt.PAN}break;default:this.state=Yt.NONE}this.state!==Yt.NONE&&this.dispatchEvent(C2)}function tQ(n){switch(this.state){case Yt.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case Yt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case Yt.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function nQ(n){this.enabled===!1||this.enableZoom===!1||this.state!==Yt.NONE||(n.preventDefault(),this.dispatchEvent(C2),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(Q5))}function rQ(n){this.enabled!==!1&&this._handleKeyDown(n)}function iQ(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case dl.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=Yt.TOUCH_ROTATE;break;case dl.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=Yt.TOUCH_PAN;break;default:this.state=Yt.NONE}break;case 2:switch(this.touches.TWO){case dl.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=Yt.TOUCH_DOLLY_PAN;break;case dl.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=Yt.TOUCH_DOLLY_ROTATE;break;default:this.state=Yt.NONE}break;default:this.state=Yt.NONE}this.state!==Yt.NONE&&this.dispatchEvent(C2)}function sQ(n){switch(this._trackPointer(n),this.state){case Yt.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case Yt.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case Yt.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case Yt.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=Yt.NONE}}function oQ(n){this.enabled!==!1&&n.preventDefault()}function aQ(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function lQ(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const uQ={type:"change"},ob=1e-6,ab=new Ml;class AQ extends Og{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new we(0,0,0),this._rotationVector=new we(0,0,0),this._lastQuaternion=new Ml,this._lastPosition=new we,this._status=0,this._onKeyDown=cQ.bind(this),this._onKeyUp=hQ.bind(this),this._onPointerMove=dQ.bind(this),this._onPointerDown=fQ.bind(this),this._onPointerUp=pQ.bind(this),this._onPointerCancel=mQ.bind(this),this._onContextMenu=gQ.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const t=this.object,r=e*this.movementSpeed,i=e*this.rollSpeed;t.translateX(this._moveVector.x*r),t.translateY(this._moveVector.y*r),t.translateZ(this._moveVector.z*r),ab.set(this._rotationVector.x*i,this._rotationVector.y*i,this._rotationVector.z*i,1).normalize(),t.quaternion.multiply(ab),(this._lastPosition.distanceToSquared(t.position)>ob||8*(1-this._lastQuaternion.dot(t.quaternion))>ob)&&(this.dispatchEvent(uQ),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function cQ(n){if(!(n.altKey||this.enabled===!1)){switch(n.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function hQ(n){if(this.enabled!==!1){switch(n.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function fQ(n){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(n.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function dQ(n){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),t=e.size[0]/2,r=e.size[1]/2;this._moveState.yawLeft=-(n.pageX-e.offset[0]-t)/t,this._moveState.pitchDown=(n.pageY-e.offset[1]-r)/r,this._updateRotationVector()}}function pQ(n){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(n.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function mQ(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function gQ(n){this.enabled!==!1&&n.preventDefault()}const yQ={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Nf{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){}dispose(){}}const _Q=new mg(-1,1,1,-1,0,1);class vQ extends Zr{constructor(){super(),this.setAttribute("position",new fs([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fs([0,2,0,0,2,0],2))}}const bQ=new vQ;class xQ{constructor(e){this._mesh=new hn(bQ,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,_Q)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class TQ extends Nf{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof Ll?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Dg.clone(e.uniforms),this.material=new Ll({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new xQ(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class lb extends Nf{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class wQ extends Nf{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class SQ{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const r=e.getSize(new ht);this._width=r.width,this._height=r.height,t=new hN(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:wr}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new TQ(yQ),this.copyPass.material.blending=Bl,this.clock=new ax}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,s=this.passes.length;i<s;i++){const o=this.passes[i];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}lb!==void 0&&(o instanceof lb?r=!0:o instanceof wQ&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new ht);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class EQ extends Nf{constructor(e,t,r=null,i=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Gn}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=i}}function RQ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function MA(n,e){return MA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},MA(n,e)}function NQ(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,MA(n,e)}function rg(n){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rg(n)}function CQ(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function X5(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X5=function(){return!!n})()}function MQ(n,e,t){if(X5())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(n.bind.apply(n,r));return t&&MA(i,t.prototype),i}function ig(n){var e=typeof Map=="function"?new Map:void 0;return ig=function(r){if(r===null||!CQ(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,i)}function i(){return MQ(r,arguments,rg(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),MA(i,r)},ig(n)}var is=(function(n){NQ(e,n);function e(t){var r;return r=n.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,RQ(r)}return e})(ig(Error));function dp(n){return Math.round(n*255)}function PQ(n,e,t){return dp(n)+","+dp(e)+","+dp(t)}function Bh(n,e,t,r){if(r===void 0&&(r=PQ),e===0)return r(t,t,t);var i=(n%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,o=s*(1-Math.abs(i%2-1)),a=0,c=0,f=0;i>=0&&i<1?(a=s,c=o):i>=1&&i<2?(a=o,c=s):i>=2&&i<3?(c=s,f=o):i>=3&&i<4?(c=o,f=s):i>=4&&i<5?(a=o,f=s):i>=5&&i<6&&(a=s,f=o);var p=t-s/2,g=a+p,v=c+p,x=f+p;return r(g,v,x)}var ub={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function BQ(n){if(typeof n!="string")return n;var e=n.toLowerCase();return ub[e]?"#"+ub[e]:n}var DQ=/^#[a-fA-F0-9]{6}$/,LQ=/^#[a-fA-F0-9]{8}$/,OQ=/^#[a-fA-F0-9]{3}$/,FQ=/^#[a-fA-F0-9]{4}$/,pp=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,IQ=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,kQ=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,qQ=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Ql(n){if(typeof n!="string")throw new is(3);var e=BQ(n);if(e.match(DQ))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(LQ)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(OQ))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(FQ)){var r=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:r}}var i=pp.exec(e);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var s=IQ.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=kQ.exec(e);if(o){var a=parseInt(""+o[1],10),c=parseInt(""+o[2],10)/100,f=parseInt(""+o[3],10)/100,p="rgb("+Bh(a,c,f)+")",g=pp.exec(p);if(!g)throw new is(4,e,p);return{red:parseInt(""+g[1],10),green:parseInt(""+g[2],10),blue:parseInt(""+g[3],10)}}var v=qQ.exec(e.substring(0,50));if(v){var x=parseInt(""+v[1],10),T=parseInt(""+v[2],10)/100,S=parseInt(""+v[3],10)/100,R="rgb("+Bh(x,T,S)+")",C=pp.exec(R);if(!C)throw new is(4,e,R);return{red:parseInt(""+C[1],10),green:parseInt(""+C[2],10),blue:parseInt(""+C[3],10),alpha:parseFloat(""+v[4])>1?parseFloat(""+v[4])/100:parseFloat(""+v[4])}}throw new is(5)}function UQ(n){var e=n.red/255,t=n.green/255,r=n.blue/255,i=Math.max(e,t,r),s=Math.min(e,t,r),o=(i+s)/2;if(i===s)return n.alpha!==void 0?{hue:0,saturation:0,lightness:o,alpha:n.alpha}:{hue:0,saturation:0,lightness:o};var a,c=i-s,f=o>.5?c/(2-i-s):c/(i+s);switch(i){case e:a=(t-r)/c+(t<r?6:0);break;case t:a=(r-e)/c+2;break;default:a=(e-t)/c+4;break}return a*=60,n.alpha!==void 0?{hue:a,saturation:f,lightness:o,alpha:n.alpha}:{hue:a,saturation:f,lightness:o}}function qo(n){return UQ(Ql(n))}var GQ=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},sg=GQ;function oa(n){var e=n.toString(16);return e.length===1?"0"+e:e}function mp(n){return oa(Math.round(n*255))}function VQ(n,e,t){return sg("#"+mp(n)+mp(e)+mp(t))}function Y5(n,e,t){return Bh(n,e,t,VQ)}function zQ(n,e,t){if(typeof n=="object"&&e===void 0&&t===void 0)return Y5(n.hue,n.saturation,n.lightness);throw new is(1)}function jQ(n,e,t,r){if(typeof n=="object"&&e===void 0&&t===void 0&&r===void 0)return n.alpha>=1?Y5(n.hue,n.saturation,n.lightness):"rgba("+Bh(n.hue,n.saturation,n.lightness)+","+n.alpha+")";throw new is(2)}function K5(n,e,t){if(typeof n=="number"&&typeof e=="number"&&typeof t=="number")return sg("#"+oa(n)+oa(e)+oa(t));if(typeof n=="object"&&e===void 0&&t===void 0)return sg("#"+oa(n.red)+oa(n.green)+oa(n.blue));throw new is(6)}function Cf(n,e,t,r){if(typeof n=="object"&&e===void 0&&t===void 0&&r===void 0)return n.alpha>=1?K5(n.red,n.green,n.blue):"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")";throw new is(7)}var $Q=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},HQ=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},WQ=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},QQ=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function Uo(n){if(typeof n!="object")throw new is(8);if(HQ(n))return Cf(n);if($Q(n))return K5(n);if(QQ(n))return jQ(n);if(WQ(n))return zQ(n);throw new is(8)}function Z5(n,e,t){return function(){var i=t.concat(Array.prototype.slice.call(arguments));return i.length>=e?n.apply(this,i):Z5(n,e,i)}}function Jr(n){return Z5(n,n.length,[])}function XQ(n,e){if(e==="transparent")return e;var t=qo(e);return Uo(mi({},t,{hue:t.hue+parseFloat(n)}))}Jr(XQ);function ru(n,e,t){return Math.max(n,Math.min(e,t))}function YQ(n,e){if(e==="transparent")return e;var t=qo(e);return Uo(mi({},t,{lightness:ru(0,1,t.lightness-parseFloat(n))}))}Jr(YQ);function KQ(n,e){if(e==="transparent")return e;var t=qo(e);return Uo(mi({},t,{saturation:ru(0,1,t.saturation-parseFloat(n))}))}Jr(KQ);function ZQ(n,e){if(e==="transparent")return e;var t=qo(e);return Uo(mi({},t,{lightness:ru(0,1,t.lightness+parseFloat(n))}))}Jr(ZQ);function JQ(n,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(n===0)return t;var r=Ql(e),i=mi({},r,{alpha:typeof r.alpha=="number"?r.alpha:1}),s=Ql(t),o=mi({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),a=i.alpha-o.alpha,c=parseFloat(n)*2-1,f=c*a===-1?c:c+a,p=1+c*a,g=(f/p+1)/2,v=1-g,x={red:Math.floor(i.red*g+o.red*v),green:Math.floor(i.green*g+o.green*v),blue:Math.floor(i.blue*g+o.blue*v),alpha:i.alpha*parseFloat(n)+o.alpha*(1-parseFloat(n))};return Cf(x)}var eX=Jr(JQ),J5=eX;function tX(n,e){if(e==="transparent")return e;var t=Ql(e),r=typeof t.alpha=="number"?t.alpha:1,i=mi({},t,{alpha:ru(0,1,(r*100+parseFloat(n)*100)/100)});return Cf(i)}var nX=Jr(tX),rX=nX;function iX(n,e){if(e==="transparent")return e;var t=qo(e);return Uo(mi({},t,{saturation:ru(0,1,t.saturation+parseFloat(n))}))}Jr(iX);function sX(n,e){return e==="transparent"?e:Uo(mi({},qo(e),{hue:parseFloat(n)}))}Jr(sX);function oX(n,e){return e==="transparent"?e:Uo(mi({},qo(e),{lightness:parseFloat(n)}))}Jr(oX);function aX(n,e){return e==="transparent"?e:Uo(mi({},qo(e),{saturation:parseFloat(n)}))}Jr(aX);function lX(n,e){return e==="transparent"?e:J5(parseFloat(n),"rgb(0, 0, 0)",e)}Jr(lX);function uX(n,e){return e==="transparent"?e:J5(parseFloat(n),"rgb(255, 255, 255)",e)}Jr(uX);function AX(n,e){if(e==="transparent")return e;var t=Ql(e),r=typeof t.alpha=="number"?t.alpha:1,i=mi({},t,{alpha:ru(0,1,+(r*100-parseFloat(n)*100).toFixed(2)/100)});return Cf(i)}Jr(AX);var og="http://www.w3.org/1999/xhtml";const Ab={svg:"http://www.w3.org/2000/svg",xhtml:og,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function e7(n){var e=n+="",t=e.indexOf(":");return t>=0&&(e=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),Ab.hasOwnProperty(e)?{space:Ab[e],local:n}:n}function cX(n){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===og&&e.documentElement.namespaceURI===og?e.createElement(n):e.createElementNS(t,n)}}function hX(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function t7(n){var e=e7(n);return(e.local?hX:cX)(e)}function fX(){}function n7(n){return n==null?fX:function(){return this.querySelector(n)}}function dX(n){typeof n!="function"&&(n=n7(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),c,f,p=0;p<o;++p)(c=s[p])&&(f=n.call(c,c.__data__,p,s))&&("__data__"in c&&(f.__data__=c.__data__),a[p]=f);return new xi(r,this._parents)}function pX(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function mX(){return[]}function gX(n){return n==null?mX:function(){return this.querySelectorAll(n)}}function yX(n){return function(){return pX(n.apply(this,arguments))}}function _X(n){typeof n=="function"?n=yX(n):n=gX(n);for(var e=this._groups,t=e.length,r=[],i=[],s=0;s<t;++s)for(var o=e[s],a=o.length,c,f=0;f<a;++f)(c=o[f])&&(r.push(n.call(c,c.__data__,f,o)),i.push(c));return new xi(r,i)}function vX(n){return function(){return this.matches(n)}}function r7(n){return function(e){return e.matches(n)}}var bX=Array.prototype.find;function xX(n){return function(){return bX.call(this.children,n)}}function TX(){return this.firstElementChild}function wX(n){return this.select(n==null?TX:xX(typeof n=="function"?n:r7(n)))}var SX=Array.prototype.filter;function EX(){return Array.from(this.children)}function RX(n){return function(){return SX.call(this.children,n)}}function NX(n){return this.selectAll(n==null?EX:RX(typeof n=="function"?n:r7(n)))}function CX(n){typeof n!="function"&&(n=vX(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=r[i]=[],c,f=0;f<o;++f)(c=s[f])&&n.call(c,c.__data__,f,s)&&a.push(c);return new xi(r,this._parents)}function i7(n){return new Array(n.length)}function MX(){return new xi(this._enter||this._groups.map(i7),this._parents)}function Dh(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}Dh.prototype={constructor:Dh,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function PX(n){return function(){return n}}function BX(n,e,t,r,i,s){for(var o=0,a,c=e.length,f=s.length;o<f;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):t[o]=new Dh(n,s[o]);for(;o<c;++o)(a=e[o])&&(i[o]=a)}function DX(n,e,t,r,i,s,o){var a,c,f=new Map,p=e.length,g=s.length,v=new Array(p),x;for(a=0;a<p;++a)(c=e[a])&&(v[a]=x=o.call(c,c.__data__,a,e)+"",f.has(x)?i[a]=c:f.set(x,c));for(a=0;a<g;++a)x=o.call(n,s[a],a,s)+"",(c=f.get(x))?(r[a]=c,c.__data__=s[a],f.delete(x)):t[a]=new Dh(n,s[a]);for(a=0;a<p;++a)(c=e[a])&&f.get(v[a])===c&&(i[a]=c)}function LX(n){return n.__data__}function OX(n,e){if(!arguments.length)return Array.from(this,LX);var t=e?DX:BX,r=this._parents,i=this._groups;typeof n!="function"&&(n=PX(n));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),f=0;f<s;++f){var p=r[f],g=i[f],v=g.length,x=FX(n.call(p,p&&p.__data__,f,r)),T=x.length,S=a[f]=new Array(T),R=o[f]=new Array(T),C=c[f]=new Array(v);t(p,g,S,R,C,x,e);for(var B=0,D=0,F,I;B<T;++B)if(F=S[B]){for(B>=D&&(D=B+1);!(I=R[D])&&++D<T;);F._next=I||null}}return o=new xi(o,r),o._enter=a,o._exit=c,o}function FX(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function IX(){return new xi(this._exit||this._groups.map(i7),this._parents)}function kX(n,e,t){var r=this.enter(),i=this,s=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?s.remove():t(s),r&&i?r.merge(i).order():i}function qX(n){for(var e=n.selection?n.selection():n,t=this._groups,r=e._groups,i=t.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var f=t[c],p=r[c],g=f.length,v=a[c]=new Array(g),x,T=0;T<g;++T)(x=f[T]||p[T])&&(v[T]=x);for(;c<i;++c)a[c]=t[c];return new xi(a,this._parents)}function UX(){for(var n=this._groups,e=-1,t=n.length;++e<t;)for(var r=n[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function GX(n){n||(n=VX);function e(g,v){return g&&v?n(g.__data__,v.__data__):!g-!v}for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s){for(var o=t[s],a=o.length,c=i[s]=new Array(a),f,p=0;p<a;++p)(f=o[p])&&(c[p]=f);c.sort(e)}return new xi(i,this._parents).order()}function VX(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function zX(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function jX(){return Array.from(this)}function $X(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function HX(){let n=0;for(const e of this)++n;return n}function WX(){return!this.node()}function QX(n){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,o=i.length,a;s<o;++s)(a=i[s])&&n.call(a,a.__data__,s,i);return this}function XX(n){return function(){this.removeAttribute(n)}}function YX(n){return function(){this.removeAttributeNS(n.space,n.local)}}function KX(n,e){return function(){this.setAttribute(n,e)}}function ZX(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function JX(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}}function eY(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function tY(n,e){var t=e7(n);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((e==null?t.local?YX:XX:typeof e=="function"?t.local?eY:JX:t.local?ZX:KX)(t,e))}function s7(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function nY(n){return function(){this.style.removeProperty(n)}}function rY(n,e,t){return function(){this.style.setProperty(n,e,t)}}function iY(n,e,t){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,t)}}function sY(n,e,t){return arguments.length>1?this.each((e==null?nY:typeof e=="function"?iY:rY)(n,e,t??"")):oY(this.node(),n)}function oY(n,e){return n.style.getPropertyValue(e)||s7(n).getComputedStyle(n,null).getPropertyValue(e)}function aY(n){return function(){delete this[n]}}function lY(n,e){return function(){this[n]=e}}function uY(n,e){return function(){var t=e.apply(this,arguments);t==null?delete this[n]:this[n]=t}}function AY(n,e){return arguments.length>1?this.each((e==null?aY:typeof e=="function"?uY:lY)(n,e)):this.node()[n]}function o7(n){return n.trim().split(/^|\s+/)}function M2(n){return n.classList||new a7(n)}function a7(n){this._node=n,this._names=o7(n.getAttribute("class")||"")}a7.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function l7(n,e){for(var t=M2(n),r=-1,i=e.length;++r<i;)t.add(e[r])}function u7(n,e){for(var t=M2(n),r=-1,i=e.length;++r<i;)t.remove(e[r])}function cY(n){return function(){l7(this,n)}}function hY(n){return function(){u7(this,n)}}function fY(n,e){return function(){(e.apply(this,arguments)?l7:u7)(this,n)}}function dY(n,e){var t=o7(n+"");if(arguments.length<2){for(var r=M2(this.node()),i=-1,s=t.length;++i<s;)if(!r.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?fY:e?cY:hY)(t,e))}function pY(){this.textContent=""}function mY(n){return function(){this.textContent=n}}function gY(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function yY(n){return arguments.length?this.each(n==null?pY:(typeof n=="function"?gY:mY)(n)):this.node().textContent}function _Y(){this.innerHTML=""}function vY(n){return function(){this.innerHTML=n}}function bY(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function xY(n){return arguments.length?this.each(n==null?_Y:(typeof n=="function"?bY:vY)(n)):this.node().innerHTML}function TY(){this.nextSibling&&this.parentNode.appendChild(this)}function wY(){return this.each(TY)}function SY(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function EY(){return this.each(SY)}function RY(n){var e=typeof n=="function"?n:t7(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function NY(){return null}function CY(n,e){var t=typeof n=="function"?n:t7(n),r=e==null?NY:typeof e=="function"?e:n7(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function MY(){var n=this.parentNode;n&&n.removeChild(this)}function PY(){return this.each(MY)}function BY(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function DY(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function LY(n){return this.select(n?DY:BY)}function OY(n){return arguments.length?this.property("__data__",n):this.node().__data__}function FY(n){return function(e){n.call(this,e,this.__data__)}}function IY(n){return n.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}function kY(n){return function(){var e=this.__on;if(e){for(var t=0,r=-1,i=e.length,s;t<i;++t)s=e[t],(!n.type||s.type===n.type)&&s.name===n.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function qY(n,e,t){return function(){var r=this.__on,i,s=FY(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=t),i.value=e;return}}this.addEventListener(n.type,s,t),i={type:n.type,name:n.name,value:e,listener:s,options:t},r?r.push(i):this.__on=[i]}}function UY(n,e,t){var r=IY(n+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,f=a.length,p;c<f;++c)for(i=0,p=a[c];i<s;++i)if((o=r[i]).type===p.type&&o.name===p.name)return p.value}return}for(a=e?qY:kY,i=0;i<s;++i)this.each(a(r[i],e,t));return this}function A7(n,e,t){var r=s7(n),i=r.CustomEvent;typeof i=="function"?i=new i(e,t):(i=r.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),n.dispatchEvent(i)}function GY(n,e){return function(){return A7(this,n,e)}}function VY(n,e){return function(){return A7(this,n,e.apply(this,arguments))}}function zY(n,e){return this.each((typeof e=="function"?VY:GY)(n,e))}function*jY(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var $Y=[null];function xi(n,e){this._groups=n,this._parents=e}function HY(){return this}xi.prototype={constructor:xi,select:dX,selectAll:_X,selectChild:wX,selectChildren:NX,filter:CX,data:OX,enter:MX,exit:IX,join:kX,merge:qX,selection:HY,order:UX,sort:GX,call:zX,nodes:jX,node:$X,size:HX,empty:WX,each:QX,attr:tY,style:sY,property:AY,classed:dY,text:yY,html:xY,raise:wY,lower:EY,append:RY,insert:CY,remove:PY,clone:LY,datum:OY,on:UY,dispatch:zY,[Symbol.iterator]:jY};function WY(n){return typeof n=="string"?new xi([[document.querySelector(n)]],[document.documentElement]):new xi([[n]],$Y)}function QY(n){let e;for(;e=n.sourceEvent;)n=e;return n}function XY(n,e){if(n=QY(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var r=t.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop]}}return[n.pageX,n.pageY]}var YA,cn,c7,h7,ua,cb,f7,d7,p7,P2,ag,lg,PA={},m7=[],YY=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Mf=Array.isArray;function ss(n,e){for(var t in e)n[t]=e[t];return n}function B2(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function KY(n,e,t){var r,i,s,o={};for(s in e)s=="key"?r=e[s]:s=="ref"?i=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?YA.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(s in n.defaultProps)o[s]===void 0&&(o[s]=n.defaultProps[s]);return sA(n,o,r,i,null)}function sA(n,e,t,r,i){var s={type:n,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++c7,__i:-1,__u:0};return i==null&&cn.vnode!=null&&cn.vnode(s),s}function Pf(n){return n.children}function C0(n,e){this.props=n,this.context=e}function Xl(n,e){if(e==null)return n.__?Xl(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?Xl(n):null}function g7(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return g7(n)}}function hb(n){(!n.__d&&(n.__d=!0)&&ua.push(n)&&!Lh.__r++||cb!=cn.debounceRendering)&&((cb=cn.debounceRendering)||f7)(Lh)}function Lh(){for(var n,e,t,r,i,s,o,a=1;ua.length;)ua.length>a&&ua.sort(d7),n=ua.shift(),a=ua.length,n.__d&&(t=void 0,r=void 0,i=(r=(e=n).__v).__e,s=[],o=[],e.__P&&((t=ss({},r)).__v=r.__v+1,cn.vnode&&cn.vnode(t),D2(e.__P,t,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,s,i??Xl(r),!!(32&r.__u),o),t.__v=r.__v,t.__.__k[t.__i]=t,v7(s,t,o),r.__e=r.__=null,t.__e!=i&&g7(t)));Lh.__r=0}function y7(n,e,t,r,i,s,o,a,c,f,p){var g,v,x,T,S,R,C,B=r&&r.__k||m7,D=e.length;for(c=ZY(t,e,B,c,D),g=0;g<D;g++)(x=t.__k[g])!=null&&(v=x.__i==-1?PA:B[x.__i]||PA,x.__i=g,R=D2(n,x,v,i,s,o,a,c,f,p),T=x.__e,x.ref&&v.ref!=x.ref&&(v.ref&&L2(v.ref,null,x),p.push(x.ref,x.__c||T,x)),S==null&&T!=null&&(S=T),(C=!!(4&x.__u))||v.__k===x.__k?c=_7(x,c,n,C):typeof x.type=="function"&&R!==void 0?c=R:T&&(c=T.nextSibling),x.__u&=-7);return t.__e=S,c}function ZY(n,e,t,r,i){var s,o,a,c,f,p=t.length,g=p,v=0;for(n.__k=new Array(i),s=0;s<i;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(c=s+v,(o=n.__k[s]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?sA(null,o,null,null,null):Mf(o)?sA(Pf,{children:o},null,null,null):o.constructor==null&&o.__b>0?sA(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,a=null,(f=o.__i=JY(o,t,c,g))!=-1&&(g--,(a=t[f])&&(a.__u|=2)),a==null||a.__v==null?(f==-1&&(i>p?v--:i<p&&v++),typeof o.type!="function"&&(o.__u|=4)):f!=c&&(f==c-1?v--:f==c+1?v++:(f>c?v--:v++,o.__u|=4))):n.__k[s]=null;if(g)for(s=0;s<p;s++)(a=t[s])!=null&&(2&a.__u)==0&&(a.__e==r&&(r=Xl(a)),x7(a,a));return r}function _7(n,e,t,r){var i,s;if(typeof n.type=="function"){for(i=n.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=n,e=_7(i[s],e,t,r));return e}n.__e!=e&&(r&&(e&&n.type&&!e.parentNode&&(e=Xl(n)),t.insertBefore(n.__e,e||null)),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function JY(n,e,t,r){var i,s,o,a=n.key,c=n.type,f=e[t],p=f!=null&&(2&f.__u)==0;if(f===null&&n.key==null||p&&a==f.key&&c==f.type)return t;if(r>(p?1:0)){for(i=t-1,s=t+1;i>=0||s<e.length;)if((f=e[o=i>=0?i--:s++])!=null&&(2&f.__u)==0&&a==f.key&&c==f.type)return o}return-1}function fb(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||YY.test(e)?t:t+"px"}function s0(n,e,t,r,i){var s,o;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(e in r)t&&e in t||fb(n.style,e,"");if(t)for(e in t)r&&t[e]==r[e]||fb(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(p7,"$1")),o=e.toLowerCase(),e=o in n||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),n.l||(n.l={}),n.l[e+s]=t,t?r?t.u=r.u:(t.u=P2,n.addEventListener(e,s?lg:ag,s)):n.removeEventListener(e,s?lg:ag,s);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function db(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=P2++;else if(e.t<t.u)return;return t(cn.event?cn.event(e):e)}}}function D2(n,e,t,r,i,s,o,a,c,f){var p,g,v,x,T,S,R,C,B,D,F,I,q,k,G,j,ee,Q=e.type;if(e.constructor!=null)return null;128&t.__u&&(c=!!(32&t.__u),s=[a=e.__e=t.__e]),(p=cn.__b)&&p(e);e:if(typeof Q=="function")try{if(C=e.props,B="prototype"in Q&&Q.prototype.render,D=(p=Q.contextType)&&r[p.__c],F=p?D?D.props.value:p.__:r,t.__c?R=(g=e.__c=t.__c).__=g.__E:(B?e.__c=g=new Q(C,F):(e.__c=g=new C0(C,F),g.constructor=Q,g.render=tK),D&&D.sub(g),g.props=C,g.state||(g.state={}),g.context=F,g.__n=r,v=g.__d=!0,g.__h=[],g._sb=[]),B&&g.__s==null&&(g.__s=g.state),B&&Q.getDerivedStateFromProps!=null&&(g.__s==g.state&&(g.__s=ss({},g.__s)),ss(g.__s,Q.getDerivedStateFromProps(C,g.__s))),x=g.props,T=g.state,g.__v=e,v)B&&Q.getDerivedStateFromProps==null&&g.componentWillMount!=null&&g.componentWillMount(),B&&g.componentDidMount!=null&&g.__h.push(g.componentDidMount);else{if(B&&Q.getDerivedStateFromProps==null&&C!==x&&g.componentWillReceiveProps!=null&&g.componentWillReceiveProps(C,F),!g.__e&&g.shouldComponentUpdate!=null&&g.shouldComponentUpdate(C,g.__s,F)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(g.props=C,g.state=g.__s,g.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Y){Y&&(Y.__=e)}),I=0;I<g._sb.length;I++)g.__h.push(g._sb[I]);g._sb=[],g.__h.length&&o.push(g);break e}g.componentWillUpdate!=null&&g.componentWillUpdate(C,g.__s,F),B&&g.componentDidUpdate!=null&&g.__h.push(function(){g.componentDidUpdate(x,T,S)})}if(g.context=F,g.props=C,g.__P=n,g.__e=!1,q=cn.__r,k=0,B){for(g.state=g.__s,g.__d=!1,q&&q(e),p=g.render(g.props,g.state,g.context),G=0;G<g._sb.length;G++)g.__h.push(g._sb[G]);g._sb=[]}else do g.__d=!1,q&&q(e),p=g.render(g.props,g.state,g.context),g.state=g.__s;while(g.__d&&++k<25);g.state=g.__s,g.getChildContext!=null&&(r=ss(ss({},r),g.getChildContext())),B&&!v&&g.getSnapshotBeforeUpdate!=null&&(S=g.getSnapshotBeforeUpdate(x,T)),j=p,p!=null&&p.type===Pf&&p.key==null&&(j=b7(p.props.children)),a=y7(n,Mf(j)?j:[j],e,t,r,i,s,o,a,c,f),g.base=e.__e,e.__u&=-161,g.__h.length&&o.push(g),R&&(g.__E=g.__=null)}catch(Y){if(e.__v=null,c||s!=null)if(Y.then){for(e.__u|=c?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(ee=s.length;ee--;)B2(s[ee]);ug(e)}else e.__e=t.__e,e.__k=t.__k,Y.then||ug(e);cn.__e(Y,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=eK(t.__e,e,t,r,i,s,o,c,f);return(p=cn.diffed)&&p(e),128&e.__u?void 0:a}function ug(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(ug)}function v7(n,e,t){for(var r=0;r<t.length;r++)L2(t[r],t[++r],t[++r]);cn.__c&&cn.__c(e,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(s){s.call(i)})}catch(s){cn.__e(s,i.__v)}})}function b7(n){return typeof n!="object"||n==null||n.__b&&n.__b>0?n:Mf(n)?n.map(b7):ss({},n)}function eK(n,e,t,r,i,s,o,a,c){var f,p,g,v,x,T,S,R=t.props,C=e.props,B=e.type;if(B=="svg"?i="http://www.w3.org/2000/svg":B=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),s!=null){for(f=0;f<s.length;f++)if((x=s[f])&&"setAttribute"in x==!!B&&(B?x.localName==B:x.nodeType==3)){n=x,s[f]=null;break}}if(n==null){if(B==null)return document.createTextNode(C);n=document.createElementNS(i,B,C.is&&C),a&&(cn.__m&&cn.__m(e,s),a=!1),s=null}if(B==null)R===C||a&&n.data==C||(n.data=C);else{if(s=s&&YA.call(n.childNodes),R=t.props||PA,!a&&s!=null)for(R={},f=0;f<n.attributes.length;f++)R[(x=n.attributes[f]).name]=x.value;for(f in R)if(x=R[f],f!="children"){if(f=="dangerouslySetInnerHTML")g=x;else if(!(f in C)){if(f=="value"&&"defaultValue"in C||f=="checked"&&"defaultChecked"in C)continue;s0(n,f,null,x,i)}}for(f in C)x=C[f],f=="children"?v=x:f=="dangerouslySetInnerHTML"?p=x:f=="value"?T=x:f=="checked"?S=x:a&&typeof x!="function"||R[f]===x||s0(n,f,x,R[f],i);if(p)a||g&&(p.__html==g.__html||p.__html==n.innerHTML)||(n.innerHTML=p.__html),e.__k=[];else if(g&&(n.innerHTML=""),y7(e.type=="template"?n.content:n,Mf(v)?v:[v],e,t,r,B=="foreignObject"?"http://www.w3.org/1999/xhtml":i,s,o,s?s[0]:t.__k&&Xl(t,0),a,c),s!=null)for(f=s.length;f--;)B2(s[f]);a||(f="value",B=="progress"&&T==null?n.removeAttribute("value"):T!=null&&(T!==n[f]||B=="progress"&&!T||B=="option"&&T!=R[f])&&s0(n,f,T,R[f],i),f="checked",S!=null&&S!=n[f]&&s0(n,f,S,R[f],i))}return n}function L2(n,e,t){try{if(typeof n=="function"){var r=typeof n.__u=="function";r&&n.__u(),r&&e==null||(n.__u=n(e))}else n.current=e}catch(i){cn.__e(i,t)}}function x7(n,e,t){var r,i;if(cn.unmount&&cn.unmount(n),(r=n.ref)&&(r.current&&r.current!=n.__e||L2(r,null,e)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){cn.__e(s,e)}r.base=r.__P=null}if(r=n.__k)for(i=0;i<r.length;i++)r[i]&&x7(r[i],e,t||typeof n.type!="function");t||B2(n.__e),n.__c=n.__=n.__e=void 0}function tK(n,e,t){return this.constructor(n,t)}function nK(n,e,t){var r,i,s,o;e==document&&(e=document.documentElement),cn.__&&cn.__(n,e),i=(r=!1)?null:e.__k,s=[],o=[],D2(e,n=e.__k=KY(Pf,null,[n]),i||PA,PA,e.namespaceURI,i?null:e.firstChild?YA.call(e.childNodes):null,s,i?i.__e:e.firstChild,r,o),v7(s,n,o)}function T7(n,e,t){var r,i,s,o,a=ss({},n.props);for(s in n.type&&n.type.defaultProps&&(o=n.type.defaultProps),e)s=="key"?r=e[s]:s=="ref"?i=e[s]:a[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(a.children=arguments.length>3?YA.call(arguments,2):t),sA(n.type,a,r||n.key,i||n.ref,null)}YA=m7.slice,cn={__e:function(n,e,t,r){for(var i,s,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((s=i.constructor)&&s.getDerivedStateFromError!=null&&(i.setState(s.getDerivedStateFromError(n)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,r||{}),o=i.__d),o)return i.__E=i}catch(a){n=a}throw n}},c7=0,h7=function(n){return n!=null&&n.constructor==null},C0.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ss({},this.state),typeof n=="function"&&(n=n(ss({},t),this.props)),n&&ss(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),hb(this))},C0.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),hb(this))},C0.prototype.render=Pf,ua=[],f7=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,d7=function(n,e){return n.__v.__b-e.__v.__b},Lh.__r=0,p7=/(PointerCapture)$|Capture$/i,P2=0,ag=db(!1),lg=db(!0);function pb(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function rK(n){if(Array.isArray(n))return n}function iK(n,e,t){return(e=AK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sK(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function oK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mb(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function aK(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mb(Object(t),!0).forEach(function(r){iK(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):mb(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function lK(n,e){return rK(n)||sK(n,e)||cK(n,e)||oK()}function uK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function AK(n){var e=uK(n,"string");return typeof e=="symbol"?e:e+""}function Oh(n){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(n)}function cK(n,e){if(n){if(typeof n=="string")return pb(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?pb(n,e):void 0}}var Ag=function(e){if(Oh(e)!=="object")return e;var t=T7(e);if(t.props){var r;t.props=aK({},t.props),t!=null&&(r=t.props)!==null&&r!==void 0&&r.children&&(t.props.children=Array.isArray(t.props.children)?t.props.children.map(Ag):Ag(t.props.children))}return t},hK=function(e){return h7(T7(e))},fK=function(e,t){delete t.__k,nK(Ag(e),t)};function dK(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}var pK=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;dK(pK);var mK=Vn({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.style,s=i===void 0?{}:i,o=!!e&&Oh(e)==="object"&&!!e.node&&typeof e.node=="function",a=WY(o?e.node():e);a.style("position")==="static"&&a.style("position","relative"),t.tooltipEl=a.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(f){var p=lK(f,2),g=p[0],v=p[1];return t.tooltipEl.style(g,v)}),t.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));t.mouseInside=!1,a.on("mousemove.".concat(c),function(f){t.mouseInside=!0;var p=XY(f),g=a.node(),v=g.offsetWidth,x=g.offsetHeight,T=[t.offsetX===null||t.offsetX===void 0?"-".concat(p[0]/v*100,"%"):typeof t.offsetX=="number"?"calc(-50% + ".concat(t.offsetX,"px)"):t.offsetX,t.offsetY===null||t.offsetY===void 0?x>130&&x-p[1]<100?"calc(-100% - 6px)":"21px":typeof t.offsetY=="number"?t.offsetY<0?"calc(-100% - ".concat(Math.abs(t.offsetY),"px)"):"".concat(t.offsetY,"px"):t.offsetY];t.tooltipEl.style("left",p[0]+"px").style("top",p[1]+"px").style("transform","translate(".concat(T.join(","),")")),t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseover.".concat(c),function(){t.mouseInside=!0,t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseout.".concat(c),function(){t.mouseInside=!1,t.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):hK(e.content)?(e.tooltipEl.text(""),fK(e.content,e.tooltipEl.node())):e.tooltipEl.style("display","none"):e.tooltipEl.text("")}});function gK(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}var yK=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;gK(yK);function cg(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function _K(n){if(Array.isArray(n))return n}function vK(n){if(Array.isArray(n))return cg(n)}function bK(n,e,t){return(e=NK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xK(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function TK(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,f=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(p){f=!0,i=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(f)throw i}}return a}}function wK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EK(n,e){return _K(n)||TK(n,e)||w7(n,e)||wK()}function ra(n){return vK(n)||xK(n)||w7(n)||SK()}function RK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function NK(n){var e=RK(n,"string");return typeof e=="symbol"?e:e+""}function w7(n,e){if(n){if(typeof n=="string")return cg(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cg(n,e):void 0}}var un=window.THREE?window.THREE:{WebGLRenderer:fN,Scene:Ih,PerspectiveCamera:oA,Raycaster:dN,SRGBColorSpace:BA,TextureLoader:dg,Vector2:ht,Vector3:we,Box3:Gh,Color:Gn,Mesh:hn,SphereGeometry:Bo,MeshBasicMaterial:ts,BackSide:hr,Clock:ax},S7=Vn({props:{width:{default:window.innerWidth,onChange:function(e,t,r){isNaN(e)&&(t.width=r)}},height:{default:window.innerHeight,onChange:function(e,t,r){isNaN(e)&&(t.height=r)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.tooltip&&t.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(o){return o.render(e.scene,e.camera)});var t=+new Date;if(e.enablePointerInteraction&&t-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=t;var r=null;if(e.hoverDuringDrag||!e.isPointerDragging){var i=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&i.sort(function(o,a){return e.hoverOrderComparator(o.object,a.object)});var s=i.find(function(o){return e.hoverFilter(o.object)})||null;r=s?s.object:null,e.intersection=s||null}r!==e.hoverObj&&(e.onHover(r,e.hoverObj,e.intersection),e.tooltip.content(r&&ve(e.tooltipContent)(r,e.intersection)||null),e.hoverObj=r)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos,r=t.x,i=t.y;return{x:r,y:i}},cameraPosition:function(e,t,r,i){var s=e.camera;if(t&&e.initialised){var o=t,a=r||{x:0,y:0,z:0};if(!i)p(o),g(a);else{var c=Object.assign({},s.position),f=v();e.tweenGroup.add(new dr(c).to(o,i).easing(On.Quadratic.Out).onUpdate(p).start()),e.tweenGroup.add(new dr(f).to(a,i/3).easing(On.Quadratic.Out).onUpdate(g).start())}return this}return Object.assign({},s.position,{lookAt:v()});function p(x){var T=x.x,S=x.y,R=x.z;T!==void 0&&(s.position.x=T),S!==void 0&&(s.position.y=S),R!==void 0&&(s.position.z=R)}function g(x){var T=new un.Vector3(x.x,x.y,x.z);e.controls.enabled&&e.controls.target?e.controls.target=T:s.lookAt(T)}function v(){return Object.assign(new un.Vector3(0,0,-1e3).applyQuaternion(s.quaternion).add(s.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,i=arguments.length,s=new Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,s),t,r)},fitToBbox:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,s=e.camera;if(t){var o=new un.Vector3(0,0,0),a=Math.max.apply(Math,ra(Object.entries(t).map(function(x){var T=EK(x,2),S=T[0],R=T[1];return Math.max.apply(Math,ra(R.map(function(C){return Math.abs(o[S]-C)})))})))*2,c=(1-i*2/e.height)*s.fov,f=a/Math.atan(c*Math.PI/180),p=f/s.aspect,g=Math.max(f,p);if(g>0){var v=o.clone().sub(s.position).normalize().multiplyScalar(-g);this.cameraPosition(v,o,r)}}return this},getBbox:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},r=new un.Box3(new un.Vector3(0,0,0),new un.Vector3(0,0,0)),i=e.objects.filter(t);return i.length?(i.forEach(function(s){return r.expandByObject(s)}),Object.assign.apply(Object,ra(["x","y","z"].map(function(s){return bK({},s,[r.min[s],r.max[s]])})))):null},getScreenCoords:function(e,t,r,i){var s=new un.Vector3(t,r,i);return s.project(this.camera()),{x:(s.x+1)*e.width/2,y:-(s.y-1)*e.height/2}},getSceneCoords:function(e,t,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=new un.Vector2(t/e.width*2-1,-(r/e.height)*2+1),o=new un.Raycaster;return o.setFromCamera(s,e.camera),Object.assign({},o.ray.at(i,new un.Vector3))},intersectingObjects:function(e,t,r){var i=new un.Vector2(t/e.width*2-1,-(r/e.height)*2+1),s=new un.Raycaster;return s.params.Line.threshold=e.lineHoverPrecision,s.params.Points.threshold=e.pointsHoverPrecision,s.setFromCamera(i,e.camera),s.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new un.Scene,camera:new un.PerspectiveCamera,clock:new un.Clock,tweenGroup:new Vh,lastRaycasterCheck:0}},init:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.controlType,s=i===void 0?"trackball":i,o=r.useWebGPU,a=o===void 0?!1:o,c=r.rendererConfig,f=c===void 0?{}:c,p=r.extraRenderers,g=p===void 0?[]:p,v=r.waitForLoadComplete,x=v===void 0?!0:v;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[s]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.tooltip=new mK(t.container),t.pointerPos=new un.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(T){return t.container.addEventListener(T,function(S){if(T==="pointerdown"&&(t.isPointerPressed=!0),!t.isPointerDragging&&S.type==="pointermove"&&(S.pressure>0||t.isPointerPressed)&&(S.pointerType==="mouse"||S.movementX===void 0||[S.movementX,S.movementY].some(function(B){return Math.abs(B)>1}))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var R=C(t.container);t.pointerPos.x=S.pageX-R.left,t.pointerPos.y=S.pageY-R.top}function C(B){var D=B.getBoundingClientRect(),F=window.pageXOffset||document.documentElement.scrollLeft,I=window.pageYOffset||document.documentElement.scrollTop;return{top:D.top+I,left:D.left+F}}},{passive:!0})}),t.container.addEventListener("pointerup",function(T){t.isPointerPressed&&(t.isPointerPressed=!1,!(t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag))&&requestAnimationFrame(function(){T.button===0&&t.onClick(t.hoverObj||null,T,t.intersection),T.button===2&&t.onRightClick&&t.onRightClick(t.hoverObj||null,T,t.intersection)}))},{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",function(T){t.onRightClick&&T.preventDefault()}),t.renderer=new(a?b5:un.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},f)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=g,t.extraRenderers.forEach(function(T){T.domElement.style.position="absolute",T.domElement.style.top="0px",T.domElement.style.pointerEvents="none",t.container.appendChild(T.domElement)}),t.postProcessingComposer=new SQ(t.renderer),t.postProcessingComposer.addPass(new EQ(t.scene,t.camera)),t.controls=new{trackball:LW,orbit:YW,fly:AQ}[s](t.camera,t.renderer.domElement),s==="fly"&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),(s==="trackball"||s==="orbit")&&(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",function(){t.controlsEngaged=!0}),t.controls.addEventListener("change",function(){t.controlsEngaged&&(t.controlsDragging=!0)}),t.controls.addEventListener("end",function(){t.controlsEngaged=!1,t.controlsDragging=!1})),[t.renderer,t.postProcessingComposer].concat(ra(t.extraRenderers)).forEach(function(T){return T.setSize(t.width,t.height)}),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new un.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!x,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))){var r,i=e.width,s=e.height;e.container.style.width="".concat(i,"px"),e.container.style.height="".concat(s,"px"),[e.renderer,e.postProcessingComposer].concat(ra(e.extraRenderers)).forEach(function(x){return x.setSize(i,s)}),e.camera.aspect=i/s;var o=e.viewOffset.slice(0,2);o.some(function(x){return x})&&(r=e.camera).setViewOffset.apply(r,[i,s].concat(ra(o),[i,s])),e.camera.updateProjectionMatrix()}if(t.hasOwnProperty("viewOffset")){var a,c=e.width,f=e.height,p=e.viewOffset.slice(0,2);p.some(function(x){return x})?(a=e.camera).setViewOffset.apply(a,[c,f].concat(ra(p),[c,f])):e.camera.clearViewOffset()}if(t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new un.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var g=Ql(e.backgroundColor).alpha;g===void 0&&(g=1),e.renderer.setClearColor(new un.Color(rX(1,e.backgroundColor)),g)}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new un.TextureLoader().load(e.backgroundImageUrl,function(x){x.colorSpace=un.SRGBColorSpace,e.skysphere.material=new un.MeshBasicMaterial({map:x,side:un.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&v()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&v())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach(function(x){return e.scene.remove(x)}),e.lights.forEach(function(x){return e.scene.add(x)})),t.hasOwnProperty("objects")&&((t.objects||[]).forEach(function(x){return e.scene.remove(x)}),e.objects.forEach(function(x){return e.scene.add(x)}));function v(){e.loadComplete=e.scene.visible=!0}}});function CK(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}var MK=`.scene-container .clickable {
  cursor: pointer;
}`;CK(MK);function hg(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function PK(n){if(Array.isArray(n))return hg(n)}function KA(n,e,t){return(e=IK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BK(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function DK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gb(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Aa(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gb(Object(t),!0).forEach(function(r){KA(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):gb(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function LK(n,e){if(n==null)return{};var t,r,i=OK(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function OK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function Bf(n){return PK(n)||BK(n)||kK(n)||DK()}function FK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function IK(n){var e=FK(n,"string");return typeof e=="symbol"?e:e+""}function kK(n,e){if(n){if(typeof n=="string")return hg(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hg(n,e):void 0}}function E7(n,e){var t=new e;return t._destructor&&t._destructor(),{linkProp:function(i){return{default:t[i](),onChange:function(o,a){a[n][i](o)},triggerUpdate:!1}},linkMethod:function(i){return function(s){for(var o=s[n],a=arguments.length,c=new Array(a>1?a-1:0),f=1;f<a;f++)c[f-1]=arguments[f];var p=o[i].apply(o,c);return p===o?this:p}}}}var qK=["rendererConfig","waitForGlobeReady"],Ou=Aa(Aa({},window.THREE?window.THREE:{AmbientLight:bb,DirectionalLight:vb,Vector2:ht,REVISION:Tg}),{},{CSS2DRenderer:ON}),R7=E7("globe",W5),UK=Object.assign.apply(Object,Bf(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","globeCurvatureResolution","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return KA({},n,R7.linkProp(n))}))),GK=Object.assign.apply(Object,Bf(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map(function(n){return KA({},n,R7.linkMethod(n))}))),N7=E7("renderObjs",S7),VK=Object.assign.apply(Object,Bf(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(n){return KA({},n,N7.linkProp(n))}))),zK=Object.assign.apply(Object,Bf(["lights","postProcessingComposer"].map(function(n){return KA({},n,N7.linkMethod(n))}))),jK=Vn({props:Aa(Aa({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},particleLabel:{default:"name",triggerUpdate:!1},onParticleClick:{triggerUpdate:!1},onParticleRightClick:{triggerUpdate:!1},onParticleHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){t.renderObjs.lineHoverPrecision(e),t.renderObjs.pointsHoverPrecision(e)}},showPointerCursor:{default:!0,triggerUpdate:!1},globeOffset:{default:[0,0],triggerUpdate:!1,onChange:function(e,t){return Array.isArray(e)&&e.length===2&&t.renderObjs.viewOffset(e.map(function(r){return-r}))}}},UK),VK),methods:Aa(Aa({pauseAnimation:function(e){var t;return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),(t=e.globe)===null||t===void 0||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return e.animationFrameRequestId===null&&this._animationCycle(),(t=e.globe)===null||t===void 0||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=o();if(t.lat===void 0&&t.lng===void 0&&t.altitude===void 0)return i;var s=Object.assign({},i,t);if(["lat","lng","altitude"].forEach(function(c){return s[c]=+s[c]}),!r)a(s);else{for(;i.lng-s.lng>180;)i.lng-=360;for(;i.lng-s.lng<-180;)i.lng+=360;e.tweenGroup.add(new dr(i).to(s,r).easing(On.Cubic.InOut).onUpdate(a).start())}return this;function o(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function a(c){var f=c.lat,p=c.lng,g=c.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(f,p,g)),e.globe.setPointOfView(e.renderObjs.camera())}},getScreenCoords:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];var o=(t=e.globe).getCoords.apply(t,i);return e.renderObjs.getScreenCoords(o.x,o.y,o.z)},toGlobeCoords:function(e,t,r){var i=e.renderObjs.intersectingObjects(t,r).find(function(c){return(c.object.__globeObjType||c.object.parent.__globeObjType)==="globe"});if(!i)return null;var s=e.globe.toGeoCoords(i.point),o=s.lat,a=s.lng;return{lat:o,lng:a}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.particlesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},GK),zK),stateInit:function(e){var t=e.rendererConfig,r=e.waitForGlobeReady,i=r===void 0?!0:r,s=LK(e,qK),o=new W5(Aa({waitForGlobeReady:i},s));return{globe:o,renderObjs:S7({controlType:"orbit",rendererConfig:t,waitForLoadComplete:i,extraRenderers:[new Ou.CSS2DRenderer]}).skyRadius(o.getGlobeRadius()*500).showNavInfo(!1).objects([o]).lights([new Ou.AmbientLight(13421772,Math.PI),new Ou.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new Vh}},init:function(e,t){var r=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var i=document.createElement("div");t.container.appendChild(i),t.renderObjs(i),t.globe.rendererSize(t.renderObjs.renderer().getSize(new Ou.Vector2)),this.pointOfView({altitude:2.5});var s=t.globe.getGlobeRadius(),o=t.renderObjs.controls();t.renderObjs.camera().near=.05,o.minDistance=s+Math.max(.001,t.renderObjs.camera().near*1.1),o.maxDistance=s*100,o.enablePan=!1,o.enableDamping=!0,o.dampingFactor=.1,o.rotateSpeed=.3,o.zoomSpeed=.3,o.zoomToCursor=!0,o.addEventListener("change",function(){o.target.setScalar(0);var f=r.pointOfView();o.rotateSpeed=f.altitude*.3,o.zoomSpeed=Math.sqrt(f.altitude)*.5,t.globe.setPointOfView(t.renderObjs.camera()),t.onZoom&&t.onZoom(f)});var a=function(p){for(var g=p;g&&!g.hasOwnProperty("__globeObjType");)g=g.parent;return g},c={point:function(p){return p},arc:function(p){return p},polygon:function(p){return p.data},path:function(p){return p},heatmap:function(p){return p},hexbin:function(p){return p},hexPolygon:function(p){return p},tile:function(p){return p},particles:function(p,g){return!g||!g.hasOwnProperty("index")||p.length<=g.index?p:p[g.index]},label:function(p){return p},object:function(p){return p},custom:function(p){return p}};Ou.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverFilter(function(f){var p=a(f);if(!p)return!1;var g=p.__globeObjType;if(g!=="globe"&&!c.hasOwnProperty(g))return!1;var v=c.hasOwnProperty(g)&&p.__data?c[g](p.__data):null;return["points","hexBinPoints"].some(function(x){return x===g})&&Array.isArray(v)?!1:t.pointerEventsFilter(p,v)}).tooltipContent(function(f,p){var g={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,particles:t.particleLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},v=a(f),x=v&&v.__globeObjType;return v&&x&&g.hasOwnProperty(x)&&c.hasOwnProperty(x)&&ve(g[x])(c[x](v.__data,p))||""}).onHover(function(f,p,g){var v={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,particles:t.onParticleHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},x={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},T=a(f);if(T&&!v.hasOwnProperty(T.__globeObjType)&&(T=null),T!==t.hoverObj){var S,R=t.hoverObj?t.hoverObj.__globeObjType:null,C=t.hoverData,B=T?T.__globeObjType:null,D=(S=T)!==null&&S!==void 0&&S.__data?c[B](T.__data,g):null;R&&R!==B&&v[R]&&v[R](null,C||null),B&&v[B]&&v[B](D,R===B?C:null),t.renderObjs.renderer().domElement.classList[B&&x[B]&&ve(t.showPointerCursor)(B,D)?"add":"remove"]("clickable"),t.hoverObj=T,t.hoverData=D}}).onClick(function(f,p,g){if(f){var v={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},x=a(f),T=x.__globeObjType;if(x&&v.hasOwnProperty(T)&&v[T]){var S=[p],R=g!=null&&g.isVector3?g:g?.point;if(T==="globe"){var C=r.toGeoCoords(R),B=C.lat,D=C.lng;S.unshift({lat:B,lng:D})}else S.push(r.toGeoCoords(R));c.hasOwnProperty(T)&&S.unshift(c[T](x.__data,g)),v[T].apply(v,S)}}}).onRightClick(function(f,p,g){if(f){var v={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,particles:t.onParticleRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},x=a(f),T=x.__globeObjType;if(x&&v.hasOwnProperty(T)&&v[T]){var S=[p],R=g!=null&&g.isVector3?g:g?.point;if(T==="globe"){var C=r.toGeoCoords(R),B=C.lat,D=C.lng;S.unshift({lat:B,lng:D})}else S.push(r.toGeoCoords(R));c.hasOwnProperty(T)&&S.unshift(c[T](x.__data,g)),v[T].apply(v,S)}}}),this._animationCycle()}}),$K={width:P.number,height:P.number,globeOffset:P.arrayOf(P.number),backgroundColor:P.string,backgroundImageUrl:P.string,globeImageUrl:P.string,bumpImageUrl:P.string,globeTileEngineUrl:P.func,showGlobe:P.bool,showGraticules:P.bool,showAtmosphere:P.bool,atmosphereColor:P.string,atmosphereAltitude:P.number,globeMaterial:P.object,onGlobeReady:P.func,onGlobeClick:P.func,onGlobeRightClick:P.func,pointsData:P.arrayOf(P.object),pointLat:P.oneOfType([P.number,P.string,P.func]),pointLng:P.oneOfType([P.number,P.string,P.func]),pointColor:P.oneOfType([P.string,P.func]),pointAltitude:P.oneOfType([P.number,P.string,P.func]),pointRadius:P.oneOfType([P.number,P.string,P.func]),pointResolution:P.number,pointsMerge:P.bool,pointsTransitionDuration:P.number,pointLabel:P.oneOfType([P.string,P.func]),onPointClick:P.func,onPointRightClick:P.func,onPointHover:P.func,arcsData:P.arrayOf(P.object),arcStartLat:P.oneOfType([P.number,P.string,P.func]),arcStartLng:P.oneOfType([P.number,P.string,P.func]),arcEndLat:P.oneOfType([P.number,P.string,P.func]),arcEndLng:P.oneOfType([P.number,P.string,P.func]),arcColor:P.oneOfType([P.string,P.arrayOf(P.string),P.func]),arcAltitude:P.oneOfType([P.number,P.string,P.func]),arcAltitudeAutoScale:P.oneOfType([P.number,P.string,P.func]),arcStroke:P.oneOfType([P.number,P.string,P.func]),arcCurveResolution:P.number,arcCircularResolution:P.number,arcDashLength:P.oneOfType([P.number,P.string,P.func]),arcDashGap:P.oneOfType([P.number,P.string,P.func]),arcDashInitialGap:P.oneOfType([P.number,P.string,P.func]),arcDashAnimateTime:P.oneOfType([P.number,P.string,P.func]),arcsTransitionDuration:P.number,arcLabel:P.oneOfType([P.string,P.func]),onArcClick:P.func,onArcRightClick:P.func,onArcHover:P.func,polygonsData:P.arrayOf(P.object),polygonGeoJsonGeometry:P.oneOfType([P.string,P.func]),polygonCapColor:P.oneOfType([P.string,P.func]),polygonCapMaterial:P.oneOfType([P.object,P.string,P.func]),polygonSideColor:P.oneOfType([P.string,P.func]),polygonSideMaterial:P.oneOfType([P.object,P.string,P.func]),polygonStrokeColor:P.oneOfType([P.string,P.func]),polygonAltitude:P.oneOfType([P.number,P.string,P.func]),polygonCapCurvatureResolution:P.oneOfType([P.number,P.string,P.func]),polygonsTransitionDuration:P.number,polygonLabel:P.oneOfType([P.string,P.func]),onPolygonClick:P.func,onPolygonRightClick:P.func,onPolygonHover:P.func,pathsData:P.array,pathPoints:P.oneOfType([P.array,P.string,P.func]),pathPointLat:P.oneOfType([P.number,P.string,P.func]),pathPointLng:P.oneOfType([P.number,P.string,P.func]),pathPointAlt:P.oneOfType([P.number,P.string,P.func]),pathResolution:P.number,pathColor:P.oneOfType([P.string,P.arrayOf(P.string),P.func]),pathStroke:P.oneOfType([P.number,P.string,P.func]),pathDashLength:P.oneOfType([P.number,P.string,P.func]),pathDashGap:P.oneOfType([P.number,P.string,P.func]),pathDashInitialGap:P.oneOfType([P.number,P.string,P.func]),pathDashAnimateTime:P.oneOfType([P.number,P.string,P.func]),pathTransitionDuration:P.number,pathLabel:P.oneOfType([P.string,P.func]),onPathClick:P.func,onPathRightClick:P.func,onPathHover:P.func,heatmapsData:P.array,heatmapPoints:P.oneOfType([P.array,P.string,P.func]),heatmapPointLat:P.oneOfType([P.number,P.string,P.func]),heatmapPointLng:P.oneOfType([P.number,P.string,P.func]),heatmapPointWeight:P.oneOfType([P.number,P.string,P.func]),heatmapBandwidth:P.oneOfType([P.number,P.string,P.func]),heatmapColorFn:P.oneOfType([P.string,P.func]),heatmapColorSaturation:P.oneOfType([P.number,P.string,P.func]),heatmapBaseAltitude:P.oneOfType([P.number,P.string,P.func]),heatmapTopAltitude:P.oneOfType([P.number,P.string,P.func]),heatmapsTransitionDuration:P.number,onHeatmapClick:P.func,onHeatmapRightClick:P.func,onHeatmapHover:P.func,hexBinPointsData:P.arrayOf(P.object),hexBinPointLat:P.oneOfType([P.number,P.string,P.func]),hexBinPointLng:P.oneOfType([P.number,P.string,P.func]),hexBinPointWeight:P.oneOfType([P.number,P.string,P.func]),hexBinResolution:P.number,hexMargin:P.oneOfType([P.number,P.func]),hexTopColor:P.func,hexSideColor:P.func,hexAltitude:P.oneOfType([P.number,P.func]),hexTopCurvatureResolution:P.number,hexBinMerge:P.bool,hexTransitionDuration:P.number,hexLabel:P.oneOfType([P.string,P.func]),onHexClick:P.func,onHexRightClick:P.func,onHexHover:P.func,hexPolygonsData:P.arrayOf(P.object),hexPolygonGeoJsonGeometry:P.oneOfType([P.string,P.func]),hexPolygonColor:P.oneOfType([P.string,P.func]),hexPolygonAltitude:P.oneOfType([P.number,P.string,P.func]),hexPolygonResolution:P.oneOfType([P.number,P.string,P.func]),hexPolygonMargin:P.oneOfType([P.number,P.string,P.func]),hexPolygonUseDots:P.oneOfType([P.bool,P.string,P.func]),hexPolygonCurvatureResolution:P.oneOfType([P.number,P.string,P.func]),hexPolygonDotResolution:P.oneOfType([P.number,P.string,P.func]),hexPolygonsTransitionDuration:P.number,hexPolygonLabel:P.oneOfType([P.string,P.func]),onHexPolygonClick:P.func,onHexPolygonRightClick:P.func,onHexPolygonHover:P.func,tilesData:P.arrayOf(P.object),tileLat:P.oneOfType([P.number,P.string,P.func]),tileLng:P.oneOfType([P.number,P.string,P.func]),tileAltitude:P.oneOfType([P.number,P.string,P.func]),tileWidth:P.oneOfType([P.number,P.string,P.func]),tileHeight:P.oneOfType([P.number,P.string,P.func]),tileUseGlobeProjection:P.oneOfType([P.bool,P.string,P.func]),tileMaterial:P.oneOfType([P.object,P.string,P.func]),tileCurvatureResolution:P.oneOfType([P.number,P.string,P.func]),tilesTransitionDuration:P.number,tileLabel:P.oneOfType([P.string,P.func]),onTileClick:P.func,onTileRightClick:P.func,onTileHover:P.func,particlesData:P.arrayOf(P.object),particlesList:P.oneOfType([P.string,P.func]),particleLat:P.oneOfType([P.number,P.string,P.func]),particleLng:P.oneOfType([P.number,P.string,P.func]),particleAltitude:P.oneOfType([P.number,P.string,P.func]),particlesSize:P.oneOfType([P.number,P.string,P.func]),particlesSizeAttenuation:P.oneOfType([P.bool,P.string,P.func]),particlesColor:P.oneOfType([P.string,P.func]),particlesTexture:P.oneOfType([P.string,P.func]),particleLabel:P.oneOfType([P.string,P.func]),onParticleClick:P.func,onParticleRightClick:P.func,onParticleHover:P.func,ringsData:P.arrayOf(P.object),ringLat:P.oneOfType([P.number,P.string,P.func]),ringLng:P.oneOfType([P.number,P.string,P.func]),ringAltitude:P.oneOfType([P.number,P.string,P.func]),ringColor:P.oneOfType([P.string,P.arrayOf(P.string),P.func]),ringResolution:P.number,ringMaxRadius:P.oneOfType([P.number,P.string,P.func]),ringPropagationSpeed:P.oneOfType([P.number,P.string,P.func]),ringRepeatPeriod:P.oneOfType([P.number,P.string,P.func]),labelsData:P.arrayOf(P.object),labelLat:P.oneOfType([P.number,P.string,P.func]),labelLng:P.oneOfType([P.number,P.string,P.func]),labelAltitude:P.oneOfType([P.number,P.string,P.func]),labelRotation:P.oneOfType([P.number,P.string,P.func]),labelText:P.oneOfType([P.string,P.func]),labelSize:P.oneOfType([P.number,P.string,P.func]),labelTypeFace:P.object,labelColor:P.oneOfType([P.string,P.func]),labelResolution:P.number,labelIncludeDot:P.oneOfType([P.bool,P.string,P.func]),labelDotRadius:P.oneOfType([P.number,P.string,P.func]),labelDotOrientation:P.oneOfType([P.string,P.func]),labelsTransitionDuration:P.number,labelLabel:P.oneOfType([P.string,P.func]),onLabelClick:P.func,onLabelRightClick:P.func,onLabelHover:P.func,htmlElementsData:P.arrayOf(P.object),htmlLat:P.oneOfType([P.number,P.string,P.func]),htmlLng:P.oneOfType([P.number,P.string,P.func]),htmlAltitude:P.oneOfType([P.number,P.string,P.func]),htmlElement:P.oneOfType([P.string,P.func]),htmlElementVisibilityModifier:P.func,htmlTransitionDuration:P.number,objectsData:P.arrayOf(P.object),objectLat:P.oneOfType([P.number,P.string,P.func]),objectLng:P.oneOfType([P.number,P.string,P.func]),objectAltitude:P.oneOfType([P.number,P.string,P.func]),objectRotation:P.oneOfType([P.shape({x:P.number,y:P.number,z:P.number}),P.string,P.func]),objectFacesSurface:P.oneOfType([P.bool,P.string,P.func]),objectThreeObject:P.oneOfType([P.object,P.string,P.func]),objectLabel:P.oneOfType([P.string,P.func]),onObjectClick:P.func,onObjectRightClick:P.func,onObjectHover:P.func,customLayerData:P.arrayOf(P.object),customThreeObject:P.oneOfType([P.object,P.string,P.func]),customThreeObjectUpdate:P.oneOfType([P.string,P.func]),customLayerLabel:P.oneOfType([P.string,P.func]),onCustomLayerClick:P.func,onCustomLayerRightClick:P.func,onCustomLayerHover:P.func,enablePointerInteraction:P.bool,pointerEventsFilter:P.func,lineHoverPrecision:P.number,showPointerCursor:P.oneOfType([P.bool,P.func]),onZoom:P.func},C7=DN(jK,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});C7.displayName="Globe";C7.propTypes=$K;export{C7 as default};
