import{g as Qs,f as gy,h as Ix,r as Oe,j as C0,t as Lx,K as py,G as Rx}from"./react-2y7n3CLG.js";import{V as _l,a as Kr,Q as ua,M as my,S as Dx,b as wl,C as yy,E as Cx,R as Px,D as kx,A as Mx,t as vy,c as Ey,d as Ox}from"./three-Bl1Xan4K.js";var Eu={exports:{}},Tu={};var _d;function Fx(){return _d||(_d=1,(function(i){function e(Y,ee){var re=Y.length;Y.push(ee);e:for(;0<re;){var ue=re-1>>>1,Te=Y[ue];if(0<r(Te,ee))Y[ue]=ee,Y[re]=Te,re=ue;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ee=Y[0],re=Y.pop();if(re!==ee){Y[0]=re;e:for(var ue=0,Te=Y.length,ge=Te>>>1;ue<ge;){var pe=2*(ue+1)-1,De=Y[pe],ze=pe+1,Me=Y[ze];if(0>r(De,re))ze<Te&&0>r(Me,De)?(Y[ue]=Me,Y[ze]=re,ue=ze):(Y[ue]=De,Y[pe]=re,ue=pe);else if(ze<Te&&0>r(Me,re))Y[ue]=Me,Y[ze]=re,ue=ze;else break e}}return ee}function r(Y,ee){var re=Y.sortIndex-ee.sortIndex;return re!==0?re:Y.id-ee.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,p=null,y=3,T=!1,b=!1,_=!1,w=!1,L=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function k(Y){for(var ee=t(h);ee!==null;){if(ee.callback===null)n(h);else if(ee.startTime<=Y)n(h),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=t(h)}}function F(Y){if(_=!1,k(Y),!b)if(t(c)!==null)b=!0,U||(U=!0,te());else{var ee=t(h);ee!==null&&X(F,ee.startTime-Y)}}var U=!1,$=-1,G=5,W=-1;function Q(){return w?!0:!(i.unstable_now()-W<G)}function K(){if(w=!1,U){var Y=i.unstable_now();W=Y;var ee=!0;try{e:{b=!1,_&&(_=!1,P($),$=-1),T=!0;var re=y;try{t:{for(k(Y),p=t(c);p!==null&&!(p.expirationTime>Y&&Q());){var ue=p.callback;if(typeof ue=="function"){p.callback=null,y=p.priorityLevel;var Te=ue(p.expirationTime<=Y);if(Y=i.unstable_now(),typeof Te=="function"){p.callback=Te,k(Y),ee=!0;break t}p===t(c)&&n(c),k(Y)}else n(c);p=t(c)}if(p!==null)ee=!0;else{var ge=t(h);ge!==null&&X(F,ge.startTime-Y),ee=!1}}break e}finally{p=null,y=re,T=!1}ee=void 0}}finally{ee?te():U=!1}}}var te;if(typeof R=="function")te=function(){R(K)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Ae=oe.port2;oe.port1.onmessage=K,te=function(){Ae.postMessage(null)}}else te=function(){L(K,0)};function X(Y,ee){$=L(function(){Y(i.unstable_now())},ee)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Y){Y.callback=null},i.unstable_forceFrameRate=function(Y){0>Y||125<Y||(G=0<Y?Math.floor(1e3/Y):5)},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var re=y;y=ee;try{return Y()}finally{y=re}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(Y,ee){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var re=y;y=Y;try{return ee()}finally{y=re}},i.unstable_scheduleCallback=function(Y,ee,re){var ue=i.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?ue+re:ue):re=ue,Y){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=re+Te,Y={id:d++,callback:ee,priorityLevel:Y,startTime:re,expirationTime:Te,sortIndex:-1},re>ue?(Y.sortIndex=re,e(h,Y),t(c)===null&&Y===t(h)&&(_?(P($),$=-1):_=!0,X(F,re-ue))):(Y.sortIndex=Te,e(c,Y),b||T||(b=!0,U||(U=!0,te()))),Y},i.unstable_shouldYield=Q,i.unstable_wrapCallback=function(Y){var ee=y;return function(){var re=y;y=ee;try{return Y.apply(this,arguments)}finally{y=re}}}})(Tu)),Tu}var wd;function cU(){return wd||(wd=1,Eu.exports=Fx()),Eu.exports}var Su,Id;function Bx(){if(Id)return Su;Id=1;var i=function(e,t,n,r,s,o,a,c){if(!e){var h;if(t===void 0)h=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,r,s,o,a,c],p=0;h=new Error(t.replace(/%s/g,function(){return d[p++]})),h.name="Invariant Violation"}throw h.framesToPop=1,h}};return Su=i,Su}var Nx=Bx();const hU=Qs(Nx);var bu,Ld;function Ux(){return Ld||(Ld=1,bu=function(e,t,n,r){var s=n?n.call(r,e,t):void 0;if(s!==void 0)return!!s;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(t),h=0;h<o.length;h++){var d=o[h];if(!c(d))return!1;var p=e[d],y=t[d];if(s=n?n.call(r,p,y,d):void 0,s===!1||s===void 0&&p!==y)return!1}return!0}),bu}var $x=Ux();const dU=Qs($x);let Gx={data:""},Vx=i=>typeof window=="object"?((i?i.querySelector("#_goober"):window._goober)||Object.assign((i||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:i||Gx,Hx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,jx=/\/\*[^]*?\*\/|  +/g,Rd=/\n+/g,hr=(i,e)=>{let t="",n="",r="";for(let s in i){let o=i[s];s[0]=="@"?s[1]=="i"?t=s+" "+o+";":n+=s[1]=="f"?hr(o,s):s+"{"+hr(o,s[1]=="k"?"":e)+"}":typeof o=="object"?n+=hr(o,e?e.replace(/([^,])+/g,a=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=hr.p?hr.p(s,o):s+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+n},Fn={},Ty=i=>{if(typeof i=="object"){let e="";for(let t in i)e+=t+Ty(i[t]);return e}return i},Kx=(i,e,t,n,r)=>{let s=Ty(i),o=Fn[s]||(Fn[s]=(c=>{let h=0,d=11;for(;h<c.length;)d=101*d+c.charCodeAt(h++)>>>0;return"go"+d})(s));if(!Fn[o]){let c=s!==i?i:(h=>{let d,p,y=[{}];for(;d=Hx.exec(h.replace(jx,""));)d[4]?y.shift():d[3]?(p=d[3].replace(Rd," ").trim(),y.unshift(y[0][p]=y[0][p]||{})):y[0][d[1]]=d[2].replace(Rd," ").trim();return y[0]})(i);Fn[o]=hr(r?{["@keyframes "+o]:c}:c,t?"":"."+o)}let a=t&&Fn.g?Fn.g:null;return t&&(Fn.g=Fn[o]),((c,h,d,p)=>{p?h.data=h.data.replace(p,c):h.data.indexOf(c)===-1&&(h.data=d?c+h.data:h.data+c)})(Fn[o],e,n,a),o},Qx=(i,e,t)=>i.reduce((n,r,s)=>{let o=e[s];if(o&&o.call){let a=o(t),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":hr(a,""):a===!1?"":a}return n+r+(o??"")},"");function ac(i){let e=this||{},t=i.call?i(e.p):i;return Kx(t.unshift?t.raw?Qx(t,[].slice.call(arguments,1),e.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):t,Vx(e.target),e.g,e.o,e.k)}let Sy,P0,k0;ac.bind({g:1});let gU=ac.bind({k:1});function pU(i,e,t,n){hr.p=e,Sy=i,P0=t,k0=n}function mU(i,e){let t=this||{};return function(){let n=arguments;function r(s,o){let a=Object.assign({},s),c=a.className||r.className;t.p=Object.assign({theme:P0&&P0()},a),t.o=/ *go\d+/.test(c),a.className=ac.apply(t,n)+(c?" "+c:"");let h=i;return i[0]&&(h=a.as||i,delete a.as),k0&&h[0]&&k0(a),Sy(h,a)}return r}}function by(i,e,t){return Math.max(i,Math.min(e,t))}class Wx{advance(e){if(!this.isRunning)return;let t=!1;if(this.lerp)this.value=(n=this.value,r=this.to,s=60*this.lerp,o=e,(function(a,c,h){return(1-h)*a+h*c})(n,r,1-Math.exp(-s*o))),Math.round(this.value)===this.to&&(this.value=this.to,t=!0);else{this.currentTime+=e;const a=by(0,this.currentTime/this.duration,1);t=a>=1;const c=t?1:this.easing(a);this.value=this.from+(this.to-this.from)*c}var n,r,s,o;this.onUpdate?.(this.value,t),t&&this.stop()}stop(){this.isRunning=!1}fromTo(e,t,{lerp:n=.1,duration:r=1,easing:s=(c=>c),onStart:o,onUpdate:a}){this.from=this.value=e,this.to=t,this.lerp=n,this.duration=r,this.easing=s,this.currentTime=0,this.isRunning=!0,o?.(),this.onUpdate=a}}class Yx{constructor({wrapper:e,content:t,autoResize:n=!0,debounce:r=250}={}){this.wrapper=e,this.content=t,n&&(this.debouncedResize=(function(s,o){let a;return function(){let c=arguments,h=this;clearTimeout(a),a=setTimeout((function(){s.apply(h,c)}),o)}})(this.resize,r),this.wrapper===window?window.addEventListener("resize",this.debouncedResize,!1):(this.wrapperResizeObserver=new ResizeObserver(this.debouncedResize),this.wrapperResizeObserver.observe(this.wrapper)),this.contentResizeObserver=new ResizeObserver(this.debouncedResize),this.contentResizeObserver.observe(this.content)),this.resize()}destroy(){this.wrapperResizeObserver?.disconnect(),this.contentResizeObserver?.disconnect(),window.removeEventListener("resize",this.debouncedResize,!1)}resize=()=>{this.onWrapperResize(),this.onContentResize()};onWrapperResize=()=>{this.wrapper===window?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight)};onContentResize=()=>{this.wrapper===window?(this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth):(this.scrollHeight=this.wrapper.scrollHeight,this.scrollWidth=this.wrapper.scrollWidth)};get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}}class xy{constructor(){this.events={}}emit(e,...t){let n=this.events[e]||[];for(let r=0,s=n.length;r<s;r++)n[r](...t)}on(e,t){return this.events[e]?.push(t)||(this.events[e]=[t]),()=>{this.events[e]=this.events[e]?.filter((n=>t!==n))}}off(e,t){this.events[e]=this.events[e]?.filter((n=>t!==n))}destroy(){this.events={}}}const Dd=100/6;class zx{constructor(e,{wheelMultiplier:t=1,touchMultiplier:n=1}){this.element=e,this.wheelMultiplier=t,this.touchMultiplier=n,this.touchStart={x:null,y:null},this.emitter=new xy,window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize(),this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(e,t){return this.emitter.on(e,t)}destroy(){this.emitter.destroy(),window.removeEventListener("resize",this.onWindowResize,!1),this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}onTouchStart=e=>{const{clientX:t,clientY:n}=e.targetTouches?e.targetTouches[0]:e;this.touchStart.x=t,this.touchStart.y=n,this.lastDelta={x:0,y:0},this.emitter.emit("scroll",{deltaX:0,deltaY:0,event:e})};onTouchMove=e=>{const{clientX:t,clientY:n}=e.targetTouches?e.targetTouches[0]:e,r=-(t-this.touchStart.x)*this.touchMultiplier,s=-(n-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=t,this.touchStart.y=n,this.lastDelta={x:r,y:s},this.emitter.emit("scroll",{deltaX:r,deltaY:s,event:e})};onTouchEnd=e=>{this.emitter.emit("scroll",{deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:e})};onWheel=e=>{let{deltaX:t,deltaY:n,deltaMode:r}=e;t*=r===1?Dd:r===2?this.windowWidth:1,n*=r===1?Dd:r===2?this.windowHeight:1,t*=this.wheelMultiplier,n*=this.wheelMultiplier,this.emitter.emit("scroll",{deltaX:t,deltaY:n,event:e})};onWindowResize=()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight}}class yU{constructor({wrapper:e=window,content:t=document.documentElement,wheelEventsTarget:n=e,eventsTarget:r=n,smoothWheel:s=!0,syncTouch:o=!1,syncTouchLerp:a=.075,touchInertiaMultiplier:c=35,duration:h,easing:d=(R=>Math.min(1,1.001-Math.pow(2,-10*R))),lerp:p=!h&&.1,infinite:y=!1,orientation:T="vertical",gestureOrientation:b="vertical",touchMultiplier:_=1,wheelMultiplier:w=1,autoResize:L=!0,__experimental__naiveDimensions:P=!1}={}){this.__isSmooth=!1,this.__isScrolling=!1,this.__isStopped=!1,this.__isLocked=!1,this.onVirtualScroll=({deltaX:R,deltaY:k,event:F})=>{if(F.ctrlKey)return;const U=F.type.includes("touch"),$=F.type.includes("wheel");if(this.options.syncTouch&&U&&F.type==="touchstart"&&!this.isStopped&&!this.isLocked)return void this.reset();const G=R===0&&k===0,W=this.options.gestureOrientation==="vertical"&&k===0||this.options.gestureOrientation==="horizontal"&&R===0;if(G||W)return;let Q=F.composedPath();if(Q=Q.slice(0,Q.indexOf(this.rootElement)),Q.find((Ae=>{var X,Y,ee,re,ue;return((X=Ae.hasAttribute)===null||X===void 0?void 0:X.call(Ae,"data-lenis-prevent"))||U&&((Y=Ae.hasAttribute)===null||Y===void 0?void 0:Y.call(Ae,"data-lenis-prevent-touch"))||$&&((ee=Ae.hasAttribute)===null||ee===void 0?void 0:ee.call(Ae,"data-lenis-prevent-wheel"))||((re=Ae.classList)===null||re===void 0?void 0:re.contains("lenis"))&&!(!((ue=Ae.classList)===null||ue===void 0)&&ue.contains("lenis-stopped"))})))return;if(this.isStopped||this.isLocked)return void F.preventDefault();if(this.isSmooth=this.options.syncTouch&&U||this.options.smoothWheel&&$,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();F.preventDefault();let K=k;this.options.gestureOrientation==="both"?K=Math.abs(k)>Math.abs(R)?k:R:this.options.gestureOrientation==="horizontal"&&(K=R);const te=U&&this.options.syncTouch,oe=U&&F.type==="touchend"&&Math.abs(K)>5;oe&&(K=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+K,Object.assign({programmatic:!1},te?{lerp:oe?this.options.syncTouchLerp:1}:{lerp:this.options.lerp,duration:this.options.duration,easing:this.options.easing}))},this.onNativeScroll=()=>{if(!this.__preventNextScrollEvent&&!this.isScrolling){const R=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-R),this.emit()}},window.lenisVersion="1.0.42",e!==document.documentElement&&e!==document.body||(e=window),this.options={wrapper:e,content:t,wheelEventsTarget:n,eventsTarget:r,smoothWheel:s,syncTouch:o,syncTouchLerp:a,touchInertiaMultiplier:c,duration:h,easing:d,lerp:p,infinite:y,gestureOrientation:b,orientation:T,touchMultiplier:_,wheelMultiplier:w,autoResize:L,__experimental__naiveDimensions:P},this.animate=new Wx,this.emitter=new xy,this.dimensions=new Yx({wrapper:e,content:t,autoResize:L}),this.toggleClassName("lenis",!0),this.velocity=0,this.isLocked=!1,this.isStopped=!1,this.isSmooth=o||s,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.options.wrapper.addEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll=new zx(r,{touchMultiplier:_,wheelMultiplier:w}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.destroy(),this.options.wrapper.removeEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll.destroy(),this.dimensions.destroy(),this.toggleClassName("lenis",!1),this.toggleClassName("lenis-smooth",!1),this.toggleClassName("lenis-scrolling",!1),this.toggleClassName("lenis-stopped",!1),this.toggleClassName("lenis-locked",!1)}on(e,t){return this.emitter.on(e,t)}off(e,t){return this.emitter.off(e,t)}setScroll(e){this.isHorizontal?this.rootElement.scrollLeft=e:this.rootElement.scrollTop=e}resize(){this.dimensions.resize()}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.animate.stop()}start(){this.isStopped&&(this.isStopped=!1,this.reset())}stop(){this.isStopped||(this.isStopped=!0,this.animate.stop(),this.reset())}raf(e){const t=e-(this.time||e);this.time=e,this.animate.advance(.001*t)}scrollTo(e,{offset:t=0,immediate:n=!1,lock:r=!1,duration:s=this.options.duration,easing:o=this.options.easing,lerp:a=!s&&this.options.lerp,onComplete:c,force:h=!1,programmatic:d=!0}={}){if(!this.isStopped&&!this.isLocked||h){if(["top","left","start"].includes(e))e=0;else if(["bottom","right","end"].includes(e))e=this.limit;else{let p;if(typeof e=="string"?p=document.querySelector(e):e?.nodeType&&(p=e),p){if(this.options.wrapper!==window){const T=this.options.wrapper.getBoundingClientRect();t-=this.isHorizontal?T.left:T.top}const y=p.getBoundingClientRect();e=(this.isHorizontal?y.left:y.top)+this.animatedScroll}}if(typeof e=="number"){if(e+=t,e=Math.round(e),this.options.infinite?d&&(this.targetScroll=this.animatedScroll=this.scroll):e=by(0,e,this.limit),n)return this.animatedScroll=this.targetScroll=e,this.setScroll(this.scroll),this.reset(),void(c==null||c(this));if(!d){if(e===this.targetScroll)return;this.targetScroll=e}this.animate.fromTo(this.animatedScroll,e,{duration:s,easing:o,lerp:a,onStart:()=>{r&&(this.isLocked=!0),this.isScrolling=!0},onUpdate:(p,y)=>{this.isScrolling=!0,this.velocity=p-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=p,this.setScroll(this.scroll),d&&(this.targetScroll=p),y||this.emit(),y&&(this.reset(),this.emit(),c?.(this),this.__preventNextScrollEvent=!0,requestAnimationFrame((()=>{delete this.__preventNextScrollEvent})))}})}}}get rootElement(){return this.options.wrapper===window?document.documentElement:this.options.wrapper}get limit(){return this.options.__experimental__naiveDimensions?this.isHorizontal?this.rootElement.scrollWidth-this.rootElement.clientWidth:this.rootElement.scrollHeight-this.rootElement.clientHeight:this.dimensions.limit[this.isHorizontal?"x":"y"]}get isHorizontal(){return this.options.orientation==="horizontal"}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){return this.options.infinite?(e=this.animatedScroll,t=this.limit,(e%t+t)%t):this.animatedScroll;var e,t}get progress(){return this.limit===0?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(e){this.__isSmooth!==e&&(this.__isSmooth=e,this.toggleClassName("lenis-smooth",e))}get isScrolling(){return this.__isScrolling}set isScrolling(e){this.__isScrolling!==e&&(this.__isScrolling=e,this.toggleClassName("lenis-scrolling",e))}get isStopped(){return this.__isStopped}set isStopped(e){this.__isStopped!==e&&(this.__isStopped=e,this.toggleClassName("lenis-stopped",e))}get isLocked(){return this.__isLocked}set isLocked(e){this.__isLocked!==e&&(this.__isLocked=e,this.toggleClassName("lenis-locked",e))}get className(){let e="lenis";return this.isStopped&&(e+=" lenis-stopped"),this.isLocked&&(e+=" lenis-locked"),this.isScrolling&&(e+=" lenis-scrolling"),this.isSmooth&&(e+=" lenis-smooth"),e}toggleClassName(e,t){this.rootElement.classList.toggle(e,t),this.emitter.emit("className change",this)}}var xu={exports:{}},_u={},wu={exports:{}},Iu={};var Cd;function qx(){if(Cd)return Iu;Cd=1;var i=gy();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,r=i.useEffect,s=i.useLayoutEffect,o=i.useDebugValue;function a(p,y){var T=y(),b=n({inst:{value:T,getSnapshot:y}}),_=b[0].inst,w=b[1];return s(function(){_.value=T,_.getSnapshot=y,c(_)&&w({inst:_})},[p,T,y]),r(function(){return c(_)&&w({inst:_}),p(function(){c(_)&&w({inst:_})})},[p]),o(T),T}function c(p){var y=p.getSnapshot;p=p.value;try{var T=y();return!t(p,T)}catch{return!0}}function h(p,y){return y()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return Iu.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:d,Iu}var Pd;function Xx(){return Pd||(Pd=1,wu.exports=qx()),wu.exports}var kd;function Zx(){if(kd)return _u;kd=1;var i=gy(),e=Xx();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=i.useRef,o=i.useEffect,a=i.useMemo,c=i.useDebugValue;return _u.useSyncExternalStoreWithSelector=function(h,d,p,y,T){var b=s(null);if(b.current===null){var _={hasValue:!1,value:null};b.current=_}else _=b.current;b=a(function(){function L(U){if(!P){if(P=!0,R=U,U=y(U),T!==void 0&&_.hasValue){var $=_.value;if(T($,U))return k=$}return k=U}if($=k,n(R,U))return $;var G=y(U);return T!==void 0&&T($,G)?(R=U,$):(R=U,k=G)}var P=!1,R,k,F=p===void 0?null:p;return[function(){return L(d())},F===null?void 0:function(){return L(F())}]},[d,p,y,T]);var w=r(h,b[0],b[1]);return o(function(){_.hasValue=!0,_.value=w},[w]),c(w),w},_u}var Md;function Jx(){return Md||(Md=1,xu.exports=Zx()),xu.exports}var e_=Jx();const t_=Qs(e_),Od=i=>{let e;const t=new Set,n=(h,d)=>{const p=typeof h=="function"?h(e):h;if(!Object.is(p,e)){const y=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(T=>T(e,y))}},r=()=>e,a={setState:n,getState:r,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h))},c=e=i(n,r,a);return a},i_=(i=>i?Od(i):Od),{useSyncExternalStoreWithSelector:n_}=t_,r_=i=>i;function s_(i,e=r_,t){const n=n_(i.subscribe,i.getState,i.getInitialState,e,t);return Ix.useDebugValue(n),n}const Fd=(i,e)=>{const t=i_(i),n=(r,s=e)=>s_(t,r,s);return Object.assign(n,t),n},vU=((i,e)=>i?Fd(i,e):Fd);function _y(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=_y(n,e,t);if(r)return r;n=e?null:n.sibling}}function wy(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const Ac=wy(Oe.createContext(null));class o_ extends Oe.Component{render(){return Oe.createElement(Ac.Provider,{value:this._reactInternals},this.props.children)}}function a_(){const i=Oe.useContext(Ac);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Oe.useId();return Oe.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=_y(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const A_=Symbol.for("react.context"),l_=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===A_;function u_(){const i=a_(),[e]=Oe.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;l_(n)&&n!==Ac&&!e.has(n)&&e.set(n,Oe.use(wy(n))),t=t.return}return e}function EU(){const i=u_();return Oe.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>Oe.createElement(e,null,Oe.createElement(t.Provider,{...n,value:i.get(t)})),e=>Oe.createElement(o_,{...e})),[i])}const Iy=Oe.createContext({});function f_(i){const e=Oe.useRef(null);return e.current===null&&(e.current=i()),e.current}const lc=typeof window<"u",c_=lc?Oe.useLayoutEffect:Oe.useEffect,uc=Oe.createContext(null);function fc(i,e){i.indexOf(e)===-1&&i.push(e)}function cc(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}const Wn=(i,e,t)=>t>e?e:t<i?i:t;let hc=()=>{};const Yn={},Ly=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i);function Ry(i){return typeof i=="object"&&i!==null}const Dy=i=>/^0[^.\s]+$/u.test(i);function dc(i){let e;return()=>(e===void 0&&(e=i()),e)}const Xi=i=>i,h_=(i,e)=>t=>e(i(t)),fa=(...i)=>i.reduce(h_),Go=(i,e,t)=>{const n=e-i;return n===0?1:(t-i)/n};class gc{constructor(){this.subscriptions=[]}add(e){return fc(this.subscriptions,e),()=>cc(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,n);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const xn=i=>i*1e3,_n=i=>i/1e3;function Cy(i,e){return e?i*(1e3/e):0}const Py=(i,e,t)=>(((1-3*t+3*e)*i+(3*t-6*e))*i+3*e)*i,d_=1e-7,g_=12;function p_(i,e,t,n,r){let s,o,a=0;do o=e+(t-e)/2,s=Py(o,n,r)-i,s>0?t=o:e=o;while(Math.abs(s)>d_&&++a<g_);return o}function ca(i,e,t,n){if(i===e&&t===n)return Xi;const r=s=>p_(s,0,1,i,t);return s=>s===0||s===1?s:Py(r(s),e,n)}const ky=i=>e=>e<=.5?i(2*e)/2:(2-i(2*(1-e)))/2,My=i=>e=>1-i(1-e),Oy=ca(.33,1.53,.69,.99),pc=My(Oy),Fy=ky(pc),By=i=>(i*=2)<1?.5*pc(i):.5*(2-Math.pow(2,-10*(i-1))),mc=i=>1-Math.sin(Math.acos(i)),Ny=My(mc),Uy=ky(mc),m_=ca(.42,0,1,1),y_=ca(0,0,.58,1),$y=ca(.42,0,.58,1),v_=i=>Array.isArray(i)&&typeof i[0]!="number",Gy=i=>Array.isArray(i)&&typeof i[0]=="number",E_={linear:Xi,easeIn:m_,easeInOut:$y,easeOut:y_,circIn:mc,circInOut:Uy,circOut:Ny,backIn:pc,backInOut:Fy,backOut:Oy,anticipate:By},T_=i=>typeof i=="string",Bd=i=>{if(Gy(i)){hc(i.length===4);const[e,t,n,r]=i;return ca(e,t,n,r)}else if(T_(i))return E_[i];return i},Fa=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function S_(i,e){let t=new Set,n=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(d){o.has(d)&&(h.schedule(d),i()),d(a)}const h={schedule:(d,p=!1,y=!1)=>{const b=y&&r?t:n;return p&&o.add(d),b.has(d)||b.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(a=d,r){s=!0;return}r=!0,[t,n]=[n,t],t.forEach(c),t.clear(),r=!1,s&&(s=!1,h.process(d))}};return h}const b_=40;function Vy(i,e){let t=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Fa.reduce((R,k)=>(R[k]=S_(s),R),{}),{setup:a,read:c,resolveKeyframes:h,preUpdate:d,update:p,preRender:y,render:T,postRender:b}=o,_=()=>{const R=Yn.useManualTiming?r.timestamp:performance.now();t=!1,Yn.useManualTiming||(r.delta=n?1e3/60:Math.max(Math.min(R-r.timestamp,b_),1)),r.timestamp=R,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),d.process(r),p.process(r),y.process(r),T.process(r),b.process(r),r.isProcessing=!1,t&&e&&(n=!1,i(_))},w=()=>{t=!0,n=!0,r.isProcessing||i(_)};return{schedule:Fa.reduce((R,k)=>{const F=o[k];return R[k]=(U,$=!1,G=!1)=>(t||w(),F.schedule(U,$,G)),R},{}),cancel:R=>{for(let k=0;k<Fa.length;k++)o[Fa[k]].cancel(R)},state:r,steps:o}}const{schedule:Lt,cancel:dr,state:ei,steps:Lu}=Vy(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xi,!0);let dA;function x_(){dA=void 0}const wi={now:()=>(dA===void 0&&wi.set(ei.isProcessing||Yn.useManualTiming?ei.timestamp:performance.now()),dA),set:i=>{dA=i,queueMicrotask(x_)}},Hy=i=>e=>typeof e=="string"&&e.startsWith(i),yc=Hy("--"),__=Hy("var(--"),vc=i=>__(i)?w_.test(i.split("/*")[0].trim()):!1,w_=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ws={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},Vo={...Ws,transform:i=>Wn(0,1,i)},Ba={...Ws,default:1},Ro=i=>Math.round(i*1e5)/1e5,Ec=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function I_(i){return i==null}const L_=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Tc=(i,e)=>t=>!!(typeof t=="string"&&L_.test(t)&&t.startsWith(i)||e&&!I_(t)&&Object.prototype.hasOwnProperty.call(t,e)),jy=(i,e,t)=>n=>{if(typeof n!="string")return n;const[r,s,o,a]=n.match(Ec);return{[i]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},R_=i=>Wn(0,255,i),Ru={...Ws,transform:i=>Math.round(R_(i))},Fr={test:Tc("rgb","red"),parse:jy("red","green","blue"),transform:({red:i,green:e,blue:t,alpha:n=1})=>"rgba("+Ru.transform(i)+", "+Ru.transform(e)+", "+Ru.transform(t)+", "+Ro(Vo.transform(n))+")"};function D_(i){let e="",t="",n="",r="";return i.length>5?(e=i.substring(1,3),t=i.substring(3,5),n=i.substring(5,7),r=i.substring(7,9)):(e=i.substring(1,2),t=i.substring(2,3),n=i.substring(3,4),r=i.substring(4,5),e+=e,t+=t,n+=n,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const M0={test:Tc("#"),parse:D_,transform:Fr.transform},ha=i=>({test:e=>typeof e=="string"&&e.endsWith(i)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${i}`}),lr=ha("deg"),wn=ha("%"),Ve=ha("px"),C_=ha("vh"),P_=ha("vw"),Nd={...wn,parse:i=>wn.parse(i)/100,transform:i=>wn.transform(i*100)},ms={test:Tc("hsl","hue"),parse:jy("hue","saturation","lightness"),transform:({hue:i,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(i)+", "+wn.transform(Ro(e))+", "+wn.transform(Ro(t))+", "+Ro(Vo.transform(n))+")"},Ut={test:i=>Fr.test(i)||M0.test(i)||ms.test(i),parse:i=>Fr.test(i)?Fr.parse(i):ms.test(i)?ms.parse(i):M0.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?Fr.transform(i):ms.transform(i),getAnimatableNone:i=>{const e=Ut.parse(i);return e.alpha=0,Ut.transform(e)}},k_=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function M_(i){return isNaN(i)&&typeof i=="string"&&(i.match(Ec)?.length||0)+(i.match(k_)?.length||0)>0}const Ky="number",Qy="color",O_="var",F_="var(",Ud="${}",B_=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ho(i){const e=i.toString(),t=[],n={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(B_,c=>(Ut.test(c)?(n.color.push(s),r.push(Qy),t.push(Ut.parse(c))):c.startsWith(F_)?(n.var.push(s),r.push(O_),t.push(c)):(n.number.push(s),r.push(Ky),t.push(parseFloat(c))),++s,Ud)).split(Ud);return{values:t,split:a,indexes:n,types:r}}function Wy(i){return Ho(i).values}function Yy(i){const{split:e,types:t}=Ho(i),n=e.length;return r=>{let s="";for(let o=0;o<n;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===Ky?s+=Ro(r[o]):a===Qy?s+=Ut.transform(r[o]):s+=r[o]}return s}}const N_=i=>typeof i=="number"?0:Ut.test(i)?Ut.getAnimatableNone(i):i;function U_(i){const e=Wy(i);return Yy(i)(e.map(N_))}const gr={test:M_,parse:Wy,createTransformer:Yy,getAnimatableNone:U_};function Du(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*(2/3-t)*6:i}function $_({hue:i,saturation:e,lightness:t,alpha:n}){i/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=Du(c,a,i+1/3),s=Du(c,a,i),o=Du(c,a,i-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}function CA(i,e){return t=>t>0?e:i}const Ct=(i,e,t)=>i+(e-i)*t,Cu=(i,e,t)=>{const n=i*i,r=t*(e*e-n)+n;return r<0?0:Math.sqrt(r)},G_=[M0,Fr,ms],V_=i=>G_.find(e=>e.test(i));function $d(i){const e=V_(i);if(!e)return!1;let t=e.parse(i);return e===ms&&(t=$_(t)),t}const Gd=(i,e)=>{const t=$d(i),n=$d(e);if(!t||!n)return CA(i,e);const r={...t};return s=>(r.red=Cu(t.red,n.red,s),r.green=Cu(t.green,n.green,s),r.blue=Cu(t.blue,n.blue,s),r.alpha=Ct(t.alpha,n.alpha,s),Fr.transform(r))},O0=new Set(["none","hidden"]);function H_(i,e){return O0.has(i)?t=>t<=0?i:e:t=>t>=1?e:i}function j_(i,e){return t=>Ct(i,e,t)}function Sc(i){return typeof i=="number"?j_:typeof i=="string"?vc(i)?CA:Ut.test(i)?Gd:W_:Array.isArray(i)?zy:typeof i=="object"?Ut.test(i)?Gd:K_:CA}function zy(i,e){const t=[...i],n=t.length,r=i.map((s,o)=>Sc(s)(s,e[o]));return s=>{for(let o=0;o<n;o++)t[o]=r[o](s);return t}}function K_(i,e){const t={...i,...e},n={};for(const r in t)i[r]!==void 0&&e[r]!==void 0&&(n[r]=Sc(i[r])(i[r],e[r]));return r=>{for(const s in n)t[s]=n[s](r);return t}}function Q_(i,e){const t=[],n={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],o=i.indexes[s][n[s]],a=i.values[o]??0;t[r]=a,n[s]++}return t}const W_=(i,e)=>{const t=gr.createTransformer(e),n=Ho(i),r=Ho(e);return n.indexes.var.length===r.indexes.var.length&&n.indexes.color.length===r.indexes.color.length&&n.indexes.number.length>=r.indexes.number.length?O0.has(i)&&!r.values.length||O0.has(e)&&!n.values.length?H_(i,e):fa(zy(Q_(n,r),r.values),t):CA(i,e)};function qy(i,e,t){return typeof i=="number"&&typeof e=="number"&&typeof t=="number"?Ct(i,e,t):Sc(i)(i,e)}const Y_=i=>{const e=({timestamp:t})=>i(t);return{start:(t=!0)=>Lt.update(e,t),stop:()=>dr(e),now:()=>ei.isProcessing?ei.timestamp:wi.now()}},Xy=(i,e,t=10)=>{let n="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)n+=Math.round(i(s/(r-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},PA=2e4;function bc(i){let e=0;const t=50;let n=i.next(e);for(;!n.done&&e<PA;)e+=t,n=i.next(e);return e>=PA?1/0:e}function z_(i,e=100,t){const n=t({...i,keyframes:[0,e]}),r=Math.min(bc(n),PA);return{type:"keyframes",ease:s=>n.next(r*s).value/e,duration:_n(r)}}const q_=5;function Zy(i,e,t){const n=Math.max(e-q_,0);return Cy(t-i(n),e-n)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Pu=.001;function X_({duration:i=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:n=Ot.mass}){let r,s,o=1-e;o=Wn(Ot.minDamping,Ot.maxDamping,o),i=Wn(Ot.minDuration,Ot.maxDuration,_n(i)),o<1?(r=h=>{const d=h*o,p=d*i,y=d-t,T=F0(h,o),b=Math.exp(-p);return Pu-y/T*b},s=h=>{const p=h*o*i,y=p*t+t,T=Math.pow(o,2)*Math.pow(h,2)*i,b=Math.exp(-p),_=F0(Math.pow(h,2),o);return(-r(h)+Pu>0?-1:1)*((y-T)*b)/_}):(r=h=>{const d=Math.exp(-h*i),p=(h-t)*i+1;return-Pu+d*p},s=h=>{const d=Math.exp(-h*i),p=(t-h)*(i*i);return d*p});const a=5/i,c=J_(r,s,a);if(i=xn(i),isNaN(c))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:i};{const h=Math.pow(c,2)*n;return{stiffness:h,damping:o*2*Math.sqrt(n*h),duration:i}}}const Z_=12;function J_(i,e,t){let n=t;for(let r=1;r<Z_;r++)n=n-i(n)/e(n);return n}function F0(i,e){return i*Math.sqrt(1-e*e)}const ew=["duration","bounce"],tw=["stiffness","damping","mass"];function Vd(i,e){return e.some(t=>i[t]!==void 0)}function iw(i){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...i};if(!Vd(i,tw)&&Vd(i,ew))if(i.visualDuration){const t=i.visualDuration,n=2*Math.PI/(t*1.2),r=n*n,s=2*Wn(.05,1,1-(i.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=X_(i);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function kA(i=Ot.visualDuration,e=Ot.bounce){const t=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:e}:i;let{restSpeed:n,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:d,duration:p,velocity:y,isResolvedFromDuration:T}=iw({...t,velocity:-_n(t.velocity||0)}),b=y||0,_=h/(2*Math.sqrt(c*d)),w=o-s,L=_n(Math.sqrt(c/d)),P=Math.abs(w)<5;n||(n=P?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=P?Ot.restDelta.granular:Ot.restDelta.default);let R;if(_<1){const F=F0(L,_);R=U=>{const $=Math.exp(-_*L*U);return o-$*((b+_*L*w)/F*Math.sin(F*U)+w*Math.cos(F*U))}}else if(_===1)R=F=>o-Math.exp(-L*F)*(w+(b+L*w)*F);else{const F=L*Math.sqrt(_*_-1);R=U=>{const $=Math.exp(-_*L*U),G=Math.min(F*U,300);return o-$*((b+_*L*w)*Math.sinh(G)+F*w*Math.cosh(G))/F}}const k={calculatedDuration:T&&p||null,next:F=>{const U=R(F);if(T)a.done=F>=p;else{let $=F===0?b:0;_<1&&($=F===0?xn(b):Zy(R,F,U));const G=Math.abs($)<=n,W=Math.abs(o-U)<=r;a.done=G&&W}return a.value=a.done?o:U,a},toString:()=>{const F=Math.min(bc(k),PA),U=Xy($=>k.next(F*$).value,F,30);return F+"ms "+U},toTransition:()=>{}};return k}kA.applyToOptions=i=>{const e=z_(i,100,kA);return i.ease=e.ease,i.duration=xn(e.duration),i.type="keyframes",i};function B0({keyframes:i,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:d}){const p=i[0],y={done:!1,value:p},T=G=>a!==void 0&&G<a||c!==void 0&&G>c,b=G=>a===void 0?c:c===void 0||Math.abs(a-G)<Math.abs(c-G)?a:c;let _=t*e;const w=p+_,L=o===void 0?w:o(w);L!==w&&(_=L-p);const P=G=>-_*Math.exp(-G/n),R=G=>L+P(G),k=G=>{const W=P(G),Q=R(G);y.done=Math.abs(W)<=h,y.value=y.done?L:Q};let F,U;const $=G=>{T(y.value)&&(F=G,U=kA({keyframes:[y.value,b(y.value)],velocity:Zy(R,G,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return $(0),{calculatedDuration:null,next:G=>{let W=!1;return!U&&F===void 0&&(W=!0,k(G),$(G)),F!==void 0&&G>=F?U.next(G-F):(!W&&k(G),y)}}}function nw(i,e,t){const n=[],r=t||Yn.mix||qy,s=i.length-1;for(let o=0;o<s;o++){let a=r(i[o],i[o+1]);if(e){const c=Array.isArray(e)?e[o]||Xi:e;a=fa(c,a)}n.push(a)}return n}function rw(i,e,{clamp:t=!0,ease:n,mixer:r}={}){const s=i.length;if(hc(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=i[0]===i[1];i[0]>i[s-1]&&(i=[...i].reverse(),e=[...e].reverse());const a=nw(e,n,r),c=a.length,h=d=>{if(o&&d<i[0])return e[0];let p=0;if(c>1)for(;p<i.length-2&&!(d<i[p+1]);p++);const y=Go(i[p],i[p+1],d);return a[p](y)};return t?d=>h(Wn(i[0],i[s-1],d)):h}function sw(i,e){const t=i[i.length-1];for(let n=1;n<=e;n++){const r=Go(0,e,n);i.push(Ct(t,1,r))}}function ow(i){const e=[0];return sw(e,i.length-1),e}function aw(i,e){return i.map(t=>t*e)}function Aw(i,e){return i.map(()=>e||$y).splice(0,i.length-1)}function Do({duration:i=300,keyframes:e,times:t,ease:n="easeInOut"}){const r=v_(n)?n.map(Bd):Bd(n),s={done:!1,value:e[0]},o=aw(t&&t.length===e.length?t:ow(e),i),a=rw(o,e,{ease:Array.isArray(r)?r:Aw(e,r)});return{calculatedDuration:i,next:c=>(s.value=a(c),s.done=c>=i,s)}}const lw=i=>i!==null;function xc(i,{repeat:e,repeatType:t="loop"},n,r=1){const s=i.filter(lw),a=r<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!a||n===void 0?s[a]:n}const uw={decay:B0,inertia:B0,tween:Do,keyframes:Do,spring:kA};function Jy(i){typeof i.type=="string"&&(i.type=uw[i.type])}class _c{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const fw=i=>i/100;class wc extends _c{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==wi.now()&&this.tick(wi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;Jy(e);const{type:t=Do,repeat:n=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const c=t||Do;c!==Do&&typeof a[0]!="number"&&(this.mixKeyframes=fa(fw,qy(a[0],a[1])),a=[0,100]);const h=c({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...a].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=bc(h));const{calculatedDuration:d}=h;this.calculatedDuration=d,this.resolvedDuration=d+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=h}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:h=0,keyframes:d,repeat:p,repeatType:y,repeatDelay:T,type:b,onUpdate:_,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const L=this.currentTime-h*(this.playbackSpeed>=0?1:-1),P=this.playbackSpeed>=0?L<0:L>r;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let R=this.currentTime,k=n;if(p){const G=Math.min(this.currentTime,r)/a;let W=Math.floor(G),Q=G%1;!Q&&G>=1&&(Q=1),Q===1&&W--,W=Math.min(W,p+1),!!(W%2)&&(y==="reverse"?(Q=1-Q,T&&(Q-=T/a)):y==="mirror"&&(k=o)),R=Wn(0,1,Q)*a}const F=P?{done:!1,value:d[0]}:k.next(R);s&&(F.value=s(F.value));let{done:U}=F;!P&&c!==null&&(U=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const $=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return $&&b!==B0&&(F.value=xc(d,this.options,w,this.speed)),_&&_(F.value),$&&this.finish(),F}then(e,t){return this.finished.then(e,t)}get duration(){return _n(this.calculatedDuration)}get time(){return _n(this.currentTime)}set time(e){e=xn(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(wi.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=_n(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Y_,startTime:t}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=t??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(wi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function cw(i){for(let e=1;e<i.length;e++)i[e]??(i[e]=i[e-1])}const Br=i=>i*180/Math.PI,N0=i=>{const e=Br(Math.atan2(i[1],i[0]));return U0(e)},hw={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate:N0,rotateZ:N0,skewX:i=>Br(Math.atan(i[1])),skewY:i=>Br(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},U0=i=>(i=i%360,i<0&&(i+=360),i),Hd=N0,jd=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),Kd=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),dw={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:jd,scaleY:Kd,scale:i=>(jd(i)+Kd(i))/2,rotateX:i=>U0(Br(Math.atan2(i[6],i[5]))),rotateY:i=>U0(Br(Math.atan2(-i[2],i[0]))),rotateZ:Hd,rotate:Hd,skewX:i=>Br(Math.atan(i[4])),skewY:i=>Br(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function $0(i){return i.includes("scale")?1:0}function G0(i,e){if(!i||i==="none")return $0(e);const t=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,r;if(t)n=dw,r=t;else{const a=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=hw,r=a}if(!r)return $0(e);const s=n[e],o=r[1].split(",").map(pw);return typeof s=="function"?s(o):o[s]}const gw=(i,e)=>{const{transform:t="none"}=getComputedStyle(i);return G0(t,e)};function pw(i){return parseFloat(i.trim())}const Ys=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],zs=new Set(Ys),Qd=i=>i===Ws||i===Ve,mw=new Set(["x","y","z"]),yw=Ys.filter(i=>!mw.has(i));function vw(i){const e=[];return yw.forEach(t=>{const n=i.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const $r={width:({x:i},{paddingLeft:e="0",paddingRight:t="0"})=>i.max-i.min-parseFloat(e)-parseFloat(t),height:({y:i},{paddingTop:e="0",paddingBottom:t="0"})=>i.max-i.min-parseFloat(e)-parseFloat(t),top:(i,{top:e})=>parseFloat(e),left:(i,{left:e})=>parseFloat(e),bottom:({y:i},{top:e})=>parseFloat(e)+(i.max-i.min),right:({x:i},{left:e})=>parseFloat(e)+(i.max-i.min),x:(i,{transform:e})=>G0(e,"x"),y:(i,{transform:e})=>G0(e,"y")};$r.translateX=$r.x;$r.translateY=$r.y;const Gr=new Set;let V0=!1,H0=!1,j0=!1;function e2(){if(H0){const i=Array.from(Gr).filter(n=>n.needsMeasurement),e=new Set(i.map(n=>n.element)),t=new Map;e.forEach(n=>{const r=vw(n);r.length&&(t.set(n,r),n.render())}),i.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const r=t.get(n);r&&r.forEach(([s,o])=>{n.getValue(s)?.set(o)})}),i.forEach(n=>n.measureEndState()),i.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}H0=!1,V0=!1,Gr.forEach(i=>i.complete(j0)),Gr.clear()}function t2(){Gr.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(H0=!0)})}function Ew(){j0=!0,t2(),e2(),j0=!1}class Ic{constructor(e,t,n,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Gr.add(this),V0||(V0=!0,Lt.read(t2),Lt.resolveKeyframes(e2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(e[0]===null){const s=r?.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(n&&t){const a=n.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),r&&s===void 0&&r.set(e[0])}cw(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Gr.delete(this)}cancel(){this.state==="scheduled"&&(Gr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Tw=i=>i.startsWith("--");function Sw(i,e,t){Tw(e)?i.style.setProperty(e,t):i.style[e]=t}const bw=dc(()=>window.ScrollTimeline!==void 0),xw={};function _w(i,e){const t=dc(i);return()=>xw[e]??t()}const i2=_w(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),To=([i,e,t,n])=>`cubic-bezier(${i}, ${e}, ${t}, ${n})`,Wd={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:To([0,.65,.55,1]),circOut:To([.55,0,1,.45]),backIn:To([.31,.01,.66,-.59]),backOut:To([.33,1.53,.69,.99])};function n2(i,e){if(i)return typeof i=="function"?i2()?Xy(i,e):"ease-out":Gy(i)?To(i):Array.isArray(i)?i.map(t=>n2(t,e)||Wd.easeOut):Wd[i]}function ww(i,e,t,{delay:n=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:c}={},h=void 0){const d={[e]:t};c&&(d.offset=c);const p=n2(a,r);Array.isArray(p)&&(d.easing=p);const y={delay:n,duration:r,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(y.pseudoElement=h),i.animate(d,y)}function r2(i){return typeof i=="function"&&"applyToOptions"in i}function Iw({type:i,...e}){return r2(i)&&i2()?i.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Lw extends _c{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:c}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,hc(typeof e.type!="string");const h=Iw(e);this.animation=ww(t,n,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const d=xc(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(d):Sw(t,n,d),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return _n(Number(e))}get time(){return _n(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=xn(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&bw()?(this.animation.timeline=e,Xi):t(this)}}const s2={anticipate:By,backInOut:Fy,circInOut:Uy};function Rw(i){return i in s2}function Dw(i){typeof i.ease=="string"&&Rw(i.ease)&&(i.ease=s2[i.ease])}const Yd=10;class Cw extends Lw{constructor(e){Dw(e),Jy(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:n,onComplete:r,element:s,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new wc({...o,autoplay:!1}),c=xn(this.finishedTime??this.time);t.setWithVelocity(a.sample(c-Yd).value,a.sample(c).value,Yd),a.stop()}}const zd=(i,e)=>e==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(gr.test(i)||i==="0")&&!i.startsWith("url("));function Pw(i){const e=i[0];if(i.length===1)return!0;for(let t=0;t<i.length;t++)if(i[t]!==e)return!0}function kw(i,e,t,n){const r=i[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=i[i.length-1],o=zd(r,e),a=zd(s,e);return!o||!a?!1:Pw(i)||(t==="spring"||r2(t))&&n}function K0(i){i.duration=0,i.type}const Mw=new Set(["opacity","clipPath","filter","transform"]),Ow=dc(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Fw(i){const{motionValue:e,name:t,repeatDelay:n,repeatType:r,damping:s,type:o}=i;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=e.owner.getProps();return Ow()&&t&&Mw.has(t)&&(t!=="transform"||!h)&&!c&&!n&&r!=="mirror"&&s!==0&&o!=="inertia"}const Bw=40;class Nw extends _c{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:c,motionValue:h,element:d,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=wi.now();const y={autoplay:e,delay:t,type:n,repeat:r,repeatDelay:s,repeatType:o,name:c,motionValue:h,element:d,...p},T=d?.KeyframeResolver||Ic;this.keyframeResolver=new T(a,(b,_,w)=>this.onKeyframesResolved(b,_,y,!w),c,h,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:c,isHandoff:h,onUpdate:d}=n;this.resolvedAt=wi.now(),kw(e,s,o,a)||((Yn.instantAnimations||!c)&&d?.(xc(e,n,t)),e[0]=e[e.length-1],K0(n),n.repeat=0);const y={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Bw?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},T=!h&&Fw(y)?new Cw({...y,element:y.motionValue.owner.current}):new wc(y);T.finished.then(()=>this.notifyFinished()).catch(Xi),this.pendingTimeline&&(this.stopTimeline=T.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=T}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Ew()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Uw=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $w(i){const e=Uw.exec(i);if(!e)return[,];const[,t,n,r]=e;return[`--${t??n}`,r]}function o2(i,e,t=1){const[n,r]=$w(i);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);if(s){const o=s.trim();return Ly(o)?parseFloat(o):o}return vc(r)?o2(r,e,t+1):r}function Lc(i,e){return i?.[e]??i?.default??i}const a2=new Set(["width","height","top","left","right","bottom",...Ys]),Gw={test:i=>i==="auto",parse:i=>i},A2=i=>e=>e.test(i),l2=[Ws,Ve,wn,lr,P_,C_,Gw],qd=i=>l2.find(A2(i));function Vw(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||Dy(i):!0}const Hw=new Set(["brightness","contrast","saturate","opacity"]);function jw(i){const[e,t]=i.slice(0,-1).split("(");if(e==="drop-shadow")return i;const[n]=t.match(Ec)||[];if(!n)return i;const r=t.replace(n,"");let s=Hw.has(e)?1:0;return n!==t&&(s*=100),e+"("+s+r+")"}const Kw=/\b([a-z-]*)\(.*?\)/gu,Q0={...gr,getAnimatableNone:i=>{const e=i.match(Kw);return e?e.map(jw).join(" "):i}},Xd={...Ws,transform:Math.round},Qw={rotate:lr,rotateX:lr,rotateY:lr,rotateZ:lr,scale:Ba,scaleX:Ba,scaleY:Ba,scaleZ:Ba,skew:lr,skewX:lr,skewY:lr,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:Vo,originX:Nd,originY:Nd,originZ:Ve},Rc={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,backgroundPositionX:Ve,backgroundPositionY:Ve,...Qw,zIndex:Xd,fillOpacity:Vo,strokeOpacity:Vo,numOctaves:Xd},Ww={...Rc,color:Ut,backgroundColor:Ut,outlineColor:Ut,fill:Ut,stroke:Ut,borderColor:Ut,borderTopColor:Ut,borderRightColor:Ut,borderBottomColor:Ut,borderLeftColor:Ut,filter:Q0,WebkitFilter:Q0},u2=i=>Ww[i];function f2(i,e){let t=u2(i);return t!==Q0&&(t=gr),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Yw=new Set(["auto","none","0"]);function zw(i,e,t){let n=0,r;for(;n<i.length&&!r;){const s=i[n];typeof s=="string"&&!Yw.has(s)&&Ho(s).values.length&&(r=i[n]),n++}if(r&&t)for(const s of e)i[s]=f2(t,r)}class qw extends Ic{constructor(e,t,n,r,s){super(e,t,n,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),vc(h))){const d=o2(h,t.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!a2.has(n)||e.length!==2)return;const[r,s]=e,o=qd(r),a=qd(s);if(o!==a)if(Qd(o)&&Qd(a))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else $r[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(e[r]===null||Vw(e[r]))&&n.push(r);n.length&&zw(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$r[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(n,r).jump(r,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const s=n.length-1,o=n[s];n[s]=$r[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,c])=>{e.getValue(a).set(c)}),this.resolveNoneKeyframes()}}function Xw(i,e,t){if(i instanceof EventTarget)return[i];if(typeof i=="string"){let n=document;const r=t?.[i]??n.querySelectorAll(i);return r?Array.from(r):[]}return Array.from(i)}const c2=(i,e)=>e&&typeof i=="number"?e.transform(i):i;function Zw(i){return Ry(i)&&"offsetHeight"in i}const Zd=30,Jw=i=>!isNaN(parseFloat(i));class eI{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const r=wi.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=wi.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Jw(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new gc);const n=this.events[e].add(t);return e==="change"?()=>{n(),Lt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=wi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Zd)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,Zd);return Cy(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Os(i,e){return new eI(i,e)}const{schedule:Dc}=Vy(queueMicrotask,!1),ln={x:!1,y:!1};function h2(){return ln.x||ln.y}function tI(i){return i==="x"||i==="y"?ln[i]?null:(ln[i]=!0,()=>{ln[i]=!1}):ln.x||ln.y?null:(ln.x=ln.y=!0,()=>{ln.x=ln.y=!1})}function d2(i,e){const t=Xw(i),n=new AbortController,r={passive:!0,...e,signal:n.signal};return[t,r,()=>n.abort()]}function Jd(i){return!(i.pointerType==="touch"||h2())}function iI(i,e,t={}){const[n,r,s]=d2(i,t),o=a=>{if(!Jd(a))return;const{target:c}=a,h=e(c,a);if(typeof h!="function"||!c)return;const d=p=>{Jd(p)&&(h(p),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,r)};return n.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const g2=(i,e)=>e?i===e?!0:g2(i,e.parentElement):!1,Cc=i=>i.pointerType==="mouse"?typeof i.button!="number"||i.button<=0:i.isPrimary!==!1,nI=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function rI(i){return nI.has(i.tagName)||i.tabIndex!==-1}const gA=new WeakSet;function eg(i){return e=>{e.key==="Enter"&&i(e)}}function ku(i,e){i.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const sI=(i,e)=>{const t=i.currentTarget;if(!t)return;const n=eg(()=>{if(gA.has(t))return;ku(t,"down");const r=eg(()=>{ku(t,"up")}),s=()=>ku(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function tg(i){return Cc(i)&&!h2()}function oI(i,e,t={}){const[n,r,s]=d2(i,t),o=a=>{const c=a.currentTarget;if(!tg(a))return;gA.add(c);const h=e(c,a),d=(T,b)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),gA.has(c)&&gA.delete(c),tg(T)&&typeof h=="function"&&h(T,{success:b})},p=T=>{d(T,c===window||c===document||t.useGlobalTarget||g2(c,T.target))},y=T=>{d(T,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return n.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),Zw(a)&&(a.addEventListener("focus",h=>sI(h,r)),!rI(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function p2(i){return Ry(i)&&"ownerSVGElement"in i}function aI(i){return p2(i)&&i.tagName==="svg"}const Ai=i=>!!(i&&i.getVelocity),AI=[...l2,Ut,gr],lI=i=>AI.find(A2(i)),m2=Oe.createContext({transformPagePoint:i=>i,isStatic:!1,reducedMotion:"never"});function uI(i=!0){const e=Oe.useContext(uc);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:r}=e,s=Oe.useId();Oe.useEffect(()=>{if(i)return r(s)},[i]);const o=Oe.useCallback(()=>i&&n&&n(s),[s,n,i]);return!t&&n?[!1,o]:[!0]}const y2=Oe.createContext({strict:!1}),ig={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Fs={};for(const i in ig)Fs[i]={isEnabled:e=>ig[i].some(t=>!!e[t])};function fI(i){for(const e in i)Fs[e]={...Fs[e],...i[e]}}const cI=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function MA(i){return i.startsWith("while")||i.startsWith("drag")&&i!=="draggable"||i.startsWith("layout")||i.startsWith("onTap")||i.startsWith("onPan")||i.startsWith("onLayout")||cI.has(i)}let v2=i=>!MA(i);function hI(i){typeof i=="function"&&(v2=e=>e.startsWith("on")?!MA(e):i(e))}try{hI(require("@emotion/is-prop-valid").default)}catch{}function dI(i,e,t){const n={};for(const r in i)r==="values"&&typeof i.values=="object"||(v2(r)||t===!0&&MA(r)||!e&&!MA(r)||i.draggable&&r.startsWith("onDrag"))&&(n[r]=i[r]);return n}const Il=Oe.createContext({});function Ll(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function jo(i){return typeof i=="string"||Array.isArray(i)}const Pc=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kc=["initial",...Pc];function Rl(i){return Ll(i.animate)||kc.some(e=>jo(i[e]))}function E2(i){return!!(Rl(i)||i.variants)}function gI(i,e){if(Rl(i)){const{initial:t,animate:n}=i;return{initial:t===!1||jo(t)?t:void 0,animate:jo(n)?n:void 0}}return i.inherit!==!1?e:{}}function pI(i){const{initial:e,animate:t}=gI(i,Oe.useContext(Il));return Oe.useMemo(()=>({initial:e,animate:t}),[ng(e),ng(t)])}function ng(i){return Array.isArray(i)?i.join(" "):i}const Ko={};function mI(i){for(const e in i)Ko[e]=i[e],yc(e)&&(Ko[e].isCSSVariable=!0)}function T2(i,{layout:e,layoutId:t}){return zs.has(i)||i.startsWith("origin")||(e||t!==void 0)&&(!!Ko[i]||i==="opacity")}const yI={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},vI=Ys.length;function EI(i,e,t){let n="",r=!0;for(let s=0;s<vI;s++){const o=Ys[s],a=i[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const h=c2(a,Rc[o]);if(!c){r=!1;const d=yI[o]||o;n+=`${d}(${h}) `}t&&(e[o]=h)}}return n=n.trim(),t?n=t(e,r?"":n):r&&(n="none"),n}function Mc(i,e,t){const{style:n,vars:r,transformOrigin:s}=i;let o=!1,a=!1;for(const c in e){const h=e[c];if(zs.has(c)){o=!0;continue}else if(yc(c)){r[c]=h;continue}else{const d=c2(h,Rc[c]);c.startsWith("origin")?(a=!0,s[c]=d):n[c]=d}}if(e.transform||(o||t?n.transform=EI(e,i.transform,t):n.transform&&(n.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:d=0}=s;n.transformOrigin=`${c} ${h} ${d}`}}const Oc=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function S2(i,e,t){for(const n in e)!Ai(e[n])&&!T2(n,t)&&(i[n]=e[n])}function TI({transformTemplate:i},e){return Oe.useMemo(()=>{const t=Oc();return Mc(t,e,i),Object.assign({},t.vars,t.style)},[e])}function SI(i,e){const t=i.style||{},n={};return S2(n,t,i),Object.assign(n,TI(i,e)),n}function bI(i,e){const t={},n=SI(i,e);return i.drag&&i.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=i.drag===!0?"none":`pan-${i.drag==="x"?"y":"x"}`),i.tabIndex===void 0&&(i.onTap||i.onTapStart||i.whileTap)&&(t.tabIndex=0),t.style=n,t}const xI={offset:"stroke-dashoffset",array:"stroke-dasharray"},_I={offset:"strokeDashoffset",array:"strokeDasharray"};function wI(i,e,t=1,n=0,r=!0){i.pathLength=1;const s=r?xI:_I;i[s.offset]=Ve.transform(-n);const o=Ve.transform(e),a=Ve.transform(t);i[s.array]=`${o} ${a}`}function b2(i,{attrX:e,attrY:t,attrScale:n,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},c,h,d){if(Mc(i,a,h),c){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:p,style:y}=i;p.transform&&(y.transform=p.transform,delete p.transform),(y.transform||p.transformOrigin)&&(y.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),y.transform&&(y.transformBox=d?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),n!==void 0&&(p.scale=n),r!==void 0&&wI(p,r,s,o,!1)}const x2=()=>({...Oc(),attrs:{}}),_2=i=>typeof i=="string"&&i.toLowerCase()==="svg";function II(i,e,t,n){const r=Oe.useMemo(()=>{const s=x2();return b2(s,e,_2(n),i.transformTemplate,i.style),{...s.attrs,style:{...s.style}}},[e]);if(i.style){const s={};S2(s,i.style,i),r.style={...s,...r.style}}return r}const LI=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Fc(i){return typeof i!="string"||i.includes("-")?!1:!!(LI.indexOf(i)>-1||/[A-Z]/u.test(i))}function RI(i,e,t,{latestValues:n},r,s=!1){const a=(Fc(i)?II:bI)(e,n,r,i),c=dI(e,typeof i=="string",s),h=i!==Oe.Fragment?{...c,...a,ref:t}:{},{children:d}=e,p=Oe.useMemo(()=>Ai(d)?d.get():d,[d]);return Oe.createElement(i,{...h,children:p})}function rg(i){const e=[{},{}];return i?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function Bc(i,e,t,n){if(typeof e=="function"){const[r,s]=rg(n);e=e(t!==void 0?t:i.custom,r,s)}if(typeof e=="string"&&(e=i.variants&&i.variants[e]),typeof e=="function"){const[r,s]=rg(n);e=e(t!==void 0?t:i.custom,r,s)}return e}function pA(i){return Ai(i)?i.get():i}function DI({scrapeMotionValuesFromProps:i,createRenderState:e},t,n,r){return{latestValues:CI(t,n,r,i),renderState:e()}}function CI(i,e,t,n){const r={},s=n(i,{});for(const y in s)r[y]=pA(s[y]);let{initial:o,animate:a}=i;const c=Rl(i),h=E2(i);e&&h&&!c&&i.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const p=d?a:o;if(p&&typeof p!="boolean"&&!Ll(p)){const y=Array.isArray(p)?p:[p];for(let T=0;T<y.length;T++){const b=Bc(i,y[T]);if(b){const{transitionEnd:_,transition:w,...L}=b;for(const P in L){let R=L[P];if(Array.isArray(R)){const k=d?R.length-1:0;R=R[k]}R!==null&&(r[P]=R)}for(const P in _)r[P]=_[P]}}}return r}const w2=i=>(e,t)=>{const n=Oe.useContext(Il),r=Oe.useContext(uc),s=()=>DI(i,e,n,r);return t?s():f_(s)};function Nc(i,e,t){const{style:n}=i,r={};for(const s in n)(Ai(n[s])||e.style&&Ai(e.style[s])||T2(s,i)||t?.getValue(s)?.liveStyle!==void 0)&&(r[s]=n[s]);return r}const PI=w2({scrapeMotionValuesFromProps:Nc,createRenderState:Oc});function I2(i,e,t){const n=Nc(i,e,t);for(const r in i)if(Ai(i[r])||Ai(e[r])){const s=Ys.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=i[r]}return n}const kI=w2({scrapeMotionValuesFromProps:I2,createRenderState:x2}),MI=Symbol.for("motionComponentSymbol");function ys(i){return i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"current")}function OI(i,e,t){return Oe.useCallback(n=>{n&&i.onMount&&i.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):ys(t)&&(t.current=n))},[e])}const Uc=i=>i.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),FI="framerAppearId",L2="data-"+Uc(FI),R2=Oe.createContext({});function BI(i,e,t,n,r){const{visualElement:s}=Oe.useContext(Il),o=Oe.useContext(y2),a=Oe.useContext(uc),c=Oe.useContext(m2).reducedMotion,h=Oe.useRef(null);n=n||o.renderer,!h.current&&n&&(h.current=n(i,{visualState:e,parent:s,props:t,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:c}));const d=h.current,p=Oe.useContext(R2);d&&!d.projection&&r&&(d.type==="html"||d.type==="svg")&&NI(h.current,t,r,p);const y=Oe.useRef(!1);Oe.useInsertionEffect(()=>{d&&y.current&&d.update(t,a)});const T=t[L2],b=Oe.useRef(!!T&&!window.MotionHandoffIsComplete?.(T)&&window.MotionHasOptimisedAnimation?.(T));return c_(()=>{d&&(y.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),b.current&&d.animationState&&d.animationState.animateChanges())}),Oe.useEffect(()=>{d&&(!b.current&&d.animationState&&d.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(T)}),b.current=!1),d.enteringChildren=void 0)}),d}function NI(i,e,t,n){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h,layoutCrossfade:d}=e;i.projection=new t(i.latestValues,e["data-framer-portal-id"]?void 0:D2(i.parent)),i.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&ys(a),visualElement:i,animationType:typeof s=="string"?s:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:h})}function D2(i){if(i)return i.options.allowProjection!==!1?i.projection:D2(i.parent)}function Mu(i,{forwardMotionProps:e=!1}={},t,n){t&&fI(t);const r=Fc(i)?kI:PI;function s(a,c){let h;const d={...Oe.useContext(m2),...a,layoutId:UI(a)},{isStatic:p}=d,y=pI(a),T=r(a,p);if(!p&&lc){$I();const b=GI(d);h=b.MeasureLayout,y.visualElement=BI(i,T,d,n,b.ProjectionNode)}return C0.jsxs(Il.Provider,{value:y,children:[h&&y.visualElement?C0.jsx(h,{visualElement:y.visualElement,...d}):null,RI(i,a,OI(T,y.visualElement,c),T,p,e)]})}s.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const o=Oe.forwardRef(s);return o[MI]=i,o}function UI({layoutId:i}){const e=Oe.useContext(Iy).id;return e&&i!==void 0?e+"-"+i:i}function $I(i,e){Oe.useContext(y2).strict}function GI(i){const{drag:e,layout:t}=Fs;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(i)||t?.isEnabled(i)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function VI(i,e){if(typeof Proxy>"u")return Mu;const t=new Map,n=(s,o)=>Mu(s,o,i,e),r=(s,o)=>n(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?n:(t.has(o)||t.set(o,Mu(o,void 0,i,e)),t.get(o))})}function C2({top:i,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:i,max:n}}}function HI({x:i,y:e}){return{top:e.min,right:i.max,bottom:e.max,left:i.min}}function jI(i,e){if(!e)return i;const t=e({x:i.left,y:i.top}),n=e({x:i.right,y:i.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function Ou(i){return i===void 0||i===1}function W0({scale:i,scaleX:e,scaleY:t}){return!Ou(i)||!Ou(e)||!Ou(t)}function Cr(i){return W0(i)||P2(i)||i.z||i.rotate||i.rotateX||i.rotateY||i.skewX||i.skewY}function P2(i){return sg(i.x)||sg(i.y)}function sg(i){return i&&i!=="0%"}function OA(i,e,t){const n=i-t,r=e*n;return t+r}function og(i,e,t,n,r){return r!==void 0&&(i=OA(i,r,n)),OA(i,t,n)+e}function Y0(i,e=0,t=1,n,r){i.min=og(i.min,e,t,n,r),i.max=og(i.max,e,t,n,r)}function k2(i,{x:e,y:t}){Y0(i.x,e.translate,e.scale,e.originPoint),Y0(i.y,t.translate,t.scale,t.originPoint)}const ag=.999999999999,Ag=1.0000000000001;function KI(i,e,t,n=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Es(i,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,k2(i,o)),n&&Cr(s.latestValues)&&Es(i,s.latestValues))}e.x<Ag&&e.x>ag&&(e.x=1),e.y<Ag&&e.y>ag&&(e.y=1)}function vs(i,e){i.min=i.min+e,i.max=i.max+e}function lg(i,e,t,n,r=.5){const s=Ct(i.min,i.max,r);Y0(i,e,t,s,n)}function Es(i,e){lg(i.x,e.x,e.scaleX,e.scale,e.originX),lg(i.y,e.y,e.scaleY,e.scale,e.originY)}function M2(i,e){return C2(jI(i.getBoundingClientRect(),e))}function QI(i,e,t){const n=M2(i,t),{scroll:r}=e;return r&&(vs(n.x,r.offset.x),vs(n.y,r.offset.y)),n}const ug=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ts=()=>({x:ug(),y:ug()}),fg=()=>({min:0,max:0}),Bt=()=>({x:fg(),y:fg()}),z0={current:null},O2={current:!1};function WI(){if(O2.current=!0,!!lc)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),e=()=>z0.current=i.matches;i.addEventListener("change",e),e()}else z0.current=!1}const YI=new WeakMap;function zI(i,e,t){for(const n in e){const r=e[n],s=t[n];if(Ai(r))i.addValue(n,r);else if(Ai(s))i.addValue(n,Os(r,{owner:i}));else if(s!==r)if(i.hasValue(n)){const o=i.getValue(n);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=i.getStaticValue(n);i.addValue(n,Os(o!==void 0?o:r,{owner:i}))}}for(const n in t)e[n]===void 0&&i.removeValue(n);return e}const cg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class qI{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ic,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=wi.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,Lt.render(this.render,!1,!0))};const{latestValues:c,renderState:h}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=Rl(t),this.isVariantNode=E2(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in p){const T=p[y];c[y]!==void 0&&Ai(T)&&T.set(c[y])}}mount(e){this.current=e,YI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),O2.current||WI(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:z0.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),dr(this.notifyUpdate),dr(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=zs.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Lt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Fs){const t=Fs[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Bt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<cg.length;n++){const r=cg[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=zI(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=Os(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(Ly(n)||Dy(n))?n=parseFloat(n):!lI(n)&&gr.test(t)&&(n=f2(e,t)),this.setBaseTarget(e,Ai(n)?n.get():n)),Ai(n)?n.get():n}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if(typeof t=="string"||typeof t=="object"){const s=Bc(this.props,t,this.presenceContext?.custom);s&&(n=s[e])}if(t&&n!==void 0)return n;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!Ai(r)?r:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new gc),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){Dc.render(this.render)}}class F2 extends qI{constructor(){super(...arguments),this.KeyframeResolver=qw}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ai(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function B2(i,{style:e,vars:t},n,r){const s=i.style;let o;for(o in e)s[o]=e[o];r?.applyProjectionStyles(s,n);for(o in t)s.setProperty(o,t[o])}function XI(i){return window.getComputedStyle(i)}class ZI extends F2{constructor(){super(...arguments),this.type="html",this.renderInstance=B2}readValueFromInstance(e,t){if(zs.has(t))return this.projection?.isProjecting?$0(t):gw(e,t);{const n=XI(e),r=(yc(t)?n.getPropertyValue(t):n[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return M2(e,t)}build(e,t,n){Mc(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return Nc(e,t,n)}}const N2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function JI(i,e,t,n){B2(i,e,void 0,n);for(const r in e.attrs)i.setAttribute(N2.has(r)?r:Uc(r),e.attrs[r])}class eL extends F2{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Bt}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(zs.has(t)){const n=u2(t);return n&&n.default||0}return t=N2.has(t)?t:Uc(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return I2(e,t,n)}build(e,t,n){b2(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){JI(e,t,n,r)}mount(e){this.isSVGTag=_2(e.tagName),super.mount(e)}}const tL=(i,e)=>Fc(i)?new eL(e):new ZI(e,{allowProjection:i!==Oe.Fragment});function Is(i,e,t){const n=i.getProps();return Bc(n,e,t!==void 0?t:n.custom,i)}const q0=i=>Array.isArray(i);function iL(i,e,t){i.hasValue(e)?i.getValue(e).set(t):i.addValue(e,Os(t))}function nL(i){return q0(i)?i[i.length-1]||0:i}function rL(i,e){const t=Is(i,e);let{transitionEnd:n={},transition:r={},...s}=t||{};s={...s,...n};for(const o in s){const a=nL(s[o]);iL(i,o,a)}}function sL(i){return!!(Ai(i)&&i.add)}function X0(i,e){const t=i.getValue("willChange");if(sL(t))return t.add(e);if(!t&&Yn.WillChange){const n=new Yn.WillChange("auto");i.addValue("willChange",n),n.add(e)}}function U2(i){return i.props[L2]}const oL=i=>i!==null;function aL(i,{repeat:e,repeatType:t="loop"},n){const r=i.filter(oL),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return r[s]}const AL={type:"spring",stiffness:500,damping:25,restSpeed:10},lL=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),uL={type:"keyframes",duration:.8},fL={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cL=(i,{keyframes:e})=>e.length>2?uL:zs.has(i)?i.startsWith("scale")?lL(e[1]):AL:fL;function hL({when:i,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...d}){return!!Object.keys(d).length}const $c=(i,e,t,n={},r,s)=>o=>{const a=Lc(n,i)||{},c=a.delay||n.delay||0;let{elapsed:h=0}=n;h=h-xn(c);const d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:y=>{e.set(y),a.onUpdate&&a.onUpdate(y)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:i,motionValue:e,element:s?void 0:r};hL(a)||Object.assign(d,cL(i,d)),d.duration&&(d.duration=xn(d.duration)),d.repeatDelay&&(d.repeatDelay=xn(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let p=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(K0(d),d.delay===0&&(p=!0)),(Yn.instantAnimations||Yn.skipAnimations)&&(p=!0,K0(d),d.delay=0),d.allowFlatten=!a.type&&!a.ease,p&&!s&&e.get()!==void 0){const y=aL(d.keyframes,a);if(y!==void 0){Lt.update(()=>{d.onUpdate(y),d.onComplete()});return}}return a.isSync?new wc(d):new Nw(d)};function dL({protectedKeys:i,needsAnimating:e},t){const n=i.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function $2(i,e,{delay:t=0,transitionOverride:n,type:r}={}){let{transition:s=i.getDefaultTransition(),transitionEnd:o,...a}=e;n&&(s=n);const c=[],h=r&&i.animationState&&i.animationState.getState()[r];for(const d in a){const p=i.getValue(d,i.latestValues[d]??null),y=a[d];if(y===void 0||h&&dL(h,d))continue;const T={delay:t,...Lc(s||{},d)},b=p.get();if(b!==void 0&&!p.isAnimating&&!Array.isArray(y)&&y===b&&!T.velocity)continue;let _=!1;if(window.MotionHandoffAnimation){const L=U2(i);if(L){const P=window.MotionHandoffAnimation(L,d,Lt);P!==null&&(T.startTime=P,_=!0)}}X0(i,d),p.start($c(d,p,y,i.shouldReduceMotion&&a2.has(d)?{type:!1}:T,i,_));const w=p.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{Lt.update(()=>{o&&rL(i,o)})}),c}function G2(i,e,t,n=0,r=1){const s=Array.from(i).sort((h,d)=>h.sortNodePosition(d)).indexOf(e),o=i.size,a=(o-1)*n;return typeof t=="function"?t(s,o):r===1?s*n:a-s*n}function Z0(i,e,t={}){const n=Is(i,e,t.type==="exit"?i.presenceContext?.custom:void 0);let{transition:r=i.getDefaultTransition()||{}}=n||{};t.transitionOverride&&(r=t.transitionOverride);const s=n?()=>Promise.all($2(i,n,t)):()=>Promise.resolve(),o=i.variantChildren&&i.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:p}=r;return gL(i,e,c,h,d,p,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[c,h]=a==="beforeChildren"?[s,o]:[o,s];return c().then(()=>h())}else return Promise.all([s(),o(t.delay)])}function gL(i,e,t=0,n=0,r=0,s=1,o){const a=[];for(const c of i.variantChildren)c.notify("AnimationStart",e),a.push(Z0(c,e,{...o,delay:t+(typeof n=="function"?0:n)+G2(i.variantChildren,c,n,r,s)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(a)}function pL(i,e,t={}){i.notify("AnimationStart",e);let n;if(Array.isArray(e)){const r=e.map(s=>Z0(i,s,t));n=Promise.all(r)}else if(typeof e=="string")n=Z0(i,e,t);else{const r=typeof e=="function"?Is(i,e,t.custom):e;n=Promise.all($2(i,r,t))}return n.then(()=>{i.notify("AnimationComplete",e)})}function V2(i,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==i.length)return!1;for(let n=0;n<t;n++)if(e[n]!==i[n])return!1;return!0}const mL=kc.length;function H2(i){if(!i)return;if(!i.isControllingVariants){const t=i.parent?H2(i.parent)||{}:{};return i.props.initial!==void 0&&(t.initial=i.props.initial),t}const e={};for(let t=0;t<mL;t++){const n=kc[t],r=i.props[n];(jo(r)||r===!1)&&(e[n]=r)}return e}const yL=[...Pc].reverse(),vL=Pc.length;function EL(i){return e=>Promise.all(e.map(({animation:t,options:n})=>pL(i,t,n)))}function TL(i){let e=EL(i),t=hg(),n=!0;const r=c=>(h,d)=>{const p=Is(i,d,c==="exit"?i.presenceContext?.custom:void 0);if(p){const{transition:y,transitionEnd:T,...b}=p;h={...h,...b,...T}}return h};function s(c){e=c(i)}function o(c){const{props:h}=i,d=H2(i.parent)||{},p=[],y=new Set;let T={},b=1/0;for(let w=0;w<vL;w++){const L=yL[w],P=t[L],R=h[L]!==void 0?h[L]:d[L],k=jo(R),F=L===c?P.isActive:null;F===!1&&(b=w);let U=R===d[L]&&R!==h[L]&&k;if(U&&n&&i.manuallyAnimateOnMount&&(U=!1),P.protectedKeys={...T},!P.isActive&&F===null||!R&&!P.prevProp||Ll(R)||typeof R=="boolean")continue;const $=SL(P.prevProp,R);let G=$||L===c&&P.isActive&&!U&&k||w>b&&k,W=!1;const Q=Array.isArray(R)?R:[R];let K=Q.reduce(r(L),{});F===!1&&(K={});const{prevResolvedValues:te={}}=P,oe={...te,...K},Ae=ee=>{G=!0,y.has(ee)&&(W=!0,y.delete(ee)),P.needsAnimating[ee]=!0;const re=i.getValue(ee);re&&(re.liveStyle=!1)};for(const ee in oe){const re=K[ee],ue=te[ee];if(T.hasOwnProperty(ee))continue;let Te=!1;q0(re)&&q0(ue)?Te=!V2(re,ue):Te=re!==ue,Te?re!=null?Ae(ee):y.add(ee):re!==void 0&&y.has(ee)?Ae(ee):P.protectedKeys[ee]=!0}P.prevProp=R,P.prevResolvedValues=K,P.isActive&&(T={...T,...K}),n&&i.blockInitialAnimation&&(G=!1);const X=U&&$;G&&(!X||W)&&p.push(...Q.map(ee=>{const re={type:L};if(typeof ee=="string"&&n&&!X&&i.manuallyAnimateOnMount&&i.parent){const{parent:ue}=i,Te=Is(ue,ee);if(ue.enteringChildren&&Te){const{delayChildren:ge}=Te.transition||{};re.delay=G2(ue.enteringChildren,i,ge)}}return{animation:ee,options:re}}))}if(y.size){const w={};if(typeof h.initial!="boolean"){const L=Is(i,Array.isArray(h.initial)?h.initial[0]:h.initial);L&&L.transition&&(w.transition=L.transition)}y.forEach(L=>{const P=i.getBaseTarget(L),R=i.getValue(L);R&&(R.liveStyle=!0),w[L]=P??null}),p.push({animation:w})}let _=!!p.length;return n&&(h.initial===!1||h.initial===h.animate)&&!i.manuallyAnimateOnMount&&(_=!1),n=!1,_?e(p):Promise.resolve()}function a(c,h){if(t[c].isActive===h)return Promise.resolve();i.variantChildren?.forEach(p=>p.animationState?.setActive(c,h)),t[c].isActive=h;const d=o(c);for(const p in t)t[p].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=hg(),n=!0}}}function SL(i,e){return typeof e=="string"?e!==i:Array.isArray(e)?!V2(e,i):!1}function Ir(i=!1){return{isActive:i,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function hg(){return{animate:Ir(!0),whileInView:Ir(),whileHover:Ir(),whileTap:Ir(),whileDrag:Ir(),whileFocus:Ir(),exit:Ir()}}class mr{constructor(e){this.isMounted=!1,this.node=e}update(){}}class bL extends mr{constructor(e){super(e),e.animationState||(e.animationState=TL(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ll(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let xL=0;class _L extends mr{constructor(){super(...arguments),this.id=xL++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const wL={animation:{Feature:bL},exit:{Feature:_L}};function Qo(i,e,t,n={passive:!0}){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t)}function da(i){return{point:{x:i.pageX,y:i.pageY}}}const IL=i=>e=>Cc(e)&&i(e,da(e));function Co(i,e,t,n){return Qo(i,e,IL(t),n)}const j2=1e-4,LL=1-j2,RL=1+j2,K2=.01,DL=0-K2,CL=0+K2;function mi(i){return i.max-i.min}function PL(i,e,t){return Math.abs(i-e)<=t}function dg(i,e,t,n=.5){i.origin=n,i.originPoint=Ct(e.min,e.max,i.origin),i.scale=mi(t)/mi(e),i.translate=Ct(t.min,t.max,i.origin)-i.originPoint,(i.scale>=LL&&i.scale<=RL||isNaN(i.scale))&&(i.scale=1),(i.translate>=DL&&i.translate<=CL||isNaN(i.translate))&&(i.translate=0)}function Po(i,e,t,n){dg(i.x,e.x,t.x,n?n.originX:void 0),dg(i.y,e.y,t.y,n?n.originY:void 0)}function gg(i,e,t){i.min=t.min+e.min,i.max=i.min+mi(e)}function kL(i,e,t){gg(i.x,e.x,t.x),gg(i.y,e.y,t.y)}function pg(i,e,t){i.min=e.min-t.min,i.max=i.min+mi(e)}function ko(i,e,t){pg(i.x,e.x,t.x),pg(i.y,e.y,t.y)}function zi(i){return[i("x"),i("y")]}const Q2=({current:i})=>i?i.ownerDocument.defaultView:null,mg=(i,e)=>Math.abs(i-e);function ML(i,e){const t=mg(i.x,e.x),n=mg(i.y,e.y);return Math.sqrt(t**2+n**2)}class W2{constructor(e,t,{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Bu(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,b=ML(y.offset,{x:0,y:0})>=this.distanceThreshold;if(!T&&!b)return;const{point:_}=y,{timestamp:w}=ei;this.history.push({..._,timestamp:w});const{onStart:L,onMove:P}=this.handlers;T||(L&&L(this.lastMoveEvent,y),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,y)},this.handlePointerMove=(y,T)=>{this.lastMoveEvent=y,this.lastMoveEventInfo=Fu(T,this.transformPagePoint),Lt.update(this.updatePoint,!0)},this.handlePointerUp=(y,T)=>{this.end();const{onEnd:b,onSessionEnd:_,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const L=Bu(y.type==="pointercancel"?this.lastMoveEventInfo:Fu(T,this.transformPagePoint),this.history);this.startEvent&&b&&b(y,L),_&&_(y,L)},!Cc(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=r||window;const a=da(e),c=Fu(a,this.transformPagePoint),{point:h}=c,{timestamp:d}=ei;this.history=[{...h,timestamp:d}];const{onSessionStart:p}=t;p&&p(e,Bu(c,this.history)),this.removeListeners=fa(Co(this.contextWindow,"pointermove",this.handlePointerMove),Co(this.contextWindow,"pointerup",this.handlePointerUp),Co(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),dr(this.updatePoint)}}function Fu(i,e){return e?{point:e(i.point)}:i}function yg(i,e){return{x:i.x-e.x,y:i.y-e.y}}function Bu({point:i},e){return{point:i,delta:yg(i,Y2(e)),offset:yg(i,OL(e)),velocity:FL(e,.1)}}function OL(i){return i[0]}function Y2(i){return i[i.length-1]}function FL(i,e){if(i.length<2)return{x:0,y:0};let t=i.length-1,n=null;const r=Y2(i);for(;t>=0&&(n=i[t],!(r.timestamp-n.timestamp>xn(e)));)t--;if(!n)return{x:0,y:0};const s=_n(r.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-n.x)/s,y:(r.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function BL(i,{min:e,max:t},n){return e!==void 0&&i<e?i=n?Ct(e,i,n.min):Math.max(i,e):t!==void 0&&i>t&&(i=n?Ct(t,i,n.max):Math.min(i,t)),i}function vg(i,e,t){return{min:e!==void 0?i.min+e:void 0,max:t!==void 0?i.max+t-(i.max-i.min):void 0}}function NL(i,{top:e,left:t,bottom:n,right:r}){return{x:vg(i.x,t,r),y:vg(i.y,e,n)}}function Eg(i,e){let t=e.min-i.min,n=e.max-i.max;return e.max-e.min<i.max-i.min&&([t,n]=[n,t]),{min:t,max:n}}function UL(i,e){return{x:Eg(i.x,e.x),y:Eg(i.y,e.y)}}function $L(i,e){let t=.5;const n=mi(i),r=mi(e);return r>n?t=Go(e.min,e.max-n,i.min):n>r&&(t=Go(i.min,i.max-r,e.min)),Wn(0,1,t)}function GL(i,e){const t={};return e.min!==void 0&&(t.min=e.min-i.min),e.max!==void 0&&(t.max=e.max-i.min),t}const J0=.35;function VL(i=J0){return i===!1?i=0:i===!0&&(i=J0),{x:Tg(i,"left","right"),y:Tg(i,"top","bottom")}}function Tg(i,e,t){return{min:Sg(i,e),max:Sg(i,t)}}function Sg(i,e){return typeof i=="number"?i:i[e]||0}const HL=new WeakMap;class jL{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Bt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:n}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=p=>{const{dragSnapToOrigin:y}=this.getProps();y?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(da(p).point)},o=(p,y)=>{const{drag:T,dragPropagation:b,onDragStart:_}=this.getProps();if(T&&!b&&(this.openDragLock&&this.openDragLock(),this.openDragLock=tI(T),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=y,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),zi(L=>{let P=this.getAxisMotionValue(L).get()||0;if(wn.test(P)){const{projection:R}=this.visualElement;if(R&&R.layout){const k=R.layout.layoutBox[L];k&&(P=mi(k)*(parseFloat(P)/100))}}this.originPoint[L]=P}),_&&Lt.postRender(()=>_(p,y)),X0(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},a=(p,y)=>{this.latestPointerEvent=p,this.latestPanInfo=y;const{dragPropagation:T,dragDirectionLock:b,onDirectionLock:_,onDrag:w}=this.getProps();if(!T&&!this.openDragLock)return;const{offset:L}=y;if(b&&this.currentDirection===null){this.currentDirection=KL(L),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",y.point,L),this.updateAxis("y",y.point,L),this.visualElement.render(),w&&w(p,y)},c=(p,y)=>{this.latestPointerEvent=p,this.latestPanInfo=y,this.stop(p,y),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>zi(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new W2(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:Q2(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,r=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!n)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&Lt.postRender(()=>a(n,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!Na(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=BL(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;e&&ys(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=NL(n.layoutBox,e):this.constraints=!1,this.elastic=VL(t),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&zi(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=GL(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!ys(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=QI(n,r.root,this.visualElement.getTransformPagePoint());let o=UL(r.layout.layoutBox,s);if(t){const a=t(HI(o));this.hasMutatedConstraints=!!a,a&&(o=C2(a))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=zi(d=>{if(!Na(d,t,this.currentDirection))return;let p=c&&c[d]||{};o&&(p={min:0,max:0});const y=r?200:1e6,T=r?40:1e7,b={type:"inertia",velocity:n?e[d]:0,bounceStiffness:y,bounceDamping:T,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(d,b)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return X0(this.visualElement,e),n.start($c(e,n,0,t,this.visualElement,!1))}stopAnimation(){zi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){zi(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){zi(t=>{const{drag:n}=this.getProps();if(!Na(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-Ct(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!ys(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};zi(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=$L({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),zi(o=>{if(!Na(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(Ct(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;HL.set(this.visualElement,this);const e=this.visualElement.current,t=Co(e,"pointerdown",c=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();ys(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Lt.read(n);const o=Qo(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(zi(d=>{const p=this.getAxisMotionValue(d);p&&(this.originPoint[d]+=c[d].translate,p.set(p.get()+c[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=J0,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Na(i,e,t){return(e===!0||e===i)&&(t===null||t===i)}function KL(i,e=10){let t=null;return Math.abs(i.y)>e?t="y":Math.abs(i.x)>e&&(t="x"),t}class QL extends mr{constructor(e){super(e),this.removeGroupControls=Xi,this.removeListeners=Xi,this.controls=new jL(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xi}unmount(){this.removeGroupControls(),this.removeListeners()}}const bg=i=>(e,t)=>{i&&Lt.postRender(()=>i(e,t))};class WL extends mr{constructor(){super(...arguments),this.removePointerDownListener=Xi}onPointerDown(e){this.session=new W2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Q2(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:bg(e),onStart:bg(t),onMove:n,onEnd:(s,o)=>{delete this.session,r&&Lt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Co(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const mA={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function xg(i,e){return e.max===e.min?0:i/(e.max-e.min)*100}const ao={correct:(i,e)=>{if(!e.target)return i;if(typeof i=="string")if(Ve.test(i))i=parseFloat(i);else return i;const t=xg(i,e.target.x),n=xg(i,e.target.y);return`${t}% ${n}%`}},YL={correct:(i,{treeScale:e,projectionDelta:t})=>{const n=i,r=gr.parse(i);if(r.length>5)return n;const s=gr.createTransformer(i),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const h=Ct(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};let Nu=!1;class zL extends Oe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:s}=e;mI(qL),s&&(t.group&&t.group.add(s),n&&n.register&&r&&n.register(s),Nu&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),mA.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:s}=this.props,{projection:o}=n;return o&&(o.isPresent=s,Nu=!0,r||e.layoutDependency!==t||t===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Lt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Dc.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;Nu=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function z2(i){const[e,t]=uI(),n=Oe.useContext(Iy);return C0.jsx(zL,{...i,layoutGroup:n,switchLayoutGroup:Oe.useContext(R2),isPresent:e,safeToRemove:t})}const qL={borderRadius:{...ao,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ao,borderTopRightRadius:ao,borderBottomLeftRadius:ao,borderBottomRightRadius:ao,boxShadow:YL};function XL(i,e,t){const n=Ai(i)?i:Os(i);return n.start($c("",n,e,t)),n.animation}const ZL=(i,e)=>i.depth-e.depth;class JL{constructor(){this.children=[],this.isDirty=!1}add(e){fc(this.children,e),this.isDirty=!0}remove(e){cc(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ZL),this.isDirty=!1,this.children.forEach(e)}}function eR(i,e){const t=wi.now(),n=({timestamp:r})=>{const s=r-t;s>=e&&(dr(n),i(s-e))};return Lt.setup(n,!0),()=>dr(n)}const q2=["TopLeft","TopRight","BottomLeft","BottomRight"],tR=q2.length,_g=i=>typeof i=="string"?parseFloat(i):i,wg=i=>typeof i=="number"||Ve.test(i);function iR(i,e,t,n,r,s){r?(i.opacity=Ct(0,t.opacity??1,nR(n)),i.opacityExit=Ct(e.opacity??1,0,rR(n))):s&&(i.opacity=Ct(e.opacity??1,t.opacity??1,n));for(let o=0;o<tR;o++){const a=`border${q2[o]}Radius`;let c=Ig(e,a),h=Ig(t,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||wg(c)===wg(h)?(i[a]=Math.max(Ct(_g(c),_g(h),n),0),(wn.test(h)||wn.test(c))&&(i[a]+="%")):i[a]=h}(e.rotate||t.rotate)&&(i.rotate=Ct(e.rotate||0,t.rotate||0,n))}function Ig(i,e){return i[e]!==void 0?i[e]:i.borderRadius}const nR=X2(0,.5,Ny),rR=X2(.5,.95,Xi);function X2(i,e,t){return n=>n<i?0:n>e?1:t(Go(i,e,n))}function Lg(i,e){i.min=e.min,i.max=e.max}function Wi(i,e){Lg(i.x,e.x),Lg(i.y,e.y)}function Rg(i,e){i.translate=e.translate,i.scale=e.scale,i.originPoint=e.originPoint,i.origin=e.origin}function Dg(i,e,t,n,r){return i-=e,i=OA(i,1/t,n),r!==void 0&&(i=OA(i,1/r,n)),i}function sR(i,e=0,t=1,n=.5,r,s=i,o=i){if(wn.test(e)&&(e=parseFloat(e),e=Ct(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Ct(s.min,s.max,n);i===s&&(a-=e),i.min=Dg(i.min,e,t,a,r),i.max=Dg(i.max,e,t,a,r)}function Cg(i,e,[t,n,r],s,o){sR(i,e[t],e[n],e[r],e.scale,s,o)}const oR=["x","scaleX","originX"],aR=["y","scaleY","originY"];function Pg(i,e,t,n){Cg(i.x,e,oR,t?t.x:void 0,n?n.x:void 0),Cg(i.y,e,aR,t?t.y:void 0,n?n.y:void 0)}function kg(i){return i.translate===0&&i.scale===1}function Z2(i){return kg(i.x)&&kg(i.y)}function Mg(i,e){return i.min===e.min&&i.max===e.max}function AR(i,e){return Mg(i.x,e.x)&&Mg(i.y,e.y)}function Og(i,e){return Math.round(i.min)===Math.round(e.min)&&Math.round(i.max)===Math.round(e.max)}function J2(i,e){return Og(i.x,e.x)&&Og(i.y,e.y)}function Fg(i){return mi(i.x)/mi(i.y)}function Bg(i,e){return i.translate===e.translate&&i.scale===e.scale&&i.originPoint===e.originPoint}class lR{constructor(){this.members=[]}add(e){fc(this.members,e),e.scheduleRender()}remove(e){if(cc(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let n;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function uR(i,e,t){let n="";const r=i.x.translate/e.x,s=i.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(n=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:p,rotateY:y,skewX:T,skewY:b}=t;h&&(n=`perspective(${h}px) ${n}`),d&&(n+=`rotate(${d}deg) `),p&&(n+=`rotateX(${p}deg) `),y&&(n+=`rotateY(${y}deg) `),T&&(n+=`skewX(${T}deg) `),b&&(n+=`skewY(${b}deg) `)}const a=i.x.scale*e.x,c=i.y.scale*e.y;return(a!==1||c!==1)&&(n+=`scale(${a}, ${c})`),n||"none"}const Uu=["","X","Y","Z"],fR=1e3;let cR=0;function $u(i,e,t,n){const{latestValues:r}=e;r[i]&&(t[i]=r[i],e.setStaticValue(i,0),n&&(n[i]=0))}function ev(i){if(i.hasCheckedOptimisedAppear=!0,i.root===i)return;const{visualElement:e}=i.options;if(!e)return;const t=U2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=i.options;window.MotionCancelOptimisedAnimation(t,"transform",Lt,!(r||s))}const{parent:n}=i;n&&!n.hasCheckedOptimisedAppear&&ev(n)}function tv({attachResizeListener:i,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=cR++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(gR),this.nodes.forEach(vR),this.nodes.forEach(ER),this.nodes.forEach(pR)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new JL)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new gc),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=p2(o)&&!aI(o),this.instance=o;const{layoutId:a,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||a)&&(this.isLayoutDirty=!0),i){let d,p=0;const y=()=>this.root.updateBlockedByResize=!1;Lt.read(()=>{p=window.innerWidth}),i(o,()=>{const T=window.innerWidth;T!==p&&(p=T,this.root.updateBlockedByResize=!0,d&&d(),d=eR(y,250),mA.hasAnimatedSinceResize&&(mA.hasAnimatedSinceResize=!1,this.nodes.forEach($g)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&h&&(a||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeLayoutChanged:y,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||h.getDefaultTransition()||_R,{onLayoutAnimationStart:_,onLayoutAnimationComplete:w}=h.getProps(),L=!this.targetLayout||!J2(this.targetLayout,T),P=!p&&y;if(this.options.layoutRoot||this.resumeFrom||P||p&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...Lc(b,"layout"),onPlay:_,onComplete:w};(h.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(d,P)}else p||$g(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),dr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(TR),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ev(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const p=this.path[d];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ng);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Ug);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(yR),this.nodes.forEach(hR),this.nodes.forEach(dR)):this.nodes.forEach(Ug),this.clearAllSnapshots();const a=wi.now();ei.delta=Wn(0,1e3/60,a-ei.timestamp),ei.timestamp=a,ei.isProcessing=!0,Lu.update.process(ei),Lu.preRender.process(ei),Lu.render.process(ei),ei.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Dc.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(mR),this.sharedNodes.forEach(SR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!mi(this.snapshot.measuredBox.x)&&!mi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Bt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!Z2(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&this.instance&&(a||Cr(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),wR(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Bt();const a=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(IR))){const{scroll:h}=this.root;h&&(vs(a.x,h.offset.x),vs(a.y,h.offset.y))}return a}removeElementScroll(o){const a=Bt();if(Wi(a,o),this.scroll?.wasRoot)return a;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:d,options:p}=h;h!==this.root&&d&&p.layoutScroll&&(d.wasRoot&&Wi(a,o),vs(a.x,d.offset.x),vs(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const c=Bt();Wi(c,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Es(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cr(d.latestValues)&&Es(c,d.latestValues)}return Cr(this.latestValues)&&Es(c,this.latestValues),c}removeTransform(o){const a=Bt();Wi(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Cr(h.latestValues))continue;W0(h.latestValues)&&h.updateSnapshot();const d=Bt(),p=h.measurePageBox();Wi(d,p),Pg(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Cr(this.latestValues)&&Pg(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ei.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==a;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:p}=this.options;if(!(!this.layout||!(d||p))){if(this.resolvedRelativeTargetAt=ei.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Bt(),this.relativeTargetOrigin=Bt(),ko(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Wi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Bt(),this.targetWithTransforms=Bt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),kL(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Wi(this.target,this.layout.layoutBox),k2(this.target,this.targetDelta)):Wi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Bt(),this.relativeTargetOrigin=Bt(),ko(this.relativeTargetOrigin,this.target,y.target),Wi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||W0(this.parent.latestValues)||P2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),a=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ei.timestamp&&(c=!1),c)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Wi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,y=this.treeScale.y;KI(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Bt());const{target:T}=o;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Rg(this.prevProjectionDelta.x,this.projectionDelta.x),Rg(this.prevProjectionDelta.y,this.projectionDelta.y)),Po(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==y||!Bg(this.projectionDelta.x,this.prevProjectionDelta.x)||!Bg(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ts(),this.projectionDelta=Ts(),this.projectionDeltaWithTransform=Ts()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},d={...this.latestValues},p=Ts();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const y=Bt(),T=c?c.source:void 0,b=this.layout?this.layout.source:void 0,_=T!==b,w=this.getStack(),L=!w||w.members.length<=1,P=!!(_&&!L&&this.options.crossfade===!0&&!this.path.some(xR));this.animationProgress=0;let R;this.mixTargetDelta=k=>{const F=k/1e3;Gg(p.x,o.x,F),Gg(p.y,o.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ko(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bR(this.relativeTarget,this.relativeTargetOrigin,y,F),R&&AR(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=Bt()),Wi(R,this.relativeTarget)),_&&(this.animationValues=d,iR(d,h,this.latestValues,F,P,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(dr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Lt.update(()=>{mA.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Os(0)),this.currentAnimation=XL(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fR),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:d}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&iv(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||Bt();const p=mi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+p;const y=mi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+y}Wi(a,c),Es(a,d),Po(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new lR),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&$u("z",o,h,this.animationValues);for(let d=0;d<Uu.length;d++)$u(`rotate${Uu[d]}`,o,h,this.animationValues),$u(`skew${Uu[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=pA(a?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=pA(a?.pointerEvents)||""),this.hasProjected&&!Cr(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const d=h.animationValues||h.latestValues;this.applyTransformsToTarget();let p=uR(this.projectionDeltaWithTransform,this.treeScale,d);c&&(p=c(d,p)),o.transform=p;const{x:y,y:T}=this.projectionDelta;o.transformOrigin=`${y.origin*100}% ${T.origin*100}% 0`,h.animationValues?o.opacity=h===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const b in Ko){if(d[b]===void 0)continue;const{correct:_,applyTo:w,isCSSVariable:L}=Ko[b],P=p==="none"?d[b]:_(d[b],h);if(w){const R=w.length;for(let k=0;k<R;k++)o[w[k]]=P}else L?this.options.visualElement.renderState.vars[b]=P:o[b]=P}this.options.layoutId&&(o.pointerEvents=h===this?pA(a?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Ng),this.root.sharedNodes.clear()}}}function hR(i){i.updateLayout()}function dR(i){const e=i.resumeFrom?.snapshot||i.snapshot;if(i.isLead()&&i.layout&&e&&i.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:n}=i.layout,{animationType:r}=i.options,s=e.source!==i.layout.source;r==="size"?zi(d=>{const p=s?e.measuredBox[d]:e.layoutBox[d],y=mi(p);p.min=t[d].min,p.max=p.min+y}):iv(r,e.layoutBox,t)&&zi(d=>{const p=s?e.measuredBox[d]:e.layoutBox[d],y=mi(t[d]);p.max=p.min+y,i.relativeTarget&&!i.currentAnimation&&(i.isProjectionDirty=!0,i.relativeTarget[d].max=i.relativeTarget[d].min+y)});const o=Ts();Po(o,t,e.layoutBox);const a=Ts();s?Po(a,i.applyTransform(n,!0),e.measuredBox):Po(a,t,e.layoutBox);const c=!Z2(o);let h=!1;if(!i.resumeFrom){const d=i.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:p,layout:y}=d;if(p&&y){const T=Bt();ko(T,e.layoutBox,p.layoutBox);const b=Bt();ko(b,t,y.layoutBox),J2(T,b)||(h=!0),d.options.layoutRoot&&(i.relativeTarget=b,i.relativeTargetOrigin=T,i.relativeParent=d)}}}i.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:a,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:h})}else if(i.isLead()){const{onExitComplete:t}=i.options;t&&t()}i.options.transition=void 0}function gR(i){i.parent&&(i.isProjecting()||(i.isProjectionDirty=i.parent.isProjectionDirty),i.isSharedProjectionDirty||(i.isSharedProjectionDirty=!!(i.isProjectionDirty||i.parent.isProjectionDirty||i.parent.isSharedProjectionDirty)),i.isTransformDirty||(i.isTransformDirty=i.parent.isTransformDirty))}function pR(i){i.isProjectionDirty=i.isSharedProjectionDirty=i.isTransformDirty=!1}function mR(i){i.clearSnapshot()}function Ng(i){i.clearMeasurements()}function Ug(i){i.isLayoutDirty=!1}function yR(i){const{visualElement:e}=i.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),i.resetTransform()}function $g(i){i.finishAnimation(),i.targetDelta=i.relativeTarget=i.target=void 0,i.isProjectionDirty=!0}function vR(i){i.resolveTargetDelta()}function ER(i){i.calcProjection()}function TR(i){i.resetSkewAndRotation()}function SR(i){i.removeLeadSnapshot()}function Gg(i,e,t){i.translate=Ct(e.translate,0,t),i.scale=Ct(e.scale,1,t),i.origin=e.origin,i.originPoint=e.originPoint}function Vg(i,e,t,n){i.min=Ct(e.min,t.min,n),i.max=Ct(e.max,t.max,n)}function bR(i,e,t,n){Vg(i.x,e.x,t.x,n),Vg(i.y,e.y,t.y,n)}function xR(i){return i.animationValues&&i.animationValues.opacityExit!==void 0}const _R={duration:.45,ease:[.4,0,.1,1]},Hg=i=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(i),jg=Hg("applewebkit/")&&!Hg("chrome/")?Math.round:Xi;function Kg(i){i.min=jg(i.min),i.max=jg(i.max)}function wR(i){Kg(i.x),Kg(i.y)}function iv(i,e,t){return i==="position"||i==="preserve-aspect"&&!PL(Fg(e),Fg(t),.2)}function IR(i){return i!==i.root&&i.scroll?.wasRoot}const LR=tv({attachResizeListener:(i,e)=>Qo(i,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Gu={current:void 0},nv=tv({measureScroll:i=>({x:i.scrollLeft,y:i.scrollTop}),defaultParent:()=>{if(!Gu.current){const i=new LR({});i.mount(window),i.setOptions({layoutScroll:!0}),Gu.current=i}return Gu.current},resetTransform:(i,e)=>{i.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:i=>window.getComputedStyle(i).position==="fixed"}),RR={pan:{Feature:WL},drag:{Feature:QL,ProjectionNode:nv,MeasureLayout:z2}};function Qg(i,e,t){const{props:n}=i;i.animationState&&n.whileHover&&i.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=n[r];s&&Lt.postRender(()=>s(e,da(e)))}class DR extends mr{mount(){const{current:e}=this.node;e&&(this.unmount=iI(e,(t,n)=>(Qg(this.node,n,"Start"),r=>Qg(this.node,r,"End"))))}unmount(){}}class CR extends mr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fa(Qo(this.node.current,"focus",()=>this.onFocus()),Qo(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Wg(i,e,t){const{props:n}=i;if(i.current instanceof HTMLButtonElement&&i.current.disabled)return;i.animationState&&n.whileTap&&i.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=n[r];s&&Lt.postRender(()=>s(e,da(e)))}class PR extends mr{mount(){const{current:e}=this.node;e&&(this.unmount=oI(e,(t,n)=>(Wg(this.node,n,"Start"),(r,{success:s})=>Wg(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ef=new WeakMap,Vu=new WeakMap,kR=i=>{const e=ef.get(i.target);e&&e(i)},MR=i=>{i.forEach(kR)};function OR({root:i,...e}){const t=i||document;Vu.has(t)||Vu.set(t,{});const n=Vu.get(t),r=JSON.stringify(e);return n[r]||(n[r]=new IntersectionObserver(MR,{root:i,...e})),n[r]}function FR(i,e,t){const n=OR(e);return ef.set(i,t),n.observe(i),()=>{ef.delete(i),n.unobserve(i)}}const BR={some:0,all:1};class NR extends mr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:BR[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:p}=this.node.getProps(),y=h?d:p;y&&y(c)};return FR(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(UR(e,t))&&this.startObserver()}unmount(){}}function UR({viewport:i={}},{viewport:e={}}={}){return t=>i[t]!==e[t]}const $R={inView:{Feature:NR},tap:{Feature:PR},focus:{Feature:CR},hover:{Feature:DR}},GR={layout:{ProjectionNode:nv,MeasureLayout:z2}},VR={...wL,...$R,...RR,...GR},SU=VI(VR,tL);var Ua={},Yg;function HR(){if(Yg)return Ua;Yg=1,Ua.match=s,Ua.parse=o;var i=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,e=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,t=/^(?:(min|max)-)?(.+)/,n=/(em|rem|px|cm|mm|in|pt|pc)?$/,r=/(dpi|dpcm|dppx)?$/;function s(d,p){return o(d).some(function(y){var T=y.inverse,b=y.type==="all"||p.type===y.type;if(b&&T||!(b||T))return!1;var _=y.expressions.every(function(w){var L=w.feature,P=w.modifier,R=w.value,k=p[L];if(!k)return!1;switch(L){case"orientation":case"scan":return k.toLowerCase()===R.toLowerCase();case"width":case"height":case"device-width":case"device-height":R=h(R),k=h(k);break;case"resolution":R=c(R),k=c(k);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":R=a(R),k=a(k);break;case"grid":case"color":case"color-index":case"monochrome":R=parseInt(R,10)||1,k=parseInt(k,10)||0;break}switch(P){case"min":return k>=R;case"max":return k<=R;default:return k===R}});return _&&!T||!_&&T})}function o(d){return d.split(",").map(function(p){p=p.trim();var y=p.match(i),T=y[1],b=y[2],_=y[3]||"",w={};return w.inverse=!!T&&T.toLowerCase()==="not",w.type=b?b.toLowerCase():"all",_=_.match(/\([^\)]+\)/g)||[],w.expressions=_.map(function(L){var P=L.match(e),R=P[1].toLowerCase().match(t);return{modifier:R[1],feature:R[2],value:P[2]}}),w})}function a(d){var p=Number(d),y;return p||(y=d.match(/^(\d+)\s*\/\s*(\d+)$/),p=y[1]/y[2]),p}function c(d){var p=parseFloat(d),y=String(d).match(r)[1];switch(y){case"dpcm":return p/2.54;case"dppx":return p*96;default:return p}}function h(d){var p=parseFloat(d),y=String(d).match(n)[1];switch(y){case"em":return p*16;case"rem":return p*16;case"cm":return p*96/2.54;case"mm":return p*96/2.54/10;case"in":return p*96;case"pt":return p*72;case"pc":return p*72/12;default:return p}}return Ua}var Hu,zg;function jR(){if(zg)return Hu;zg=1;var i=HR().match,e=typeof window<"u"?window.matchMedia:null;function t(r,s,o){var a=this,c;e&&!o&&(c=e.call(window,r)),c?(this.matches=c.matches,this.media=c.media,c.addListener(p)):(this.matches=i(r,s),this.media=r),this.addListener=h,this.removeListener=d,this.dispose=y;function h(T){c&&c.addListener(T)}function d(T){c&&c.removeListener(T)}function p(T){a.matches=T.matches,a.media=T.media}function y(){c&&c.removeListener(p)}}function n(r,s,o){return new t(r,s,o)}return Hu=n,Hu}var KR=jR();const bU=Qs(KR);var QR=/[A-Z]/g,WR=/^ms-/,ju={};function YR(i){return"-"+i.toLowerCase()}function xU(i){if(ju.hasOwnProperty(i))return ju[i];var e=i.replace(QR,YR);return ju[i]=WR.test(e)?"-"+e:e}function _U(i,e){if(i===e)return!0;if(!i||!e)return!1;const t=Object.keys(i),n=Object.keys(e),r=t.length;if(n.length!==r)return!1;for(let s=0;s<r;s++){const o=t[s];if(i[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}var Ku={exports:{}},Qu,qg;function zR(){if(qg)return Qu;qg=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Qu=i,Qu}var Wu,Xg;function qR(){if(Xg)return Wu;Xg=1;var i=zR();function e(){}function t(){}return t.resetWarningCache=e,Wu=function(){function n(o,a,c,h,d,p){if(p!==i){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}n.isRequired=n;function r(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:r,element:n,elementType:n,instanceOf:r,node:n,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},Wu}var Zg;function XR(){return Zg||(Zg=1,Ku.exports=qR()()),Ku.exports}var ZR=XR();const wU=Qs(ZR);function Di(){return Di=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Di.apply(null,arguments)}function Mo(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function tf(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function JR(i,e){if(i){if(typeof i=="string")return tf(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tf(i,e)}}function eD(i){if(Array.isArray(i))return tf(i)}function tD(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function iD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nD(i){return eD(i)||tD(i)||JR(i)||iD()}new _l;new _l;function rD(i,e,t){return Math.max(e,Math.min(t,i))}function sD(i,e){return rD(i-Math.floor(i/e)*e,0,e)}function oD(i,e){var t=sD(e-i,Math.PI*2);return t>Math.PI&&(t-=Math.PI*2),t}function rv(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var Yi=function i(e,t,n){var r=this;rv(this,i),Mo(this,"dot2",function(s,o){return r.x*s+r.y*o}),Mo(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=e,this.y=t,this.z=n},aD=[new Yi(1,1,0),new Yi(-1,1,0),new Yi(1,-1,0),new Yi(-1,-1,0),new Yi(1,0,1),new Yi(-1,0,1),new Yi(1,0,-1),new Yi(-1,0,-1),new Yi(0,1,1),new Yi(0,-1,1),new Yi(0,1,-1),new Yi(0,-1,-1)],Jg=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],ep=new Array(512),tp=new Array(512),AD=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var n;t&1?n=Jg[t]^e&255:n=Jg[t]^e>>8&255,ep[t]=ep[t+256]=n,tp[t]=tp[t+256]=aD[n%12]}};AD(0);function lD(i){if(typeof i=="number")i=Math.abs(i);else if(typeof i=="string"){var e=i;i=0;for(var t=0;t<e.length;t++)i=(i+(t+1)*(e.charCodeAt(t)%96))%2147483647}return i===0&&(i=311),i}function ip(i){var e=lD(i);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var uD=function i(e){var t=this;rv(this,i),Mo(this,"seed",0),Mo(this,"init",function(n){t.seed=n,t.value=ip(n)}),Mo(this,"value",ip(this.seed)),this.init(e)};new uD(Math.random());var fD=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return n/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*r)/t)},sv=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)},cD=function(e){return e},hD={in:function(e){return 1-Math.cos(e*Math.PI/2)},out:function(e){return Math.sin(e*Math.PI/2)},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},dD={in:function(e){return e*e*e},out:function(e){return 1-Math.pow(1-e,3)},inOut:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}},gD={in:function(e){return e*e*e*e*e},out:function(e){return 1-Math.pow(1-e,5)},inOut:function(e){return e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2}},pD={in:function(e){return 1-Math.sqrt(1-Math.pow(e,2))},out:function(e){return Math.sqrt(1-Math.pow(e-1,2))},inOut:function(e){return e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2}},mD={in:function(e){return e*e*e*e},out:function(e){return 1- --e*e*e*e},inOut:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}},yD={in:function(e){return e===0?0:Math.pow(2,10*e-10)},out:function(e){return e===1?1:1-Math.pow(2,-10*e)},inOut:function(e){return e===0?0:e===1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}};function Kt(i,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:sv,a=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,c="velocity_"+e;if(i.__damp===void 0&&(i.__damp={}),i.__damp[c]===void 0&&(i.__damp[c]=0),Math.abs(i[e]-t)<=a)return i[e]=t,!1;n=Math.max(1e-4,n);var h=2/n,d=o(h*r),p=i[e]-t,y=t,T=s*n;p=Math.min(Math.max(p,-T),T),t=i[e]-p;var b=(i.__damp[c]+h*p)*r;i.__damp[c]=(i.__damp[c]-h*b)*d;var _=t+(p+b)*d;return y-i[e]>0==_>y&&(_=y,i.__damp[c]=(_-y)/r),i[e]=_,!0}var vD=function(e){return e&&e.isCamera},ED=function(e){return e&&e.isLight},Ao=new Kr,np=new ua,rp=new ua,lo=new my,Yu=new Kr;function TD(i,e,t,n,r,s,o){typeof e=="number"?Ao.setScalar(e):Array.isArray(e)?Ao.set(e[0],e[1],e[2]):Ao.copy(e);var a=i.parent;i.updateWorldMatrix(!0,!1),Yu.setFromMatrixPosition(i.matrixWorld),vD(i)||ED(i)?lo.lookAt(Yu,Ao,i.up):lo.lookAt(Ao,Yu,i.up),FA(i.quaternion,rp.setFromRotationMatrix(lo),t,n,r,s,o),a&&(lo.extractRotation(a.matrixWorld),np.setFromRotationMatrix(lo),FA(i.quaternion,rp.copy(i.quaternion).premultiply(np.invert()),t,n,r,s,o))}function Ls(i,e,t,n,r,s,o,a){return Kt(i,e,i[e]+oD(i[e],t),n,r,s,o,a)}var uo=new _l,sp,op;function SD(i,e,t,n,r,s,o){return typeof e=="number"?uo.setScalar(e):Array.isArray(e)?uo.set(e[0],e[1]):uo.copy(e),sp=Kt(i,"x",uo.x,t,n,r,s,o),op=Kt(i,"y",uo.y,t,n,r,s,o),sp||op}var ss=new Kr,ap,Ap,lp;function nf(i,e,t,n,r,s,o){return typeof e=="number"?ss.setScalar(e):Array.isArray(e)?ss.set(e[0],e[1],e[2]):ss.copy(e),ap=Kt(i,"x",ss.x,t,n,r,s,o),Ap=Kt(i,"y",ss.y,t,n,r,s,o),lp=Kt(i,"z",ss.z,t,n,r,s,o),ap||Ap||lp}var Lr=new wl,up,fp,cp,hp;function bD(i,e,t,n,r,s,o){return typeof e=="number"?Lr.setScalar(e):Array.isArray(e)?Lr.set(e[0],e[1],e[2],e[3]):Lr.copy(e),up=Kt(i,"x",Lr.x,t,n,r,s,o),fp=Kt(i,"y",Lr.y,t,n,r,s,o),cp=Kt(i,"z",Lr.z,t,n,r,s,o),hp=Kt(i,"w",Lr.w,t,n,r,s,o),up||fp||cp||hp}var fo=new Cx,dp,gp,pp;function xD(i,e,t,n,r,s,o){return Array.isArray(e)?fo.set(e[0],e[1],e[2],e[3]):fo.copy(e),dp=Ls(i,"x",fo.x,t,n,r,s,o),gp=Ls(i,"y",fo.y,t,n,r,s,o),pp=Ls(i,"z",fo.z,t,n,r,s,o),dp||gp||pp}var os=new yy,mp,yp,vp;function _D(i,e,t,n,r,s,o){return e instanceof yy?os.copy(e):Array.isArray(e)?os.setRGB(e[0],e[1],e[2]):os.set(e),mp=Kt(i,"r",os.r,t,n,r,s,o),yp=Kt(i,"g",os.g,t,n,r,s,o),vp=Kt(i,"b",os.b,t,n,r,s,o),mp||yp||vp}var sn=new ua,Bn=new wl,Ep=new wl,co=new wl,Tp,Sp,bp,xp;function FA(i,e,t,n,r,s,o){var a=i;Array.isArray(e)?sn.set(e[0],e[1],e[2],e[3]):sn.copy(e);var c=i.dot(sn)>0?1:-1;return sn.x*=c,sn.y*=c,sn.z*=c,sn.w*=c,Tp=Kt(i,"x",sn.x,t,n,r,s,o),Sp=Kt(i,"y",sn.y,t,n,r,s,o),bp=Kt(i,"z",sn.z,t,n,r,s,o),xp=Kt(i,"w",sn.w,t,n,r,s,o),Bn.set(i.x,i.y,i.z,i.w).normalize(),Ep.set(a.__damp.velocity_x,a.__damp.velocity_y,a.__damp.velocity_z,a.__damp.velocity_w),co.copy(Bn).multiplyScalar(Ep.dot(Bn)/Bn.dot(Bn)),a.__damp.velocity_x-=co.x,a.__damp.velocity_y-=co.y,a.__damp.velocity_z-=co.z,a.__damp.velocity_w-=co.w,i.set(Bn.x,Bn.y,Bn.z,Bn.w),Tp||Sp||bp||xp}var ho=new Dx,_p,wp,Ip;function wD(i,e,t,n,r,s,o){return Array.isArray(e)?ho.set(e[0],e[1],e[2]):ho.copy(e),_p=Kt(i,"radius",ho.radius,t,n,r,s,o),wp=Ls(i,"phi",ho.phi,t,n,r,s,o),Ip=Ls(i,"theta",ho.theta,t,n,r,s,o),_p||wp||Ip}var $a=new my,Lp=new Kr,Rp=new ua,Dp=new Kr,Cp,Pp,kp;function ID(i,e,t,n,r,s,o){var a=i;return a.__damp===void 0&&(a.__damp={position:new Kr,rotation:new ua,scale:new Kr},i.decompose(a.__damp.position,a.__damp.rotation,a.__damp.scale)),Array.isArray(e)?$a.set.apply($a,nD(e)):$a.copy(e),$a.decompose(Lp,Rp,Dp),Cp=nf(a.__damp.position,Lp,t,n,r,s,o),Pp=FA(a.__damp.rotation,Rp,t,n,r,s,o),kp=nf(a.__damp.scale,Dp,t,n,r,s,o),i.compose(a.__damp.position,a.__damp.rotation,a.__damp.scale),Cp||Pp||kp}var IU=Object.freeze({__proto__:null,rsqw:fD,exp:sv,linear:cD,sine:hD,cubic:dD,quint:gD,circ:pD,quart:mD,expo:yD,damp:Kt,dampLookAt:TD,dampAngle:Ls,damp2:SD,damp3:nf,damp4:bD,dampE:xD,dampC:_D,dampQ:FA,dampS:wD,dampM:ID});const be=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},LD=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=RD},RD=Number.MAX_SAFE_INTEGER||9007199254740991;let Re=(function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i})({}),se=(function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i})({}),C=(function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i})({});var st={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},we={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class as{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class DD{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new as(e),this.fast_=new as(t),this.defaultTTFB_=r,this.ttfb_=new as(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new as(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new as(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new as(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,s=n/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function CD(i,e,t){return(e=kD(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Et(){return Et=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Et.apply(null,arguments)}function Mp(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function yt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Mp(Object(t),!0).forEach(function(n){CD(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Mp(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function PD(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function kD(i){var e=PD(i,"string");return typeof e=="symbol"?e:e+""}class tn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=ur,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const ur=function(){},MD={trace:ur,debug:ur,log:ur,warn:ur,info:ur,error:ur};function rf(){return Et({},MD)}function OD(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):ur}function Op(i,e,t){return e[i]?e[i].bind(e):OD(i,t)}const sf=rf();function FD(i,e,t){const n=rf();if(typeof console=="object"&&i===!0||typeof i=="object"){const r=["debug","log","info","warn","error"];r.forEach(s=>{n[s]=Op(s,i,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.11`)}catch{return rf()}r.forEach(s=>{sf[s]=Op(s,i)})}else Et(sf,n);return n}const pt=sf;function zn(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function BD(i){return typeof self<"u"&&i===self.ManagedMediaSource}function ov(i,e){const t=Object.keys(i),n=Object.keys(e),r=t.length,s=n.length;return!r||!s||r===s&&!t.some(o=>n.indexOf(o)===-1)}function Ui(i,e=!1){if(typeof TextDecoder<"u"){const h=new TextDecoder("utf-8").decode(i);if(e){const d=h.indexOf("\0");return d!==-1?h.substring(0,d):h}return h.replace(/\0/g,"")}const t=i.length;let n,r,s,o="",a=0;for(;a<t;){if(n=i[a++],n===0&&e)return o;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(n);break;case 12:case 13:r=i[a++],o+=String.fromCharCode((n&31)<<6|r&63);break;case 14:r=i[a++],s=i[a++],o+=String.fromCharCode((n&15)<<12|(r&63)<<6|(s&63)<<0);break}}return o}function Oi(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function av(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function ND(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var zu={exports:{}},Fp;function UD(){return Fp||(Fp=1,(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(c,h,d){if(d=d||{},c=c.trim(),h=h.trim(),!h){if(!d.alwaysNormalize)return c;var p=a.parseURL(c);if(!p)throw new Error("Error trying to parse base URL.");return p.path=a.normalizePath(p.path),a.buildURLFromParts(p)}var y=a.parseURL(h);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return d.alwaysNormalize?(y.path=a.normalizePath(y.path),a.buildURLFromParts(y)):h;var T=a.parseURL(c);if(!T)throw new Error("Error trying to parse base URL.");if(!T.netLoc&&T.path&&T.path[0]!=="/"){var b=r.exec(T.path);T.netLoc=b[1],T.path=b[2]}T.netLoc&&!T.path&&(T.path="/");var _={scheme:T.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(_.netLoc=T.netLoc,y.path[0]!=="/"))if(!y.path)_.path=T.path,y.params||(_.params=T.params,y.query||(_.query=T.query));else{var w=T.path,L=w.substring(0,w.lastIndexOf("/")+1)+y.path;_.path=a.normalizePath(L)}return _.path===null&&(_.path=d.alwaysNormalize?a.normalizePath(y.path):y.path),a.buildURLFromParts(_)},parseURL:function(c){var h=n.exec(c);return h?{scheme:h[1]||"",netLoc:h[2]||"",path:h[3]||"",params:h[4]||"",query:h[5]||"",fragment:h[6]||""}:null},normalizePath:function(c){for(c=c.split("").reverse().join("").replace(s,"");c.length!==(c=c.replace(o,"")).length;);return c.split("").reverse().join("")},buildURLFromParts:function(c){return c.scheme+c.netLoc+c.path+c.params+c.query+c.fragment}};i.exports=a})()})(zu)),zu.exports}var Gc=UD();class Dl{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var St={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Vc{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,$D(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=t?.byteRangeEndOffset||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[St.AUDIO]:null,[St.VIDEO]:null,[St.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Dl),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Gc.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[St.AUDIO]=null,e[St.VIDEO]=null,e[St.AUDIOVIDEO]=null}}function $t(i){return i.sn!=="initSegment"}class yA extends Vc{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(be(e)&&be(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1){const r=this._decryptdata=this.levelkeys[n[0]]||null;if(r)return r.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=be(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const n=Object.keys(this.levelkeys),r=n.length;if(r>1||r===1&&(t=this.levelkeys[n[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!be(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return $t(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,s,o=!1){const{elementaryStreams:a}=this,c=a[e];if(!c){a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:o};return}c.startPTS=Math.min(c.startPTS,t),c.endPTS=Math.max(c.endPTS,n),c.startDTS=Math.min(c.startDTS,r),c.endDTS=Math.max(c.endDTS,s)}}class Av extends Vc{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function lv(i,e){const t=Object.getPrototypeOf(i);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||lv(t,e)}}function $D(i,e){const t=lv(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const Bp=Math.pow(2,32)-1,GD=[].push,uv={video:1,audio:2,id3:3,text:4};function Vt(i){return String.fromCharCode.apply(null,i)}function fv(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function Ke(i,e){const t=cv(i,e);return t<0?4294967296+t:t}function Np(i,e){let t=Ke(i,e);return t*=Math.pow(2,32),t+=Ke(i,e+4),t}function cv(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function VD(i){const e=i.byteLength;for(let t=0;t<e;){const n=Ke(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function nt(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const s=Ke(i,r),o=Vt(i.subarray(r+4,r+8)),a=s>1?r+s:n;if(o===e[0])if(e.length===1)t.push(i.subarray(r+8,a));else{const c=nt(i.subarray(r+8,a),e.slice(1));c.length&&GD.apply(t,c)}r=a}return t}function HD(i){const e=[],t=i[0];let n=8;const r=Ke(i,n);n+=4;let s=0,o=0;t===0?(s=Ke(i,n),o=Ke(i,n+4),n+=8):(s=Np(i,n),o=Np(i,n+8),n+=16),n+=2;let a=i.length+o;const c=fv(i,n);n+=2;for(let h=0;h<c;h++){let d=n;const p=Ke(i,d);d+=4;const y=p&2147483647;if((p&2147483648)>>>31===1)return pt.warn("SIDX has hierarchical references (not supported)"),null;const b=Ke(i,d);d+=4,e.push({referenceSize:y,subsegmentDuration:b,info:{duration:b/r,start:a,end:a+y-1}}),a+=y,d+=4,n=d}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:c,references:e}}function hv(i){const e=[],t=nt(i,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=nt(s,["tkhd"])[0];if(o){let a=o[0];const c=Ke(o,a===0?12:20),h=nt(s,["mdia","mdhd"])[0];if(h){a=h[0];const d=Ke(h,a===0?12:20),p=nt(s,["mdia","hdlr"])[0];if(p){const y=Vt(p.subarray(8,12)),T={soun:St.AUDIO,vide:St.VIDEO}[y],b=nt(s,["mdia","minf","stbl","stsd"])[0],_=jD(b);T?(e[c]={timescale:d,type:T,stsd:_},e[T]=yt({timescale:d,id:c},_)):e[c]={timescale:d,type:y,stsd:_}}}}}return nt(i,["moov","mvex","trex"]).forEach(r=>{const s=Ke(r,4),o=e[s];o&&(o.default={duration:Ke(r,12),flags:Ke(r,20)})}),e}function jD(i){const e=i.subarray(8),t=e.subarray(86),n=Vt(e.subarray(4,8));let r=n,s;const o=n==="enca"||n==="encv";if(o){const h=nt(e,[n])[0].subarray(n==="enca"?28:78);nt(h,["sinf"]).forEach(p=>{const y=nt(p,["schm"])[0];if(y){const T=Vt(y.subarray(4,8));if(T==="cbcs"||T==="cenc"){const b=nt(p,["frma"])[0];b&&(r=Vt(b))}}})}const a=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const c=nt(t,["avcC"])[0];c&&c.length>3&&(r+="."+Va(c[1])+Va(c[2])+Va(c[3]),s=Ga(a==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const c=nt(e,[n])[0],h=nt(c.subarray(28),["esds"])[0];if(h&&h.length>7){let d=4;if(h[d++]!==3)break;d=qu(h,d),d+=2;const p=h[d++];if(p&128&&(d+=2),p&64&&(d+=h[d++]),h[d++]!==4)break;d=qu(h,d);const y=h[d++];if(y===64)r+="."+Va(y);else break;if(d+=12,h[d++]!==5)break;d=qu(h,d);const T=h[d++];let b=(T&248)>>3;b===31&&(b+=1+((T&7)<<3)+((h[d]&224)>>5)),r+="."+b}break}case"hvc1":case"hev1":{const c=nt(t,["hvcC"])[0];if(c&&c.length>12){const h=c[1],d=["","A","B","C"][h>>6],p=h&31,y=Ke(c,2),T=(h&32)>>5?"H":"L",b=c[12],_=c.subarray(6,12);r+="."+d+p,r+="."+KD(y).toString(16).toUpperCase(),r+="."+T+b;let w="";for(let L=_.length;L--;){const P=_[L];(P||w)&&(w="."+P.toString(16).toUpperCase()+w)}r+=w}s=Ga(a=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=Ga(r,t)||r;break}case"vp09":{const c=nt(t,["vpcC"])[0];if(c&&c.length>6){const h=c[4],d=c[5],p=c[6]>>4&15;r+="."+En(h)+"."+En(d)+"."+En(p)}break}case"av01":{const c=nt(t,["av1C"])[0];if(c&&c.length>2){const h=c[1]>>>5,d=c[1]&31,p=c[2]>>>7?"H":"M",y=(c[2]&64)>>6,T=(c[2]&32)>>5,b=h===2&&y?T?12:10:y?10:8,_=(c[2]&16)>>4,w=(c[2]&8)>>3,L=(c[2]&4)>>2,P=c[2]&3;r+="."+h+"."+En(d)+p+"."+En(b)+"."+_+"."+w+L+P+"."+En(1)+"."+En(1)+"."+En(1)+"."+0,s=Ga("dav1",t)}break}}return{codec:r,encrypted:o,supplemental:s}}function Ga(i,e){const t=nt(e,["dvvC"]),n=t.length?t[0]:nt(e,["dvcC"])[0];if(n){const r=n[2]>>1&127,s=n[2]<<5&32|n[3]>>3&31;return i+"."+En(r)+"."+En(s)}}function KD(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function qu(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function Va(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function En(i){return(i<10?"0":"")+i}function QD(i,e){if(!i||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&nt(i,["moov","trak"]).forEach(r=>{const o=nt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=nt(o,["enca"]);const c=a.length>0;c||(a=nt(o,["encv"])),a.forEach(h=>{const d=c?h.subarray(28):h.subarray(78);nt(d,["sinf"]).forEach(y=>{const T=dv(y);if(T){const b=T.subarray(8,24);b.some(_=>_!==0)||(pt.log(`[eme] Patching keyId in 'enc${c?"a":"v"}>sinf>>tenc' box: ${Oi(b)} -> ${Oi(t)}`),T.set(t,8))}})})})}function dv(i){const e=nt(i,["schm"])[0];if(e){const t=Vt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return nt(i,["schi","tenc"])[0]}return null}function WD(i,e,t){const n={},r=nt(i,["moof","traf"]);for(let s=0;s<r.length;s++){const o=r[s],a=nt(o,["tfhd"])[0],c=Ke(a,4),h=e[c];if(!h)continue;n[c]||(n[c]={start:NaN,duration:0,sampleCount:0,timescale:h.timescale,type:h.type});const d=n[c],p=nt(o,["tfdt"])[0];if(p){const R=p[0];let k=Ke(p,4);R===1&&(k===Bp?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(k*=Bp+1,k+=Ke(p,8))),be(k)&&(!be(d.start)||k<d.start)&&(d.start=k)}const y=h.default,T=Ke(a,0)|y?.flags;let b=y?.duration||0;T&8&&(T&2?b=Ke(a,12):b=Ke(a,8));const _=nt(o,["trun"]);let w=d.start||0,L=0,P=b;for(let R=0;R<_.length;R++){const k=_[R],F=Ke(k,4),U=d.sampleCount;d.sampleCount+=F;const $=k[3]&1,G=k[3]&4,W=k[2]&1,Q=k[2]&2,K=k[2]&4,te=k[2]&8;let oe=8,Ae=F;for($&&(oe+=4),G&&F&&(!(k[oe+1]&1)&&d.keyFrameIndex===void 0&&(d.keyFrameIndex=U),oe+=4,W?(P=Ke(k,oe),oe+=4):P=b,Q&&(oe+=4),te&&(oe+=4),w+=P,L+=P,Ae--);Ae--;)W?(P=Ke(k,oe),oe+=4):P=b,Q&&(oe+=4),K&&(k[oe+1]&1||d.keyFrameIndex===void 0&&(d.keyFrameIndex=d.sampleCount-(Ae+1),d.keyFrameStart=w),oe+=4),te&&(oe+=4),w+=P,L+=P;!L&&b&&(L+=b*F)}d.duration+=L}if(!Object.keys(n).some(s=>n[s].duration)){let s=1/0,o=0;const a=nt(i,["sidx"]);for(let c=0;c<a.length;c++){const h=HD(a[c]);if(h!=null&&h.references){s=Math.min(s,h.earliestPresentationTime/h.timescale);const d=h.references.reduce((p,y)=>p+y.info.duration||0,0);o=Math.max(o,d+h.earliestPresentationTime/h.timescale)}}o&&be(o)&&Object.keys(n).forEach(c=>{n[c].duration||(n[c].duration=o*n[c].timescale-n[c].start)})}return n}function YD(i){const e={valid:null,remainder:null},t=nt(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=i.slice(0,n.byteOffset-8),e.remainder=i.slice(n.byteOffset-8),e}function Zi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function Up(i,e){const t=[],n=e.samples,r=e.timescale,s=e.id;let o=!1;return nt(n,["moof"]).map(c=>{const h=c.byteOffset-8;nt(c,["traf"]).map(p=>{const y=nt(p,["tfdt"]).map(T=>{const b=T[0];let _=Ke(T,4);return b===1&&(_*=Math.pow(2,32),_+=Ke(T,8)),_/r})[0];return y!==void 0&&(i=y),nt(p,["tfhd"]).map(T=>{const b=Ke(T,4),_=Ke(T,0)&16777215,w=(_&1)!==0,L=(_&2)!==0,P=(_&8)!==0;let R=0;const k=(_&16)!==0;let F=0;const U=(_&32)!==0;let $=8;b===s&&(w&&($+=8),L&&($+=4),P&&(R=Ke(T,$),$+=4),k&&(F=Ke(T,$),$+=4),U&&($+=4),e.type==="video"&&(o=Cl(e.codec)),nt(p,["trun"]).map(G=>{const W=G[0],Q=Ke(G,0)&16777215,K=(Q&1)!==0;let te=0;const oe=(Q&4)!==0,Ae=(Q&256)!==0;let X=0;const Y=(Q&512)!==0;let ee=0;const re=(Q&1024)!==0,ue=(Q&2048)!==0;let Te=0;const ge=Ke(G,4);let pe=8;K&&(te=Ke(G,pe),pe+=4),oe&&(pe+=4);let De=te+h;for(let ze=0;ze<ge;ze++){if(Ae?(X=Ke(G,pe),pe+=4):X=R,Y?(ee=Ke(G,pe),pe+=4):ee=F,re&&(pe+=4),ue&&(W===0?Te=Ke(G,pe):Te=cv(G,pe),pe+=4),e.type===St.VIDEO){let Me=0;for(;Me<ee;){const rt=Ke(n,De);if(De+=4,zD(o,n[De])){const Qt=n.subarray(De,De+rt);Hc(Qt,o?2:1,i+Te/r,t)}De+=rt,Me+=rt+4}}i+=X/r}}))})})}),t}function Cl(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function zD(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Hc(i,e,t,n){const r=gv(i);let s=0;s+=e;let o=0,a=0,c=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;c=r[s++],o+=c}while(c===255);a=0;do{if(s>=r.length)break;c=r[s++],a+=c}while(c===255);const h=r.length-s;let d=s;if(a<h)s+=a;else if(a>h){pt.error(`Malformed SEI payload. ${a} is too small, only ${h} bytes left to parse.`);break}if(o===4){if(r[d++]===181){const y=fv(r,d);if(d+=2,y===49){const T=Ke(r,d);if(d+=4,T===1195456820){const b=r[d++];if(b===3){const _=r[d++],w=31&_,L=64&_,P=L?2+w*3:0,R=new Uint8Array(P);if(L){R[0]=_;for(let k=1;k<P;k++)R[k]=r[d++]}n.push({type:b,payloadType:o,pts:t,bytes:R})}}}}}else if(o===5&&a>16){const p=[];for(let b=0;b<16;b++){const _=r[d++].toString(16);p.push(_.length==1?"0"+_:_),(b===3||b===5||b===7||b===9)&&p.push("-")}const y=a-16,T=new Uint8Array(y);for(let b=0;b<y;b++)T[b]=r[d++];n.push({payloadType:o,pts:t,uuid:p.join(""),userData:Ui(T),userDataBytes:T})}}}function gv(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const r=e-t.length,s=new Uint8Array(r);let o=0;for(n=0;n<r;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=i[o];return s}function qD(i){const e=i[0];let t="",n="",r=0,s=0,o=0,a=0,c=0,h=0;if(e===0){for(;Vt(i.subarray(h,h+1))!=="\0";)t+=Vt(i.subarray(h,h+1)),h+=1;for(t+=Vt(i.subarray(h,h+1)),h+=1;Vt(i.subarray(h,h+1))!=="\0";)n+=Vt(i.subarray(h,h+1)),h+=1;n+=Vt(i.subarray(h,h+1)),h+=1,r=Ke(i,12),s=Ke(i,16),a=Ke(i,20),c=Ke(i,24),h=28}else if(e===1){h+=4,r=Ke(i,h),h+=4;const p=Ke(i,h);h+=4;const y=Ke(i,h);for(h+=4,o=2**32*p+y,LD(o)||(o=Number.MAX_SAFE_INTEGER,pt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Ke(i,h),h+=4,c=Ke(i,h),h+=4;Vt(i.subarray(h,h+1))!=="\0";)t+=Vt(i.subarray(h,h+1)),h+=1;for(t+=Vt(i.subarray(h,h+1)),h+=1;Vt(i.subarray(h,h+1))!=="\0";)n+=Vt(i.subarray(h,h+1)),h+=1;n+=Vt(i.subarray(h,h+1)),h+=1}const d=i.subarray(h,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:c,payload:d}}function XD(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}function ZD(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),XD([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,o,t)}const pv=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Bs={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function jc(i,e){const t=Bs[e];return!!t&&!!t[i.slice(0,4)]}function of(i,e,t=!0){return!i.split(",").some(n=>!Kc(n,e,t))}function Kc(i,e,t=!0){var n;const r=zn(t);return(n=r?.isTypeSupported(Wo(i,e)))!=null?n:!1}function Wo(i,e){return`${e}/mp4;codecs=${i}`}function $p(i){if(i){const e=i.substring(0,4);return Bs.video[e]}return 2}function BA(i){const e=pv();return i.split(",").reduce((t,n)=>{const s=e&&Cl(n)?9:Bs.video[n];return s?(s*2+t)/(t?3:2):(Bs.audio[n]+t)/(t?2:1)},0)}const Xu={};function JD(i,e=!0){if(Xu[i])return Xu[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let r=0;r<t.length;r++){var n;if(Kc(t[r],"audio",e))return Xu[i]=t[r],t[r];if(t[r]==="mp3"&&(n=zn(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return i}const eC=/flac|opus|mp4a\.40\.34/i;function NA(i,e=!0){return i.replace(eC,t=>JD(t.toLowerCase(),e))}function tC(i,e){const t=[];if(i){const n=i.split(",");for(let r=0;r<n.length;r++)jc(n[r],"video")||t.push(n[r])}return e&&t.push(e),t.join(",")}function vA(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1)&&(Gp(i,"audio")||Gp(i,"video")))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let n=t.length;n--;)if(t[n].substring(0,4)===i.substring(0,4))return t[n]}return t[0]}}return e||i}function Gp(i,e){return jc(i,e)&&Kc(i,e)}function iC(i){const e=i.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");n.length>2&&n[0]==="avc1"&&(e[t]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function nC(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return i}function Vp(i){const e=zn(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function af(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const rC={supported:!0,powerEfficient:!0,smooth:!0},sC={supported:!1,smooth:!1,powerEfficient:!1},mv={supported:!0,configurations:[],decodingInfoResults:[rC]};function yv(i,e){return{supported:!1,configurations:e,decodingInfoResults:[sC],error:i}}function oC(i,e,t,n,r,s){const o=i.videoCodec,a=i.audioCodec?i.audioGroups:null,c=s?.audioCodec,h=s?.channels,d=h?parseInt(h):c?1/0:2;let p=null;if(a!=null&&a.length)try{a.length===1&&a[0]?p=e.groups[a[0]].channels:p=a.reduce((y,T)=>{if(T){const b=e.groups[T];if(!b)throw new Error(`Audio track group ${T} not found`);Object.keys(b.channels).forEach(_=>{y[_]=(y[_]||0)+b.channels[_]})}return y},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(y=>Cl(y))||i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!p&&be(d)&&Object.keys(p).some(y=>parseInt(y)>d)}function vv(i,e,t,n={}){const r=i.videoCodec;if(!r&&!i.audioCodec||!t)return Promise.resolve(mv);const s=[],o=aC(i),a=o.length,c=AC(i,e,a>0),h=c.length;for(let d=a||1*h||1;d--;){const p={type:"media-source"};if(a&&(p.video=o[d%a]),h){p.audio=c[d%h];const y=p.audio.bitrate;p.video&&y&&(p.video.bitrate-=y)}s.push(p)}if(r){const d=navigator.userAgent;if(r.split(",").some(p=>Cl(p))&&pv())return Promise.resolve(yv(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${d})`),s))}return Promise.all(s.map(d=>{const p=uC(d);return n[p]||(n[p]=t.decodingInfo(d))})).then(d=>({supported:!d.some(p=>!p.supported),configurations:s,decodingInfoResults:d})).catch(d=>({supported:!1,configurations:s,decodingInfoResults:[],error:d}))}function aC(i){var e;const t=(e=i.videoCodec)==null?void 0:e.split(","),n=Ev(i),r=i.width||640,s=i.height||480,o=i.frameRate||30,a=i.videoRange.toLowerCase();return t?t.map(c=>{const h={contentType:Wo(nC(c),"video"),width:r,height:s,bitrate:n,framerate:o};return a!=="sdr"&&(h.transferFunction=a),h}):[]}function AC(i,e,t){var n;const r=(n=i.audioCodec)==null?void 0:n.split(","),s=Ev(i);return r&&i.audioGroups?i.audioGroups.reduce((o,a)=>{var c;const h=a?(c=e.groups[a])==null?void 0:c.tracks:null;return h?h.reduce((d,p)=>{if(p.groupId===a){const y=parseFloat(p.channels||"");r.forEach(T=>{const b={contentType:Wo(T,"audio"),bitrate:t?lC(T,s):s};y&&(b.channels=""+y),d.push(b)})}return d},o):o},[]):[]}function lC(i,e){if(e<=1)return 1;let t=128e3;return i==="ec-3"?t=768e3:i==="ac-3"&&(t=64e4),Math.min(e/2,t)}function Ev(i){return Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)/1e3)*1e3||1}function uC(i){let e="";const{audio:t,video:n}=i;if(n){const r=af(n.contentType);e+=`${r}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(t){const r=af(t.contentType);e+=`${n?"_":""}${r}_c${t.channels}`}return e}const Af=["NONE","TYPE-0","TYPE-1",null];function fC(i){return Af.indexOf(i)>-1}const UA=["SDR","PQ","HLG"];function cC(i){return!!i&&UA.indexOf(i)>-1}var Oo={No:"",Yes:"YES",v2:"v2"};function Hp(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?Oo.v2:Oo.Yes:Oo.No}class lf{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ns{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return jp(this._audioGroups,e)}hasSubtitleGroup(e){return jp(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function jp(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function hC(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function dC(i,e){let t=!1,n=[];if(i&&(t=i!=="SDR",n=[i]),e){n=e.allowedVideoRanges||UA.slice(0);const r=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&hC(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const gC=i=>{const e=new WeakSet;return(t,n)=>{if(i&&(n=i(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},xt=(i,e)=>JSON.stringify(i,gC(e));function pC(i,e,t,n,r){const s=Object.keys(i),o=n?.channels,a=n?.audioCodec,c=r?.videoCodec,h=o&&parseInt(o)===2;let d=!1,p=!1,y=1/0,T=1/0,b=1/0,_=1/0,w=0,L=[];const{preferHDR:P,allowedVideoRanges:R}=dC(e,r);for(let G=s.length;G--;){const W=i[s[G]];d||(d=W.channels[2]>0),y=Math.min(y,W.minHeight),T=Math.min(T,W.minFramerate),b=Math.min(b,W.minBitrate),R.filter(K=>W.videoRanges[K]>0).length>0&&(p=!0)}y=be(y)?y:0,T=be(T)?T:0;const k=Math.max(1080,y),F=Math.max(30,T);b=be(b)?b:t,t=Math.max(b,t),p||(e=void 0);const U=s.length>1;return{codecSet:s.reduce((G,W)=>{const Q=i[W];if(W===G)return G;if(L=p?R.filter(K=>Q.videoRanges[K]>0):[],U){if(Q.minBitrate>t)return yn(W,`min bitrate of ${Q.minBitrate} > current estimate of ${t}`),G;if(!Q.hasDefaultAudio)return yn(W,"no renditions with default or auto-select sound found"),G;if(a&&W.indexOf(a.substring(0,4))%5!==0)return yn(W,`audio codec preference "${a}" not found`),G;if(o&&!h){if(!Q.channels[o])return yn(W,`no renditions with ${o} channel sound found (channels options: ${Object.keys(Q.channels)})`),G}else if((!a||h)&&d&&Q.channels[2]===0)return yn(W,"no renditions with stereo sound found"),G;if(Q.minHeight>k)return yn(W,`min resolution of ${Q.minHeight} > maximum of ${k}`),G;if(Q.minFramerate>F)return yn(W,`min framerate of ${Q.minFramerate} > maximum of ${F}`),G;if(!L.some(K=>Q.videoRanges[K]>0))return yn(W,`no variants with VIDEO-RANGE of ${xt(L)} found`),G;if(c&&W.indexOf(c.substring(0,4))%5!==0)return yn(W,`video codec preference "${c}" not found`),G;if(Q.maxScore<w)return yn(W,`max score of ${Q.maxScore} < selected max of ${w}`),G}return G&&(BA(W)>=BA(G)||Q.fragmentError>i[G].fragmentError)?G:(_=Q.minIndex,w=Q.maxScore,W)},void 0),videoRanges:L,preferHDR:P,minFramerate:T,minBitrate:b,minIndex:_}}function yn(i,e){pt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function Tv(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function mC(i,e,t,n){return i.slice(t,n+1).reduce((r,s,o)=>{if(!s.codecSet)return r;const a=s.audioGroups;let c=r[s.codecSet];c||(r[s.codecSet]=c={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),c.minBitrate=Math.min(c.minBitrate,s.bitrate);const h=Math.min(s.height,s.width);return c.minHeight=Math.min(c.minHeight,h),c.minFramerate=Math.min(c.minFramerate,s.frameRate),c.minIndex=Math.min(c.minIndex,o),c.maxScore=Math.max(c.maxScore,s.score),c.fragmentError+=s.fragmentError,c.videoRanges[s.videoRange]=(c.videoRanges[s.videoRange]||0)+1,a&&a.forEach(d=>{if(!d)return;const p=e.groups[d];p&&(c.hasDefaultAudio=c.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(y=>{c.channels[y]=(c.channels[y]||0)+p.channels[y]}))}),r},{})}function Kp(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:s}=i;return{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:s}}function Sn(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(Vr(i,r,t))return n}return-1}function Vr(i,e,t){const{groupId:n,name:r,lang:s,assocLang:o,default:a}=i,c=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(s===void 0||yC(s,e.lang))&&(s===void 0||e.assocLang===o)&&(a===void 0||e.default===a)&&(c===void 0||e.forced===c)&&(!("characteristics"in i)||vC(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function yC(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function vC(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function Pr(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function EC(i,e,t,n,r){const s=e[n],a=e.reduce((y,T,b)=>{const _=T.uri;return(y[_]||(y[_]=[])).push(b),y},{})[s.uri];a.length>1&&(n=Math.max.apply(Math,a));const c=s.videoRange,h=s.frameRate,d=s.codecSet.substring(0,4),p=Qp(e,n,y=>{if(y.videoRange!==c||y.frameRate!==h||y.codecSet.substring(0,4)!==d)return!1;const T=y.audioGroups,b=t.filter(_=>!T||T.indexOf(_.groupId)!==-1);return Sn(i,b,r)>-1});return p>-1?p:Qp(e,n,y=>{const T=y.audioGroups,b=t.filter(_=>!T||T.indexOf(_.groupId)!==-1);return Sn(i,b,r)>-1})}function Qp(i,e,t){for(let n=e;n>-1;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}function $A(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class Sv extends tn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:r,partCurrent:s,hls:o}=this,{autoLevelEnabled:a,media:c}=o;if(!r||!c)return;const h=performance.now(),d=s?s.stats:r.stats,p=s?s.duration:r.duration,y=h-d.loading.start,T=o.minAutoLevel,b=r.level,_=this._nextAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||b<=T){this.clearTimer(),this._nextAutoLevel=-1;return}if(!a)return;const w=_>-1&&_!==b,L=!!t||w;if(!L&&(c.paused||!c.playbackRate||!c.readyState))return;const P=o.mainForwardBufferInfo;if(!L&&P===null)return;const R=this.bwEstimator.getEstimateTTFB(),k=Math.abs(c.playbackRate);if(y<=Math.max(R,1e3*(p/(k*2))))return;const F=P?P.len/k:0,U=d.loading.first?d.loading.first-d.loading.start:-1,$=d.loaded&&U>-1,G=this.getBwEstimate(),W=o.levels,Q=W[b],K=Math.max(d.loaded,Math.round(p*(r.bitrate||Q.averageBitrate)/8));let te=$?y-U:y;te<1&&$&&(te=Math.min(y,d.loaded*8/G));const oe=$?d.loaded*1e3/te:0,Ae=R/1e3,X=oe?(K-d.loaded)/oe:K*8/G+Ae;if(X<=F)return;const Y=oe?oe*8:G,ee=((n=t?.details||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,re=this.hls.config.abrBandWidthUpFactor;let ue=Number.POSITIVE_INFINITY,Te;for(Te=b-1;Te>T;Te--){const ze=W[Te].maxBitrate,Me=!W[Te].details||ee;if(ue=this.getTimeToLoadFrag(Ae,Y,p*ze,Me),ue<Math.min(F,p+Ae))break}if(ue>=X||ue>p*10)return;$?this.bwEstimator.sample(y-Math.min(R,U),d.loaded):this.bwEstimator.sampleTTFB(y);const ge=W[Te].maxBitrate;this.getBwEstimate()*re>ge&&this.resetEstimator(ge);const pe=this.findBestLevel(ge,T,Te,0,F,1,1);pe>-1&&(Te=pe),this.warn(`Fragment ${r.sn}${s?" part "+s.index:""} of level ${b} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${F.toFixed(3)} s
      Estimated load time for current fragment: ${X.toFixed(3)} s
      Estimated load time for down switch fragment: ${ue.toFixed(3)} s
      TTFB estimate: ${U|0} ms
      Current BW estimate: ${be(G)?G|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${Te} @ ${ge|0} bps`),o.nextLoadLevel=o.nextAutoLevel=Te,this.clearTimer();const De=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===Te&&Te>0){const ze=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${Te>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${ze.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,Te>T){let Me=this.findBestLevel(this.hls.levels[T].bitrate,T,Te,0,ze,1,1);Me===-1&&(Me=T),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Me,this.resetEstimator(this.hls.levels[Me].bitrate)}}};w||X>ue*2?De():this.timer=self.setInterval(De,ue*1e3),o.trigger(C.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:s,stats:d})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new DD(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(C.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case se.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:s}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const o=performance.now(),a=s?s.stats:n.stats,c=o-a.loading.start,h=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&h>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(c-Math.min(p,h),a.loaded)}else this.bwEstimator.sampleTTFB(c)}break}}}getTimeToLoadFrag(e,t,n,r){const s=e+n/t,o=r?e+this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.first;be(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===we.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+r.loaded,c=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:c},o.realBitrate=Math.round(8*a/c)}if(t.bitrateTest){const s={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(C.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==we.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,r,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:r,config:s,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,c=this.getBwEstimate(),h=this.getStarvationDelay();let d=s.abrBandWidthFactor,p=s.abrBandWidthUpFactor;if(h){const w=this.findBestLevel(c,o,r,h,0,d,p);if(w>=0)return this.rebufferNotice=-1,w}let y=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!h){const w=this.bitrateTestDelay;w&&(y=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-w,this.info(`bitrate test took ${Math.round(1e3*w)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),d=p=1)}const T=this.findBestLevel(c,o,r,h,y,d,p);if(this.rebufferNotice!==T&&(this.rebufferNotice=T,this.info(`${h?"rebuffering expected":"buffer is empty"}, optimal quality level ${T}`)),T>-1)return T;const b=n.levels[o],_=n.loadLevelObj;return _&&b?.bitrate<_.bitrate?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,o,a){var c;const h=r+s,d=this.lastLoadedFragLevel,p=d===-1?this.hls.firstLevel:d,{fragCurrent:y,partCurrent:T}=this,{levels:b,allAudioTracks:_,loadLevel:w,config:L}=this.hls;if(b.length===1)return 0;const P=b[p],R=!!((c=this.hls.latestLevelDetails)!=null&&c.live),k=w===-1||d===-1;let F,U="SDR",$=P?.frameRate||0;const{audioPreference:G,videoPreference:W}=L,Q=this.audioTracksByGroup||(this.audioTracksByGroup=Tv(_));let K=-1;if(k){if(this.firstSelection!==-1)return this.firstSelection;const Y=this.codecTiers||(this.codecTiers=mC(b,Q,t,n)),ee=pC(Y,U,e,G,W),{codecSet:re,videoRanges:ue,minFramerate:Te,minBitrate:ge,minIndex:pe,preferHDR:De}=ee;K=pe,F=re,U=De?ue[ue.length-1]:ue[0],$=Te,e=Math.max(e,ge),this.log(`picked start tier ${xt(ee)}`)}else F=P?.codecSet,U=P?.videoRange;const te=T?T.duration:y?y.duration:0,oe=this.bwEstimator.getEstimateTTFB()/1e3,Ae=[];for(let Y=n;Y>=t;Y--){var X;const ee=b[Y],re=Y>p;if(!ee)continue;if(L.useMediaCapabilities&&!ee.supportedResult&&!ee.supportedPromise){const Me=navigator.mediaCapabilities;typeof Me?.decodingInfo=="function"&&oC(ee,Q,U,$,e,G)?(ee.supportedPromise=vv(ee,Q,Me,this.supportedCache),ee.supportedPromise.then(rt=>{if(!this.hls)return;ee.supportedResult=rt;const Qt=this.hls.levels,Gt=Qt.indexOf(ee);rt.error?this.warn(`MediaCapabilities decodingInfo error: "${rt.error}" for level ${Gt} ${xt(rt)}`):rt.supported?rt.decodingInfoResults.some(vi=>vi.smooth===!1||vi.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Gt} not smooth or powerEfficient: ${xt(rt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Gt} ${xt(rt)}`),Gt>-1&&Qt.length>1&&(this.log(`Removing unsupported level ${Gt}`),this.hls.removeLevel(Gt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(rt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${rt}`)})):ee.supportedResult=mv}if((F&&ee.codecSet!==F||U&&ee.videoRange!==U||re&&$>ee.frameRate||!re&&$>0&&$<ee.frameRate||(X=ee.supportedResult)!=null&&(X=X.decodingInfoResults)!=null&&X.some(Me=>Me.smooth===!1))&&(!k||Y!==K)){Ae.push(Y);continue}const ue=ee.details,Te=(T?ue?.partTarget:ue?.averagetargetduration)||te;let ge;re?ge=a*e:ge=o*e;const pe=te&&r>=te*2&&s===0?ee.averageBitrate:ee.maxBitrate,De=this.getTimeToLoadFrag(oe,ge,pe*Te,ue===void 0);if(ge>=pe&&(Y===d||ee.loadError===0&&ee.fragmentError===0)&&(De<=oe||!be(De)||R&&!this.bitrateTestDelay||De<h)){const Me=this.forcedAutoLevel;return Y!==w&&(Me===-1||Me!==w)&&(Ae.length&&this.trace(`Skipped level(s) ${Ae.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${b[Ae[0]].codecs}" ${b[Ae[0]].videoRange}; not compatible with "${F}" ${U}`),this.info(`switch candidate:${p}->${Y} adjustedbw(${Math.round(ge)})-bitrate=${Math.round(ge-pe)} ttfb:${oe.toFixed(1)} avgDuration:${Te.toFixed(1)} maxFetchDuration:${h.toFixed(1)} fetchDuration:${De.toFixed(1)} firstSelection:${k} codecSet:${ee.codecSet} videoRange:${ee.videoRange} hls.loadLevel:${w}`)),k&&(this.firstSelection=Y),Y}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const bv={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];const o=e(s);if(o>0)t=r+1;else if(o<0)n=r-1;else return s}return null}};function TC(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!be(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let s=0;s<i.length;++s){const o=i[s];if(bC(e,t,o))return o}return null}function Qr(i,e,t=0,n=0,r=.005){let s=null;if(i){s=e[1+i.sn-e[0].sn]||null;const a=i.endDTS-t;a>0&&a<15e-7&&(t+=15e-7),s&&i.level!==s.level&&s.end<=i.end&&(s=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&Wp(t,n,s)===0||SC(s,i,Math.min(r,n))))return s;const o=bv.search(e,Wp.bind(null,t,n));return o&&(o!==i||!s)?o:s}function SC(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return i.start<=n}return!1}function Wp(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function bC(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function xv(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let n=i.fragments;const{fragmentHint:r}=i;r&&(n=n.concat(r));let s;return bv.search(n,o=>o.cc<e?1:o.cc>e?-1:(s=o,o.end<=t?1:o.start>t?-1:0)),s||null}return null}function GA(i){switch(i.details){case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_TIMEOUT:case se.LEVEL_LOAD_TIMEOUT:case se.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Yp(i,e){const t=GA(e);return i.default[`${t?"timeout":"error"}Retry`]}function Qc(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function zp(i){return yt(yt({},i),{errorRetry:null,timeoutRetry:null})}function VA(i,e,t,n){if(!i)return!1;const r=n?.code,s=e<i.maxNumRetry&&(xC(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,s):s}function xC(i){return uf(i)||!!i&&(i<400||i>499)}function uf(i){return i===0&&navigator.onLine===!1}var Ht={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},bi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4,SwitchToSDR:8};class _v extends tn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.ERROR,this.onError,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.ERROR,this.onError,this),e.off(C.ERROR,this.onErrorOut,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===we.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||n===-1?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if((n=e.details)!=null&&n.hasKey(t))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(o=>r.indexOf(o.groupId)>=0).some(o=>{var a;return(a=o.details)==null?void 0:a.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const r=this.hls,s=t.context;switch(t.details){case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case se.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=Rs();return}case se.FRAG_GAP:case se.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ht.SendAlternateToPenaltyBox;return}case se.LEVEL_EMPTY_ERROR:case se.LEVEL_PARSING_ERROR:{var o;const c=t.parent===we.MAIN?t.level:r.loadLevel;t.details===se.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(o=o.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case se.LEVEL_LOAD_ERROR:case se.LEVEL_LOAD_TIMEOUT:typeof s?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case se.AUDIO_TRACK_LOAD_ERROR:case se.AUDIO_TRACK_LOAD_TIMEOUT:case se.SUBTITLE_LOAD_ERROR:case se.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const c=r.loadLevelObj;if(c&&(s.type===st.AUDIO_TRACK&&c.hasAudioGroup(s.groupId)||s.type===st.SUBTITLE_TRACK&&c.hasSubtitleGroup(s.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Ht.SendAlternateToPenaltyBox,t.errorAction.flags=bi.MoveAllAlternatesMatchingHost;return}}return;case se.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Ht.SendAlternateToPenaltyBox,flags:bi.MoveAllAlternatesMatchingHDCP};return;case se.KEY_SYSTEM_SESSION_UPDATE_FAILED:case se.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case se.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Ht.SendAlternateToPenaltyBox,flags:bi.MoveAllAlternatesMatchingKey};return;case se.BUFFER_ADD_CODEC_ERROR:case se.REMUX_ALLOC_ERROR:case se.BUFFER_APPEND_ERROR:if(!t.errorAction){var a;t.errorAction=this.getLevelSwitchAction(t,(a=t.level)!=null?a:r.loadLevel)}return;case se.INTERNAL_EXCEPTION:case se.BUFFER_APPENDING_ERROR:case se.BUFFER_FULL_ERROR:case se.LEVEL_SWITCH_ERROR:case se.BUFFER_STALLED_ERROR:case se.BUFFER_SEEK_OVER_HOLE:case se.BUFFER_NUDGE_ON_STALL:t.errorAction=Rs();return}t.type===Re.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Rs())}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=Yp(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(VA(r,s,GA(e),e.response))return{action:Ht.RetryRequest,flags:bi.None,retryConfig:r,retryCount:s};const a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=Yp(e.details.startsWith("key")?o:s,e),c=t.levels.reduce((d,p)=>d+p.fragmentError,0);if(r&&(e.details!==se.FRAG_GAP&&r.fragmentError++,VA(a,c,GA(e),e.response)))return{action:Ht.RetryRequest,flags:bi.None,retryConfig:a,retryCount:c};const h=this.getLevelSwitchAction(e,n);return a&&(h.retryConfig=a,h.retryCount=c),h}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var s,o;const h=e.details;r.loadError++,h===se.BUFFER_APPEND_ERROR&&r.fragmentError++;let d=-1;const{levels:p,loadLevel:y,minAutoLevel:T,maxAutoLevel:b}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const _=(s=e.frag)==null?void 0:s.type,L=(_===we.AUDIO&&h===se.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(h===se.BUFFER_ADD_CODEC_ERROR||h===se.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:U})=>r.audioCodec!==U),R=e.sourceBufferName==="video"&&(h===se.BUFFER_ADD_CODEC_ERROR||h===se.BUFFER_APPEND_ERROR)&&p.some(({codecSet:U,audioCodec:$})=>r.codecSet!==U&&r.audioCodec===$),{type:k,groupId:F}=(o=e.context)!=null?o:{};for(let U=p.length;U--;){const $=(U+y)%p.length;if($!==y&&$>=T&&$<=b&&p[$].loadError===0){var a,c;const G=p[$];if(h===se.FRAG_GAP&&_===we.MAIN&&e.frag){const W=p[$].details;if(W){const Q=Qr(e.frag,W.fragments,e.frag.start);if(Q!=null&&Q.gap)continue}}else{if(k===st.AUDIO_TRACK&&G.hasAudioGroup(F)||k===st.SUBTITLE_TRACK&&G.hasSubtitleGroup(F))continue;if(_===we.AUDIO&&(a=r.audioGroups)!=null&&a.some(W=>G.hasAudioGroup(W))||_===we.SUBTITLE&&(c=r.subtitleGroups)!=null&&c.some(W=>G.hasSubtitleGroup(W))||L&&r.audioCodec===G.audioCodec||R&&r.codecSet===G.codecSet||!L&&r.codecSet!==G.codecSet)continue}d=$;break}}if(d>-1&&n.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:Ht.SendAlternateToPenaltyBox,flags:bi.None,nextAutoLevel:d}}return{action:Ht.SendAlternateToPenaltyBox,flags:bi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Ht.DoNothing:break;case Ht.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==se.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case Ht.RetryRequest:break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r}=n,s=n.nextAutoLevel;switch(r){case bi.None:this.switchLevel(e,s);break;case bi.MoveAllAlternatesMatchingHDCP:{const c=this.getVariantLevelIndex(e.frag),h=t.levels[c],d=h?.attrs["HDCP-LEVEL"];if(n.hdcpLevel=d,d){t.maxHdcpLevel=Af[Af.indexOf(d)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case bi.MoveAllAlternatesMatchingKey:{const c=e.decryptdata;if(c){const h=this.hls.levels;for(let d=h.length;d--;)if(this.variantHasKey(h[d],c)){var o,a;this.log(`Banned key found in level ${d} (${h[d].bitrate}bps) or audio group "${(o=h[d].audioGroups)==null?void 0:o.join(",")}" (${(a=e.frag)==null?void 0:a.type} fragment) ${Oi(c.keyId||[])}`),h[d].fragmentError++,h[d].loadError++,this.log(`Removing level ${d} with key error (${e.error})`),this.hls.removeLevel(d)}h.length&&(n.resolved=!0)}break}}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===se.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=af(e.mimeType),r=this.hls.levels;for(let s=r.length;s--;)r[s][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${s} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(s))}}}function Rs(i){const e={action:Ht.DoNothing,flags:bi.None};return i&&(e.resolved=!0),e}var jt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class _C{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const s=n[r];if(!s)break;if(s.start<=e&&e<=s.end&&s.loaded)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:r}=this,s=Object.keys(r);for(let o=s.length;o--;){const a=r[s[o]];if(a?.body.type===t&&(!n||a.buffered)){const c=a.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,n,r,s){this.timeRanges&&(this.timeRanges[e]=t);const o=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(a=>{const c=this.fragments[a];if(!c||o>=c.body.sn)return;if(!c.buffered&&(!c.loaded||s)){c.body.type===n&&this.removeFragment(c.body);return}const h=c.range[e];if(h){if(h.time.length===0){this.removeFragment(c.body);return}h.time.some(d=>{const p=!this.isTimeBuffered(d.startPTS,d.endPTS,t);return p&&this.removeFragment(c.body),p})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,r=As(n),s=this.fragments[r];if(!s||s.buffered&&n.gap)return;const o=!n.relurl;Object.keys(t).forEach(a=>{const c=n.elementaryStreams[a];if(!c)return;const h=t[a],d=o||c.partial===!0;s.range[a]=this.getBufferedTimes(n,e.part,d,h)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=n.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),Ha(s)||this.removeParts(n.sn-1,n.type)):this.removeFragment(s.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=qp(n,r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=As(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const s={time:[],partial:n},o=e.start,a=e.end,c=e.minEndPTS||a,h=e.maxStartPTS||o;for(let d=0;d<r.length;d++){const p=r.start(d)-this.bufferPadding,y=r.end(d)+this.bufferPadding;if(h>=p&&c<=y){s.time.push({startPTS:Math.max(o,r.start(d)),endPTS:Math.min(a,r.end(d))});break}else if(o<y&&a>p){const T=Math.max(o,r.start(d)),b=Math.min(a,r.end(d));b>T&&(s.partial=!0,s.time.push({startPTS:T,endPTS:b}))}else if(a<=p)break}return s}getPartialFragment(e){let t=null,n,r,s,o=0;const{bufferPadding:a,fragments:c}=this;return Object.keys(c).forEach(h=>{const d=c[h];d&&Ha(d)&&(r=d.body.start-a,s=d.body.end+a,e>=r&&e<=s&&(n=Math.min(e-r,s-e),o<=n&&(t=d.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ha(t))}getState(e){const t=As(e),n=this.fragments[t];return n?n.buffered?Ha(n)?jt.PARTIAL:jt.OK:jt.APPENDING:jt.NOT_LOADED}isTimeBuffered(e,t,n){let r,s;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,r=t.part?null:t,s=As(n);this.fragments[s]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:s,type:o}=t;if(n.sn==="initSegment")return;const a=n.type;if(r){let h=this.activePartLists[a];h||(this.activePartLists[a]=h=[]),h.push(r)}this.timeRanges=s;const c=s[o];this.detectEvictedFragments(o,c,a,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=As(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let r=n.length;r--;){const s=t[n[r]];if(s?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const c=a.body;c.type!==n||r&&!c.gap||c.start<t&&c.end>e&&(a.buffered||s)&&this.removeFragment(c)})}removeFragment(e){const t=As(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=qp(n,s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(n=>n.clearElementaryStreamInfo())}}function Ha(i){var e,t,n;return i.buffered&&!!(i.body.gap||(e=i.range.video)!=null&&e.partial||(t=i.range.audio)!=null&&t.partial||(n=i.range.audiovideo)!=null&&n.partial)}function As(i){return`${i.type}_${i.level}_${i.sn}`}function qp(i,e){return i.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var pr={cbc:0,ctr:1};class wC{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case pr.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case pr.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function IC(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class LC{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],o=n[2],a=n[3],c=this.invSubMix,h=c[0],d=c[1],p=c[2],y=c[3],T=new Uint32Array(256);let b=0,_=0,w=0;for(w=0;w<256;w++)w<128?T[w]=w<<1:T[w]=w<<1^283;for(w=0;w<256;w++){let L=_^_<<1^_<<2^_<<3^_<<4;L=L>>>8^L&255^99,e[b]=L,t[L]=b;const P=T[b],R=T[P],k=T[R];let F=T[L]*257^L*16843008;r[b]=F<<24|F>>>8,s[b]=F<<16|F>>>16,o[b]=F<<8|F>>>24,a[b]=F,F=k*16843009^R*65537^P*257^b*16843008,h[L]=F<<24|F>>>8,d[L]=F<<16|F>>>16,p[L]=F<<8|F>>>24,y[L]=F,b?(b=P^T[T[T[k^P]]],_^=T[T[_]]):b=_=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,c;const h=this.keySchedule=new Uint32Array(o),d=this.invKeySchedule=new Uint32Array(o),p=this.sBox,y=this.rcon,T=this.invSubMix,b=T[0],_=T[1],w=T[2],L=T[3];let P,R;for(a=0;a<o;a++){if(a<s){P=h[a]=t[a];continue}R=P,a%s===0?(R=R<<8|R>>>24,R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255],R^=y[a/s|0]<<24):s>6&&a%s===4&&(R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255]),h[a]=P=(h[a-s]^R)>>>0}for(c=0;c<o;c++)a=o-c,c&3?R=h[a]:R=h[a-4],c<4||a<=4?d[c]=R:d[c]=b[p[R>>>24]]^_[p[R>>>16&255]]^w[p[R>>>8&255]]^L[p[R&255]],d[c]=d[c]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,c=a[0],h=a[1],d=a[2],p=a[3],y=this.uint8ArrayToUint32Array_(n);let T=y[0],b=y[1],_=y[2],w=y[3];const L=new Int32Array(e),P=new Int32Array(L.length);let R,k,F,U,$,G,W,Q,K,te,oe,Ae,X,Y;const ee=this.networkToHostOrderSwap;for(;t<L.length;){for(K=ee(L[t]),te=ee(L[t+1]),oe=ee(L[t+2]),Ae=ee(L[t+3]),$=K^s[0],G=Ae^s[1],W=oe^s[2],Q=te^s[3],X=4,Y=1;Y<r;Y++)R=c[$>>>24]^h[G>>16&255]^d[W>>8&255]^p[Q&255]^s[X],k=c[G>>>24]^h[W>>16&255]^d[Q>>8&255]^p[$&255]^s[X+1],F=c[W>>>24]^h[Q>>16&255]^d[$>>8&255]^p[G&255]^s[X+2],U=c[Q>>>24]^h[$>>16&255]^d[G>>8&255]^p[W&255]^s[X+3],$=R,G=k,W=F,Q=U,X=X+4;R=o[$>>>24]<<24^o[G>>16&255]<<16^o[W>>8&255]<<8^o[Q&255]^s[X],k=o[G>>>24]<<24^o[W>>16&255]<<16^o[Q>>8&255]<<8^o[$&255]^s[X+1],F=o[W>>>24]<<24^o[Q>>16&255]<<16^o[$>>8&255]<<8^o[G&255]^s[X+2],U=o[Q>>>24]<<24^o[$>>16&255]<<16^o[G>>8&255]<<8^o[W&255]^s[X+3],P[t]=ee(R^T),P[t+1]=ee(U^b),P[t+2]=ee(F^_),P[t+3]=ee(k^w),T=K,b=te,_=oe,w=Ae,t=t+4}return P.buffer}}class RC{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=DC(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function DC(i){switch(i){case pr.cbc:return"AES-CBC";case pr.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const CC=16;class Wc{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?IC(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,r){return this.useSoftware?new Promise((s,o)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,r);const c=this.flush();c?s(c.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,r)}softwareDecrypt(e,t,n,r){const{currentIV:s,currentResult:o,remainderData:a}=this;if(r!==pr.cbc||t.byteLength!==16)return pt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=Zi(a,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;s&&(n=s);let h=this.softwareDecrypter;h||(h=this.softwareDecrypter=new LC),h.expandKey(t);const d=o;return this.currentResult=h.decrypt(c.buffer,0,n),this.currentIV=c.slice(-16).buffer,d||null}webCryptoDecrypt(e,t,n,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,r));this.key=t,this.fastAesKey=new RC(this.subtle,t,r)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new wC(this.subtle,new Uint8Array(n),r).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(pt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n,r)))}onWebCryptoError(e,t,n,r){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,r);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%CC;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(pt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Xp=Math.pow(2,17);class PC{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Gn({type:Re.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,c)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(b=>b[0]==="GAP")){c(Jp(e));return}else e.gap=!1;const h=this.loader=s?new s(r):new o(r),d=Zp(e);e.loader=h;const p=zp(r.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Xp};e.stats=h.stats;const T={onSuccess:(b,_,w,L)=>{this.resetLoader(e,h);let P=b.data;w.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(P.slice(0,16)),P=P.slice(16)),a({frag:e,part:null,payload:P,networkDetails:L})},onError:(b,_,w,L)=>{this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:yt({url:n,data:void 0},b),error:new Error(`HTTP Error ${b.code} ${b.text}`),networkDetails:w,stats:L}))},onAbort:(b,_,w)=>{this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:w,stats:b}))},onTimeout:(b,_,w)=>{this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:w,stats:b}))}};t&&(T.onProgress=(b,_,w,L)=>t({frag:e,part:null,payload:w,networkDetails:L})),h.load(d,y,T)})}loadPart(e,t,n){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,c)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){c(Jp(e,t));return}const h=this.loader=s?new s(r):new o(r),d=Zp(e,t);e.loader=h;const p=zp(r.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Xp};t.stats=h.stats,h.load(d,y,{onSuccess:(T,b,_,w)=>{this.resetLoader(e,h),this.updateStatsFromPart(e,t);const L={frag:e,part:t,payload:T.data,networkDetails:w};n(L),a(L)},onError:(T,b,_,w)=>{this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:yt({url:d.url,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:_,stats:w}))},onAbort:(T,b,_)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:_,stats:T}))},onTimeout:(T,b,_)=>{this.resetLoader(e,h),c(new Gn({type:Re.NETWORK_ERROR,details:se.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:_,stats:T}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){const c=Math.round(e.duration/t.duration),h=Math.min(Math.round(n.loaded/s),c),p=(c-h)*Math.round(n.loaded/h);n.total=n.loaded+p}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Zp(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(be(r)&&be(s)){var o;let a=r,c=s;if(i.sn==="initSegment"&&kC((o=i.decryptdata)==null?void 0:o.method)){const h=s-r;h%16&&(c=s+(16-h%16)),r!==0&&(n.resetIV=!0,a=r-16)}n.rangeStart=a,n.rangeEnd=c}return n}function Jp(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:Re.MEDIA_ERROR,details:se.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new Gn(n)}function kC(i){return i==="AES-128"||i==="AES-256"}class Gn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class wv extends tn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Pl{constructor(e,t,n,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ja(),this.buffering={audio:ja(),video:ja(),audiovideo:ja()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=o}}function ja(){return{start:0,executeStart:0,executeEnd:0,end:0}}const em={length:0,start:()=>0,end:()=>0};class Xe{static isBuffered(e,t){if(e){const n=Xe.getBuffered(e);for(let r=n.length;r--;)if(t>=n.start(r)&&t<=n.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=Xe.getBuffered(e);return Xe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const r=Xe.bufferedRanges(e);if(r.length)return Xe.bufferedInfo(r,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((d,p)=>d.start-p.start||p.end-d.end);let r=-1,s=[];if(n)for(let d=0;d<e.length;d++){t>=e[d].start&&t<=e[d].end&&(r=d);const p=s.length;if(p){const y=s[p-1].end;e[d].start-y<n?e[d].end>y&&(s[p-1].end=e[d].end):s.push(e[d])}else s.push(e[d])}else s=e;let o=0,a,c=t,h=t;for(let d=0;d<s.length;d++){const p=s[d].start,y=s[d].end;if(r===-1&&t>=p&&t<=y&&(r=d),t+n>=p&&t<y)c=p,h=y,o=h-t;else if(t+n<p){a=p;break}}return{len:o,start:c||0,end:h||0,nextStart:a,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||em}catch(t){return pt.log("failed to get media.buffered",t),em}}}const Iv=/\{\$([a-zA-Z0-9-_]+)\}/g;function tm(i){return Iv.test(i)}function ff(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(Iv,n=>{const r=n.substring(2,n.length-1),s=t?.[r];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function im(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(r))s=o.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function MC(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const OC=/^(\d+)x(\d+)$/,nm=/(.+?)=(".*?"|.*?)(?:,|$)/g;class wt{constructor(e,t){typeof e=="string"&&(e=wt.parseAttrList(e,t)),Et(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((r,s)=>(r[s.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=OC.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const r={};for(nm.lastIndex=0;(n=nm.exec(e))!==null;){const o=n[1].trim();let a=n[2];const c=a.indexOf('"')===0&&a.lastIndexOf('"')===a.length-1;let h=!1;if(c)a=a.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":h=!0}if(t&&(c||h))a=ff(t,a);else if(!h&&!c)switch(o){case"CLOSED-CAPTIONS":if(a==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":pt.warn(`${e}: attribute ${o} is missing quotes`)}r[o]=a}return r}}const FC="com.apple.hls.interstitial";function BC(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function NC(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class Yc{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(r=t?.tagOrder)!=null?r:n,t){const s=t.attr;for(const o in s)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==s[o]){pt.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=Et(new wt({}),s,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=t?.endDate||new Date(this.attr["END-DATE"]);be(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(pt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(be(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===FC}get isValid(){return!!this.id&&!this._badValueForSameId&&be(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const UC=10;class Lv{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?be(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||UC}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Rv(i,e){return i.length===e.length?!i.some((t,n)=>t!==e[n]):!1}function rm(i,e){return!i&&!e?!0:!i||!e?!1:Rv(i,e)}function Ds(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function zc(i){switch(i){case"AES-128":case"AES-256":return pr.cbc;case"AES-256-CTR":return pr.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function qc(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function cf(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function $C(i){const e=cf(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function GC(i){const e=function(n,r,s){const o=n[r];n[r]=n[s],n[s]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function VC(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const s=r[0]==="base64",o=r[1];s?(n.splice(-1,1),t=qc(o)):t=$C(o)}}return t}const HA=typeof self<"u"?self:void 0;var Dt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},hi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function EA(i){switch(i){case hi.FAIRPLAY:return Dt.FAIRPLAY;case hi.PLAYREADY:return Dt.PLAYREADY;case hi.WIDEVINE:return Dt.WIDEVINE;case hi.CLEARKEY:return Dt.CLEARKEY}}function Zu(i){switch(i){case Dt.FAIRPLAY:return hi.FAIRPLAY;case Dt.PLAYREADY:return hi.PLAYREADY;case Dt.WIDEVINE:return hi.WIDEVINE;case Dt.CLEARKEY:return hi.CLEARKEY}}function So(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Dt.FAIRPLAY,Dt.WIDEVINE,Dt.PLAYREADY,Dt.CLEARKEY].filter(r=>!!e[r]):[];return!n[Dt.WIDEVINE]&&t&&n.push(Dt.WIDEVINE),n}const Xc=(function(i){return HA!=null&&(i=HA.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function HC(i,e,t,n){let r;switch(i){case Dt.FAIRPLAY:r=["cenc","sinf"];break;case Dt.WIDEVINE:case Dt.PLAYREADY:r=["cenc"];break;case Dt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return jC(r,e,t,n)}function jC(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function KC(i){var e;return!!i&&(i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function QC(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(o){const a=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(a){const c=qc(a).subarray(0,16);return GC(c),c}}return null}let Ka={};class ga{static clearKeyUriToKeyIdMap(){Ka={}}constructor(e,t,n,r=[1],s=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ds(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(av(o)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Rv(e.keyFormatVersions,this.keyFormatVersions)&&rm(e.iv,this.iv)&&rm(e.keyId,this.keyId)}isSupported(){if(this.method){if(Ds(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case hi.FAIRPLAY:case hi.WIDEVINE:case hi.PLAYREADY:case hi.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Ds(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(pt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=WC(e);return new ga(this.method,this.uri,"identity",this.keyFormatVersions,n)}if(this.pssh&&this.keyId)return this;const t=VC(this.uri);if(t)switch(this.keyFormat){case hi.WIDEVINE:if(this.pssh=t,!this.keyId&&t.length>=22){const n=t.length-22;this.keyId=t.subarray(n,n+16)}break;case hi.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=ZD(n,null,t),this.keyId=QC(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Ka[this.uri];if(!n){const r=Object.keys(Ka).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),Ka[this.uri]=n}this.keyId=n}return this}}function WC(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const sm=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,om=/#EXT-X-MEDIA:(.*)/g,YC=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ju=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),zC=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class cn{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return Gc.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return YC.test(e)}static parseMasterPlaylist(e,t){const n=tm(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];sm.lastIndex=0;let o;for(;(o=sm.exec(e))!=null;)if(o[1]){var a;const h=new wt(o[1],r),d=ff(r,o[2]),p={attrs:h,bitrate:h.decimalInteger("BANDWIDTH")||h.decimalInteger("AVERAGE-BANDWIDTH"),name:h.NAME,url:cn.resolve(d,t)},y=h.decimalResolution("RESOLUTION");y&&(p.width=y.width,p.height=y.height),lm(h.CODECS,p);const T=h["SUPPLEMENTAL-CODECS"];T&&(p.supplemental={},lm(T,p.supplemental)),(a=p.unknownCodecs)!=null&&a.length||s.push(p),r.levels.push(p)}else if(o[3]){const h=o[3],d=o[4];switch(h){case"SESSION-DATA":{const p=new wt(d,r),y=p["DATA-ID"];y&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[y]=p);break}case"SESSION-KEY":{const p=am(d,t,r);p.encrypted&&p.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(p)):pt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${d}"`);break}case"DEFINE":{{const p=new wt(d,r);im(r,p,t)}break}case"CONTENT-STEERING":{const p=new wt(d,r);r.contentSteering={uri:cn.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=Am(d);break}}}const c=s.length>0&&s.length<r.levels.length;return r.levels=c?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const s={},o=n.levels,a={AUDIO:o.map(h=>({id:h.attrs.AUDIO,audioCodec:h.audioCodec})),SUBTITLES:o.map(h=>({id:h.attrs.SUBTITLES,textCodec:h.textCodec})),"CLOSED-CAPTIONS":[]};let c=0;for(om.lastIndex=0;(r=om.exec(e))!==null;){const h=new wt(r[1],n),d=h.TYPE;if(d){const p=a[d],y=s[d]||[];s[d]=y;const T=h.LANGUAGE,b=h["ASSOC-LANGUAGE"],_=h.CHANNELS,w=h.CHARACTERISTICS,L=h["INSTREAM-ID"],P={attrs:h,bitrate:0,id:c++,groupId:h["GROUP-ID"]||"",name:h.NAME||T||"",type:d,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:T,url:h.URI?cn.resolve(h.URI,t):""};if(b&&(P.assocLang=b),_&&(P.channels=_),w&&(P.characteristics=w),L&&(P.instreamId=L),p!=null&&p.length){const R=cn.findGroup(p,P.groupId)||p[0];um(P,R,"audioCodec"),um(P,R,"textCodec")}y.push(P)}}return s}static parseLevelPlaylist(e,t,n,r,s,o){var a;const c={url:t},h=new Lv(t),d=h.fragments,p=[];let y=null,T=0,b=0,_=0,w=0,L=0,P=null,R=new yA(r,c),k,F,U,$=-1,G=!1,W=null,Q;if(Ju.lastIndex=0,h.m3u8=e,h.hasVariableRefs=tm(e),((a=Ju.exec(e))==null?void 0:a[0])!=="#EXTM3U")return h.playlistParsingError=new Error("Missing format identifier #EXTM3U"),h;for(;(k=Ju.exec(e))!==null;){G&&(G=!1,R=new yA(r,c),R.playlistOffset=_,R.setStart(_),R.sn=T,R.cc=w,L&&(R.bitrate=L),R.level=n,y&&(R.initSegment=y,y.rawProgramDateTime&&(R.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),W&&(R.setByteRange(W),W=null)));const Ae=k[1];if(Ae){R.duration=parseFloat(Ae);const X=(" "+k[2]).slice(1);R.title=X||null,R.tagList.push(X?["INF",Ae,X]:["INF",Ae])}else if(k[3]){if(be(R.duration)){R.playlistOffset=_,R.setStart(_),U&&cm(R,U,h),R.sn=T,R.level=n,R.cc=w,d.push(R);const X=(" "+k[3]).slice(1);R.relurl=ff(h,X),hf(R,P,p),P=R,_+=R.duration,T++,b=0,G=!0}}else{if(k=k[0].match(zC),!k){pt.warn("No matches on slow regex match for level playlist!");continue}for(F=1;F<k.length&&k[F]===void 0;F++);const X=(" "+k[F]).slice(1),Y=(" "+k[F+1]).slice(1),ee=k[F+2]?(" "+k[F+2]).slice(1):null;switch(X){case"BYTERANGE":P?R.setByteRange(Y,P):R.setByteRange(Y);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=Y,R.tagList.push(["PROGRAM-DATE-TIME",Y]),$===-1&&($=d.length);break;case"PLAYLIST-TYPE":h.type&&Nn(h,X,k),h.type=Y.toUpperCase();break;case"MEDIA-SEQUENCE":h.startSN!==0?Nn(h,X,k):d.length>0&&hm(h,X,k),T=h.startSN=parseInt(Y);break;case"SKIP":{h.skippedSegments&&Nn(h,X,k);const re=new wt(Y,h),ue=re.decimalInteger("SKIPPED-SEGMENTS");if(be(ue)){h.skippedSegments+=ue;for(let ge=ue;ge--;)d.push(null);T+=ue}const Te=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");Te&&(h.recentlyRemovedDateranges=(h.recentlyRemovedDateranges||[]).concat(Te.split("	")));break}case"TARGETDURATION":h.targetduration!==0&&Nn(h,X,k),h.targetduration=Math.max(parseInt(Y),1);break;case"VERSION":h.version!==null&&Nn(h,X,k),h.version=parseInt(Y);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":h.live||Nn(h,X,k),h.live=!1;break;case"#":(Y||ee)&&R.tagList.push(ee?[Y,ee]:[Y]);break;case"DISCONTINUITY":w++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([X]);break;case"BITRATE":R.tagList.push([X,Y]),L=parseInt(Y)*1e3,be(L)?R.bitrate=L:L=0;break;case"DATERANGE":{const re=new wt(Y,h),ue=new Yc(re,h.dateRanges[re.ID],h.dateRangeTagCount);h.dateRangeTagCount++,ue.isValid||h.skippedSegments?h.dateRanges[ue.id]=ue:pt.warn(`Ignoring invalid DATERANGE tag: "${Y}"`),R.tagList.push(["EXT-X-DATERANGE",Y]);break}case"DEFINE":{{const re=new wt(Y,h);"IMPORT"in re?MC(h,re,o):im(h,re,t)}break}case"DISCONTINUITY-SEQUENCE":h.startCC!==0?Nn(h,X,k):d.length>0&&hm(h,X,k),h.startCC=w=parseInt(Y);break;case"KEY":{const re=am(Y,t,h);if(re.isSupported()){if(re.method==="NONE"){U=void 0;break}U||(U={});const ue=U[re.keyFormat];ue!=null&&ue.matches(re)||(ue&&(U=Et({},U)),U[re.keyFormat]=re)}else pt.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Y}"`);break}case"START":h.startTimeOffset=Am(Y);break;case"MAP":{const re=new wt(Y,h);if(R.duration){const ue=new yA(r,c);fm(ue,re,n,U),y=ue,R.initSegment=y,y.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=y.rawProgramDateTime)}else{const ue=R.byteRangeEndOffset;if(ue){const Te=R.byteRangeStartOffset;W=`${ue-Te}@${Te}`}else W=null;fm(R,re,n,U),y=R,G=!0}y.cc=w;break}case"SERVER-CONTROL":{Q&&Nn(h,X,k),Q=new wt(Y),h.canBlockReload=Q.bool("CAN-BLOCK-RELOAD"),h.canSkipUntil=Q.optionalFloat("CAN-SKIP-UNTIL",0),h.canSkipDateRanges=h.canSkipUntil>0&&Q.bool("CAN-SKIP-DATERANGES"),h.partHoldBack=Q.optionalFloat("PART-HOLD-BACK",0),h.holdBack=Q.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{h.partTarget&&Nn(h,X,k);const re=new wt(Y);h.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=h.partList;re||(re=h.partList=[]);const ue=b>0?re[re.length-1]:void 0,Te=b++,ge=new wt(Y,h),pe=new Av(ge,R,c,Te,ue);re.push(pe),R.duration+=pe.duration;break}case"PRELOAD-HINT":{const re=new wt(Y,h);h.preloadHint=re;break}case"RENDITION-REPORT":{const re=new wt(Y,h);h.renditionReports=h.renditionReports||[],h.renditionReports.push(re);break}default:pt.warn(`line parsed but not handled: ${k}`);break}}}P&&!P.relurl?(d.pop(),_-=P.duration,h.partList&&(h.fragmentHint=P)):h.partList&&(hf(R,P,p),R.cc=w,h.fragmentHint=R,U&&cm(R,U,h)),h.targetduration||(h.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const K=d.length,te=d[0],oe=d[K-1];if(_+=h.skippedSegments*h.targetduration,_>0&&K&&oe){h.averagetargetduration=_/K;const Ae=oe.sn;h.endSN=Ae!=="initSegment"?Ae:0,h.live||(oe.endList=!0),$>0&&(XC(d,$),te&&p.unshift(te))}return h.fragmentHint&&(_+=h.fragmentHint.duration),h.totalduration=_,p.length&&h.dateRangeTagCount&&te&&Dv(p,h),h.endCC=w,h}}function Dv(i,e){let t=i.length;if(!t)if(e.hasProgramDateTime){const a=e.fragments[e.fragments.length-1];i.push(a),t++}else return;const n=i[t-1],r=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const c=e.dateRanges[s[a]],h=c.startDate.getTime();c.tagAnchor=n.ref;for(let d=t;d--;){var o;if(((o=i[d])==null?void 0:o.sn)<e.startSN)break;const p=qC(e,h,i,d,r);if(p!==-1){c.tagAnchor=e.fragments[p].ref;break}}}}function qC(i,e,t,n,r){const s=t[n];if(s){const a=s.programDateTime;if(e>=a||n===0){var o;const c=(((o=t[n+1])==null?void 0:o.start)||r)-s.start;if(e<=a+c*1e3){const h=t[n].sn-i.startSN;if(h<0)return-1;const d=i.fragments;if(d.length>t.length){const y=(t[n+1]||d[d.length-1]).sn-i.startSN;for(let T=y;T>h;T--){const b=d[T].programDateTime;if(e>=b&&e<b+d[T].duration*1e3)return T}}return h}}}return-1}function am(i,e,t){var n,r;const s=new wt(i,t),o=(n=s.METHOD)!=null?n:"",a=s.URI,c=s.hexadecimalInteger("IV"),h=s.KEYFORMATVERSIONS,d=(r=s.KEYFORMAT)!=null?r:"identity";a&&s.IV&&!c&&pt.error(`Invalid IV: ${s.IV}`);const p=a?cn.resolve(a,e):"",y=(h||"1").split("/").map(Number).filter(Number.isFinite);return new ga(o,p,d,y,c,s.KEYID)}function Am(i){const t=new wt(i).decimalFloatingPoint("TIME-OFFSET");return be(t)?t:null}function lm(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(s=>jc(s,n));r.length&&(e[`${n}Codec`]=r.map(s=>s.split("/")[0]).join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function um(i,e,t){const n=e[t];n&&(i[t]=n)}function XC(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function hf(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function fm(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function cm(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}function Nn(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function hm(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function e0(i,e){const t=e.startPTS;if(be(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&r.setDuration(n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function Cv(i,e,t,n,r,s,o){n-t<=0&&(o.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let c=t,h=n;const d=e.startPTS,p=e.endPTS;if(be(d)){const L=Math.abs(d-t);i&&L>i.totalduration?o.warn(`media timestamps and playlist times differ by ${L}s for level ${e.level} ${i.url}`):be(e.deltaPTS)?e.deltaPTS=Math.max(L,e.deltaPTS):e.deltaPTS=L,c=Math.max(t,d),t=Math.min(t,d),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,h=Math.min(n,p),n=Math.max(n,p),s=e.endDTS!==void 0?Math.max(s,e.endDTS):s}const y=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=c,e.startDTS=r,e.endPTS=n,e.minEndPTS=h,e.endDTS=s;const T=e.sn;if(!i||T<i.startSN||T>i.endSN)return 0;let b;const _=T-i.startSN,w=i.fragments;for(w[_]=e,b=_;b>0;b--)e0(w[b],w[b-1]);for(b=_;b<w.length-1;b++)e0(w[b],w[b+1]);return i.fragmentHint&&e0(w[w.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,y}function ZC(i,e,t){if(i===e)return;let n=null;const r=i.fragments;for(let d=r.length-1;d>=0;d--){const p=r[d].initSegment;if(p){n=p;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let s;tP(i,e,(d,p,y,T)=>{if((!e.startCC||e.skippedSegments)&&p.cc!==d.cc){const b=d.cc-p.cc;for(let _=y;_<T.length;_++)T[_].cc+=b;e.endCC=T[T.length-1].cc}be(d.startPTS)&&be(d.endPTS)&&(p.setStart(p.startPTS=d.startPTS),p.startDTS=d.startDTS,p.maxStartPTS=d.maxStartPTS,p.endPTS=d.endPTS,p.endDTS=d.endDTS,p.minEndPTS=d.minEndPTS,p.setDuration(d.endPTS-d.startPTS),p.duration&&(s=p),e.PTSKnown=e.alignedSliding=!0),d.hasStreams&&(p.elementaryStreams=d.elementaryStreams),p.loader=d.loader,d.hasStats&&(p.stats=d.stats),d.initSegment&&(p.initSegment=d.initSegment,n=d.initSegment)});const o=e.fragments,a=e.fragmentHint?o.concat(e.fragmentHint):o;if(n&&a.forEach(d=>{var p;d&&(!d.initSegment||d.initSegment.relurl===((p=n)==null?void 0:p.relurl))&&(d.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(d=>!d),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)o.shift();e.startSN=o[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=JC(i.dateRanges,e,t));const d=i.fragments.filter(p=>p.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let p=1;p<a.length;p++)a[p].programDateTime===null&&hf(a[p],a[p-1],d);Dv(d,e)}e.endCC=o[o.length-1].cc}if(!e.startCC){var c;const d=Mv(i,e.startSN-1);e.startCC=(c=d?.cc)!=null?c:o[0].cc}eP(i.partList,e.partList,(d,p)=>{p.elementaryStreams=d.elementaryStreams,p.stats=d.stats}),s?Cv(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,t):Pv(i,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const h=e.advancedDateTime;if(e.advanced&&h){const d=e.edge;e.driftStart||(e.driftStartTime=h,e.driftStart=d),e.driftEndTime=h,e.driftEnd=d}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function JC(i,e,t){const{dateRanges:n,recentlyRemovedDateranges:r}=e,s=Et({},i);r&&r.forEach(c=>{delete s[c]});const a=Object.keys(s).length;return a?(Object.keys(n).forEach(c=>{const h=s[c],d=new Yc(n[c].attr,h);d.isValid?(s[c]=d,h||(d.tagOrder+=a)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${xt(n[c].attr)}"`)}),s):n}function eP(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){const o=i[r],a=e[r+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function tP(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,c=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let h=r;h<=s;h++){const d=c[o+h];let p=a[h];if(n&&!p&&d&&(p=e.fragments[h]=d),d&&p){t(d,p,h,a);const y=d.relurl,T=p.relurl;if(y&&iP(y,T)){e.playlistParsingError=dm(`media sequence mismatch ${p.sn}:`,i,e,d,p);return}else if(d.cc!==p.cc){e.playlistParsingError=dm(`discontinuity sequence mismatch (${d.cc}!=${p.cc})`,i,e,d,p);return}}}}function dm(i,e,t,n,r){return new Error(`${i} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function Pv(i,e,t=!0){const n=e.startSN+e.skippedSegments-i.startSN,r=i.fragments,s=n>=0;let o=0;if(s&&n<r.length)o=r[n].start;else if(s&&e.startSN===i.endSN+1)o=i.fragmentEnd;else if(s&&t)o=i.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=i.fragmentStart;else return;df(e,o)}function df(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function kv(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function Mv(i,e,t){if(!i)return null;let n=i.fragments[e-i.startSN];return n||(n=i.fragmentHint,n&&n.sn===e)?n:e<i.startSN&&t&&t.sn===e?t:null}function gm(i,e,t){return i?Ov(i.partList,e,t):null}function Ov(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function Fv(i){i.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function iP(i,e){return i!==e&&e?pm(i)!==pm(e):!1}function pm(i){return i.replace(/\?[^?]*$/,"")}function Fo(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function nP(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function mm(i,e){const t=i.start+e;i.startPTS=t,i.setStart(t),i.endPTS=t+i.duration}function Bv(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)mm(t[n],i);e.fragmentHint&&mm(e.fragmentHint,i),e.alignedSliding=!0}function rP(i,e){i&&(Nv(e,i),e.alignedSliding||jA(e,i),!e.alignedSliding&&!e.skippedSegments&&Pv(i,e,!1))}function Nv(i,e){if(!nP(e,i))return;const t=Math.min(e.endCC,i.endCC),n=Fo(e.fragments,t),r=Fo(i.fragments,t);if(!n||!r)return;pt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const s=n.start-r.start;Bv(s,i)}function jA(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,s;const o=Math.min(e.endCC,i.endCC);e.startCC<o&&i.startCC<o&&(r=Fo(n,o),s=Fo(t,o)),(!r||!s)&&(r=n[Math.floor(n.length/2)],s=Fo(t,r.cc)||t[Math.floor(t.length/2)]);const a=r.programDateTime,c=s.programDateTime;if(!a||!c)return;const h=(c-a)/1e3-(s.start-r.start);Bv(h,i)}function yi(i,e,t){Ii(i,e,t),i.addEventListener(e,t)}function Ii(i,e,t){i.removeEventListener(e,t)}const sP={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},fe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class kl extends wv{constructor(e,t,n,r,s){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=fe.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:a,media:c,mediaBuffer:h,state:d}=this,p=c?c.currentTime:0,y=Xe.bufferInfo(h||c,p,o.maxBufferHole),T=!y.len;if(this.log(`Media seeking to ${be(p)?p.toFixed(3):p}, state: ${d}, ${T?"out of":"in"} buffer`),this.state===fe.ENDED)this.resetLoadingState();else if(a){const b=o.maxFragLookUpTolerance,_=a.start-b,w=a.start+a.duration+b;if(T||w<y.start||_>y.end){const L=p>w;(p<_||L)&&(L&&a.loader&&(this.log(`Cancelling fragment load for seek (sn: ${a.sn})`),a.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(c){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const b=this.lastCurrentTime;if(p>b&&(this.lastCurrentTime=p),!this.loadingParts){const _=Math.max(y.end,p),w=this.shouldLoadParts(this.getLevelDetails(),_);w&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${_.toFixed(2)}`),this.loadingParts=w)}}this.hls.hasEnoughToStart||(this.log(`Setting ${T?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,T&&(this.startPosition=p)),T&&this.state===fe.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new PC(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Wc(e.config)}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===fe.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=fe.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,r=this.config.timelineOffset||0;if(n<=r)return!1;const s=e.buffered;this.config.maxBufferHole&&s&&s.length>1&&(e=Xe.bufferedInfo(s,e.start,0));const o=e.nextStart;if(o&&o>r&&o<t.edge||this.media.currentTime<e.start)return!1;const c=t.partList;if(c!=null&&c.length){const d=c[c.length-1];return Xe.isBuffered(this.media,d.start+d.duration/2)}const h=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(h)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;yi(n,"seeking",this.onMediaSeeking),yi(n,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===fe.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Ii(r,"seeking",this.onMediaSeeking),Ii(r,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=fe.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=s=>{const o=s.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(o,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,r).then(s=>{if(!s)return;const o=this.state,a=s.frag;if(this.fragContextChanged(a)){(o===fe.FRAG_LOADING||!this.fragCurrent&&o===fe.PARSING)&&(this.fragmentTracker.removeFragment(a),this.state=fe.IDLE);return}"payload"in s&&(this.log(`Loaded ${a.type} sn: ${a.sn} of ${this.playlistLabel()} ${a.level}`),this.hls.trigger(C.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===fe.STOPPED||this.state===fe.ERROR||(this.warn(`Frag error: ${s?.message||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===jt.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),c=this.backtrackFragment;((c?e.sn-c.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===jt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(C.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const r=n?.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{frag:s,payload:o}=n,a=s.decryptdata;if(o&&o.byteLength>0&&a!=null&&a.key&&a.iv&&Ds(a.method)){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),a.key.buffer,a.iv.buffer,zc(a.method)).catch(h=>{throw r.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:s}),h}).then(h=>{const d=self.performance.now();return r.trigger(C.FRAG_DECRYPTED,{frag:s,payload:h,stats:{tstart:c,tdecrypt:d}}),n.payload=h,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===fe.STOPPED||this.state===fe.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==fe.STOPPED&&(this.state=fe.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,r;const s=e.tracks;if(s&&!t.encrypted&&((n=s.audio)!=null&&n.encrypted||(r=s.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,a=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(a.message),!o||o.mediaKeys?!1:(this.hls.trigger(C.ERROR,{type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_KEYS,fatal:!1,error:a,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?sP.toString(Xe.getBuffered(n)):"(detached)"})`),$t(e)){var r;if(e.type!==we.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(a=>!!o[a])){this.state=fe.IDLE;return}}const s=(r=this.levels)==null?void 0:r[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=fe.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:s}=e,o=!s||s.length===0||s.some(c=>!c),a=new Pl(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;this.fragCurrent=e;const o=t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)){if(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=fe.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(y=>{if(!this.fragContextChanged(y.frag))return this.hls.trigger(C.KEY_LOADED,y),this.state===fe.KEY_LOADING&&(this.state=fe.IDLE),y}),this.hls.trigger(C.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(a=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));const c=this.fragPrevious;if($t(e)&&(!c||e.sn!==c.sn)){const y=this.shouldLoadParts(t.details,e.end);y!==this.loadingParts&&(this.log(`LL-Part loading ${y?"ON":"OFF"} loading sn ${c?.sn}->${e.sn}`),this.loadingParts=y)}if(n=Math.max(e.start,n||0),this.loadingParts&&$t(e)){const y=o.partList;if(y&&r){n>o.fragmentEnd&&o.fragmentHint&&(e=o.fragmentHint);const T=this.getNextPart(y,e,n);if(T>-1){const b=y[T];e=this.fragCurrent=b.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${b.index} (${T}/${y.length-1}) of ${this.fragInfo(e,!1,b)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=b.start+b.duration,this.state=fe.FRAG_LOADING;let _;return a?_=a.then(w=>!w||this.fragContextChanged(w.frag)?null:this.doFragPartsLoad(e,b,t,r)).catch(w=>this.handleFragLoadError(w)):_=this.doFragPartsLoad(e,b,t,r).catch(w=>this.handleFragLoadError(w)),this.hls.trigger(C.FRAG_LOADING,{frag:e,part:b,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):_}else if(!e.url||this.loadedEndOfParts(y,n))return Promise.resolve(null)}}if($t(e)&&this.loadingParts){var h;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(h=o.partList)==null?void 0:h.filter(y=>y.loaded).map(y=>`[${y.start}-${y.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),be(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=fe.FRAG_LOADING;const d=this.config.progressive;let p;return d&&a?p=a.then(y=>!y||this.fragContextChanged(y.frag)?null:this.fragmentLoader.load(e,r)).catch(y=>this.handleFragLoadError(y)):p=Promise.all([this.fragmentLoader.load(e,d?r:void 0),a]).then(([y])=>(!d&&r&&r(y),y)).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(C.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(e,t,n,r){return new Promise((s,o)=>{var a;const c=[],h=(a=n.details)==null?void 0:a.partList,d=p=>{this.fragmentLoader.loadPart(e,p,r).then(y=>{c[p.index]=y;const T=y.part;this.hls.trigger(C.FRAG_LOADED,y);const b=gm(n.details,e.sn,p.index+1)||Ov(h,e.sn,p.index+1);if(b)d(b);else return s({frag:e,part:T,partsLoaded:c})}).catch(o)};d(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===se.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Re.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetFragmentLoading(t.frag)):this.hls.trigger(C.ERROR,t)}else this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==fe.PARSING){!this.fragCurrent&&this.state!==fe.STOPPED&&this.state!==fe.ERROR&&(this.state=fe.IDLE);return}const{frag:n,part:r,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o);const a=this.getLevelDetails(),h=a&&n.sn>a.endSN||this.shouldLoadParts(a,n.end);h!==this.loadingParts&&(this.log(`LL-Part loading ${h?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=h),this.updateLevelTiming(n,r,s,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const s=e.partList[0];if(s.fragment.type===we.SUBTITLE)return!1;const o=s.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=o){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:o}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const a=t[r],c=a.details,h=o>-1?gm(c,s,o):null,d=h?h.fragment:Mv(c,s,n);return d?(n&&n!==d&&(d.stats=n.stats),{frag:d,part:h,level:a}):null}bufferFragmentData(e,t,n,r,s){if(this.state!==fe.PARSING)return;const{data1:o,data2:a}=e;let c=o;if(a&&(c=Zi(o,a)),!c.length)return;const h=this.initPTS[t.cc],d=h?-h.baseTime/h.timescale:void 0,p={type:e.type,frag:t,part:n,chunkMeta:r,offset:d,parent:t.type,data:c};if(this.hls.trigger(C.BUFFER_APPENDING,p),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Xe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=Xe.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!be(r))return null;const o=this.lastCurrentTime>r||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,o)}getFwdBufferInfoAtPos(e,t,n,r){const s=Xe.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&(s.nextStart<=o.end||o.gap)){const a=Math.max(Math.min(s.nextStart,o.end)-t,r);return Xe.bufferInfo(e,t,a)}}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),s=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return s>=r?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=we.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:s}=this,o=n[0].start,a=s.lowLatencyMode&&!!t.partList;let c=null;if(t.live){const p=s.initialLiveManifestSize;if(r<p)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${p})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var h;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),c=this.getInitialLiveFragment(t);const y=this.hls.startPosition,T=this.hls.liveSyncPosition,b=c?(y!==-1&&y>=o?y:T)||c.start:e;this.log(`Setting startPosition to ${b} to match start frag at live edge. mainStart: ${y} liveSyncPosition: ${T} frag.start: ${(h=c)==null?void 0:h.start}`),this.startPosition=this.nextLoadPosition=b}}else e<=o&&(c=n[0]);if(!c){const p=this.loadingParts?t.partEnd:t.fragmentEnd;c=this.getFragmentAtPosition(e,p,t)}let d=this.filterReplacedPrimary(c,t);if(!d&&c){const p=c.sn-t.startSN;d=this.filterReplacedPrimary(n[p+1]||null,t)}return this.mapToInitFragWhenRequired(d)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===jt.OK||n===jt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&n.nextStart)){const a=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r,0);if(a!==null&&n.len+a.len>=s){const c=o.sn;return this.loopSn!==c&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${c}`),this.loopSn=c),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(ym(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(ym(this.config)&&e.type!==we.SUBTITLE){const n=this.hls.interstitialsManager,r=n?.bufferingItem;if(r){const o=r.event;if(o){if(o.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&t?.live===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const s=n?.playerQueue;if(s)for(let o=s.length;o--;){const a=s[o].interstitial;if(a.appendInPlace&&e.start>=a.startTime&&e.end<=a.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,s=!1,o=!0;for(let a=0,c=e.length;a<c;a++){const h=e[a];if(o=o&&!h.independent,r>-1&&n<h.start)break;const d=h.loaded;d?r=-1:(s||(h.independent||o)&&h.fragment===t)&&(h.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${h.start}`),r=a),s=d}return r}loadedEndOfParts(e,t){let n;for(let r=e.length;r--;){if(n=e[r],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=TC(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=xv(e,n.cc,n.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=n;const{fragmentHint:c}=n,{maxFragLookUpTolerance:h}=r,d=n.partList,p=!!(this.loadingParts&&d!=null&&d.length&&c);p&&!this.bitrateTest&&d[d.length-1].fragment.sn===c.sn&&(o=o.concat(c),a=c.sn);let y;if(e<t){var T;const _=e<this.lastCurrentTime||e>t-h||(T=this.media)!=null&&T.paused||!this.startFragRequested?0:h;y=Qr(s,o,e,_)}else y=o[o.length-1];if(y){const b=y.sn-n.startSN,_=this.fragmentTracker.getState(y);if((_===jt.OK||_===jt.PARTIAL&&y.gap)&&(s=y),s&&y.sn===s.sn&&(!p||d[0].fragment.sn>y.sn||!n.live)&&y.level===s.level){const L=o[b+1];y.sn<a&&this.fragmentTracker.getState(L)!==jt.OK?y=L:y=null}}return y}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,o=!t,a=e.alignedSliding&&be(s);if(o||!a&&!s){rP(n,e);const c=e.fragmentStart;return this.log(`Live playlist sliding: ${c.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),c}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(n===-1){const s=this.startTimeOffset!==null,o=s?this.startTimeOffset:e.startTimeOffset;o!==null&&be(o)?(n=t+o,o<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${o} found in ${s?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&$t(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==fe.FRAG_LOADING_WAITING_RETRY)&&(this.state=fe.IDLE)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const L=this.getCurrentContext(t.chunkMeta);L&&(t.frag=L.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var s;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const o=t.details===se.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(r,!0);const a=t.errorAction;if(!a){this.state=fe.ERROR;return}const{action:c,flags:h,retryCount:d=0,retryConfig:p}=a,y=!!p,T=y&&c===Ht.RetryRequest,b=y&&!a.resolved&&h===bi.MoveAllAlternatesMatchingHost,_=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!T&&b&&$t(r)&&!r.endList&&_)this.resetFragmentErrors(e),this.treatAsGap(r),a.resolved=!0;else if((T||b)&&d<p.maxNumRetry){var w;const L=uf((w=t.response)==null?void 0:w.code),P=Qc(p,d);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+P,this.state=fe.FRAG_LOADING_WAITING_RETRY,a.resolved=!0,L){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${d+1}/${p.maxNumRetry} in ${P}ms`)}else if(p)if(this.resetFragmentErrors(e),d<p.maxNumRetry)!o&&c!==Ht.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${d})`);return}else c===Ht.SendAlternateToPenaltyBox?this.state=fe.WAITING_LEVEL:this.state=fe.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!uf(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=fe.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===fe.PARSING||this.state===fe.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,t?.duration||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===we.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==fe.STOPPED&&(this.state=fe.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Xe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===fe.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==fe.STOPPED&&(this.state=fe.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){const s=n.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((c,h)=>{const d=e.elementaryStreams[h];if(d){const p=d.endPTS-d.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${h} duration reliably (${p})`),c||!1;const y=r?0:Cv(s,e,d.startPTS,d.endPTS,d.startDTS,d.endDTS,this);return this.hls.trigger(C.LEVEL_PTS_UPDATED,{details:s,level:n,drift:y,type:h,frag:e,start:d.startPTS,end:d.endPTS}),!0}return c},!1)){var a;if(n.fragmentError===0&&this.treatAsGap(e,n),((a=this.transmuxer)==null?void 0:a.error)===null){const c=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(c.message),this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,error:c,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=fe.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(C.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===we.MAIN?"level":"track"}fragInfo(e,t=!0,n){var r,s;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((r=t&&!n?e.startPTS:(n||e).start)!=null?r:NaN).toFixed(3)}-${((s=t&&!n?e.endPTS:(n||e).end)!=null?s:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function ym(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class Uv{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=oP(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function oP(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const s=i[r];t.set(s,n),n+=s.length}return t}var t0={exports:{}},vm;function aP(){return vm||(vm=1,(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(c,h,d){this.fn=c,this.context=h,this.once=d||!1}function s(c,h,d,p,y){if(typeof d!="function")throw new TypeError("The listener must be a function");var T=new r(d,p||c,y),b=t?t+h:h;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],T]:c._events[b].push(T):(c._events[b]=T,c._eventsCount++),c}function o(c,h){--c._eventsCount===0?c._events=new n:delete c._events[h]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],d,p;if(this._eventsCount===0)return h;for(p in d=this._events)e.call(d,p)&&h.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},a.prototype.listeners=function(h){var d=t?t+h:h,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var y=0,T=p.length,b=new Array(T);y<T;y++)b[y]=p[y].fn;return b},a.prototype.listenerCount=function(h){var d=t?t+h:h,p=this._events[d];return p?p.fn?1:p.length:0},a.prototype.emit=function(h,d,p,y,T,b){var _=t?t+h:h;if(!this._events[_])return!1;var w=this._events[_],L=arguments.length,P,R;if(w.fn){switch(w.once&&this.removeListener(h,w.fn,void 0,!0),L){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,p),!0;case 4:return w.fn.call(w.context,d,p,y),!0;case 5:return w.fn.call(w.context,d,p,y,T),!0;case 6:return w.fn.call(w.context,d,p,y,T,b),!0}for(R=1,P=new Array(L-1);R<L;R++)P[R-1]=arguments[R];w.fn.apply(w.context,P)}else{var k=w.length,F;for(R=0;R<k;R++)switch(w[R].once&&this.removeListener(h,w[R].fn,void 0,!0),L){case 1:w[R].fn.call(w[R].context);break;case 2:w[R].fn.call(w[R].context,d);break;case 3:w[R].fn.call(w[R].context,d,p);break;case 4:w[R].fn.call(w[R].context,d,p,y);break;default:if(!P)for(F=1,P=new Array(L-1);F<L;F++)P[F-1]=arguments[F];w[R].fn.apply(w[R].context,P)}}return!0},a.prototype.on=function(h,d,p){return s(this,h,d,p,!1)},a.prototype.once=function(h,d,p){return s(this,h,d,p,!0)},a.prototype.removeListener=function(h,d,p,y){var T=t?t+h:h;if(!this._events[T])return this;if(!d)return o(this,T),this;var b=this._events[T];if(b.fn)b.fn===d&&(!y||b.once)&&(!p||b.context===p)&&o(this,T);else{for(var _=0,w=[],L=b.length;_<L;_++)(b[_].fn!==d||y&&!b[_].once||p&&b[_].context!==p)&&w.push(b[_]);w.length?this._events[T]=w.length===1?w[0]:w:o(this,T)}return this},a.prototype.removeAllListeners=function(h){var d;return h?(d=t?t+h:h,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(t0)),t0.exports}var AP=aP(),Zc=ND(AP);const Yo="1.6.11",Us={};function lP(){return typeof __HLS_WORKER_BUNDLE__=="function"}function uP(){const i=Us[Yo];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Us[Yo]=r,r}function fP(i){const e=Us[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Us[i]=r,r}function cP(i){const e=Us[i||Yo];if(e&&e.clientCount--===1){const{worker:n,objectURL:r}=e;delete Us[i||Yo],r&&self.URL.revokeObjectURL(r),n.terminate()}}function $v(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Jc(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Ml(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function zo(i,e){const t=e;let n=0;for(;Jc(i,e);){n+=10;const r=Ml(i,e+6);n+=r,$v(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)}function hP(i,e,t,n){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[t+2],o=s>>2&15;if(o>12){const T=new Error(`invalid ADTS sampling index:${o}`);i.emit(C.ERROR,C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!0,error:T,reason:T.message});return}const a=(s>>6&3)+1,c=e[t+3]>>6&3|(s&1)<<2,h="mp4a.40."+a,d=r[o];let p=o;(a===5||a===29)&&(p-=3);const y=[a<<3|(p&14)>>1,(p&1)<<7|c<<3];return pt.log(`manifest codec:${n}, parsed codec:${h}, channels:${c}, rate:${d} (ADTS object type:${a} sampling index:${o})`),{config:y,samplerate:d,channelCount:c,codec:h,parsedCodec:h,manifestCodec:n}}function Gv(i,e){return i[e]===255&&(i[e+1]&246)===240}function Vv(i,e){return i[e+1]&1?7:9}function eh(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function dP(i,e){return e+5<i.length}function KA(i,e){return e+1<i.length&&Gv(i,e)}function gP(i,e){return dP(i,e)&&Gv(i,e)&&eh(i,e)<=i.length-e}function pP(i,e){if(KA(i,e)){const t=Vv(i,e);if(e+t>=i.length)return!1;const n=eh(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||KA(i,r)}return!1}function Hv(i,e,t,n,r){if(!i.samplerate){const s=hP(e,t,n,r);if(!s)return;Et(i,s)}}function jv(i){return 1024*9e4/i}function mP(i,e){const t=Vv(i,e);if(e+t<=i.length){const n=eh(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function Kv(i,e,t,n,r){const s=jv(i.samplerate),o=n+r*s,a=mP(e,t);let c;if(a){const{frameLength:p,headerLength:y}=a,T=y+p,b=Math.max(0,t+T-e.length);b?(c=new Uint8Array(T-y),c.set(e.subarray(t+y,e.length),0)):c=e.subarray(t+y,t+T);const _={unit:c,pts:o};return b||i.samples.push(_),{sample:_,length:T,missing:b}}const h=e.length-t;return c=new Uint8Array(h),c.set(e.subarray(t,e.length),0),{sample:{unit:c,pts:o},length:h,missing:-1}}function yP(i,e){return Jc(i,e)&&Ml(i,e+6)+10<=i.length-e}function vP(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function i0(i,e=0,t=1/0){return EP(i,e,t,Uint8Array)}function EP(i,e,t,n){const r=TP(i);let s=1;"BYTES_PER_ELEMENT"in n&&(s=n.BYTES_PER_ELEMENT);const o=SP(i)?i.byteOffset:0,a=(o+i.byteLength)/s,c=(o+e)/s,h=Math.floor(Math.max(0,Math.min(c,a))),d=Math.floor(Math.min(h+Math.max(t,0),a));return new n(r,h,d-h)}function TP(i){return i instanceof ArrayBuffer?i:i.buffer}function SP(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function bP(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2||i.data[0]!==t)return;const n=i.data.subarray(1).indexOf(0);if(n===-1)return;const r=Ui(i0(i.data,1,n)),s=i.data[2+n],o=i.data.subarray(3+n).indexOf(0);if(o===-1)return;const a=Ui(i0(i.data,3+n,o));let c;return r==="-->"?c=Ui(i0(i.data,4+n+o)):c=vP(i.data.subarray(4+n+o)),e.mimeType=r,e.pictureType=s,e.description=a,e.data=c,e}function xP(i){if(i.size<2)return;const e=Ui(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function _P(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=Ui(i.data.subarray(t),!0);t+=n.length+1;const r=Ui(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Ui(i.data.subarray(1));return{key:i.type,info:"",data:e}}function wP(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=Ui(i.data.subarray(t),!0);t+=n.length+1;const r=Ui(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Ui(i.data);return{key:i.type,info:"",data:e}}function IP(i){return i.type==="PRIV"?xP(i):i.type[0]==="W"?wP(i):i.type==="APIC"?bP(i):_P(i)}function LP(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Ml(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}}const Qa=10,RP=10;function Qv(i){let e=0;const t=[];for(;Jc(i,e);){const n=Ml(i,e+6);i[e+5]>>6&1&&(e+=Qa),e+=Qa;const r=e+n;for(;e+RP<r;){const s=LP(i.subarray(e)),o=IP(s);o&&t.push(o),e+=s.size+Qa}$v(i,e)&&(e+=Qa)}return t}function Wv(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function DP(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function th(i){const e=Qv(i);for(let t=0;t<e.length;t++){const n=e[t];if(Wv(n))return DP(n)}}let xi=(function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i})({});function Tn(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class ih{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Zi(this.cachedData,e),this.cachedData=null);let n=zo(e,0),r=n?n.length:0,s;const o=this._audioTrack,a=this._id3Track,c=n?th(n):void 0,h=e.length;for((this.basePTS===null||this.frameIndex===0&&be(c))&&(this.basePTS=CP(c,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:xi.audioId3,duration:Number.POSITIVE_INFINITY});r<h;){if(this.canParse(e,r)){const d=this.appendFrame(o,e,r);d?(this.frameIndex++,this.lastPTS=d.sample.pts,r+=d.length,s=r):r=h}else yP(e,r)?(n=zo(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:xi.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===h&&s!==h){const d=e.slice(s);this.cachedData?this.cachedData=Zi(this.cachedData,d):this.cachedData=d}}return{audioTrack:o,videoTrack:Tn(),id3Track:a,textTrack:Tn()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Tn(),id3Track:this._id3Track,textTrack:Tn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const CP=(i,e,t)=>{if(be(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let Wa=null;const PP=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],kP=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],MP=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],OP=[0,1,1,4];function Yv(i,e,t,n,r){if(t+24>e.length)return;const s=zv(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=n+r*o,c={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(c),{sample:c,length:s.frameLength,missing:0}}}function zv(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const o=i[e+2]>>1&1,a=i[e+3]>>6,c=t===3?3-n:n===3?3:4,h=PP[c*14+r-1]*1e3,p=kP[(t===3?0:t===2?1:2)*3+s],y=a===3?1:2,T=MP[t][n],b=OP[n],_=T*8*b,w=Math.floor(T*h/p+o)*b;if(Wa===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Wa=R?parseInt(R[1]):0}return!!Wa&&Wa<=87&&n===2&&h>=224e3&&a===0&&(i[e+3]=i[e+3]|128),{sampleRate:p,channelCount:y,frameLength:w,samplesPerFrame:_}}}function nh(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function qv(i,e){return e+1<i.length&&nh(i,e)}function FP(i,e){return nh(i,e)&&4<=i.length-e}function Xv(i,e){if(e+1<i.length&&nh(i,e)){const n=zv(i,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===i.length||qv(i,s)}return!1}class BP extends ih{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=zo(e,0);let r=n?.length||0;if(Xv(e,r))return!1;for(let s=e.length;r<s;r++)if(pP(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return gP(e,t)}appendFrame(e,t,n){Hv(e,this.observer,t,n,e.manifestCodec);const r=Kv(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const Zv=(i,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=i[e];const a=Math.min(n,8),c=8-a;s[0]=4278190080>>>24+c<<c,r[0]=(o[0]&s[0])>>c,t=t?t<<a|r[0]:r[0],e+=1,n-=a}return t};class NP extends ih{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=Jv(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=zo(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&th(t)!==void 0&&Zv(e,n)<16}}function Jv(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],c=e[t+4]&63,d=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][c*3+s]*2;if(t+d>e.length)return-1;const p=e[t+6]>>5;let y=0;p===2?y+=2:(p&1&&p!==1&&(y+=2),p&4&&(y+=2));const T=(e[t+6]<<8|e[t+7])>>12-y&1,_=[2,1,2,3,3,4,4,5][p]+T,w=e[t+5]>>3,L=e[t+5]&7,P=new Uint8Array([s<<6|w<<1|L>>2,(L&3)<<6|p<<3|T<<2|c>>4,c<<4&224]),R=1536/a*9e4,k=n+r*R,F=e.subarray(t,t+d);return i.config=P,i.channelCount=_,i.samplerate=a,i.samples.push({unit:F,pts:k}),d}class UP extends ih{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=zo(e,0);let n=t?.length||0;if(t&&e[n]===11&&e[n+1]===119&&th(t)!==void 0&&Zv(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(Xv(e,n))return pt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return FP(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return Yv(e,t,n,this.basePTS,this.frameIndex)}}const $P=/\/emsg[-/]ID3/i;class GP{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const s=this.videoTrack=Tn("video",1),o=this.audioTrack=Tn("audio",1),a=this.txtTrack=Tn("text",1);if(this.id3Track=Tn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const c=hv(e);if(c.video){const{id:h,timescale:d,codec:p,supplemental:y}=c.video;s.id=h,s.timescale=a.timescale=d,s.codec=p,s.supplemental=y}if(c.audio){const{id:h,timescale:d,codec:p}=c.audio;o.id=h,o.timescale=d,o.codec=p}a.id=uv.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return VD(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Zi(this.remainderData,e));const a=YD(n);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return s.samples=Up(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=Up(e,t),{videoTrack:t,audioTrack:Tn(),id3Track:r,textTrack:Tn()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=nt(e.samples,["emsg"]);r&&r.forEach(s=>{const o=qD(s);if($P.test(o.schemeIdUri)){const a=Em(o,t);let c=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;c<=.001&&(c=Number.POSITIVE_INFINITY);const h=o.payload;n.samples.push({data:h,len:h.byteLength,dts:a,pts:a,type:xi.emsg,duration:c})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const a=Em(o,t);n.samples.push({data:o.payload,len:o.payload.byteLength,dts:a,pts:a,type:xi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function Em(i,e){return be(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class VP{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Wc(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,pr.cbc)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const c=new Uint8Array(a);r.set(c,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){const o=gv(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(c=>{s.data=this.getAvcDecryptedUnit(o,c),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)}).catch(r)}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,r,o),!this.decrypter.isSync()))return}}}}class eE{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const s=n[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const r=t.byteLength;let s=e.naluState||0;const o=s,a=[];let c=0,h,d,p,y=-1,T=0;for(s===-1&&(y=0,T=this.getNALuType(t,0),s=0,c=1);c<r;){if(h=t[c++],!s){s=h?0:1;continue}if(s===1){s=h?0:2;continue}if(!h)s=3;else if(h===1){if(d=c-s-1,y>=0){const b={data:t.subarray(y,d),type:T};a.push(b)}else{const b=this.getLastNalUnit(e.samples);b&&(o&&c<=4-o&&b.state&&(b.data=b.data.subarray(0,b.data.byteLength-o)),d>0&&(b.data=Zi(b.data,t.subarray(0,d)),b.state=0))}c<r?(p=this.getNALuType(t,c),y=c,T=p,s=0):s=-1}else s=0}if(y>=0&&s>=0){const b={data:t.subarray(y,r),type:T,state:s};a.push(b)}if(a.length===0){const b=this.getLastNalUnit(e.samples);b&&(b.data=Zi(b.data,t))}return e.naluState=s,a}}class Bo{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&pt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class HP extends eE{parsePES(e,t,n,r){const s=this.parseNALu(e,n.data,r);let o=this.VideoSample,a,c=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),s.forEach(h=>{var d,p;switch(h.type){case 1:{let _=!1;a=!0;const w=h.data;if(c&&w.length>4){const L=this.readSliceType(w);(L===2||L===4||L===7||L===9)&&(_=!0)}if(_){var y;(y=o)!=null&&y.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.frame=!0,o.key=_;break}case 5:a=!0,(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 6:{a=!0,Hc(h.data,1,n.pts,t.samples);break}case 7:{var T,b;a=!0,c=!0;const _=h.data,w=this.readSPS(_);if(!e.sps||e.width!==w.width||e.height!==w.height||((T=e.pixelRatio)==null?void 0:T[0])!==w.pixelRatio[0]||((b=e.pixelRatio)==null?void 0:b[1])!==w.pixelRatio[1]){e.width=w.width,e.height=w.height,e.pixelRatio=w.pixelRatio,e.sps=[_];const L=_.subarray(1,4);let P="avc1.";for(let R=0;R<3;R++){let k=L[R].toString(16);k.length<2&&(k="0"+k),P+=k}e.codec=P}break}case 8:a=!0,e.pps=[h.data];break;case 9:a=!0,e.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:a=!0;break;default:a=!1;break}o&&a&&o.units.push(h)}),r&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Bo(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,r=8,s;for(let o=0;o<e;o++)r!==0&&(s=t.readEG(),r=(n+s+256)%256),n=r===0?n:r}readSPS(e){const t=new Bo(e);let n=0,r=0,s=0,o=0,a,c,h;const d=t.readUByte.bind(t),p=t.readBits.bind(t),y=t.readUEG.bind(t),T=t.readBoolean.bind(t),b=t.skipBits.bind(t),_=t.skipEG.bind(t),w=t.skipUEG.bind(t),L=this.skipScalingList.bind(this);d();const P=d();if(p(5),b(3),d(),w(),P===100||P===110||P===122||P===244||P===44||P===83||P===86||P===118||P===128){const G=y();if(G===3&&b(1),w(),w(),b(1),T())for(c=G!==3?8:12,h=0;h<c;h++)T()&&(h<6?L(16,t):L(64,t))}w();const R=y();if(R===0)y();else if(R===1)for(b(1),_(),_(),a=y(),h=0;h<a;h++)_();w(),b(1);const k=y(),F=y(),U=p(1);U===0&&b(1),b(1),T()&&(n=y(),r=y(),s=y(),o=y());let $=[1,1];if(T()&&T())switch(d()){case 1:$=[1,1];break;case 2:$=[12,11];break;case 3:$=[10,11];break;case 4:$=[16,11];break;case 5:$=[40,33];break;case 6:$=[24,11];break;case 7:$=[20,11];break;case 8:$=[32,11];break;case 9:$=[80,33];break;case 10:$=[18,11];break;case 11:$=[15,11];break;case 12:$=[64,33];break;case 13:$=[160,99];break;case 14:$=[4,3];break;case 15:$=[3,2];break;case 16:$=[2,1];break;case 255:{$=[d()<<8|d(),d()<<8|d()];break}}return{width:Math.ceil((k+1)*16-n*2-r*2),height:(2-U)*(F+1)*16-(U?2:4)*(s+o),pixelRatio:$}}}class jP extends eE{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,r){const s=this.parseNALu(e,n.data,r);let o=this.VideoSample,a,c=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),s.forEach(h=>{var d,p;switch(h.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:if(a=!0,c){var y;(y=o)!=null&&y.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:a=!0,(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 39:a=!0,Hc(h.data,2,n.pts,t.samples);break;case 32:a=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Et(e.params,this.readVPS(h.data)),this.initVPS=h.data),e.vps=[h.data];break;case 33:if(a=!0,c=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],h.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const T=this.readSPS(h.data);e.width=T.width,e.height=T.height,e.pixelRatio=T.pixelRatio,e.codec=T.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const b in T.params)e.params[b]=T.params[b]}this.pushParameterSet(e.sps,h.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0;break;case 34:if(a=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const T=this.readPPS(h.data);for(const b in T)e.params[b]=T[b]}this.pushParameterSet(e.pps,h.data,e.vps)}break;case 35:a=!0,e.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:a=!1;break}o&&a&&o.units.push(h)}),r&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[n]=e[r],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Bo(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:r}}readSPS(e){const t=new Bo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const r=t.readBits(2),s=t.readBoolean(),o=t.readBits(5),a=t.readUByte(),c=t.readUByte(),h=t.readUByte(),d=t.readUByte(),p=t.readUByte(),y=t.readUByte(),T=t.readUByte(),b=t.readUByte(),_=t.readUByte(),w=t.readUByte(),L=t.readUByte(),P=[],R=[];for(let At=0;At<n;At++)P.push(t.readBoolean()),R.push(t.readBoolean());if(n>0)for(let At=n;At<8;At++)t.readBits(2);for(let At=0;At<n;At++)P[At]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),R[At]&&t.readUByte();t.readUEG();const k=t.readUEG();k==3&&t.skipBits(1);const F=t.readUEG(),U=t.readUEG(),$=t.readBoolean();let G=0,W=0,Q=0,K=0;$&&(G+=t.readUEG(),W+=t.readUEG(),Q+=t.readUEG(),K+=t.readUEG());const te=t.readUEG(),oe=t.readUEG(),Ae=t.readUEG(),X=t.readBoolean();for(let At=X?0:n;At<=n;At++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let _t=0;_t<4;_t++)for(let Wt=0;Wt<(_t===3?2:6);Wt++)if(!t.readBoolean())t.readUEG();else{const Pi=Math.min(64,1<<4+(_t<<1));_t>1&&t.readEG();for(let li=0;li<Pi;li++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const re=t.readUEG();let ue=0;for(let At=0;At<re;At++){let _t=!1;if(At!==0&&(_t=t.readBoolean()),_t){At===re&&t.readUEG(),t.readBoolean(),t.readUEG();let Wt=0;for(let kn=0;kn<=ue;kn++){const Pi=t.readBoolean();let li=!1;Pi||(li=t.readBoolean()),(Pi||li)&&Wt++}ue=Wt}else{const Wt=t.readUEG(),kn=t.readUEG();ue=Wt+kn;for(let Pi=0;Pi<Wt;Pi++)t.readUEG(),t.readBoolean();for(let Pi=0;Pi<kn;Pi++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const At=t.readUEG();for(let _t=0;_t<At;_t++){for(let Wt=0;Wt<Ae+4;Wt++)t.readBits(1);t.readBits(1)}}let ge=0,pe=1,De=1,ze=!0,Me=1,rt=0;t.readBoolean(),t.readBoolean();let Qt=!1;if(t.readBoolean()){if(t.readBoolean()){const nn=t.readUByte(),Js=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],rn=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];nn>0&&nn<16?(pe=Js[nn-1],De=rn[nn-1]):nn===255&&(pe=t.readBits(16),De=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Qt=t.readBoolean(),Qt&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(Me=t.readBits(32),rt=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const rn=t.readBoolean(),zr=t.readBoolean();let Er=!1;(rn||zr)&&(Er=t.readBoolean(),Er&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Er&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Ta=0;Ta<=n;Ta++){ze=t.readBoolean();const Sa=ze||t.readBoolean();let ba=!1;Sa?t.readEG():ba=t.readBoolean();const xa=ba?1:t.readUEG()+1;if(rn)for(let Tr=0;Tr<xa;Tr++)t.readUEG(),t.readUEG(),Er&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(zr)for(let Tr=0;Tr<xa;Tr++)t.readUEG(),t.readUEG(),Er&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ge=t.readUEG())}let vi=F,Vi=U;if($){let At=1,_t=1;k===1?At=_t=2:k==2&&(At=2),vi=F-At*W-At*G,Vi=U-_t*K-_t*Q}const Pn=r?["A","B","C"][r]:"",Hl=a<<24|c<<16|h<<8|d;let Xs=0;for(let At=0;At<32;At++)Xs=(Xs|(Hl>>At&1)<<31-At)>>>0;let Zs=Xs.toString(16);return o===1&&Zs==="2"&&(Zs="6"),{codecString:`hvc1.${Pn}${o}.${Zs}.${s?"H":"L"}${L}.B0`,params:{general_tier_flag:s,general_profile_idc:o,general_profile_space:r,general_profile_compatibility_flags:[a,c,h,d],general_constraint_indicator_flags:[p,y,T,b,_,w],general_level_idc:L,bit_depth:te+8,bit_depth_luma_minus8:te,bit_depth_chroma_minus8:oe,min_spatial_segmentation_idc:ge,chroma_format_idc:k,frame_rate:{fixed:ze,fps:rt/Me}},width:vi,height:Vi,pixelRatio:[pe,De]}}readPPS(e){const t=new Bo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),s=t.readBoolean();let o=1;return s&&r?o=0:s?o=3:r&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Xt=188;class fr{constructor(e,t,n,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=r,this.videoParser=null}static probe(e,t){const n=fr.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Xt*5,t-Xt)+1,r=0;for(;r<n;){let s=!1,o=-1,a=0;for(let c=r;c<t;c+=Xt)if(e[c]===71&&(t-c===Xt||e[c+Xt]===71)){if(a++,o===-1&&(o=c,o!==0&&(n=Math.min(o+Xt*99,e.length-Xt)+1)),s||(s=gf(e,c)===0),s&&a>1&&(o===0&&a>2||c+Xt>n))return o}else{if(a)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:uv[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=fr.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=fr.createTrack("audio",r),this._id3Track=fr.createTrack("id3"),this._txtTrack=fr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let s;const o=this._videoTrack,a=this._audioTrack,c=this._id3Track,h=this._txtTrack;let d=o.pid,p=o.pesData,y=a.pid,T=c.pid,b=a.pesData,_=c.pesData,w=null,L=this.pmtParsed,P=this._pmtId,R=e.length;if(this.remainderData&&(e=Zi(this.remainderData,e),R=e.length,this.remainderData=null),R<Xt&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:c,textTrack:h};const k=Math.max(0,fr.syncOffset(e));R-=(R-k)%Xt,R<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let F=0;for(let $=k;$<R;$+=Xt)if(e[$]===71){const G=!!(e[$+1]&64),W=gf(e,$),Q=(e[$+3]&48)>>4;let K;if(Q>1){if(K=$+5+e[$+4],K===$+Xt)continue}else K=$+4;switch(W){case d:G&&(p&&(s=ls(p,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,h,s,!1)),p={data:[],size:0}),p&&(p.data.push(e.subarray(K,$+Xt)),p.size+=$+Xt-K);break;case y:if(G){if(b&&(s=ls(b,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}b={data:[],size:0}}b&&(b.data.push(e.subarray(K,$+Xt)),b.size+=$+Xt-K);break;case T:G&&(_&&(s=ls(_,this.logger))&&this.parseID3PES(c,s),_={data:[],size:0}),_&&(_.data.push(e.subarray(K,$+Xt)),_.size+=$+Xt-K);break;case 0:G&&(K+=e[K]+1),P=this._pmtId=KP(e,K);break;case P:{G&&(K+=e[K]+1);const te=QP(e,K,this.typeSupported,n,this.observer,this.logger);d=te.videoPid,d>0&&(o.pid=d,o.segmentCodec=te.segmentVideoCodec),y=te.audioPid,y>0&&(a.pid=y,a.segmentCodec=te.segmentAudioCodec),T=te.id3Pid,T>0&&(c.pid=T),w!==null&&!L&&(this.logger.warn(`MPEG-TS PMT found at ${$} after unknown PID '${w}'. Backtracking to sync byte @${k} to parse all TS packets.`),w=null,$=k-188),L=this.pmtParsed=!0;break}case 17:case 8191:break;default:w=W;break}}else F++;F>0&&pf(this.observer,new Error(`Found ${F} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=p,a.pesData=b,c.pesData=_;const U={audioTrack:a,videoTrack:o,id3Track:c,textTrack:h};return r&&this.extractRemainingSamples(U),U}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,o=n.pesData,a=t.pesData,c=r.pesData;let h;if(o&&(h=ls(o,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,s,h,!0),n.pesData=null)):n.pesData=o,a&&(h=ls(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,h);break;case"mp3":this.parseMPEGPES(t,h);break;case"ac3":this.parseAC3PES(t,h);break}t.pesData=null}else a!=null&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;c&&(h=ls(c,this.logger))?(this.parseID3PES(r,h),r.pesData=null):r.pesData=c}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new VP(this.observer,this.config,t);return this.decrypt(r,s)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new HP:e==="hevc"&&(this.videoParser=new jP))}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const p=r.missing,y=r.sample.unit.byteLength;if(p===-1)s=Zi(r.sample.unit,s);else{const T=y-p;r.sample.unit.set(s.subarray(0,p),T),e.samples.push(r.sample),n=r.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!KA(s,o);o++);if(o!==n){let p;const y=o<a-1;if(y?p=`AAC PES did not start with ADTS header,offset:${o}`:p="No ADTS header found in AAC PES",pf(this.observer,new Error(p),y,this.logger),!y)return}Hv(e,this.observer,s,o,this.audioCodec);let c;if(t.pts!==void 0)c=t.pts;else if(r){const p=jv(e.samplerate);c=r.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let h=0,d;for(;o<a;)if(d=Kv(e,s,o,c,h),o+=d.length,d.missing){this.aacOverFlow=d;break}else for(h++;o<a-1&&!KA(s,o);o++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let s=0,o=0;const a=t.pts;if(a===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<r;)if(qv(n,o)){const c=Yv(e,n,o,a,s);if(c)o+=c.length,s++;else break}else o++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let o=0,a=0,c;for(;a<s&&(c=Jv(e,n,a,r,o++))>0;)a+=c}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Et({},t,{type:this._videoTrack?xi.emsg:xi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function gf(i,e){return((i[e+1]&31)<<8)+i[e+2]}function KP(i,e){return(i[e+10]&31)<<8|i[e+11]}function QP(i,e,t,n,r,s){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(i[e+1]&15)<<8|i[e+2],c=e+3+a-4,h=(i[e+10]&15)<<8|i[e+11];for(e+=12+h;e<c;){const d=gf(i,e),p=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){n0("ADTS AAC",s);break}case 15:o.audioPid===-1&&(o.audioPid=d);break;case 21:o.id3Pid===-1&&(o.id3Pid=d);break;case 219:if(!n){n0("H.264",s);break}case 27:o.videoPid===-1&&(o.videoPid=d);break;case 3:case 4:!t.mpeg&&!t.mp3?s.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="mp3");break;case 193:if(!n){n0("AC-3",s);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&p>0){let y=e+5,T=p;for(;T>2;){switch(i[y]){case 106:t.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=d,o.segmentAudioCodec="ac3");break}const _=i[y+1]+2;y+=_,T-=_}}break;case 194:case 135:return pf(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),o;case 36:o.videoPid===-1&&(o.videoPid=d,o.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=p+5}return o}function pf(i,e,t,n){n.warn(`parsing error: ${e.message}`),i.emit(C.ERROR,C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function n0(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function ls(i,e){let t=0,n,r,s,o,a;const c=i.data;if(!i||i.size===0)return null;for(;c[0].length<19&&c.length>1;)c[0]=Zi(c[0],c[1]),c.splice(1,1);if(n=c[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(r=(n[4]<<8)+n[5],r&&r>i.size-6)return null;const d=n[7];d&192&&(o=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,d&64?(a=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,o-a>60*9e4&&(e.warn(`${Math.round((o-a)/9e4)}s delta between PTS and DTS, align them`),o=a)):a=o),s=n[8];let p=s+9;if(i.size<=p)return null;i.size-=p;const y=new Uint8Array(i.size);for(let T=0,b=c.length;T<b;T++){n=c[T];let _=n.byteLength;if(p)if(p>_){p-=_;continue}else n=n.subarray(p),_-=p,p=0;y.set(n,t),t+=_}return r&&(r-=s+3),{data:y,pts:o,dts:a,len:r}}return null}class WP{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ar=Math.pow(2,32)-1;class ne{static init(){ne.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in ne.types)ne.types.hasOwnProperty(e)&&(ne.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ne.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);ne.STTS=ne.STSC=ne.STCO=s,ne.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ne.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),ne.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),ne.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);ne.FTYP=ne.box(ne.types.ftyp,o,c,o,a),ne.DINF=ne.box(ne.types.dinf,ne.box(ne.types.dref,r))}static box(e,...t){let n=8,r=t.length;const s=r;for(;r--;)n+=t[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),r=0,n=8;r<s;r++)o.set(t[r],n),n+=t[r].byteLength;return o}static hdlr(e){return ne.box(ne.types.hdlr,ne.HDLR_TYPES[e])}static mdat(e){return ne.box(ne.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ar+1)),r=Math.floor(t%(ar+1));return ne.box(ne.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return ne.box(ne.types.mdia,ne.mdhd(e.timescale||0,e.duration||0),ne.hdlr(e.type),ne.minf(e))}static mfhd(e){return ne.box(ne.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?ne.box(ne.types.minf,ne.box(ne.types.smhd,ne.SMHD),ne.DINF,ne.stbl(e)):ne.box(ne.types.minf,ne.box(ne.types.vmhd,ne.VMHD),ne.DINF,ne.stbl(e))}static moof(e,t,n){return ne.box(ne.types.moof,ne.mfhd(e),ne.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=ne.trak(e[t]);return ne.box.apply(null,[ne.types.moov,ne.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(ne.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=ne.trex(e[t]);return ne.box.apply(null,[ne.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ar+1)),r=Math.floor(t%(ar+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return ne.box(ne.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,n[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return ne.box(ne.types.sdtp,n)}static stbl(e){return ne.box(ne.types.stbl,ne.stsd(e),ne.box(ne.types.stts,ne.STTS),ne.box(ne.types.stsc,ne.STSC),ne.box(ne.types.stsz,ne.STSZ),ne.box(ne.types.stco,ne.STCO))}static avc1(e){let t=[],n=[],r,s,o;for(r=0;r<e.sps.length;r++)s=e.sps[r],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],o=s.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(s));const a=ne.box(ne.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),c=e.width,h=e.height,d=e.pixelRatio[0],p=e.pixelRatio[1];return ne.box(ne.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,ne.box(ne.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ne.box(ne.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return ne.box(ne.types.mp4a,ne.audioStsd(e),ne.box(ne.types.esds,ne.esds(e)))}static mp3(e){return ne.box(ne.types[".mp3"],ne.audioStsd(e))}static ac3(e){return ne.box(ne.types["ac-3"],ne.audioStsd(e),ne.box(ne.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return ne.box(ne.types.stsd,ne.STSD,ne.mp4a(e));if(t==="ac3"&&e.config)return ne.box(ne.types.stsd,ne.STSD,ne.ac3(e));if(t==="mp3"&&e.codec==="mp3")return ne.box(ne.types.stsd,ne.STSD,ne.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return ne.box(ne.types.stsd,ne.STSD,ne.avc1(e));if(t==="hevc"&&e.vps)return ne.box(ne.types.stsd,ne.STSD,ne.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),r=e.width||0,s=e.height||0,o=Math.floor(n/(ar+1)),a=Math.floor(n%(ar+1));return ne.box(ne.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=ne.sdtp(e),r=e.id,s=Math.floor(t/(ar+1)),o=Math.floor(t%(ar+1));return ne.box(ne.types.traf,ne.box(ne.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),ne.box(ne.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),ne.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,ne.box(ne.types.trak,ne.tkhd(e),ne.mdia(e))}static trex(e){const t=e.id;return ne.box(ne.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,s=12+16*r,o=new Uint8Array(s);let a,c,h,d,p,y;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<r;a++)c=n[a],h=c.duration,d=c.size,p=c.flags,y=c.cts,o.set([h>>>24&255,h>>>16&255,h>>>8&255,h&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*a);return ne.box(ne.types.trun,o)}static initSegment(e){ne.types||ne.init();const t=ne.moov(e);return Zi(ne.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],r=4,s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let o=s.length;for(let b=0;b<n.length;b+=1){o+=3;for(let _=0;_<n[b].length;_+=1)o+=2+n[b][_].length}const a=new Uint8Array(o);a.set(s,0),o=s.length;const c=n.length-1;for(let b=0;b<n.length;b+=1){a.set(new Uint8Array([32+b|(b===c?128:0),0,n[b].length]),o),o+=3;for(let _=0;_<n[b].length;_+=1)a.set(new Uint8Array([n[b][_].length>>8,n[b][_].length&255]),o),o+=2,a.set(n[b][_],o),o+=n[b][_].length}const h=ne.box(ne.types.hvcC,a),d=e.width,p=e.height,y=e.pixelRatio[0],T=e.pixelRatio[1];return ne.box(ne.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,ne.box(ne.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ne.box(ne.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,y&255,T>>24,T>>16&255,T>>8&255,T&255])))}}ne.types=void 0;ne.HDLR_TYPES=void 0;ne.STTS=void 0;ne.STSC=void 0;ne.STCO=void 0;ne.STSZ=void 0;ne.VMHD=void 0;ne.SMHD=void 0;ne.STSD=void 0;ne.FTYP=void 0;ne.DINF=void 0;const tE=9e4;function rh(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function YP(i,e,t=1,n=!1){return rh(i,e,1/t,n)}function go(i,e=!1){return rh(i,1e3,1/tE,e)}function zP(i,e=1){return rh(i,tE,1/e)}const qP=10*1e3,XP=1024,ZP=1152,JP=1536;let us=null,r0=null;function Tm(i,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class TA extends tn{constructor(e,t,n,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,us===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);us=o?parseInt(o[1]):0}if(r0===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);r0=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((s,o)=>{let a=o.pts,c=a-s;return c<-4294967296&&(t=!0,a=qi(a,n),c=a-s),c>0?s:a},n);return t&&this.debug("PTS rollover detected"),r}remux(e,t,n,r,s,o,a,c){let h,d,p,y,T,b,_=s,w=s;const L=e.pid>-1,P=t.pid>-1,R=t.samples.length,k=e.samples.length>0,F=a&&R>0||R>1;if((!L||k)&&(!P||F)||this.ISGenerated||a){if(this.ISGenerated){var $,G,W,Q;const Ae=this.videoTrackConfig;(Ae&&(t.width!==Ae.width||t.height!==Ae.height||(($=t.pixelRatio)==null?void 0:$[0])!==((G=Ae.pixelRatio)==null?void 0:G[0])||((W=t.pixelRatio)==null?void 0:W[1])!==((Q=Ae.pixelRatio)==null?void 0:Q[1]))||!Ae&&F||this.nextAudioTs===null&&k)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,t,s,o));const K=this.isVideoContiguous;let te=-1,oe;if(F&&(te=ek(t.samples),!K&&this.config.forceKeyFrameOnDiscontinuity))if(b=!0,te>0){this.warn(`Dropped ${te} out of ${R} video samples due to a missing keyframe`);const Ae=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(te),t.dropped+=te,w+=(t.samples[0].pts-Ae)/t.inputTimeScale,oe=w}else te===-1&&(this.warn(`No keyframe found out of ${R} video samples`),b=!1);if(this.ISGenerated){if(k&&F){const Ae=this.getVideoStartPts(t.samples),Y=(qi(e.samples[0].pts,Ae)-Ae)/t.inputTimeScale;_+=Math.max(0,Y),w+=Math.max(0,-Y)}if(k){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(e,t,s,o)),d=this.remuxAudio(e,_,this.isAudioContiguous,o,P||F||c===we.AUDIO?w:void 0),F){const Ae=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(e,t,s,o)),h=this.remuxVideo(t,w,K,Ae)}}else F&&(h=this.remuxVideo(t,w,K,0));h&&(h.firstKeyFrame=te,h.independent=te!==-1,h.firstKeyFramePTS=oe)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(T=iE(n,s,this._initPTS,this._initDTS)),r.samples.length&&(y=nE(r,s,this._initPTS))),{audio:d,video:h,initSegment:p,independent:b,text:y,id3:T}}generateIS(e,t,n,r){const s=e.samples,o=t.samples,a=this.typeSupported,c={},h=this._initPTS;let d=!h||r,p="audio/mp4",y,T,b,_=-1;if(d&&(y=T=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}c.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):ne.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(_=e.id,b=e.inputTimeScale,!h||b!==h.timescale?y=T=s[0].pts-Math.round(b*n):d=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ne.initSegment([t]),metadata:{width:t.width,height:t.height}},d)if(_=t.id,b=t.inputTimeScale,!h||b!==h.timescale){const w=this.getVideoStartPts(o),L=Math.round(b*n);T=Math.min(T,qi(o[0].dts,w)-L),y=Math.min(y,w-L)}else d=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,d?(h&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${n} ${y/b} != initPTS: ${h.baseTime/h.timescale} (${h.baseTime}/${h.timescale}) trackId: ${h.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${y/b} (${y}/${b}) trackId: ${_}`),this._initPTS={baseTime:y,timescale:b,trackId:_},this._initDTS={baseTime:T,timescale:b,trackId:_}):y=b=void 0,{tracks:c,initPTS:y,timescale:b,trackId:_}}remuxVideo(e,t,n,r){const s=e.inputTimeScale,o=e.samples,a=[],c=o.length,h=this._initPTS,d=h.baseTime*s/h.timescale;let p=this.nextVideoTs,y=8,T=this.videoSampleDuration,b,_,w=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,P=!1;if(!n||p===null){const ge=d+t*s,pe=o[0].pts-qi(o[0].dts,o[0].pts);us&&p!==null&&Math.abs(ge-pe-(p+d))<15e3?n=!0:p=ge-pe-d}const R=p+d;for(let ge=0;ge<c;ge++){const pe=o[ge];pe.pts=qi(pe.pts,R),pe.dts=qi(pe.dts,R),pe.dts<o[ge>0?ge-1:ge].dts&&(P=!0)}P&&o.sort(function(ge,pe){const De=ge.dts-pe.dts,ze=ge.pts-pe.pts;return De||ze}),b=o[0].dts,_=o[o.length-1].dts;const k=_-b,F=k?Math.round(k/(c-1)):T||e.inputTimeScale/30;if(n){const ge=b-R,pe=ge>F,De=ge<-1;if((pe||De)&&(pe?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${go(ge,!0)} ms (${ge}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${go(-ge,!0)} ms (${ge}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!De||R>=o[0].pts||us)){b=R;const ze=o[0].pts-ge;if(pe)o[0].dts=b,o[0].pts=ze;else{let Me=!0;for(let rt=0;rt<o.length&&!(o[rt].dts>ze&&Me);rt++){const Qt=o[rt].pts;if(o[rt].dts-=ge,o[rt].pts-=ge,rt<o.length-1){const Gt=o[rt+1].pts,vi=o[rt].pts,Vi=Gt<=vi,Pn=Gt<=Qt;Me=Vi==Pn}}}this.log(`Video: Initial PTS/DTS adjusted: ${go(ze,!0)}/${go(b,!0)}, delta: ${go(ge,!0)} ms`)}}b=Math.max(0,b);let U=0,$=0,G=b;for(let ge=0;ge<c;ge++){const pe=o[ge],De=pe.units,ze=De.length;let Me=0;for(let rt=0;rt<ze;rt++)Me+=De[rt].data.length;$+=Me,U+=ze,pe.length=Me,pe.dts<G?(pe.dts=G,G+=F/4|0||1):G=pe.dts,w=Math.min(pe.pts,w),L=Math.max(pe.pts,L)}_=o[c-1].dts;const W=$+4*U+8;let Q;try{Q=new Uint8Array(W)}catch(ge){this.observer.emit(C.ERROR,C.ERROR,{type:Re.MUX_ERROR,details:se.REMUX_ALLOC_ERROR,fatal:!1,error:ge,bytes:W,reason:`fail allocating video mdat ${W}`});return}const K=new DataView(Q.buffer);K.setUint32(0,W),Q.set(ne.types.mdat,4);let te=!1,oe=Number.POSITIVE_INFINITY,Ae=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,Y=Number.NEGATIVE_INFINITY;for(let ge=0;ge<c;ge++){const pe=o[ge],De=pe.units;let ze=0;for(let Qt=0,Gt=De.length;Qt<Gt;Qt++){const vi=De[Qt],Vi=vi.data,Pn=vi.data.byteLength;K.setUint32(y,Pn),y+=4,Q.set(Vi,y),y+=Pn,ze+=4+Pn}let Me;if(ge<c-1)T=o[ge+1].dts-pe.dts,Me=o[ge+1].pts-pe.pts;else{const Qt=this.config,Gt=ge>0?pe.dts-o[ge-1].dts:F;if(Me=ge>0?pe.pts-o[ge-1].pts:F,Qt.stretchShortVideoTrack&&this.nextAudioTs!==null){const vi=Math.floor(Qt.maxBufferHole*s),Vi=(r?w+r*s:this.nextAudioTs+d)-pe.pts;Vi>vi?(T=Vi-Gt,T<0?T=Gt:te=!0,this.log(`It is approximately ${Vi/90} ms to the next segment; using duration ${T/90} ms for the last video frame.`)):T=Gt}else T=Gt}const rt=Math.round(pe.pts-pe.dts);oe=Math.min(oe,T),X=Math.max(X,T),Ae=Math.min(Ae,Me),Y=Math.max(Y,Me),a.push(Tm(pe.key,T,ze,rt))}if(a.length){if(us){if(us<70){const ge=a[0].flags;ge.dependsOn=2,ge.isNonSync=0}}else if(r0&&Y-Ae<X-oe&&F/X<.025&&a[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ge=b;for(let pe=0,De=a.length;pe<De;pe++){const ze=ge+a[pe].duration,Me=ge+a[pe].cts;if(pe<De-1){const rt=ze+a[pe+1].cts;a[pe].duration=rt-Me}else a[pe].duration=pe?a[pe-1].duration:F;a[pe].cts=0,ge=ze}}}T=te||!T?F:T;const ee=_+T;this.nextVideoTs=p=ee-d,this.videoSampleDuration=T,this.isVideoContiguous=!0;const Te={data1:ne.moof(e.sequenceNumber++,b,Et(e,{samples:a})),data2:Q,startPTS:(w-d)/s,endPTS:(L+T-d)/s,startDTS:(b-d)/s,endDTS:p/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Te}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return ZP;case"ac3":return JP;default:return XP}}remuxAudio(e,t,n,r,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,c=o/a,h=this.getSamplesPerFrame(e),d=h*c,p=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,T=[],b=s!==void 0;let _=e.samples,w=y?0:8,L=this.nextAudioTs||-1;const P=p.baseTime*o/p.timescale,R=P+t*o;if(this.isAudioContiguous=n=n||_.length&&L>0&&(r&&Math.abs(R-(L+P))<9e3||Math.abs(qi(_[0].pts,R)-(L+P))<20*d),_.forEach(function(Y){Y.pts=qi(Y.pts,R)}),!n||L<0){if(_=_.filter(Y=>Y.pts>=0),!_.length)return;s===0?L=0:r&&!b?L=Math.max(0,R-P):L=_[0].pts-P}if(e.segmentCodec==="aac"){const Y=this.config.maxAudioFramesDrift;for(let ee=0,re=L+P;ee<_.length;ee++){const ue=_[ee],Te=ue.pts,ge=Te-re,pe=Math.abs(1e3*ge/o);if(ge<=-Y*d&&b)ee===0&&(this.warn(`Audio frame @ ${(Te/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*ge/o)} ms.`),this.nextAudioTs=L=Te-P,re=Te);else if(ge>=Y*d&&pe<qP&&b){let De=Math.round(ge/d);for(re=Te-De*d;re<0&&De&&d;)De--,re+=d;ee===0&&(this.nextAudioTs=L=re-P),this.warn(`Injecting ${De} audio frames @ ${((re-P)/o).toFixed(3)}s due to ${Math.round(1e3*ge/o)} ms gap.`);for(let ze=0;ze<De;ze++){let Me=WP.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Me||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Me=ue.unit.subarray()),_.splice(ee,0,{unit:Me,pts:re}),re+=d,ee++}}ue.pts=re,re+=d}}let k=null,F=null,U,$=0,G=_.length;for(;G--;)$+=_[G].unit.byteLength;for(let Y=0,ee=_.length;Y<ee;Y++){const re=_[Y],ue=re.unit;let Te=re.pts;if(F!==null){const pe=T[Y-1];pe.duration=Math.round((Te-F)/c)}else if(n&&e.segmentCodec==="aac"&&(Te=L+P),k=Te,$>0){$+=w;try{U=new Uint8Array($)}catch(pe){this.observer.emit(C.ERROR,C.ERROR,{type:Re.MUX_ERROR,details:se.REMUX_ALLOC_ERROR,fatal:!1,error:pe,bytes:$,reason:`fail allocating audio mdat ${$}`});return}y||(new DataView(U.buffer).setUint32(0,$),U.set(ne.types.mdat,4))}else return;U.set(ue,w);const ge=ue.byteLength;w+=ge,T.push(Tm(!0,h,ge,0)),F=Te}const W=T.length;if(!W)return;const Q=T[T.length-1];L=F-P,this.nextAudioTs=L+c*Q.duration;const K=y?new Uint8Array(0):ne.moof(e.sequenceNumber++,k/c,Et({},e,{samples:T}));e.samples=[];const te=(k-P)/o,oe=L/o,X={data1:K,data2:U,startPTS:te,endPTS:oe,startDTS:te,endDTS:oe,type:"audio",hasAudio:!0,hasVideo:!1,nb:W};return this.isAudioContiguous=!0,X}}function qi(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function ek(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function iE(i,e,t,n){const r=i.samples.length;if(!r)return;const s=i.inputTimeScale;for(let a=0;a<r;a++){const c=i.samples[a];c.pts=qi(c.pts-t.baseTime*s/t.timescale,e*s)/s,c.dts=qi(c.dts-n.baseTime*s/n.timescale,e*s)/s}const o=i.samples;return i.samples=[],{samples:o}}function nE(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let o=0;o<n;o++){const a=i.samples[o];a.pts=qi(a.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((o,a)=>o.pts-a.pts);const s=i.samples;return i.samples=[],{samples:s}}class tk extends tn{constructor(e,t,n,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:s,video:o}=this.initData=hv(e);if(t)QD(e,t);else{const c=s||o;c!=null&&c.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${c.codec}")!`)}s&&(n=Sm(s,St.AUDIO,this)),o&&(r=Sm(o,St.VIDEO,this));const a={};s&&o?a.audiovideo={container:"video/mp4",codec:n+","+r,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:s?a.audio={container:"audio/mp4",codec:n,encrypted:s.encrypted,initSegment:e,id:"audio"}:o?a.video={container:"video/mp4",codec:r,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,n,r,s,o){var a,c;let{initPTS:h,lastEndTime:d}=this;const p={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};be(d)||(d=this.lastEndTime=s||0);const y=t.samples;if(!y.length)return p;const T={initPTS:void 0,timescale:void 0,trackId:void 0};let b=this.initData;if((a=b)!=null&&a.length||(this.generateInitSegment(y),b=this.initData),!((c=b)!=null&&c.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1);const _=WD(y,b,this),w=b.audio?_[b.audio.id]:null,L=b.video?_[b.video.id]:null,P=Ya(L,1/0),R=Ya(w,1/0),k=Ya(L,0,!0),F=Ya(w,0,!0);let U=s,$=0;const G=w&&(!L||!h&&R<P||h&&h.trackId===b.audio.id),W=G?w:L;if(W){const re=W.timescale,ue=W.start-s*re,Te=G?b.audio.id:b.video.id;U=W.start/re,$=G?F-R:k-P,(o||!h)&&(ik(h,U,s,$)||re!==h.timescale)&&(h&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${s} ${ue/re} != initPTS: ${h.baseTime/h.timescale} (${h.baseTime}/${h.timescale}) trackId: ${h.trackId}`),this.log(`Found initPTS at playlist time: ${s} offset: ${U-s} (${ue}/${re}) trackId: ${Te}`),h=null,T.initPTS=ue,T.timescale=re,T.trackId=Te)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${s}`);h?(T.initPTS=h.baseTime,T.timescale=h.timescale,T.trackId=h.trackId):((!T.timescale||T.trackId===void 0||T.initPTS===void 0)&&(this.warn("Could not set initPTS"),T.initPTS=U,T.timescale=1,T.trackId=-1),this.initPTS=h={baseTime:T.initPTS,timescale:T.timescale,trackId:T.trackId});const Q=U-h.baseTime/h.timescale,K=Q+$;$>0?this.lastEndTime=K:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const te=!!b.audio,oe=!!b.video;let Ae="";te&&(Ae+="audio"),oe&&(Ae+="video");const X=(b.audio?b.audio.encrypted:!1)||(b.video?b.video.encrypted:!1),Y={data1:y,startPTS:Q,startDTS:Q,endPTS:K,endDTS:K,type:Ae,hasAudio:te,hasVideo:oe,nb:1,dropped:0,encrypted:X};p.audio=te&&!oe?Y:void 0,p.video=oe?Y:void 0;const ee=L?.sampleCount;if(ee){const re=L.keyFrameIndex,ue=re!==-1;Y.nb=ee,Y.dropped=re===0||this.isVideoContiguous?0:ue?re:ee,Y.independent=ue,Y.firstKeyFrame=re,ue&&L.keyFrameStart&&(Y.firstKeyFramePTS=(L.keyFrameStart-h.baseTime)/h.timescale),this.isVideoContiguous||(p.independent=ue),this.isVideoContiguous||(this.isVideoContiguous=ue),Y.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${re}/${ee} dropped: ${Y.dropped} start: ${Y.firstKeyFramePTS||"NA"}`)}return p.initSegment=T,p.id3=iE(n,s,h,h),r.samples.length&&(p.text=nE(r,s,h)),p}}function Ya(i,e,t=!1){return i?.start!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function ik(i,e,t,n){if(i===null)return!0;const r=Math.max(n,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>r}function Sm(i,e,t){const n=i.codec;return n&&n.length>4?n:e===St.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?NA(n,!1):(t.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(t.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let Vn;try{Vn=self.performance.now.bind(self.performance)}catch{Vn=Date.now}const SA=[{demux:GP,remux:tk},{demux:fr,remux:TA},{demux:BP,remux:TA},{demux:UP,remux:TA}];SA.splice(2,0,{demux:NP,remux:TA});class bm{constructor(e,t,n,r,s,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=s,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const s=n.transmuxing;s.executeStart=Vn();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:c}=this;r&&(this.currentTransmuxState=r);const{contiguous:h,discontinuity:d,trackSwitch:p,accurateTimeOffset:y,timeOffset:T,initSegmentChange:b}=r||a,{audioCodec:_,videoCodec:w,defaultInitPts:L,duration:P,initSegmentData:R}=c,k=nk(o,t);if(k&&Ds(k.method)){const G=this.getDecrypter(),W=zc(k.method);if(G.isSync()){let Q=G.softwareDecrypt(o,k.key.buffer,k.iv.buffer,W);if(n.part>-1){const te=G.flush();Q=te&&te.buffer}if(!Q)return s.executeEnd=Vn(),s0(n);o=new Uint8Array(Q)}else return this.asyncResult=!0,this.decryptionPromise=G.webCryptoDecrypt(o,k.key.buffer,k.iv.buffer,W).then(Q=>{const K=this.push(Q,null,n);return this.decryptionPromise=null,K}),this.decryptionPromise}const F=this.needsProbing(d,p);if(F){const G=this.configureTransmuxer(o);if(G)return this.logger.warn(`[transmuxer] ${G.message}`),this.observer.emit(C.ERROR,C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,error:G,reason:G.message}),s.executeEnd=Vn(),s0(n)}(d||p||b||F)&&this.resetInitSegment(R,_,w,P,t),(d||b||F)&&this.resetInitialTimestamp(L),h||this.resetContiguity();const U=this.transmux(o,k,T,y,n);this.asyncResult=qo(U);const $=this.currentTransmuxState;return $.contiguous=!0,$.discontinuity=!1,$.trackSwitch=!1,s.executeEnd=Vn(),U}flush(e){const t=e.transmuxing;t.executeStart=Vn();const{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const o=[],{timeOffset:a}=r;if(n){const p=n.flush();p&&o.push(this.push(p.buffer,null,e))}const{demuxer:c,remuxer:h}=this;if(!c||!h){t.executeEnd=Vn();const p=[s0(e)];return this.asyncResult?Promise.resolve(p):p}const d=c.flush(a);return qo(d)?(this.asyncResult=!0,d.then(p=>(this.flushRemux(o,p,e),o))):(this.flushRemux(o,d,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:c,timeOffset:h}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===we.MAIN?"level":"track"} ${n.level}`);const d=this.remuxer.remux(r,s,o,a,h,c,!0,this.id);e.push({remuxResult:d,chunkMeta:n}),n.transmuxing.executeEnd=Vn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,r,s):o=this.transmuxUnencrypted(e,n,r,s),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:c}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,c,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r}=this;let s;for(let p=0,y=SA.length;p<y;p++){var o;if((o=SA[p].demux)!=null&&o.probe(e,this.logger)){s=SA[p];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,c=this.remuxer,h=s.remux,d=s.demux;(!c||!(c instanceof h))&&(this.remuxer=new h(n,t,r,this.logger)),(!a||!(a instanceof d))&&(this.demuxer=new d(n,t,r,this.logger),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Wc(this.config)),e}}function nk(i,e){let t=null;return i.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const s0=i=>({remuxResult:{},chunkMeta:i});function qo(i){return"then"in i&&i.then instanceof Function}class rk{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}}class sk{constructor(e,t,n,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}let xm=0;class rE{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=xm++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=c=>{const h=c.data,d=this.hls;if(!(!d||!(h!=null&&h.event)||h.instanceNo!==this.instanceNo))switch(h.event){case"init":{var p;const y=(p=this.workerContext)==null?void 0:p.objectURL;y&&self.URL.revokeObjectURL(y);break}case"transmuxComplete":{this.handleTransmuxComplete(h.data);break}case"flush":{this.onFlush(h.data);break}case"workerLog":{d.logger[h.data.logType]&&d.logger[h.data.logType](h.data.message);break}default:{h.data=h.data||{},h.data.frag=this.frag,h.data.part=this.part,h.data.id=this.id,d.trigger(h.event,h.data);break}}},this.onWorkerError=c=>{if(!this.hls)return;const h=new Error(`${c.message}  (${c.filename}:${c.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})};const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(c,h)=>{h=h||{},h.frag=this.frag||void 0,c===C.ERROR&&(h=h,h.parent=this.id,h.part=this.part,this.error=h.error),this.hls.trigger(c,h)};this.observer=new Zc,this.observer.on(C.FRAG_DECRYPTED,o),this.observer.on(C.ERROR,o);const a=Vp(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const c=this.hls.logger;if(s.workerPath||lP()){try{s.workerPath?(c.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=fP(s.workerPath)):(c.log(`injecting Web Worker for "${t}"`),this.workerContext=uP());const{worker:d}=this.workerContext;d.addEventListener("message",this.onWorkerMessage),d.addEventListener("error",this.onWorkerError),d.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:t,config:xt(s)})}catch(d){c.warn(`Error setting up "${t}" Web Worker, fallback to inline`,d),this.terminateWorker(),this.error=null,this.transmuxer=new bm(this.observer,a,s,"",t,e.logger)}return}}this.transmuxer=new bm(this.observer,a,s,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=xm++;const t=this.hls.config,n=Vp(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:xt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),cP(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,r,s,o,a,c,h,d){var p,y;h.transmuxing.start=self.performance.now();const{instanceNo:T,transmuxer:b}=this,_=o?o.start:s.start,w=s.decryptdata,L=this.frag,P=!(L&&s.cc===L.cc),R=!(L&&h.level===L.level),k=L?h.sn-L.sn:-1,F=this.part?h.part-this.part.index:-1,U=k===0&&h.id>1&&h.id===L?.stats.chunkCount,$=!R&&(k===1||k===0&&(F===1||U&&F<=0)),G=self.performance.now();(R||k||s.stats.parsing.start===0)&&(s.stats.parsing.start=G),o&&(F||!$)&&(o.stats.parsing.start=G);const W=!(L&&((p=s.initSegment)==null?void 0:p.url)===((y=L.initSegment)==null?void 0:y.url)),Q=new sk(P,$,c,R,_,W);if(!$||P||W){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${h.sn}${h.part>-1?" part: "+h.part:""} ${this.id===we.MAIN?"level":"track"}: ${h.level} id: ${h.id}
        discontinuity: ${P}
        trackSwitch: ${R}
        contiguous: ${$}
        accurateTimeOffset: ${c}
        timeOffset: ${_}
        initSegmentChange: ${W}`);const K=new rk(n,r,t,a,d);this.configureTransmuxer(K)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:T,cmd:"demux",data:e,decryptdata:w,chunkMeta:h,state:Q},e instanceof ArrayBuffer?[e]:[]);else if(b){const K=b.push(e,w,h,Q);qo(K)?K.then(te=>{this.handleTransmuxComplete(te)}).catch(te=>{this.transmuxerError(te,h,"transmuxer-interface push error")}):this.handleTransmuxComplete(K)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const r=n.flush(e);qo(r)?r.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const _m=100;class sE extends kl{constructor(e,t,n){super(e,t,n,"audio-stream-controller",we.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s,trackId:o}){if(n===we.MAIN){const a=t.cc,c=this.fragCurrent;if(this.initPTS[a]={baseTime:r,timescale:s,trackId:o},this.log(`InitPTS for cc: ${a} found from main: ${r/s} (${r}/${s}) trackId: ${o}`),this.mainAnchor=t,this.state===fe.WAITING_INIT_PTS){const h=this.waitingData;(!h&&!this.loadingParts||h&&h.frag.cc!==a)&&this.syncWithAnchor(t,h?.frag)}else!this.hls.hasEnoughToStart&&c&&c.cc!==a?(c.abortRequests(),this.syncWithAnchor(t,c)):this.state===fe.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const r=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(t&&r?.cc===t.cc)return;const s=(r||e).cc,o=this.getLevelDetails(),a=this.getLoadPosition(),c=xv(o,s,a);c&&(this.log(`Syncing with main frag at ${c.start} cc ${c.cc}`),this.startFragRequested=!1,this.nextLoadPosition=c.start,this.resetLoadingState(),this.state===fe.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=fe.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(_m),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=fe.IDLE):this.state=fe.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case fe.IDLE:this.doTickIdle();break;case fe.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=e?.[t],r=n?.details;if(r&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(r))break;this.state=fe.WAITING_INIT_PTS}break}case fe.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case fe.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:s}=e,o=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=fe.FRAG_LOADING;const a=r.flush().buffer,c={frag:t,part:n,payload:a,networkDetails:null};this._handleFragmentLoadProgress(c),s&&super._handleFragmentLoadComplete(c)}else o&&o.cc!==e.frag.cc&&this.syncWithAnchor(o,e.frag)}else this.state=fe.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:r,trackId:s}=this,o=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(n!=null&&n[s]))return;const a=n[s],c=a.details;if(!c||this.waitForLive(a)||this.waitForCdnTuneIn(c)){this.state=fe.WAITING_TRACK,this.startFragRequested=!1;return}const h=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&h&&(this.bufferFlushed=!1,this.afterBufferFlushed(h,St.AUDIO,we.AUDIO));const d=this.getFwdBufferInfo(h,we.AUDIO);if(d===null)return;if(!this.switchingTrack&&this._streamEnded(d,c)){t.trigger(C.BUFFER_EOS,{type:"audio"}),this.state=fe.ENDED;return}const p=d.len,y=t.maxBufferLength,T=c.fragments,b=T[0].start,_=this.getLoadPosition(),w=this.flushing?_:d.end;if(this.switchingTrack&&r){const R=_;c.PTSKnown&&R<b&&(d.end>b||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=b+.05)}if(p>=y&&!this.switchingTrack&&w<T[T.length-1].start)return;let L=this.getNextFragment(w,c);if(L&&this.isLoopLoading(L,w)&&(L=this.getNextFragmentLoopLoading(L,c,d,we.MAIN,y)),!L){this.bufferFlushed=!0;return}let P=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&P&&$t(L)&&!L.endList&&(!c.live||!this.loadingParts&&w<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(P)===jt.OK&&(this.mainFragLoading=P=null),P&&$t(P))){if(L.start>P.end){const k=this.fragmentTracker.getFragAtPos(w,we.MAIN);k&&k.end>P.end&&(P=k,this.mainFragLoading={frag:k,targetBufferTime:null})}if(L.start>P.end)return}this.loadFragment(L,a,w)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Ns(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==fe.STOPPED&&(this.setInterval(_m),this.state=fe.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(C.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:r}=this,{details:s,id:o,groupId:a,track:c}=t;if(!r){this.warn(`Audio tracks reset while loading track ${o} "${c.name}" of "${a}"`);return}const h=this.mainDetails;if(!h||s.endCC>h.endCC||h.expired){this.cachedTrackLoadedData=t,this.state!==fe.STOPPED&&(this.state=fe.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${c.name}" of "${a}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const d=r[o];let p=0;if(s.live||(n=d.details)!=null&&n.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(d.details){var y;p=this.alignPlaylists(s,d.details,(y=this.levelLastLoaded)==null?void 0:y.details)}s.alignedSliding||(Nv(s,h),s.alignedSliding||jA(s,h),p=s.fragmentStart)}d.details=s,this.levelLastLoaded=d,this.startFragRequested||this.setStartPosition(h,p),this.hls.trigger(C.AUDIO_TRACK_UPDATED,{details:s,id:o,groupId:t.groupId}),this.state===fe.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=fe.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:s}=e,{config:o,trackId:a,levels:c}=this;if(!c){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const h=c[a];if(!h){this.warn("Audio track is undefined on fragment load progress");return}const d=h.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const p=o.defaultAudioCodec||h.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new rE(this.hls,we.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const T=this.initPTS[n.cc],b=(t=n.initSegment)==null?void 0:t.data;if(T!==void 0){const w=r?r.index:-1,L=w!==-1,P=new Pl(n.level,n.sn,n.stats.chunkCount,s.byteLength,w,L);y.push(s,b,p,"",n,r,d.totalduration,!1,P,T)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${d.startSN} ,${d.endSN}],track ${a}`);const{cache:_}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new Uv,complete:!1};_.push(new Uint8Array(s)),this.state!==fe.STOPPED&&(this.state=fe.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===we.MAIN&&$t(t.frag)&&(this.mainFragLoading=t,this.state===fe.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==we.AUDIO){!this.audioOnly&&n.type===we.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if($t(n)){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(C.AUDIO_TRACK_SWITCHED,yt({},s)))}this.fragBufferedComplete(n,r),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=fe.ERROR;return}switch(t.details){case se.FRAG_GAP:case se.FRAG_PARSING_ERROR:case se.FRAG_DECRYPT_ERROR:case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(we.AUDIO,t);break;case se.AUDIO_TRACK_LOAD_ERROR:case se.AUDIO_TRACK_LOAD_TIMEOUT:case se.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===fe.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===st.AUDIO_TRACK&&(this.state=fe.IDLE);break;case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case se.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case se.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==St.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==St.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===fe.ENDED&&(this.state=fe.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,we.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:c,part:h,level:d}=a,{details:p}=d,{audio:y,text:T,id3:b,initSegment:_}=s;if(this.fragContextChanged(c)||!p){this.fragmentTracker.removeFragment(c);return}if(this.state=fe.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),_!=null&&_.tracks){const w=c.initSegment||c;if(this.unhandledEncryptionError(_,c))return;this._bufferInitSegment(d,_.tracks,w,o),r.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:n,tracks:_.tracks})}if(y){const{startPTS:w,endPTS:L,startDTS:P,endDTS:R}=y;h&&(h.elementaryStreams[St.AUDIO]={startPTS:w,endPTS:L,startDTS:P,endDTS:R}),c.setElementaryStreamInfo(St.AUDIO,w,L,P,R),this.bufferFragmentData(y,c,h,o)}if(b!=null&&(t=b.samples)!=null&&t.length){const w=Et({id:n,frag:c,details:p},b);r.trigger(C.FRAG_PARSING_METADATA,w)}if(T){const w=Et({id:n,frag:c,details:p},T);r.trigger(C.FRAG_PARSING_USERDATA,w)}}_bufferInitSegment(e,t,n,r){if(this.state!==fe.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const s=t.audio;s.id=we.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(C.BUFFER_CODECS,t);const a=s.initSegment;if(a!=null&&a.byteLength){const c={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:a};this.hls.trigger(C.BUFFER_APPENDING,c)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===jt.NOT_LOADED||r===jt.PARTIAL){var s;if(!$t(e))this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=fe.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&jA(t.details,o)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:s,audioCodec:o,channels:a}=this.bufferedTrack;Vr({name:t,lang:n,assocLang:r,characteristics:s,audioCodec:o,channels:a},e,Pr)||($A(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(C.AUDIO_TRACK_SWITCHED,yt({},e))}}class Ol extends tn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t?.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){const a=r[o];let c;try{c=new self.URL(a.URI,t.url).href}catch(h){this.warn(`Could not construct new URL for Rendition Report: ${h}`),c=a.URI||""}if(c===e){s=o;break}else c===e.substring(0,c.length)&&(s=o)}if(s!==-1){const o=r[s],a=parseInt(o["LAST-MSN"])||t.lastPartSn;let c=parseInt(o["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}const h=n&&Hp(n);return new lf(a,c>=0?c:void 0,h)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:r,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;r.advancedDateTime=Date.now()-a;const c=this.hls.config.timelineOffset;if(c!==r.appliedTimelineOffset){const d=Math.max(c||0,0);r.appliedTimelineOffset=d,r.fragments.forEach(p=>{p.setStart(p.playlistOffset+d)})}if(r.live||n!=null&&n.live){const d="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(n),n&&r.fragments.length>0){ZC(n,r,this);const P=r.playlistParsingError;if(P){this.warn(P);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var h;const{networkDetails:k}=t;R.trigger(C.ERROR,{type:Re.NETWORK_ERROR,details:se.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:P,reason:P.message,level:t.level||void 0,parent:(h=r.fragments[0])==null?void 0:h.type,networkDetails:k,stats:s});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=s.loading.start);const p=this.hls.mainForwardBufferInfo,y=p?p.end-p.len:0,T=(r.edge-y)*1e3,b=kv(r,T);if(r.requestScheduled+b<o?r.requestScheduled=o:r.requestScheduled+=b,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let _,w,L;if(r.canBlockReload&&r.endSN&&r.advanced){const P=this.hls.config.lowLatencyMode,R=r.lastPartSn,k=r.endSN,F=r.lastPartIndex,U=F!==-1,$=R===k;U?$?(w=k+1,L=P?0:F):(w=R,L=P?F+1:r.maxPartIndex):w=k+1;const G=r.age,W=G+r.ageHeader;let Q=Math.min(W-r.partTarget,r.targetduration*1.5);if(Q>0){if(W>r.targetduration*3)this.log(`Playlist last advanced ${G.toFixed(2)}s ago. Omitting segment and part directives.`),w=void 0,L=void 0;else if(n!=null&&n.tuneInGoal&&W-r.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${Q} with playlist age: ${r.age}`),Q=0;else{const K=Math.floor(Q/r.targetduration);if(w+=K,L!==void 0){const te=Math.round(Q%r.targetduration/r.partTarget);L+=te}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${G.toFixed(2)}s goal: ${Q} skip sn ${K} to part ${L}`)}r.tuneInGoal=Q}if(_=this.getDeliveryDirectives(r,t.deliveryDirectives,w,L),P||!$){r.requestScheduled=o,this.loadingPlaylist(d,_);return}}else(r.canBlockReload||r.canSkipUntil)&&(_=this.getDeliveryDirectives(r,t.deliveryDirectives,w,L));_&&w!==void 0&&r.canBlockReload&&(r.requestScheduled=s.loading.first+Math.max(b-a*2,b/2)),this.scheduleLoading(d,_,r)}else this.clearTimer()}scheduleLoading(e,t,n){const r=n||e.details;if(!r){this.loadingPlaylist(e,t);return}const s=self.performance.now(),o=r.requestScheduled;if(s>=o){this.loadingPlaylist(e,t);return}const a=o-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,n,r){let s=Hp(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=Oo.No),new lf(n,r,s)}checkRetry(e){const t=e.details,n=GA(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=r||{},c=!!r&&!!a&&(s===Ht.RetryRequest||!r.resolved&&s===Ht.SendAlternateToPenaltyBox);if(c){var h;if(o>=a.maxNumRetry)return!1;if(n&&(h=e.context)!=null&&h.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const d=Qc(a,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),d),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${d}ms`)}e.levelRetry=!0,r.resolved=!0}return c}}function oE(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Xo(i[t].attrs,e[t].attrs))return!1;return!0}function Xo(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function mf(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class aE extends Ol{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${o?.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(a=>r?.indexOf(a)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(y=>!n||n.indexOf(y.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(y=>y.default)&&(this.selectDefaultTrack=!1),a.forEach((y,T)=>{y.id=T});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const c=this.hls.config.audioPreference;if(!s&&c){const y=Sn(c,a,Pr);if(y>-1)s=a[y];else{const T=Sn(c,this.tracks);s=this.tracks[T]}}let h=this.findTrackId(s);h===-1&&s&&(h=this.findTrackId(null));const d={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n?.join(",")}`),this.hls.trigger(C.AUDIO_TRACKS_UPDATED,d);const p=this.trackId;if(h!==-1&&p===-1)this.setAudioTrack(h);else if(a.length&&p===-1){var o;const y=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(y.message),this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}}onError(e,t){t.fatal||!t.context||t.context.type===st.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&Vr(e,r,Pr))return r;const s=Sn(e,this.tracksInGroup,Pr);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(r){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=EC(e,t.levels,n,o,Pr);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=Sn(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===n&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(C.AUDIO_TRACK_SWITCHING,yt({},r)),s))return;const o=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||Vr(e,r,Pr)))return n}if(e){const{name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:c}=e;for(let h=0;h<t.length;h++){const d=t[h];if(Vr({name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:c},d,Pr))return h}for(let h=0;h<t.length;h++){const d=t[h];if(Xo(e.attrs,d.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return h}for(let h=0;h<t.length;h++){const d=t[h];if(Xo(e.attrs,d.attrs,["LANGUAGE"]))return h}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&$A(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,t),o=e.details,a=o?.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${s}`),this.hls.trigger(C.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:t||null,track:e})}}class ok{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(s){var n;if(r.onError(s),this.queues===null||this.tracks===null)return;const o=(n=this.tracks[e])==null?void 0:n.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],r=n?.buffer;return r?`SourceBuffer${r.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const wm=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,AE="HlsJsTrackRemovedError";class ak extends Error{constructor(e){super(e),this.name=AE}}class lE extends tn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:r,mediaSource:s}=this;n&&this.log("Media source opened"),!(!r||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(C.MEDIA_ATTACHED,{media:r,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=BD(zn(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_APPENDING,this.onBufferAppending,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.BUFFER_EOS,this.onBufferEos,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.FRAG_PARSED,this.onFragParsed,this),e.on(C.FRAG_CHANGED,this.onFragChanged,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_APPENDING,this.onBufferAppending,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_EOS,this.onBufferEos,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.FRAG_PARSED,this.onFragParsed,this),e.off(C.FRAG_CHANGED,this.onFragChanged,this),e.off(C.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const o=this.isQueued();(s||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?Et(n,r.tracks):this.sourceBuffers.forEach(s=>{const[o]=s;o&&(n[o]=Et({},this.tracks[o]),this.removeBuffer(o)),s[0]=s[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const r=zn(this.appendSource);if(r){const s=!!t.mediaSource;(s||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(o),s)this._objectUrl=n.src,this.attachTransferred();else{const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const c=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||c&&o instanceof c,Im(n),Ak(n,a),n.load()}catch{n.src=a}else n.src=a}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,r=t.tracks,s=r?Object.keys(r):null,o=s?s.length:0,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&s&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${xt(n,(c,h)=>c==="initSegment"?void 0:h)};
transfer tracks: ${xt(r,(c,h)=>c==="initSegment"?void 0:h)}}`),!ov(r,n)){t.mediaSource=null,t.tracks=void 0;const c=e.currentTime,h=this.details,d=Math.max(c,h?.fragments[0].start||0);if(d-c>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${c} -> ${d}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(n)}") start time: ${d} currentTime: ${c}`),this.onMediaDetaching(C.MEDIA_DETACHING,{}),this.onMediaAttaching(C.MEDIA_ATTACHING,t),e.currentTime=d;return}this.transferData=void 0,s.forEach(c=>{const h=c,d=r[h];if(d){const p=d.buffer;if(p){const y=this.fragmentTracker,T=d.id;if(y.hasFragments(T)||y.hasParts(T)){const w=Xe.getBuffered(p);y.detectEvictedFragments(h,w,T,null,!0)}const b=o0(h),_=[h,p];this.sourceBuffers[b]=_,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(h),this.trackSourceBuffer(h,d)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:s,_objectUrl:o}=this;if(s){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([a])=>{a&&this.removeBuffer(a)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const a=s.readyState==="open";try{const c=s.sourceBuffers;for(let h=c.length;h--;)a&&c[h].abort(),s.removeSourceBuffer(c[h]);a&&s.endOfStream()}catch(c){this.warn(`onMediaDetaching: ${c.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),n||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(r.removeAttribute("src"),this.appendSource&&Im(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(C.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[o0(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new ok(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,r=Object.keys(t);this.log(`BUFFER_CODECS: "${r}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),o=!s&&this.sourceBufferCount&&this.media&&r.some(a=>!n[a]);if(s||o){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${r}" SourceBuffers`);return}r.forEach(a=>{var c,h;const d=t[a],{id:p,codec:y,levelCodec:T,container:b,metadata:_,supplemental:w}=d;let L=n[a];const P=(c=this.transferData)==null||(c=c.tracks)==null?void 0:c[a],R=P!=null&&P.buffer?P:L,k=R?.pendingCodec||R?.codec,F=R?.levelCodec;L||(L=n[a]={buffer:void 0,listeners:[],codec:y,supplemental:w,container:b,levelCodec:T,metadata:_,id:p});const U=vA(k,F),$=U?.replace(wm,"$1");let G=vA(y,T);const W=(h=G)==null?void 0:h.replace(wm,"$1");G&&U&&$!==W&&(a.slice(0,5)==="audio"&&(G=NA(G,this.appendSource)),this.log(`switching codec ${k} to ${G}`),G!==(L.pendingCodec||L.codec)&&(L.pendingCodec=G),L.container=b,this.appendChangeType(a,b,G))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const r=`${t};codecs=${n}`,s={label:`change-type=${r}`,execute:()=>{const o=this.tracks[e];if(o){const a=o.buffer;a!=null&&a.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),a.changeType(r),o.codec=n,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,r=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,we.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var a;const c=this.tracks.video;(this.lastVideoAppendEnd>r||c!=null&&c.buffer&&Xe.isBuffered(c.buffer,r)||((a=this.fragmentTracker.getAppendedFrag(r,we.MAIN))==null?void 0:a.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn("Error executing block-audio operation",a)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:r,type:s,parent:o,frag:a,part:c,chunkMeta:h,offset:d}=t,p=h.buffering[s],{sn:y,cc:T}=a,b=self.performance.now();p.start=b;const _=a.stats.buffering,w=c?c.stats.buffering:null;_.start===0&&(_.start=b),w&&w.start===0&&(w.start=b);const L=n.audio;let P=!1;s==="audio"&&L?.container==="audio/mpeg"&&(P=!this.lastMpegAudioChunk||h.id===1||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);const R=n.video,k=R?.buffer;if(k&&y!=="initSegment"){const $=c||a,G=this.blockedAudioAppend;if(s==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(R.ending||R.ended)){const Q=$.start+$.duration*.05,K=k.buffered,te=this.currentOp("video");!K.length&&!te?this.blockAudio($):!te&&!Xe.isBuffered(k,Q)&&this.lastVideoAppendEnd<Q&&this.blockAudio($)}else if(s==="video"){const W=$.end;if(G){const Q=G.frag.start;(W>Q||W<this.lastVideoAppendEnd||Xe.isBuffered(k,Q))&&this.unblockAudio()}this.lastVideoAppendEnd=W}}const F=(c||a).start,U={label:`append-${s}`,execute:()=>{var $;p.executeStart=self.performance.now();const G=($=this.tracks[s])==null?void 0:$.buffer;G&&(P?this.updateTimestampOffset(G,F,.1,s,y,T):d!==void 0&&be(d)&&this.updateTimestampOffset(G,d,1e-6,s,y,T)),this.appendExecutor(r,s)},onStart:()=>{},onComplete:()=>{const $=self.performance.now();p.executeEnd=p.end=$,_.first===0&&(_.first=$),w&&w.first===0&&(w.first=$);const G={};this.sourceBuffers.forEach(([W,Q])=>{W&&(G[W]=Xe.getBuffered(Q))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(C.BUFFER_APPENDED,{type:s,frag:a,part:c,chunkMeta:h,parent:a.type,timeRanges:G})},onError:$=>{var G;const W={type:Re.MEDIA_ERROR,parent:a.type,details:se.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:a,part:c,chunkMeta:h,error:$,err:$,fatal:!1},Q=(G=this.media)==null?void 0:G.error;if($.code===DOMException.QUOTA_EXCEEDED_ERR||$.name=="QuotaExceededError"||"quota"in $)W.details=se.BUFFER_FULL_ERROR;else if($.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!Q)W.errorAction=Rs(!0);else if($.name===AE&&this.sourceBufferCount===0)W.errorAction=Rs(!0);else{const K=++this.appendErrors[s];this.warn(`Failed ${K}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${Q||"no media error"})`),(K>=this.hls.config.appendErrorMaxRetry||Q)&&(W.fatal=!0)}this.hls.trigger(C.ERROR,W)}};this.append(U,s,this.isPending(this.tracks[s]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(C.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:n,startOffset:r,endOffset:s}=t;n?this.append(this.getFlushOp(n,r,s),n):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,r,s),o)})}onFragParsed(e,t){const{frag:n,part:r}=t,s=[],o=r?r.elementaryStreams:n.elementaryStreams;o[St.AUDIOVIDEO]?s.push("audiovideo"):(o[St.AUDIO]&&s.push("audio"),o[St.VIDEO]&&s.push("video"));const a=()=>{const c=self.performance.now();n.stats.buffering.end=c,r&&(r.stats.buffering.end=c);const h=r?r.stats:n.stats;this.hls.trigger(C.FRAG_BUFFERED,{frag:n,part:r,stats:h,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s).catch(c=>{this.warn(`Fragment buffered callback ${c}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([o])=>{if(o){const a=this.tracks[o];(!t.type||t.type===o)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${o} buffer reached EOS`)))}});const r=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var a;return o&&!((a=this.tracks[o])!=null&&a.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(C.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(C.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===se.BUFFER_APPEND_ERROR&&t.frag){var n;const r=(n=t.errorAction)==null?void 0:n.nextAutoLevel;be(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const r=e.config,s=n.currentTime,o=t.levelTargetDuration,a=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(be(a)&&a>=0){const h=Math.max(a,o),d=Math.floor(s/o)*o-h;this.flushBackBuffer(s,o,d)}const c=r.frontBufferFlushThreshold;if(be(c)&&c>0){const h=Math.max(r.maxBufferLength,c),d=Math.max(h,o),p=Math.floor(s/o)*o+d;this.flushFrontBuffer(s,o,p)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([r,s])=>{if(s){const a=Xe.getBuffered(s);if(a.length>0&&n>a.start(0)){var o;this.hls.trigger(C.BACK_BUFFER_REACHED,{bufferEnd:n});const c=this.tracks[r];if((o=this.details)!=null&&o.live)this.hls.trigger(C.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(c!=null&&c.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:r})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([r,s])=>{if(s){const o=Xe.getBuffered(s),a=o.length;if(a<2)return;const c=o.start(a-1),h=o.end(a-1);if(n>c||e>=c&&e<=h)return;this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||n?.readyState!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const h=Math.max(0,t.fragmentStart),d=Math.max(h,r);return{duration:1/0,start:h,end:d}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return be(s)?{duration:s}:null;const o=this.media.duration,a=be(n.duration)?n.duration:0;return r>a&&r>o||!be(o)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(be(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${xt(n)}`),this.tracksReady){var r;const s=(r=this.transferData)==null?void 0:r.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const r=this.tracks[t];e[t]={buffer:n,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(C.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const o=s,a=e[o];if(this.isPending(a)){const c=this.getTrackCodec(a,o),h=`${a.container};codecs=${c}`;a.codec=c,this.log(`creating sourceBuffer(${h})${this.currentOp(o)?" Queued":""} ${xt(a)}`);try{const d=n.addSourceBuffer(h),p=o0(o),y=[o,d];t[p]=y,a.buffer=d}catch(d){var r;this.error(`error while trying to add sourceBuffer: ${d.message}`),this.shiftAndExecuteNext(o),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[o],this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:o,mimeType:h,parent:a.id});return}this.trackSourceBuffer(o,a)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let r=e.codec;n&&(t==="video"||t==="audiovideo")&&of(n,"video")&&(r=tC(r,n));const s=vA(r,e.levelCodec);return s?t.slice(0,5)==="audio"?NA(s,this.appendSource):s:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,o)=>{const a=o.removedRanges;a!=null&&a.length&&this.hls.trigger(C.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.currentOp(e);s&&s.onError(r)}updateTimestampOffset(e,t,n,r,s,o){const a=t-e.timestampOffset;Math.abs(a)>=n&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${t} (sn: ${s} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:r,mediaSource:s}=this,o=this.tracks[e],a=o?.buffer;if(!r||!s||!a){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const c=be(r.duration)?r.duration:1/0,h=be(s.duration)?s.duration:1/0,d=Math.max(0,t),p=Math.min(n,c,h);p>d&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${d},${p}] from the ${e} SourceBuffer`),a.remove(d,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],r=n?.buffer;if(!r)throw new ak(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(o=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const r=(n=this.tracks[t])==null?void 0:n.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const r=this.tracks[e];if(!r)return;const s=r.buffer;if(!s)return;const o=n.bind(this,e);r.listeners.push({event:t,listener:o}),s.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(r=>{n.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function Im(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function Ak(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function o0(i){return i==="audio"?1:0}class Fl{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&be(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,Fl.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(a,c)=>c?a.width!==c.width||a.height!==c.height:!0;let s=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const c=e[a];if((c.width>=o||c.height>=o)&&r(c,e[a+1])){s=a;break}}return s}}const lk={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Si=lk,uk={HLS:"h"},fk=uk;class Rn{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof Rn?n:new Rn(n))),this.value=e,this.params=t}}const ck="Dict";function hk(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function dk(i,e,t,n){return new Error(`failed to ${i} "${hk(e)}" as ${t}`,{cause:n})}function Dn(i,e,t){return dk("serialize",i,e,t)}class uE{constructor(e){this.description=e}}const Lm="Bare Item",gk="Boolean";function pk(i){if(typeof i!="boolean")throw Dn(i,gk);return i?"?1":"?0"}function mk(i){return btoa(String.fromCharCode(...i))}const yk="Byte Sequence";function vk(i){if(ArrayBuffer.isView(i)===!1)throw Dn(i,yk);return`:${mk(i)}:`}const Ek="Integer";function Tk(i){return i<-999999999999999||999999999999999<i}function fE(i){if(Tk(i))throw Dn(i,Ek);return i.toString()}function Sk(i){return`@${fE(i.getTime()/1e3)}`}function cE(i,e){if(i<0)return-cE(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}const bk="Decimal";function xk(i){const e=cE(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Dn(i,bk);const t=e.toString();return t.includes(".")?t:`${t}.0`}const _k="String",wk=/[\x00-\x1f\x7f]+/;function Ik(i){if(wk.test(i))throw Dn(i,_k);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Lk(i){return i.description||i.toString().slice(7,-1)}const Rk="Token";function Rm(i){const e=Lk(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Dn(e,Rk);return e}function yf(i){switch(typeof i){case"number":if(!be(i))throw Dn(i,Lm);return Number.isInteger(i)?fE(i):xk(i);case"string":return Ik(i);case"symbol":return Rm(i);case"boolean":return pk(i);case"object":if(i instanceof Date)return Sk(i);if(i instanceof Uint8Array)return vk(i);if(i instanceof uE)return Rm(i);default:throw Dn(i,Lm)}}const Dk="Key";function vf(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw Dn(i,Dk);return i}function sh(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${vf(e)}`:`;${vf(e)}=${yf(t)}`).join("")}function hE(i){return i instanceof Rn?`${yf(i.value)}${sh(i.params)}`:yf(i)}function Ck(i){return`(${i.value.map(hE).join(" ")})${sh(i.params)}`}function Pk(i,e={whitespace:!0}){if(typeof i!="object"||i==null)throw Dn(i,ck);const t=i instanceof Map?i.entries():Object.entries(i),n=e?.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof Rn||(s=new Rn(s));let o=vf(r);return s.value===!0?o+=sh(s.params):(o+="=",Array.isArray(s.value)?o+=Ck(s):o+=hE(s)),o}).join(`,${n}`)}function dE(i,e){return Pk(i,e)}const vn="CMCD-Object",kt="CMCD-Request",Rr="CMCD-Session",Ar="CMCD-Status",kk={br:vn,ab:vn,d:vn,ot:vn,tb:vn,tpb:vn,lb:vn,tab:vn,lab:vn,url:vn,pb:kt,bl:kt,tbl:kt,dl:kt,ltc:kt,mtp:kt,nor:kt,nrr:kt,rc:kt,sn:kt,sta:kt,su:kt,ttfb:kt,ttfbb:kt,ttlb:kt,cmsdd:kt,cmsds:kt,smrt:kt,df:kt,cs:kt,ts:kt,cid:Rr,pr:Rr,sf:Rr,sid:Rr,st:Rr,v:Rr,msd:Rr,bs:Ar,bsd:Ar,cdn:Ar,rtp:Ar,bg:Ar,pt:Ar,ec:Ar,e:Ar},Mk={REQUEST:kt};function Ok(i){return Object.keys(i).reduce((e,t)=>{var n;return(n=i[t])===null||n===void 0||n.forEach(r=>e[r]=t),e},{})}function Fk(i,e){const t={};if(!i)return t;const n=Object.keys(i),r=e?Ok(e):{};return n.reduce((s,o)=>{var a;const c=kk[o]||r[o]||Mk.REQUEST,h=(a=s[c])!==null&&a!==void 0?a:s[c]={};return h[o]=i[o],s},t)}function Bk(i){return["ot","sf","st","e","sta"].includes(i)}function Nk(i){return typeof i=="number"?be(i):i!=null&&i!==""&&i!==!1}const gE="event";function Uk(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const r=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+t.search+t.hash}const bA=i=>Math.round(i),Ef=(i,e)=>Array.isArray(i)?i.map(t=>Ef(t,e)):i instanceof Rn&&typeof i.value=="string"?new Rn(Ef(i.value,e),i.params):(e.baseUrl&&(i=Uk(i,e.baseUrl)),e.version===1?encodeURIComponent(i):i),za=i=>bA(i/100)*100,$k=(i,e)=>{let t=i;return e.version>=2&&(i instanceof Rn&&typeof i.value=="string"?t=new Rn([i]):typeof i=="string"&&(t=[i])),Ef(t,e)},Gk={br:bA,d:bA,bl:za,dl:za,mtp:za,nor:$k,rtp:za,tb:bA},pE="request",mE="response",oh=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],Vk=["e"],Hk=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Bl(i){return Hk.test(i)}function jk(i){return oh.includes(i)||Vk.includes(i)||Bl(i)}const yE=["d","dl","nor","ot","rtp","su"];function Kk(i){return oh.includes(i)||yE.includes(i)||Bl(i)}const Qk=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function Wk(i){return oh.includes(i)||yE.includes(i)||Qk.includes(i)||Bl(i)}const Yk=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function zk(i){return Yk.includes(i)||Bl(i)}const qk={[mE]:Wk,[gE]:jk,[pE]:Kk};function vE(i,e={}){const t={};if(i==null||typeof i!="object")return t;const n=e.version||i.v||1,r=e.reportingMode||pE,s=n===1?zk:qk[r];let o=Object.keys(i).filter(s);const a=e.filter;typeof a=="function"&&(o=o.filter(a));const c=r===mE||r===gE;c&&!o.includes("ts")&&o.push("ts"),n>1&&!o.includes("v")&&o.push("v");const h=Et({},Gk,e.formatters),d={version:n,reportingMode:r,baseUrl:e.baseUrl};return o.sort().forEach(p=>{let y=i[p];const T=h[p];if(typeof T=="function"&&(y=T(y,d)),p==="v"){if(n===1)return;y=n}p=="pr"&&y===1||(c&&p==="ts"&&!be(y)&&(y=Date.now()),Nk(y)&&(Bk(p)&&typeof y=="string"&&(y=new uE(y)),t[p]=y))}),t}function Xk(i,e={}){const t={};if(!i)return t;const n=vE(i,e),r=Fk(n,e?.customHeaderMap);return Object.entries(r).reduce((s,[o,a])=>{const c=dE(a,{whitespace:!1});return c&&(s[o]=c),s},t)}function Zk(i,e,t){return Et(i,Xk(e,t))}const Jk="CMCD";function eM(i,e={}){return i?dE(vE(i,e),{whitespace:!1}):""}function tM(i,e={}){if(!i)return"";const t=eM(i,e);return encodeURIComponent(t)}function iM(i,e={}){if(!i)return"";const t=tM(i,e);return`${Jk}=${t}`}const Dm=/CMCD=[^&#]+/;function nM(i,e,t){const n=iM(e,t);if(!n)return i;if(Dm.test(i))return i.replace(Dm,n);const r=i.includes("?")?"&":"?";return`${i}${r}${n}`}class EE{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:Si.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const{frag:s,part:o}=r,a=this.hls.levels[s.level],c=this.getObjectType(s),h={d:(o||s).duration*1e3,ot:c};(c===Si.VIDEO||c===Si.AUDIO||c==Si.MUXED)&&(h.br=a.bitrate/1e3,h.tb=this.getTopBandwidth(c)/1e3,h.bl=this.getBufferLength(c));const d=o?this.getNextPart(o):this.getNextFrag(s);d!=null&&d.url&&d.url!==s.url&&(h.nor=d.url),this.apply(r,h)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHED,this.onMediaDetached,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHED,this.onMediaDetached,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:fk.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Et(t,this.createData());const n=t.ot===Si.INIT||t.ot===Si.VIDEO||t.ot===Si.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((o,a)=>(r.includes(a)&&(o[a]=t[a]),o),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Zk(e.headers,t,s)):e.url=nM(e.url,t,s)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const r=e.sn-n.startSN;return n.fragments[r+1]}}getNextPart(e){var t;const{index:n,fragment:r}=e,s=(t=this.hls.levels[r.level])==null||(t=t.details)==null?void 0:t.partList;if(s){const{sn:o}=r;for(let a=s.length-1;a>=0;a--){const c=s[a];if(c.index===n&&c.fragment.sn===o)return s[a+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Si.TIMED_TEXT;if(e.sn==="initSegment")return Si.INIT;if(t==="audio")return Si.AUDIO;if(t==="main")return this.hls.audioTracks.length?Si.VIDEO:Si.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===Si.AUDIO)n=r.audioTracks;else{const s=r.maxAutoLevel,o=s>-1?s+1:r.levels.length;n=r.levels.slice(0,o)}return n.forEach(s=>{s.bitrate>t&&(t=s.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===Si.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Xe.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}}const rM=3e5;class TE extends tn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(n?.action===Ht.SendAlternateToPenaltyBox&&n.flags===bi.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:c,type:h}=t.context;a&&r?o=this.getPathwayForGroupId(a,h,o):c&&(o=c)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==o),t.details===se.BUFFER_APPEND_ERROR&&!t.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${xt(s)} penalized: ${xt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>rM&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,c=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,Fv(t),this.hls.trigger(C.LEVELS_UPDATED,{levels:t});const h=this.hls.levels[a];c&&h&&this.levels&&(h.attrs["STABLE-VARIANT-ID"]!==c.attrs["STABLE-VARIANT-ID"]&&h.bitrate!==c.bitrate&&this.log(`Unstable Pathways change from bitrate ${c.bitrate} to ${h.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===st.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===st.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":c}=s;if(t.some(d=>d.pathwayId===o))return;const h=this.getLevelsForPathway(a).map(d=>{const p=new wt(d.attrs);p["PATHWAY-ID"]=o;const y=p.AUDIO&&`${p.AUDIO}_clone_${o}`,T=p.SUBTITLES&&`${p.SUBTITLES}_clone_${o}`;y&&(n[p.AUDIO]=y,p.AUDIO=y),T&&(r[p.SUBTITLES]=T,p.SUBTITLES=T);const b=SE(d.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",c),_=new Ns({attrs:p,audioCodec:d.audioCodec,bitrate:d.bitrate,height:d.height,name:d.name,url:b,videoCodec:d.videoCodec,width:d.width});if(d.audioGroups)for(let w=1;w<d.audioGroups.length;w++)_.addGroupId("audio",`${d.audioGroups[w]}_clone_${o}`);if(d.subtitleGroups)for(let w=1;w<d.subtitleGroups.length;w++)_.addGroupId("text",`${d.subtitleGroups[w]}_clone_${o}`);return _});t.push(...h),Cm(this.audioTracks,n,c,o),Cm(this.subtitleTracks,r,c,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const d=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+d)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},c={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},h={onSuccess:(d,p,y,T)=>{this.log(`Loaded steering manifest: "${r}"`);const b=d.data;if(b?.VERSION!==1){this.log(`Steering VERSION ${b.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=b.TTL;const{"RELOAD-URI":_,"PATHWAY-CLONES":w,"PATHWAY-PRIORITY":L}=b;if(_)try{this.uri=new self.URL(_,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${_}`);return}this.scheduleRefresh(this.uri||y.url),w&&this.clonePathways(w);const P={steeringManifest:b,url:r.toString()};this.hls.trigger(C.STEERING_MANIFEST_LOADED,P),L&&this.updatePathwayPriority(L)},onError:(d,p,y,T)=>{if(this.log(`Error loading steering manifest: ${d.code} ${d.text} (${p.url})`),this.stopLoad(),d.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let b=this.timeToLoad*1e3;if(d.code===429){const _=this.loader;if(typeof _?.getResponseHeader=="function"){const w=_.getResponseHeader("Retry-After");w&&(b=parseFloat(w)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,b)},onTimeout:(d,p,y)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,c,h)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Cm(i,e,t,n){i&&Object.keys(e).forEach(r=>{const s=i.filter(o=>o.groupId===r).map(o=>{const a=Et({},o);return a.details=void 0,a.attrs=new wt(a.attrs),a.url=a.attrs.URI=SE(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[r],a.attrs["PATHWAY-ID"]=n,a});i.push(...s)})}function SE(i,e,t,n){const{HOST:r,PARAMS:s,[t]:o}=n;let a;e&&(a=o?.[e],a&&(i=a));const c=new self.URL(i);return r&&!a&&(c.host=r),s&&Object.keys(s).sort().forEach(h=>{h&&c.searchParams.set(h,s[h])}),c.href}class Hr extends tn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Hr.CDMCleanupPromise?[Hr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,s=`"${t.type}" event: init data type: "${n}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=So(this.config));const a=o.map(Zu).filter(c=>!!c);this.keyFormatPromise=this.getKeyFormatPromise(a)}this.keyFormatPromise.then(o=>{const a=EA(o);if(n!=="sinf"||a!==Dt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${n}" for selected key-system ${a}`);return}let c;try{const T=Vt(new Uint8Array(r)),b=qc(JSON.parse(T).sinf),_=dv(b);if(!_)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");c=new Uint8Array(_.subarray(8,24))}catch(T){this.warn(`${s} Failed to parse sinf: ${T}`);return}const h=Oi(c),{keyIdToKeySessionPromise:d,mediaKeySessions:p}=this;let y=d[h];for(let T=0;T<p.length;T++){const b=p[T],_=b.decryptdata;if(!_.keyId)continue;const w=Oi(_.keyId);if(h===w||_.uri.replace(/-/g,"").indexOf(h)!==-1){if(y=d[w],!y)continue;if(_.pssh)break;delete d[w],_.pssh=new Uint8Array(r),_.keyId=c,y=d[h]=y.then(()=>this.generateRequestWithPreferredKeySession(b,n,r,"encrypted-event-key-match")),y.catch(L=>this.handleError(L));break}}y||this.handleError(new Error(`Key ID ${h} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(C.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(C.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t?.[e];if(r)return r.licenseUrl;if(e===Dt.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t?.[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,c)=>!!o&&c.indexOf(o)===a,r=t.map(o=>o.audioCodec).filter(n),s=t.map(o=>o.videoCodec).filter(n);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const c=h=>{const d=h.shift();this.getMediaKeysPromise(d,r,s).then(p=>o({keySystem:d,mediaKeys:p})).catch(p=>{h.length?c(h):p instanceof an?a(p):a(new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};c(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return Xc===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){var r;const s=HC(e,t,n,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[e],a=(r=o)==null?void 0:r.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${xt(s)}`),a=this.requestMediaKeySystemAccess(e,s);const c=o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(h=>{this.log(`Failed to obtain access to key-system "${e}": ${h}`)}),a.then(h=>{this.log(`Access for key-system "${h.keySystem}" obtained`);const d=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const p=c.mediaKeys=h.createMediaKeys().then(y=>(this.log(`Media-keys created for "${e}"`),c.hasMediaKeys=!0,d.then(T=>T?this.setMediaKeysServerCertificate(y,e,T):y)));return p.catch(y=>{this.error(`Failed to create media-keys for "${e}"}: ${y}`)}),p})}return a.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Oi(e.keyId||[])}`);const r=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,s,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Oi(e.keyId)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${Oi(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Zu(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:n})=>this.attemptSetMediaKeys(t,n))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const s=Zu(r);s?t(s):n(new Error(`Unable to find format for key-system "${r}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=So(this.config),n=e.map(EA).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(n)}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=this.bannedKeyIds[n];if(r){const a=Pm(r,t);return this.handleError(a,e.frag),Promise.reject(a)}const s=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);const o=this.keyIdToKeySessionPromise[n];if(!o){const a=this.getKeySystemForKeyPromise(t).then(({keySystem:c,mediaKeys:h})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(c,h).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:c,mediaKeys:h,decryptdata:t}))))).then(c=>{const h="cenc",d=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(c,h,d,"playlist-key")});return a.catch(c=>this.handleError(c,e.frag)),this.keyIdToKeySessionPromise[n]=a,a}return o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){this.hls&&(this.error(e.message),e instanceof an?(t&&(e.data.frag=t),this.hls.trigger(C.ERROR,e.data)):this.hls.trigger(C.ERROR,{type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=EA(e.keyFormat),s=r?[r]:So(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=So(this.config)),e.length===0)throw new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${xt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var s;const o=(s=this.config.drmSystems)==null||(s=s[e.keySystem])==null?void 0:s.generateRequest;if(o)try{const y=o.call(this.hls,t,n,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,n=y.initData?y.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const a=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${a} (init data type: ${t} length: ${n.byteLength})`);const c=new Zc,h=e._onmessage=y=>{const T=e.mediaKeysSession;if(!T){c.emit("error",new Error("invalid state"));return}const{messageType:b,message:_}=y;this.log(`"${b}" message event for session "${T.sessionId}" message size: ${_.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,_).catch(w=>{c.eventNames().length?c.emit("error",w):this.handleError(w)}):b==="license-release"?e.keySystem===Dt.FAIRPLAY&&(this.updateKeySession(e,cf("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${b}"`)},d=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}const b=e.keyStatus;this.onKeyStatusChange(e);const _=e.keyStatus;_!==b&&(c.emit("keyStatus",_,e),_==="expired"&&(this.log(`${e.keySystem} expired for key ${a}`),this.renewKeySession(e)))};yi(e.mediaKeysSession,"message",h),yi(e.mediaKeysSession,"keystatuseschange",d);const p=new Promise((y,T)=>{c.on("error",T),c.on("keyStatus",(b,{decryptdata:_})=>{b.startsWith("usable")?y():b==="internal-error"||b==="output-restricted"?T(Pm(b,_)):b==="expired"?T(new Error(`key expired while generating request (keyId: ${a})`)):this.warn(`unhandled key status change "${b}" (keyId: ${a})`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${a}`)}).catch(y=>{throw new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>p).catch(y=>{throw c.removeAllListeners(),this.removeSession(e),y}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){const t=Oi(new Uint8Array(e.decryptdata.keyId||[]));e.mediaKeysSession.keyStatuses.forEach((n,r)=>{if(typeof r=="string"&&typeof n=="object"){const a=r;r=n,n=a}const s=Oi("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r));n==="internal-error"&&(this.bannedKeyIds[s]=n);const o=s===t;this.log(`${o?"":"un"}matched key status change "${n}" for keyStatuses keyId: ${s} session keyId: ${t} uri: ${e.decryptdata.uri}`),o&&(e.keyStatus=n)})}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const c={responseType:"arraybuffer",url:s},h=t.certLoadPolicy.default,d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,T,b,_)=>{o(y.data)},onError:(y,T,b,_)=>{a(new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:b,response:yt({url:c.url,data:void 0},y)},`"${e}" certificate request failed (${s}). Status: ${y.code} (${y.text})`))},onTimeout:(y,T,b)=>{a(new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:b,response:{url:c.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(y,T,b)=>{a(new Error("aborted"))}};r.load(c,d,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,s)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),r(e)}).catch(o=>{s(new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let d;for(let p=0,y=s.length;p<y;p++){var o,a;d=s[p];const T=(o=d.querySelector("name"))==null?void 0:o.textContent,b=(a=d.querySelector("value"))==null?void 0:a.textContent;T&&b&&e.setRequestHeader(T,b)}}const c=r.querySelector("Challenge"),h=c?.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return cf(atob(h))}setupLicenseXHR(e,t,n,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,r)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,n,r)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let c=a.response;this.log(`License received ${c instanceof ArrayBuffer?c.byteLength:c}`);const h=this.config.licenseResponseCallback;if(h)try{c=h.call(this.hls,a,o,e)}catch(d){this.error(d)}r(c)}else{const c=n.errorRetry,h=c?c.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h||a.status>=400&&a.status<500)s(new an({type:Re.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const d=h-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:c,licenseChallenge:h})=>{e.keySystem==Dt.PLAYREADY&&(h=this.unpackPlayReadyKeyMessage(c,h)),c.send(h)}).catch(s)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,yi(n,"encrypted",this.onMediaEncrypted),yi(n,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(Ii(e,"encrypted",this.onMediaEncrypted),Ii(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,ga.clearKeyUriToKeyIdMap();const r=n.length;Hr.CDMCleanupPromise=Promise.all(n.map(s=>this.removeSession(s)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(s=>{this.log(`Could not clear media keys: ${s}`),this.hls&&this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}`),this.hls&&this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:r}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Oi(r?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{drmSystemOptions:o}=this.config;return(KC(o)?new Promise((c,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(c).catch(h)}):Promise.resolve()).catch(c=>{this.log(`Could not remove session: ${c}`),this.hls&&this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${c}`)})}).then(()=>t.close()).catch(c=>{this.log(`Could not close session: ${c}`),this.hls&&this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${c}`)})})}}}Hr.CDMCleanupPromise=void 0;class an extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Pm(i,e){const t=i==="output-restricted",n=t?se.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:se.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new an({type:Re.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${i}"`)}class bE{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,c=1e3*o/s,h=this.hls;if(h.trigger(C.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),c>0&&o>h.config.fpsDroppedMonitoringThreshold*a){let d=h.currentLevel;h.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(h.autoLevelCapping===-1||h.autoLevelCapping>=d)&&(d=d-1,h.trigger(C.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:h.currentLevel}),h.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function xE(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function _E(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){pt.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){pt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function Ss(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let n=i.cues.length;n--;)e&&i.cues[n].removeEventListener("enter",e),i.removeCue(i.cues[n]);t==="disabled"&&(i.mode=t)}function Tf(i,e,t,n){const r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=oM(i.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&i.removeCue(s[o])}r==="disabled"&&(i.mode=r)}function sM(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t,s;for(;n<=r;)if(s=Math.floor((r+n)/2),e<i[s].startTime)r=s-1;else if(e>i[s].startTime&&n<t)n=s+1;else return s;return i[n].startTime-e<e-i[r].startTime?n:r}function oM(i,e,t){const n=[],r=sM(i,e);if(r>-1)for(let s=r,o=i.length;s<o;s++){const a=i[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function xA(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}class wE extends Ol{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=xA(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;xA(n.textTracks).forEach(o=>{Ss(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${o?.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(o=>r?.indexOf(o)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(d=>!n||n.indexOf(d.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(d=>d.default)&&(this.selectDefaultTrack=!1),o.forEach((d,p)=>{d.id=p});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const d=Sn(a,o);if(d>-1)s=o[d];else{const p=Sn(a,this.tracks);s=this.tracks[p]}}let c=this.findTrackId(s);c===-1&&s&&(c=this.findTrackId(null));const h={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n?.join(",")}" group-id`),this.hls.trigger(C.SUBTITLE_TRACKS_UPDATED,h),c!==-1&&this.trackId===-1&&this.setSubtitleTrack(c)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(n&&!s.default||!n&&!e)&&(!e||Vr(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(Xo(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(Xo(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(mf(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===st.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Vr(e,n))return n;const r=Sn(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(n)return null;{const s=Sn(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,t),o=e.details,a=o?.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${s}`),this.hls.trigger(C.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=xA(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(s=>mf(n,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!be(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:a="",name:c,type:h,url:d}=r;this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:c,type:h,url:d});const p=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(p)}}function aM(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}function No(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const Cs=.025;let QA=(function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i})({});function AM(i,e,t){return`${i.identifier}-${t+1}-${No(e)}`}class lM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return a0(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=a0(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=be(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return a0(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Cs))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?QA.Range:QA.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return uM(this)}}function a0(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<Cs)?e.start:e.start+e.duration}function IE(i,e,t){const n=new self.URL(i,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function A0(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function uM(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function ps(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class fM{constructor(e,t,n,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(C.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(t);this.interstitial=n,this.assetItem=r;const o=()=>{this.hasDetails=!0};s.once(C.LEVEL_LOADED,o),s.once(C.AUDIO_TRACK_LOADED,o),s.once(C.SUBTITLE_TRACK_LOADED,o),s.on(C.MEDIA_ATTACHING,(a,{media:c})=>{this.removeMediaListeners(),this.mediaAttached=c,this.interstitial.playoutLimit&&(c.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(C.BUFFER_APPENDED,()=>{const d=this.bufferedEnd;this.reachedPlayout(d)&&(this._bufferedEosTime=d,s.trigger(C.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=IE(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,s=Xe.bufferInfo(e,r,0);return this.getAssetTime(s.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Xe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=n=>delete n.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var r;(r=this.hls)==null||r.on(e,t)}once(e,t,n){var r;(r=this.hls)==null||r.once(e,t)}off(e,t,n){var r;(r=this.hls)==null||r.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${ps(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const km=.033;class cM extends tn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(s=r[n])!=null&&s.event;){var s;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let r=0;r<n.length;r++){let s=n[r];if(t&&t!=="primary"&&(s=s[t]),e===s.start||e>s.start&&e<s.end)return r}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let r=e;r<=t&&n[r];r++){const s=n[r].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var n;if(((n=t[r].event)==null?void 0:n.identifier)===e)return r}return-1}findAssetIndex(e,t){const n=e.assetList,r=n.length;if(r>1)for(let s=0;s<r;s++){const o=n[s];if(!o.error){const a=o.timelineStart;if(t===a||t>a&&(t<a+(o.duration||0)||s===r-1))return s}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const n=t.assetList,r=n[n.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:r}=n,s=this.events,o=this.parseDateRanges(r,{url:n.url},t),a=Object.keys(r),c=s?s.filter(h=>!a.includes(h.identifier)):[];o.length&&o.sort((h,d)=>{const p=h.cue.pre,y=h.cue.post,T=d.cue.pre,b=d.cue.post;if(p&&!T)return-1;if(T&&!p||y&&!b)return 1;if(b&&!y)return-1;if(!p&&!T&&!y&&!b){const _=h.startTime,w=d.startTime;if(_!==w)return _-w}return h.dateRange.tagOrder-d.dateRange.tagOrder}),this.events=o,c.forEach(h=>{this.removeEvent(h)}),this.updateSchedule(e,c)}updateSchedule(e,t=[],n=!1){const r=this.events||[];if(r.length||t.length||this.length<2){const s=this.items,o=this.parseSchedule(r,e);(n||t.length||s?.length!==o.length||o.some((c,h)=>Math.abs(c.playout.start-s[h].playout.start)>.005||Math.abs(c.playout.end-s[h].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(t,s))}}parseDateRanges(e,t,n){const r=[],s=Object.keys(e);for(let o=0;o<s.length;o++){const a=s[o],c=e[a];if(c.isInterstitial){let h=this.eventMap[a];h?h.setDateRange(c):(h=new lM(c,t),this.eventMap[a]=h,n===!1&&(h.appendInPlace=n)),r.push(h)}}return r}parseSchedule(e,t){const n=[],r=t.main.details,s=r.live?1/0:r.edge;let o=0;if(e=e.filter(c=>!c.error&&!(c.cue.once&&c.hasPlayed)),e.length){this.resolveOffsets(e,t);let c=0,h=0;if(e.forEach((d,p)=>{const y=d.cue.pre,T=d.cue.post,b=e[p-1]||null,_=d.appendInPlace,w=T?s:d.startOffset,L=d.duration,P=d.timelineOccupancy===QA.Range?L:0,R=d.resumptionOffset,k=b?.startTime===w,F=w+d.cumulativeDuration;let U=_?F+L:w+R;if(y||!T&&w<=0){const G=h;h+=P,d.timelineStart=F;const W=o;o+=L,n.push({event:d,start:F,end:U,playout:{start:W,end:o},integrated:{start:G,end:h}})}else if(w<=s){if(!k){const Q=w-c;if(Q>km){const K=c,te=h;h+=Q;const oe=o;o+=Q;const Ae={previousEvent:e[p-1]||null,nextEvent:d,start:K,end:K+Q,playout:{start:oe,end:o},integrated:{start:te,end:h}};n.push(Ae)}else Q>0&&b&&(b.cumulativeDuration+=Q,n[n.length-1].end=w)}T&&(U=F),d.timelineStart=F;const G=h;h+=P;const W=o;o+=L,n.push({event:d,start:F,end:U,playout:{start:W,end:o},integrated:{start:G,end:h}})}else return;const $=d.resumeTime;T||$>s?c=s:c=$}),c<s){var a;const d=c,p=h,y=s-c;h+=y;const T=o;o+=y,n.push({previousEvent:((a=n[n.length-1])==null?void 0:a.event)||null,nextEvent:null,start:c,end:d+y,playout:{start:T,end:o},integrated:{start:p,end:h}})}this.setDurations(s,o,h)}else n.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let s=0,o=-1;e.forEach((a,c)=>{const h=a.cue.pre,d=a.cue.post,p=h?0:d?r:a.startTime;this.updateAssetDurations(a),o===p?a.cumulativeDuration=s:(s=0,o=p),!d&&a.snapOptions.in&&(a.resumeAnchor=Qr(null,n.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(a,t)||(a.appendInPlace=!1)),!a.appendInPlace&&c+1<e.length&&e[c+1].startTime-e[c].resumeTime<km&&(e[c+1].appendInPlace=!1,e[c+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`));const T=be(a.resumeOffset)?a.resumeOffset:a.duration;s+=T})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(n-r)>Cs?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${r}`),!1):!Object.keys(t).some(o=>{const a=t[o].details,c=a.edge;if(n>=c)return this.log(`"${e.identifier}" resumption ${n} past ${o} playlist end ${c}`),!1;const h=Qr(null,a.fragments,n);if(!h)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${o} playlist (${a.fragStart}-${a.fragmentEnd})`),!0;const d=o==="audio"?.175:0;return Math.abs(h.start-n)<Cs+d||Math.abs(h.end-n)<Cs+d?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${o} fragment bounds (${h.start}-${h.end} sn: ${h.sn} cc: ${h.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,r=!1,s=!1;for(let o=0;o<e.assetList.length;o++){const a=e.assetList[o],c=t+n;a.startOffset=n,a.timelineStart=c,r||(r=a.duration===null),s||(s=!!a.error);const h=a.error?0:a.duration||0;n+=h}r&&!s?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function on(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class hM{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let r;try{r=IE(n,this.hls.sessionId,e.baseUrl)}catch(y){const T=this.assignAssetListError(e,se.ASSET_LIST_LOAD_ERROR,y,n);this.hls.trigger(C.ERROR,T);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const s=this.hls.config,o=s.loader,a=new o(s),c={responseType:"json",url:r.href},h=s.interstitialAssetListLoadPolicy.default,d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,T,b,_)=>{const w=y.data,L=w?.ASSETS;if(!Array.isArray(L)){const P=this.assignAssetListError(e,se.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),b.url,T,_);this.hls.trigger(C.ERROR,P);return}e.assetListResponse=w,this.hls.trigger(C.ASSET_LIST_LOADED,{event:e,assetListResponse:w,networkDetails:_})},onError:(y,T,b,_)=>{const w=this.assignAssetListError(e,se.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${y.code} ${y.text} (${T.url})`),T.url,_,b);this.hls.trigger(C.ERROR,w)},onTimeout:(y,T,b)=>{const _=this.assignAssetListError(e,se.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${T.url})`),T.url,y,b);this.hls.trigger(C.ERROR,_)}};return a.load(c,d,p),this.hls.trigger(C.ASSET_LIST_LOADING,{event:e}),a}assignAssetListError(e,t,n,r,s,o){return e.error=n,{type:Re.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:n,networkDetails:o,stats:s}}}function Mm(i){i?.play().catch(()=>{})}function qa(i,e){return`[${i}] Advancing timeline position to ${e}`}class dM extends tn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const r=n-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const o=r<=-.01;this.timelinePos=n,this.bufferedPos=n;const a=this.playingItem;if(!a){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(n,n-r)&&this.updateSchedule(!0),this.checkBuffer(),o&&n<a.start||n>=a.end){var c;const T=this.findItemIndex(a);let b=this.schedule.findItemIndexAtTime(n);if(b===-1&&(b=T+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${n} (resolving from ${T} to ${b})`)),!this.isInterstitial(a)&&(c=this.media)!=null&&c.paused&&(this.shouldPlay=!1),!o&&b>T){const _=this.schedule.findJumpRestrictedIndex(T+1,b);if(_>T){this.setSchedulePosition(_);return}}this.setSchedulePosition(b);return}const h=this.playingAsset;if(!h){if(this.playingLastItem&&this.isInterstitial(a)){const T=a.event.assetList[0];T&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,T))}return}const d=h.timelineStart,p=h.duration||0;if(o&&n<d||n>=d+p){var y;(y=a.event)!=null&&y.appendInPlace&&(this.clearInterstitial(a.event,a),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,h)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(n>=r.end){this.timelinePos=r.end;const a=this.findItemIndex(r);this.setSchedulePosition(a+1)}const s=this.playingAsset;if(!s)return;const o=s.timelineStart+(s.duration||0);n>=o&&this.setScheduleToAssetAtTime(n,s)},this.onScheduleUpdate=(n,r)=>{const s=this.schedule;if(!s)return;const o=this.playingItem,a=s.events||[],c=s.items||[],h=s.durations,d=n.map(_=>_.identifier),p=!!(a.length||d.length);(p||r)&&this.log(`INTERSTITIALS_UPDATED (${a.length}): ${a}
Schedule: ${c.map(_=>on(_))} pos: ${this.timelinePos}`),d.length&&this.log(`Removed events ${d}`);let y=null,T=null;o&&(y=this.updateItem(o,this.timelinePos),this.itemsMatch(o,y)?this.playingItem=y:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const b=this.bufferingItem;if(b&&(T=this.updateItem(b,this.bufferedPos),this.itemsMatch(b,T)?this.bufferingItem=T:b.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(b.event,null))),n.forEach(_=>{_.assetList.forEach(w=>{this.clearAssetPlayer(w.identifier,null)})}),this.playerQueue.forEach(_=>{if(_.interstitial.appendInPlace){const w=_.assetItem.timelineStart,L=_.timelineOffset-w;if(L)try{_.timelineOffset=w}catch(P){Math.abs(L)>Cs&&this.warn(`${P} ("${_.assetId}" ${_.timelineOffset}->${w})`)}}}),p||r){if(this.hls.trigger(C.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:c.slice(0),durations:h,removedIds:d}),this.isInterstitial(o)&&d.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(y,o),b&&T!==y&&this.trimInPlace(T,b),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new hM(e),this.schedule=new cM(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(C.MEDIA_ENDED,this.onMediaEnded,this),e.on(C.ERROR,this.onError,this),e.on(C.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(C.MEDIA_ENDED,this.onMediaEnded,this),e.off(C.ERROR,this.onError,this),e.off(C.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Ii(e,"play",this.onPlay),Ii(e,"pause",this.onPause),Ii(e,"seeking",this.onSeeking),Ii(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;yi(n,"seeking",this.onSeeking),yi(n,"timeupdate",this.onTimeupdate),yi(n,"play",this.onPlay),yi(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!r){this.clearScheduleState();const s=this.findItemIndex(n);this.setSchedulePosition(s)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(this.media=null,!n&&(r&&this.removeMediaListeners(r),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.log(`Removing schedule state for detachedData and ${s}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=p=>p&&e.getAssetPlayer(p.identifier),r=(p,y,T,b,_)=>{if(p){let w=p[y].start;const L=p.event;if(L){if(y==="playout"||L.timelineOccupancy!==QA.Point){const P=n(T);P?.interstitial===L&&(w+=P.assetItem.startOffset+P[_])}}else{const P=b==="bufferedPos"?o():e[b];w+=P-p.start}return w}return 0},s=(p,y)=>{var T;if(p!==0&&y!=="primary"&&(T=e.schedule)!=null&&T.length){var b;const _=e.schedule.findItemIndexAtTime(p),w=(b=e.schedule.items)==null?void 0:b[_];if(w){const L=w[y].start-w.start;return p+L}}return p},o=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?a("primary"):Math.max(p,0)},a=p=>{var y,T;return(y=e.primaryDetails)!=null&&y.live?e.primaryDetails.edge:((T=e.schedule)==null?void 0:T.durations[p])||0},c=(p,y)=>{var T,b;const _=e.effectivePlayingItem;if(_!=null&&(T=_.event)!=null&&T.restrictions.skip||!e.schedule)return;e.log(`seek to ${p} "${y}"`);const w=e.effectivePlayingItem,L=e.schedule.findItemIndexAtTime(p,y),P=(b=e.schedule.items)==null?void 0:b[L],R=e.getBufferingPlayer(),k=R?.interstitial,F=k?.appendInPlace,U=w&&e.itemsMatch(w,P);if(w&&(F||U)){const $=n(e.playingAsset),G=$?.media||e.primaryMedia;if(G){const W=y==="primary"?G.currentTime:r(w,y,e.playingAsset,"timelinePos","currentTime"),Q=p-W,K=(F?W:G.currentTime)+Q;if(K>=0&&(!$||F||K<=$.duration)){G.currentTime=K;return}}}if(P){let $=p;if(y!=="primary"){const W=P[y].start,Q=p-W;$=P.start+Q}const G=!e.isInterstitial(P);if((!e.isInterstitial(w)||w.event.appendInPlace)&&(G||P.event.appendInPlace)){const W=e.media||(F?R?.media:null);W&&(W.currentTime=$)}else if(w){const W=e.findItemIndex(w);if(L>W){const K=e.schedule.findJumpRestrictedIndex(W+1,L);if(K>W){e.setSchedulePosition(K);return}}let Q=0;if(G)e.timelinePos=$,e.checkBuffer();else{const K=P.event.assetList,te=p-(P[y]||P).start;for(let oe=K.length;oe--;){const Ae=K[oe];if(Ae.duration&&te>=Ae.startOffset&&te<Ae.startOffset+Ae.duration){Q=oe;break}}}e.setSchedulePosition(L,Q)}}},h=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const y=t();return e.isInterstitial(y)?y:null},d={get bufferedEnd(){const p=t(),y=e.bufferingItem;if(y&&y===p){var T;return r(y,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-y.playout.start||((T=e.bufferingAsset)==null?void 0:T.startOffset)||0}return 0},get currentTime(){const p=h(),y=e.effectivePlayingItem;return y&&y===p?r(y,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-y.playout.start:0},set currentTime(p){const y=h(),T=e.effectivePlayingItem;T&&T===y&&c(p+T.playout.start,"playout")},get duration(){const p=h();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const y=(p=h())==null?void 0:p.event.assetList;return y?y.map(T=>e.getAssetPlayer(T.identifier)):[]},get playingIndex(){var p;const y=(p=h())==null?void 0:p.event;return y&&e.effectivePlayingAsset?y.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return h()}};return this.manager={get events(){var p;return((p=e.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=e.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return h()?d:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const p=t();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return o()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){c(p,"primary")},get duration(){return a("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){c(p,"integrated")},get duration(){return a("integrated")},get seekableStart(){var p;return s(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,y=p?.event;if(y&&!y.restrictions.skip){const T=e.findItemIndex(p);if(y.appendInPlace){const b=p.playout.start+p.event.duration;c(b+.001,"playout")}else e.advanceAfterAssetEnded(y,T,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const s=(t=r)==null?void 0:t.currentTime;if(!(s===void 0||!be(s)))return s}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,r=e.media;if(n&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${xt(s)}`),this.detachedData=s}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var n,r;if(e.media===t)return;let s=null;const o=this.hls,a=e!==o,c=a&&e.interstitial.appendInPlace,h=(n=this.detachedData)==null?void 0:n.mediaSource;let d;if(o.media)c&&(s=o.transferMedia(),this.detachedData=s),d="Primary";else if(h){const b=this.getBufferingPlayer();b?(s=b.transferMedia(),d=`${b}`):d="detached MediaSource"}else d="detached media";if(!s){if(h)s=this.detachedData,this.log(`using detachedData: MediaSource ${xt(s)}`);else if(!this.detachedData||o.media===t){const b=this.playerQueue;b.length>1&&b.forEach(_=>{if(a&&_.interstitial.appendInPlace!==c){const w=_.interstitial;this.clearInterstitial(_.interstitial,null),w.appendInPlace=!1,w.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${w}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const p=s&&"mediaSource"in s&&((r=s.mediaSource)==null?void 0:r.readyState)!=="closed",y=p&&s?s:t;this.log(`${p?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${d} (media.currentTime: ${t.currentTime})`);const T=this.schedule;if(y===s&&T){const b=a&&e.assetId===T.assetIdAtEnd;y.overrides={duration:T.duration,endOfStream:!a||b,cueRemoval:!a}}e.attachMedia(y)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,r=this.effectivePlayingItem;if(n===-1){const s=this.hls.startPosition;if(this.log(qa("checkStart",s)),this.timelinePos=s,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(s>=0||!this.primaryLive){const o=this.timelinePos=s>0?s:0,a=e.findItemIndexAtTime(o);this.setSchedulePosition(a)}}else if(r&&!this.playingItem){const s=e.findItemIndex(r);this.setSchedulePosition(s)}}advanceAssetBuffering(e,t){const n=e.event,r=n.findAssetIndex(t),s=A0(n,r);if(!n.isAssetPastPlayoutLimit(s))this.bufferedToEvent(e,s);else if(this.schedule){var o;const a=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(e)+1];a&&this.bufferedToItem(a)}}advanceAfterAssetEnded(e,t,n){const r=A0(e,n);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const s=this.schedule.items;if(s){const o=t+1,a=s.length;if(o>=a){this.setSchedulePosition(-1);return}const c=e.resumeTime;this.timelinePos<c&&(this.log(qa("advanceAfterAssetEnded",c)),this.timelinePos=c,e.appendInPlace&&this.advanceInPlace(c),this.checkBuffer(this.bufferedPos<c)),this.setSchedulePosition(o)}}}else{if(e.appendInPlace){const s=e.assetList[r];s&&this.advanceInPlace(s.timelineStart)}this.setSchedulePosition(t,r)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const r=t.parentIdentifier,s=n.getEvent(r);if(s){const o=n.findEventIndex(r),a=n.findAssetIndex(s,e);this.advanceAfterAssetEnded(s,o,a-1)}}setSchedulePosition(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(!r||this.playbackDisabled)return;const s=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${s&&on(s)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(o)){const d=o.event,p=this.playingAsset,y=p?.identifier,T=y?this.getAssetPlayer(y):null;if(T&&y&&(!this.eventItemsMatch(o,s)||t!==void 0&&y!==d.assetList[t].identifier)){var c;const b=d.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${b+1}/${d.assetList.length} ${ps(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(C.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:b,event:d,schedule:r.slice(0),scheduleIndex:e,player:T}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(d,this.findItemIndex(this.playingItem),b);return}this.retreiveMediaSource(y,s),T.media&&!((c=this.detachedData)!=null&&c.mediaSource)&&T.detachMedia()}if(!this.eventItemsMatch(o,s)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${d} ${on(o)}`),d.hasPlayed=!0,this.hls.trigger(C.INTERSTITIAL_ENDED,{event:d,schedule:r.slice(0),scheduleIndex:e}),d.cue.once)){var h;this.updateSchedule();const b=(h=this.schedule)==null?void 0:h.items;if(s&&b){const _=this.findItemIndex(s);this.advanceSchedule(_,b,t,o,a)}return}}this.advanceSchedule(e,r,t,o,a)}advanceSchedule(e,t,n,r,s){const o=this.schedule;if(!o)return;const a=t[e]||null,c=this.primaryMedia,h=this.playerQueue;if(h.length&&h.forEach(d=>{const p=d.interstitial,y=o.findEventIndex(p.identifier);(y<e||y>e+1)&&this.clearInterstitial(p,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const d=a.event;if(n===void 0){n=o.findAssetIndex(d,this.timelinePos);const b=A0(d,n-1);if(d.isAssetPastPlayoutLimit(b)||d.appendInPlace&&this.timelinePos===a.end){this.advanceAfterAssetEnded(d,e,n);return}n=b}const p=this.waitingItem;this.assetsBuffered(a,c)||this.setBufferingItem(a);let y=this.preloadAssets(d,n);if(this.eventItemsMatch(a,p||r)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${on(a)} ${d.appendInPlace?"append in place":""}`),this.hls.trigger(C.INTERSTITIAL_STARTED,{event:d,schedule:t.slice(0),scheduleIndex:e})),!d.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${d}`);return}if(d.assetListLoader&&(d.assetListLoader.destroy(),d.assetListLoader=void 0),!c){this.log(`Waiting for attachMedia to start Interstitial ${d}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const T=d.assetList[n];if(!T){this.advanceAfterAssetEnded(d,e,n||0);return}if(y||(y=this.getAssetPlayer(T.identifier)),y===null||y.destroyed){const b=d.assetList.length;this.warn(`asset ${n+1}/${b} player destroyed ${d}`),y=this.createAssetPlayer(d,T,n),y.loadSource()}if(!this.eventItemsMatch(a,this.bufferingItem)&&d.appendInPlace&&this.isAssetBuffered(T))return;this.startAssetPlayer(y,n,t,e,c),this.shouldPlay&&Mm(y.media)}else a?(this.resumePrimary(a,e,r),this.shouldPlay&&Mm(this.hls.media)):s&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var r,s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${on(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.log(qa("resumePrimary",a)),this.timelinePos=a),this.attachPrimary(a,e)}if(!n)return;const o=(s=this.schedule)==null?void 0:s.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${on(e)}`),this.hls.trigger(C.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(n<r.fragmentStart||n>r.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Xe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,r),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(qa("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((n=r.mainForwardBufferInfo)==null?void 0:n.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(C.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(C.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const n=this.hls.levels[t.level],r=yt(yt({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=yt(yt({},this.altSelection),{},{audio:n});return}const s=yt(yt({},r),{},{audio:n});this.mediaSelection=s}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=yt(yt({},this.altSelection),{},{subtitles:n});return}const s=yt(yt({},r),{},{subtitles:n});this.mediaSelection=s}onAudioTrackSwitching(e,t){const n=Kp(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(t)||r.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=Kp(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(t)||t.id!==-1&&r.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const s=t[r];if(s.cue.post){var n;const o=this.schedule.findEventIndex(s.identifier),a=(n=this.schedule.items)==null?void 0:n[o];this.isInterstitial(a)&&this.eventItemsMatch(a,this.bufferingItem)&&this.bufferedToItem(a,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(e&&r){const s=this.findItemIndex(e,t);return r[s]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((s,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(s.identifier,null)});const n=e.end+.25,r=Xe.bufferInfo(this.primaryMedia,n,0);(r.end>n||(r.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${on(e)} (was ${on(t)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&((t=this.schedule)==null||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=(t=this.schedule)==null?void 0:t.items;if(!n)return;const r=Xe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,n,e)}updateBufferedPos(e,t,n){const r=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(t.length===1&&this.itemsMatch(t[0],s)){this.bufferedPos=e;return}const o=this.playingItem,a=this.findItemIndex(o);let c=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var h;const d=this.findItemIndex(s),p=Math.min(d+1,t.length-1),y=t[p];if((c===-1&&s&&e>=s.end||(h=y.event)!=null&&h.appendInPlace&&e+.01>=y.start)&&(c=p),this.isInterstitial(s)){const T=s.event;if(p-a>1&&T.appendInPlace===!1||T.assetList.length===0&&T.assetListLoader)return}if(this.bufferedPos=e,c>d&&c>a)this.bufferedToItem(y);else{const T=this.primaryDetails;this.primaryLive&&T&&e>T.edge-T.targetduration&&y.start<T.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else n&&o&&!this.itemsMatch(o,s)&&(c===a?this.bufferedToItem(o):c===a+1&&this.bufferedToItem(t[c]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const s=this.getAssetPlayer(r.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:r,events:s}=n;if(!r||!s)return t;const o=this.isInterstitial(e),a=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const c=a?a.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${on(e)}`+(t?` (${c.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const h=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((d,p)=>{const y=this.getAssetPlayer(d.identifier);y&&(p===h&&y.loadSource(),y.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(h=>h.pauseBuffering());this.hls.trigger(C.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,r=n.assetList.length===0&&!n.assetListLoader,s=n.cue.once;if(r||!s){const o=this.preloadAssets(n,t);if(o!=null&&o.interstitial.appendInPlace){const a=this.primaryMedia;a&&this.bufferAssetPlayer(o,a)}}}preloadAssets(e,t){const n=e.assetUrl,r=e.assetList.length,s=r===0&&!e.assetListLoader,o=e.cue.once;if(s){const c=e.timelineStart;if(e.appendInPlace){var a;const y=this.playingItem;!this.isInterstitial(y)&&(y==null||(a=y.nextEvent)==null?void 0:a.identifier)===e.identifier&&this.flushFrontBuffer(c+.25)}let h,d=0;if(!this.playingItem&&this.primaryLive&&(d=this.hls.startPosition,d===-1&&(d=this.hls.liveSyncPosition||0)),d&&!(e.cue.pre||e.cue.post)){const y=d-c;y>0&&(h=Math.round(y*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:r} ${e}${h?` live-start: ${d} start-offset: ${h}`:""}`),n)return this.createAsset(e,0,0,c,e.duration,n);const p=this.assetListLoader.loadAssetList(e,h);p&&(e.assetListLoader=p)}else if(!o&&r){for(let h=t;h<r;h++){const d=e.assetList[h],p=this.getAssetPlayerQueueIndex(d.identifier);(p===-1||this.playerQueue[p].destroyed)&&!d.error&&this.createAssetPlayer(e,d,h)}const c=e.assetList[t];if(c){const h=this.getAssetPlayer(c.identifier);return h&&h.loadSource(),h}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,r,s,o){const a={parentIdentifier:e.identifier,identifier:AM(e,o,t),duration:s,startOffset:n,timelineStart:r,uri:o};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){const r=this.hls,s=r.userConfig;let o=s.videoPreference;const a=r.loadLevelObj||r.levels[r.currentLevel];(o||a)&&(o=Et({},o),a.videoCodec&&(o.videoCodec=a.videoCodec),a.videoRange&&(o.allowedVideoRanges=[a.videoRange]));const c=r.audioTracks[r.audioTrack],h=r.subtitleTracks[r.subtitleTrack];let d=0;if(this.primaryLive||e.appendInPlace){const k=this.timelinePos-t.timelineStart;if(k>1){const F=t.duration;F&&k<F&&(d=k)}}const p=t.identifier,y=yt(yt({},s),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:d,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:c||s.audioPreference,subtitlePreference:h||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(y.timelineOffset=t.timelineStart));const T=y.cmcd;T!=null&&T.sessionId&&T.contentId&&(y.cmcd=Et({},T,{contentId:No(t.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const b=new fM(this.HlsPlayerClass,y,e,t);this.playerQueue.push(b),e.assetList[n]=t;let _=!0;const w=k=>{if(k.live){var F;const G=new Error(`Interstitials MUST be VOD assets ${e}`),W={fatal:!0,type:Re.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:G},Q=((F=this.schedule)==null?void 0:F.findEventIndex(e.identifier))||-1;this.handleAssetItemError(W,e,Q,n,G.message);return}const U=k.edge-k.fragmentStart,$=t.duration;(_||$===null||U>$)&&(_=!1,this.log(`Interstitial asset "${p}" duration change ${$} > ${U}`),t.duration=U,this.updateSchedule())};b.on(C.LEVEL_UPDATED,(k,{details:F})=>w(F)),b.on(C.LEVEL_PTS_UPDATED,(k,{details:F})=>w(F)),b.on(C.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const L=(k,F)=>{const U=this.getAssetPlayer(p);if(U&&F.tracks){U.off(C.BUFFER_CODECS,L),U.tracks=F.tracks;const $=this.primaryMedia;this.bufferingAsset===U.assetItem&&$&&!U.media&&this.bufferAssetPlayer(U,$)}};b.on(C.BUFFER_CODECS,L);const P=()=>{var k;const F=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${F}`),!F||!this.schedule)return;const U=this.schedule.findEventIndex(e.identifier),$=(k=this.schedule.items)==null?void 0:k[U];this.isInterstitial($)&&this.advanceAssetBuffering($,t)};b.on(C.BUFFERED_TO_END,P);const R=k=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const U=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,U,k)};return b.once(C.MEDIA_ENDED,R(n)),b.once(C.PLAYOUT_LIMIT_REACHED,R(1/0)),b.on(C.ERROR,(k,F)=>{if(!this.schedule)return;const U=this.getAssetPlayer(p);if(F.details===se.BUFFER_STALLED_ERROR){if(U!=null&&U.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(F,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${F.error} ${e}`)}),b.on(C.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const F=new Error(`Asset player destroyed unexpectedly ${p}`),U={fatal:!0,type:Re.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:F};this.handleAssetItemError(U,e,this.schedule.findEventIndex(e.identifier),n,F.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${ps(t)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:b}),b}clearInterstitial(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const r=this.playerQueue[n];this.log(`clear ${r} toSegment: ${t&&on(t)}`),this.transferMediaFromPlayer(r,t),this.playerQueue.splice(n,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,r,s){const{interstitial:o,assetItem:a,assetId:c}=e,h=o.assetList.length,d=this.playingAsset;this.endedAsset=null,this.playingAsset=a,(!d||d.identifier!==c)&&(d&&(this.clearAssetPlayer(d.identifier,n[r]),delete d.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${h} ${ps(a)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:o,schedule:n.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,t){var n,r;if(!this.schedule)return;const{interstitial:s,assetItem:o}=e,a=this.schedule.findEventIndex(s.identifier),c=(n=this.schedule.items)==null?void 0:n[a];if(!c)return;e.loadSource(),this.setBufferingItem(c),this.bufferingAsset=o;const h=this.getBufferingPlayer();if(h===e)return;const d=s.appendInPlace;if(d&&h?.interstitial.appendInPlace===!1)return;const p=h?.tracks||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(d&&o!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(p&&!ov(p,e.tracks)){const y=new Error(`Asset ${ps(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),T={fatal:!0,type:Re.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:y},b=s.findAssetIndex(o);this.handleAssetItemError(T,s,a,b,y.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const r=n.currentTime,s=t.findAssetIndex(e,r),o=e.assetList[s];if(o){const a=this.getAssetPlayer(o.identifier);if(a){const c=a.currentTime||r-o.timelineStart,h=a.duration-c;if(this.warn(`Stalled at ${c} of ${c+h} in ${a} ${e} (media.currentTime: ${r})`),c&&(h/n.playbackRate<.5||a.bufferedInPlaceToEnd(n))&&a.hls){const d=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,d,s)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,r,s){if(e.details===se.BUFFER_STALLED_ERROR)return;const o=t.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&ps(o)} ${e.error}`),!this.schedule)return;const a=o?.identifier||"",c=this.getAssetPlayerQueueIndex(a),h=this.playerQueue[c]||null,d=this.schedule.items,p=Et({},e,{fatal:!1,errorAction:Rs(!0),asset:o,assetListIndex:r,event:t,schedule:d,scheduleIndex:n,player:h});if(this.hls.trigger(C.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const y=this.playingAsset,T=this.bufferingAsset,b=new Error(s);if(o&&(this.clearAssetPlayer(a,null),o.error=b),!t.assetList.some(_=>!_.error))t.error=b;else for(let _=r;_<t.assetList.length;_++)this.resetAssetPlayer(t.assetList[_].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):y&&y.identifier===a?this.advanceAfterAssetEnded(t,n,r):T&&T.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,T)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${on(n)} error: ${e.error}`);let r=this.timelinePos;r===-1&&(r=this.hls.startPosition);const s=this.updateItem(n,r);if(this.itemsMatch(n,s)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;const o=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(e,t){var n,r;const s=t.event,o=s.identifier,a=t.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(o)))return;const c=s.timelineStart,h=s.duration;let d=0;a.forEach((_,w)=>{const L=parseFloat(_.DURATION);this.createAsset(s,w,d,c+d,L,_.URI),d+=L}),s.duration=d,this.log(`Loaded asset-list with duration: ${d} (was: ${h}) ${s}`);const p=this.waitingItem,y=p?.event.identifier===o;this.updateSchedule();const T=(r=this.bufferingItem)==null?void 0:r.event;if(y){var b;const _=this.schedule.findEventIndex(o),w=(b=this.schedule.items)==null?void 0:b[_];if(w){if(!this.playingItem&&this.timelinePos>w.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==_){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.updateSchedule(!0),this.primaryFallback(s);return}this.setBufferingItem(w)}this.setSchedulePosition(_)}else if(T?.identifier===o){const _=s.assetList[0];if(_){const w=this.getAssetPlayer(_.identifier);if(T.appendInPlace){const L=this.primaryMedia;w&&L&&this.bufferAssetPlayer(w,L)}else w&&w.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case se.ASSET_LIST_PARSING_ERROR:case se.ASSET_LIST_LOAD_ERROR:case se.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case se.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Om=500;class LE extends kl{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",we.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=fe.IDLE,this.setInterval(Om),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragContextChanged(n)||($t(n)&&(this.fragPrevious=n),this.state=fe.IDLE),!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=n.start;for(let h=0;h<s.length;h++)if(a>=s[h].start&&a<=s[h].end){o=s[h];break}const c=n.start+n.duration;o?o.end=c:(o={start:a,end:c},s.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,s,we.SUBTITLE)}}onError(e,t){const n=t.frag;n?.type===we.SUBTITLE&&(t.details===se.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==fe.STOPPED&&(this.state=fe.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&oE(this.levels,t)){this.levels=t.map(n=>new Ns(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new Ns(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,we.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==fe.STOPPED&&this.setInterval(Om)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const c=s[a];if(a>=s.length||!c)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let h=0;if(o.live||(n=c.details)!=null&&n.live){if(o.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const y=p.fragments[0];if(!c.details)o.hasProgramDateTime&&p.hasProgramDateTime?(jA(o,p),h=o.fragmentStart):y&&(h=y.start,df(o,h));else{var d;h=this.alignPlaylists(o,c.details,(d=this.levelLastLoaded)==null?void 0:d.details),h===0&&y&&(h=y.start,df(o,h))}p&&!this.startFragRequested&&this.setStartPosition(p,h)}c.details=o,this.levelLastLoaded=c,a===r&&(this.hls.trigger(C.SUBTITLE_TRACK_UPDATED,{details:o,id:a,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===fe.IDLE&&(Qr(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),c.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&Ds(r.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer,zc(r.method)).catch(a=>{throw s.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const c=performance.now();s.trigger(C.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:c}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=fe.IDLE})}}doTick(){if(!this.media){this.state=fe.IDLE;return}if(this.state===fe.IDLE){const{currentTrackId:e,levels:t}=this,n=t?.[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:r}=this,s=this.getLoadPosition(),o=Xe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:a,len:c}=o,h=n.details,d=this.hls.maxBufferLength+h.levelTargetDuration;if(c>d)return;const p=h.fragments,y=p.length,T=h.edge;let b=null;const _=this.fragPrevious;if(a<T){const P=r.maxFragLookUpTolerance,R=a>T-P?0:P;b=Qr(_,p,Math.max(p[0].start,a),R),!b&&_&&_.start<p[0].start&&(b=p[0])}else b=p[y-1];if(b=this.filterReplacedPrimary(b,n.details),!b)return;const w=b.sn-h.startSN,L=p[w-1];if(L&&L.cc===b.cc&&this.fragmentTracker.getState(L)===jt.NOT_LOADED&&(b=L),this.fragmentTracker.getState(b)===jt.NOT_LOADED){const P=this.mapToInitFragWhenRequired(b);P&&this.loadFragment(P,n,a)}}}loadFragment(e,t,n){$t(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new gM(this.tracksBuffered[this.currentTrackId]||[])}}class gM{constructor(e){this.buffered=void 0;const t=(n,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const pM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},RE=i=>String.fromCharCode(pM[i]||i),un=15,Un=100,mM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},yM={17:2,18:4,21:6,22:8,23:10,19:13,20:15},vM={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},EM={25:2,26:4,29:6,30:8,31:10,27:13,28:15},TM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class SM{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;pt.log(`${this.time} [${e}] ${n}`)}}}const Dr=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class DE{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class bM{constructor(){this.uchar=" ",this.penState=new DE}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class xM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new DE,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Un;t++)this.chars.push(new bM);this.logger=e}equals(e){for(let t=0;t<Un;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Un;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Un;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Un&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Un)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=RE(e);if(this.pos>=Un){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Un;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Un;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class l0{constructor(e){this.rows=[],this.currRow=un-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<un;t++)this.rows.push(new xM(e));this.logger=e}reset(){for(let e=0;e<un;e++)this.rows[e].clear();this.currRow=un-1}equals(e){let t=!0;for(let n=0;n<un;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<un;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<un;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+xt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<un;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,c=this.logger.time;if(a!==null&&c!==null&&a<c)for(let h=0;h<this.nrRollUpRows;h++)this.rows[t-this.nrRollUpRows+h+1].copy(o.rows[s+h])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+xt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let s=0;s<un;s++){const o=this.rows[s].getTextString();o&&(r=s+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class Fm{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new l0(n),this.nonDisplayedMemory=new l0(n),this.lastOutputScreen=new l0(n),this.currRollUpRow=this.displayedMemory.rows[un-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[un-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+xt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Bm{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=wM(),this.logger=void 0;const r=this.logger=new SM;this.channels=[null,new Fm(e,t,r),new Fm(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,s=t[n+1]&127;let o=!1,a=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+Dr([t[n],t[n+1]])+"] -> ("+Dr([r,s])+")");const c=this.cmdHistory;if(r>=16&&r<=31){if(_M(r,s,c)){Xa(null,null,c),this.logger.log(3,()=>"Repeated command ("+Dr([r,s])+") is dropped");continue}Xa(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else Xa(null,null,c);if(!o&&(a=this.parseChars(r,s),a)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Dr([r,s])+" orig: "+Dr([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Dr([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?mM[e]:vM[e]:n=o===1?yM[e]:EM[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+RE(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Dr(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=TM[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Xa(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Xa(i,e,t){t.a=i,t.b=e}function _M(i,e,t){return t.a===i&&t.b===e}function wM(){return{a:null,b:null}}var ah=(function(){if(HA!=null&&HA.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,c){if(typeof c!="string"||!Array.isArray(a))return!1;const h=c.toLowerCase();return~a.indexOf(h)?h:!1}function n(a){return t(i,a)}function r(a){return t(e,a)}function s(a,...c){let h=1;for(;h<arguments.length;h++){const d=arguments[h];for(const p in d)a[p]=d[p]}return a}function o(a,c,h){const d=this,p={enumerable:!0};d.hasBeenReset=!1;let y="",T=!1,b=a,_=c,w=h,L=null,P="",R=!0,k="auto",F="start",U=50,$="middle",G=50,W="middle";Object.defineProperty(d,"id",s({},p,{get:function(){return y},set:function(Q){y=""+Q}})),Object.defineProperty(d,"pauseOnExit",s({},p,{get:function(){return T},set:function(Q){T=!!Q}})),Object.defineProperty(d,"startTime",s({},p,{get:function(){return b},set:function(Q){if(typeof Q!="number")throw new TypeError("Start time must be set to a number.");b=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",s({},p,{get:function(){return _},set:function(Q){if(typeof Q!="number")throw new TypeError("End time must be set to a number.");_=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",s({},p,{get:function(){return w},set:function(Q){w=""+Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",s({},p,{get:function(){return L},set:function(Q){L=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",s({},p,{get:function(){return P},set:function(Q){const K=n(Q);if(K===!1)throw new SyntaxError("An invalid or illegal string was specified.");P=K,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",s({},p,{get:function(){return R},set:function(Q){R=!!Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",s({},p,{get:function(){return k},set:function(Q){if(typeof Q!="number"&&Q!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");k=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",s({},p,{get:function(){return F},set:function(Q){const K=r(Q);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");F=K,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",s({},p,{get:function(){return U},set:function(Q){if(Q<0||Q>100)throw new Error("Position must be between 0 and 100.");U=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",s({},p,{get:function(){return $},set:function(Q){const K=r(Q);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");$=K,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",s({},p,{get:function(){return G},set:function(Q){if(Q<0||Q>100)throw new Error("Size must be between 0 and 100.");G=Q,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",s({},p,{get:function(){return W},set:function(Q){const K=r(Q);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");W=K,this.hasBeenReset=!0}})),d.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o})();class IM{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function CE(i){function e(n,r,s,o){return(n|0)*3600+(r|0)*60+(s|0)+parseFloat(o||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class LM{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function PE(i,e,t,n){const r=n?i.split(n):[i];for(const s in r){if(typeof r[s]!="string")continue;const o=r[s].split(t);if(o.length!==2)continue;const a=o[0],c=o[1];e(a,c)}}const Sf=new ah(0,0,""),Za=Sf.align==="middle"?"middle":"center";function RM(i,e,t){const n=i;function r(){const a=CE(i);if(a===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,c){const h=new LM;PE(a,function(y,T){let b;switch(y){case"region":for(let _=t.length-1;_>=0;_--)if(t[_].id===T){h.set(y,t[_].region);break}break;case"vertical":h.alt(y,T,["rl","lr"]);break;case"line":b=T.split(","),h.integer(y,b[0]),h.percent(y,b[0])&&h.set("snapToLines",!1),h.alt(y,b[0],["auto"]),b.length===2&&h.alt("lineAlign",b[1],["start",Za,"end"]);break;case"position":b=T.split(","),h.percent(y,b[0]),b.length===2&&h.alt("positionAlign",b[1],["start",Za,"end","line-left","line-right","auto"]);break;case"size":h.percent(y,T);break;case"align":h.alt(y,T,["start",Za,"end","left","right"]);break}},/:/,/\s/),c.region=h.get("region",null),c.vertical=h.get("vertical","");let d=h.get("line","auto");d==="auto"&&Sf.line===-1&&(d=-1),c.line=d,c.lineAlign=h.get("lineAlign","start"),c.snapToLines=h.get("snapToLines",!0),c.size=h.get("size",100),c.align=h.get("align",Za);let p=h.get("position","auto");p==="auto"&&Sf.position===50&&(p=c.align==="start"||c.align==="left"?0:c.align==="end"||c.align==="right"?100:50),c.position=p}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),o(),e.endTime=r(),o(),s(i,e)}function kE(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class DM{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new IM,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=kE(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function r(s){PE(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const a=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new ah(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{RM(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const CM=/\r\n|\n\r|\n|\r/g,u0=function(e,t,n=0){return e.slice(n,n+t.length)===t},PM=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!be(t)||!be(n)||!be(r)||!be(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=3600*1e3*s,t};function Ah(i,e,t){return No(i.toString())+No(e.toString())+No(t)}const kM=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};function MM(i,e,t,n,r,s,o){const a=new DM,c=Ui(new Uint8Array(i)).trim().replace(CM,`
`).split(`
`),h=[],d=e?zP(e.baseTime,e.timescale):0;let p="00:00.000",y=0,T=0,b,_=!0;a.oncue=function(w){const L=t[n];let P=t.ccOffset;const R=(y-d)/9e4;if(L!=null&&L.new&&(T!==void 0?P=t.ccOffset=L.start:kM(t,n,R)),R){if(!e){b=new Error("Missing initPTS for VTT MPEGTS");return}P=R-t.presentationOffset}const k=w.endTime-w.startTime,F=qi((w.startTime+P-T)*9e4,r*9e4)/9e4;w.startTime=Math.max(F,0),w.endTime=Math.max(F+k,0);const U=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(U)),w.id||(w.id=Ah(w.startTime,w.endTime,U)),w.endTime>0&&h.push(w)},a.onparsingerror=function(w){b=w},a.onflush=function(){if(b){o(b);return}s(h)},c.forEach(w=>{if(_)if(u0(w,"X-TIMESTAMP-MAP=")){_=!1,w.slice(16).split(",").forEach(L=>{u0(L,"LOCAL:")?p=L.slice(6):u0(L,"MPEGTS:")&&(y=parseInt(L.slice(7)))});try{T=PM(p)/1e3}catch(L){b=L}return}else w===""&&(_=!1);a.parse(w+`
`)}),a.flush()}const f0="stpp.ttml.im1t",ME=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,OE=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,OM={left:"start",center:"center",right:"end",start:"start",end:"end"};function Nm(i,e,t,n){const r=nt(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(a=>Ui(a)),o=YP(e.baseTime,1,e.timescale);try{s.forEach(a=>t(FM(a,o)))}catch(a){n(a)}}function FM(i,e){const r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((p,y)=>(p[y]=r.getAttribute(`ttp:${y}`)||s[y],p),{}),a=r.getAttribute("xml:space")!=="preserve",c=Um(c0(r,"styling","style")),h=Um(c0(r,"layout","region")),d=c0(r,"body","[begin]");return[].map.call(d,p=>{const y=FE(p,a);if(!y||!p.hasAttribute("begin"))return null;const T=d0(p.getAttribute("begin"),o),b=d0(p.getAttribute("dur"),o);let _=d0(p.getAttribute("end"),o);if(T===null)throw $m(p);if(_===null){if(b===null)throw $m(p);_=T+b}const w=new ah(T-e,_-e,y);w.id=Ah(w.startTime,w.endTime,w.text);const L=h[p.getAttribute("region")],P=c[p.getAttribute("style")],R=BM(L,P,c),{textAlign:k}=R;if(k){const F=OM[k];F&&(w.lineAlign=F),w.align=k}return Et(w,R),w}).filter(p=>p!==null)}function c0(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Um(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function FE(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return n.nodeName==="br"&&r?t+`
`:(s=n.childNodes)!=null&&s.length?FE(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function BM(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),s.reduce((a,c)=>{const h=h0(e,n,c)||h0(i,n,c)||h0(r,n,c);return h&&(a[c]=h),a},{})}function h0(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function $m(i){return new Error(`Could not parse ttml timestamp ${i}`)}function d0(i,e){if(!i)return null;let t=CE(i);return t===null&&(ME.test(i)?t=NM(i,e):OE.test(i)&&(t=UM(i,e))),t}function NM(i,e){const t=ME.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function UM(i,e){const t=OE.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class Ja{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class BE{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Vm(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Ja(this,"textTrack1"),t=new Ja(this,"textTrack2"),n=new Ja(this,"textTrack3"),r=new Ja(this,"textTrack4");this.cea608Parser1=new Bm(1,e,t),this.cea608Parser2=new Bm(3,n,r)}addCues(e,t,n,r,s){let o=!1;for(let a=s.length;a--;){const c=s[a],h=$M(c[0],c[1],t,n);if(h>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],n),o=!0,h/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,r)}else{const a=this.Cues.newCue(null,t,n,r);this.hls.trigger(C.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s,trackId:o}){const{unparsedVttFrags:a}=this;n===we.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:s,trackId:o}),a.length&&(this.unparsedVttFrags=[],a.forEach(c=>{this.initPTS[c.frag.cc]?this.onFragLoaded(C.FRAG_LOADED,c):this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:c.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const s=n.textTracks[r];if(Gm(s,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)n[e]=a,Ss(n[e]),xE(n[e],r);else{const c=this.createTextTrack("captions",s,o);c&&(c[e]=!0,n[e]=c)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:r}=this;Object.keys(r).forEach(s=>{Ss(r[s]),delete r[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Vm(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Ss(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===f0);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(oE(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?xA(o.textTracks):null;if(this.tracks.forEach((c,h)=>{let d;if(a){let p=null;for(let y=0;y<a.length;y++)if(a[y]&&Gm(a[y],c)){p=a[y],a[y]=null;break}p&&(d=p)}if(d)Ss(d);else{const p=NE(c);d=this.createTextTrack(p,c.name,c.lang),d&&(d.mode="disabled")}d&&this.textTracks.push(d)}),a!=null&&a.length){const c=a.filter(h=>h!==null).map(h=>h.label);c.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${c.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const s=`textTrack${r[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===we.MAIN){var n,r;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:c,sn:h}=t.frag,d=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;s&&o&&(h!==a+1||h===a&&d!==this.lastPartIndex+1||c!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=c,this.lastSn=h,this.lastPartIndex=d}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===we.SUBTITLE)if(r.byteLength){const s=n.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const a=this.tracks[n.level],c=this.vttCCs;c[n.cc]||(c[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===f0?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Nm(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{n.logger.log(`Failed to parse IMSC1: ${r}`),n.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[n.cc]&&a===-1){o.push(e);return}const c=this.hls,h=(t=n.initSegment)!=null&&t.data?Zi(n.initSegment.data,new Uint8Array(r)).buffer:r;MM(h,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,d=>{this._appendCues(d,n.level),c.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},d=>{const p=d.message==="Missing initPTS for VTT MPEGTS";p?o.push(e):this._fallbackToIMSC1(n,r),c.logger.log(`Failed to parse VTT cue: ${d}`),!(p&&a>n.cc)&&c.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:d})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Nm(t,this.initPTS[e.cc],()=>{n.textCodec=f0,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>_E(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;n.trigger(C.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===we.SUBTITLE&&this.onFragLoaded(C.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:r}=t;if(!(n.type===we.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let s=0;s<r.length;s++){const o=r[s].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const a=this.extractCea608Data(o);this.cea608Parser1.addData(r[s].pts,a[0]),this.cea608Parser2.addData(r[s].pts,a[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(c=>Tf(a[c],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(c=>Tf(a[c],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let s=0;s<n;s++){const o=e[r++],a=127&e[r++],c=127&e[r++];if(a===0&&c===0)continue;if((4&o)!==0){const d=3&o;(d===0||d===1)&&(t[d].push(a),t[d].push(c))}}return t}}function NE(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function Gm(i,e){return!!i&&i.kind===NE(e)&&mf(e,i)}function $M(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function Vm(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const GM=/\s/,UE={newCue(i,e,t,n){const r=[];let s,o,a,c,h;const d=self.VTTCue||self.TextTrackCue;for(let y=0;y<n.rows.length;y++)if(s=n.rows[y],a=!0,c=0,h="",!s.isEmpty()){var p;for(let _=0;_<s.chars.length;_++)GM.test(s.chars[_].uchar)&&a?c++:(h+=s.chars[_].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),c>=16?c--:c++;const T=kE(h.trim()),b=Ah(e,t,T);i!=null&&(p=i.cues)!=null&&p.getCueById(b)||(o=new d(e,t,T),o.id=b,o.line=y+1,o.align="left",o.position=10+Math.min(80,Math.floor(c*8/32)*10),r.push(o))}return i&&r.length&&(r.sort((y,T)=>y.line==="auto"||T.line==="auto"?0:y.line>8&&T.line>8?T.line-y.line:y.line-T.line),r.forEach(y=>_E(i,y))),r}};function $E(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const VM=/(\d+)-(\d+)\/(\d+)/;class bf{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||QM,this.controller=new self.AbortController,this.stats=new Dl}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=HM(e,this.controller.signal),o=e.responseType==="arraybuffer",a=o?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:h}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&be(c)?c:h,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(qo(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var y;this.response=this.loader=p;const T=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=h,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},h-(T-r.loading.start)),!p.ok){const{status:_,statusText:w}=p;throw new WM(w||"fetch, bad network response",_,p)}r.loading.first=T,r.total=KM(p.headers)||r.total;const b=(y=this.callbacks)==null?void 0:y.onProgress;return b&&be(t.highWaterMark)?this.loadProgressively(p,r,e,t.highWaterMark,b):o?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{var y,T;const b=this.response;if(!b)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const _=p[a];_&&(r.loaded=r.total=_);const w={url:b.url,data:p,code:b.status},L=(y=this.callbacks)==null?void 0:y.onProgress;L&&!be(t.highWaterMark)&&L(r,e,p,b),(T=this.callbacks)==null||T.onSuccess(w,r,e,b)}).catch(p=>{var y;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const T=p&&p.code||0,b=p?p.message:null;(y=this.callbacks)==null||y.onError({code:T,text:b},e,p?p.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){const o=new Uv,a=e.body.getReader(),c=()=>a.read().then(h=>{if(h.done)return o.dataLength&&s(t,n,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const d=h.value,p=d.length;return t.loaded+=p,p<r||o.dataLength?(o.push(d),o.dataLength>=r&&s(t,n,o.flush().buffer,e)):s(t,n,d.buffer,e),c()}).catch(()=>Promise.reject());return c()}}function HM(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Et({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function jM(i){const e=VM.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function KM(i){const e=i.get("Content-Range");if(e){const n=jM(e);if(be(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function QM(i,e){return new self.Request(i.url,e)}class WM extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const YM=/^age:\s*[\d.]+\s*$/im;class lh{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Dl,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{var a;(a=this.callbacks)==null||a.onError({code:n.status,text:o.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const a in r)e.setRequestHeader(a,r[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&be(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const h=t.status,d=t.responseType==="text"?t.responseText:null;if(h>=200&&h<300){const b=d??t.response;if(b!=null){var o,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const _=t.responseType==="arraybuffer"?b.byteLength:b.length;n.loaded=n.total=_,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const w=(o=this.callbacks)==null?void 0:o.onProgress;w&&w(n,e,b,t);const L={url:t.responseURL,data:b,code:h};(a=this.callbacks)==null||a.onSuccess(L,n,e,t);return}}const p=s.loadPolicy.errorRetry,y=n.retry,T={url:e.url,data:void 0,code:h};if(VA(p,y,!1,T))this.retry(p);else{var c;pt.error(`${h} while loading ${e.url}`),(c=this.callbacks)==null||c.onError({code:h,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(VA(e,t,!0))this.retry(e);else{var n;pt.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Qc(e,n.retry),n.retry++,pt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&YM.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const zM={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},qM=yt(yt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:lh,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Sv,bufferController:lE,capLevelController:Fl,errorController:_v,fpsController:bE,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Xc,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:zM},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},XM()),{},{subtitleStreamController:LE,subtitleTrackController:wE,timelineController:BE,audioStreamController:sE,audioTrackController:aE,emeController:Hr,cmcdController:EE,contentSteeringController:TE,interstitialsController:dM});function XM(){return{cueHandler:UE,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function ZM(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=xf(i),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(o=>{const a=`${o==="level"?"playlist":o}LoadPolicy`,c=e[a]===void 0,h=[];s.forEach(d=>{const p=`${o}Loading${d}`,y=e[p];if(y!==void 0&&c){h.push(p);const T=n[a].default;switch(e[a]={default:T},d){case"TimeOut":T.maxLoadTimeMs=y,T.maxTimeToFirstByteMs=y;break;case"MaxRetry":T.errorRetry.maxNumRetry=y,T.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":T.errorRetry.retryDelayMs=y,T.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":T.errorRetry.maxRetryDelayMs=y,T.timeoutRetry.maxRetryDelayMs=y;break}}}),h.length&&t.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${a}": ${xt(e[a])}`)}),yt(yt({},n),e)}function xf(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(xf):Object.keys(i).reduce((e,t)=>(e[t]=xf(i[t]),e),{}):i}function JM(i,e){const t=i.loader;t!==bf&&t!==lh?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):$E()&&(i.loader=bf,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const _A=2,e3=.1,t3=.05,i3=100;class n3 extends wv{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(i3),this.mediaSource=t.mediaSource;const n=this.media=t.media;yi(n,"playing",this.onMediaPlaying),yi(n,"waiting",this.onMediaWaiting),yi(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Ii(n,"playing",this.onMediaPlaying),Ii(n,"waiting",this.onMediaWaiting),Ii(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,r;const s=(n=this.hls)==null?void 0:n.config;if(!s)return;const o=this.media;if(!o)return;const{seeking:a}=o,c=this.seeking&&!a,h=!this.seeking&&a,d=o.paused&&!a||o.ended||o.playbackRate===0;if(this.seeking=a,e!==t){t&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!d&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(h||c){c&&this.stallResolved(e);return}if(d){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1}));return}if(!Xe.getBuffered(o).length){this.nudgeRetry=0;return}const p=Xe.bufferInfo(o,e,0),y=p.nextStart||0,T=this.fragmentTracker;if(a&&T&&this.hls){const U=Hm(this.hls.inFlightFragments,e),$=p.len>_A,G=!y||U||y-e>_A&&!T.getPartialFragment(e);if($||G)return;this.moved=!1}const b=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&T){if(!(p.len>0)&&!y)return;const $=Math.max(y,p.start||0)-e,W=!!(b!=null&&b.live)?b.targetduration*2:_A,Q=eA(e,T);if($>0&&($<=W||Q)){o.paused||this._trySkipBufferHole(Q);return}}const _=s.detectStallWithCurrentTimeMs,w=self.performance.now(),L=this.waiting;let P=this.stalled;if(P===null)if(L>0&&w-L<_)P=this.stalled=L;else{this.stalled=w;return}const R=w-P;if(!a&&(R>=_||L)&&this.hls){var k;if(((k=this.mediaSource)==null?void 0:k.readyState)==="ended"&&!(b!=null&&b.live)&&Math.abs(e-(b?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const F=Xe.bufferInfo(o,e,s.maxBufferHole);this._tryFixBufferStall(F,R,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(C.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&r&&r.length>1&&e>r.end(0)){const s=Xe.bufferedInfo(Xe.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&t>=s.start){const o=Xe.timeRangesToArray(r),a=Xe.bufferedInfo(o,t,0).bufferedIndex;if(a>-1&&a<o.length-1){const c=Xe.bufferedInfo(o,e,0).bufferedIndex,h=o[a].end,d=o[a+1].start;if((c===-1||c>a)&&d-h<1&&e-h<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${h} -> ${d} buffered index: ${c}`);this.warn(p.message),this.media.currentTime+=1e-6;let y=eA(e,this.fragmentTracker);y&&"fragment"in y?y=y.fragment:y||(y=void 0);const T=Xe.bufferInfo(this.media,e,0);this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:y,buffer:T.len,bufferInfo:T})}}}}}_tryFixBufferStall(e,t,n){var r,s;const{fragmentTracker:o,media:a}=this,c=(r=this.hls)==null?void 0:r.config;if(!a||!o||!c)return;const h=(s=this.hls)==null?void 0:s.latestLevelDetails,d=eA(n,o);if((d||h!=null&&h.live&&n<h.fragmentStart)&&(this._trySkipBufferHole(d)||!this.media))return;const p=e.buffered,y=this.adjacentTraversal(e,n);(p&&p.length>1&&e.len>c.maxBufferHole||e.nextStart&&(e.nextStart-n<c.maxBufferHole||y))&&(t>c.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,r=e.nextStart;if(n&&r){const s=n.getFragAtPos(t,we.MAIN),o=n.getFragAtPos(r,we.MAIN);if(s&&o)return o.sn-s.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:r,stalled:s}=this;if(!r&&s!==null&&n&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${xt(e)})`);this.warn(o.message),t.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:r}=this,s=(t=this.hls)==null?void 0:t.config;if(!r||!n||!s)return 0;const o=r.currentTime,a=Xe.bufferInfo(r,o,0),c=o<a.start?a.start:a.nextStart;if(c&&this.hls){const d=a.len<=s.maxBufferHole,p=a.len>0&&a.len<1&&r.readyState<3,y=c-o;if(y>0&&(d||p)){if(y>s.maxBufferHole){let b=!1;if(o===0){const _=n.getAppendedFrag(0,we.MAIN);_&&c<_.end&&(b=!0)}if(!b&&e){var h;if(!((h=this.hls.loadLevelObj)!=null&&h.details)||Hm(this.hls.inFlightFragments,c))return 0;let w=!1,L=e.end;for(;L<c;){const P=eA(L,n);if(P)L+=P.duration;else{w=!0;break}}if(w)return 0}}const T=Math.max(c+t3,o+e3);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${T}`),this.moved=!0,r.currentTime=T,!(e!=null&&e.gap)){const b=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${T}`),_={type:Re.MEDIA_ERROR,details:se.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:b,reason:b.message,buffer:a.len,bufferInfo:a};e&&("fragment"in e?_.part=e:_.frag=e),this.hls.trigger(C.ERROR,_)}return T}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:r}=this,s=t?.config;if(!n||!s)return 0;const o=n.currentTime;if(this.nudgeRetry++,r<s.nudgeMaxRetry){const a=o+(r+1)*s.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${o} to ${a}`);this.warn(c.message),n.currentTime=a,t.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1,buffer:e.len,bufferInfo:e})}else{const a=new Error(`Playhead still not moving while enough data buffered @${o} after ${s.nudgeMaxRetry} nudges`);this.error(a.message),t.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.BUFFER_STALLED_ERROR,error:a,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Hm(i,e){const t=jm(i.main);if(t&&t.start<=e)return t;const n=jm(i.audio);return n&&n.start<=e?n:null}function jm(i){if(!i)return null;switch(i.state){case fe.IDLE:case fe.STOPPED:case fe.ENDED:case fe.ERROR:return null}return i.frag}function eA(i,e){return e.getAppendedFrag(i,we.MAIN)||e.getPartialFragment(i)}const r3=.25;function _f(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function g0(i,e,t,n,r){let s=new i(e,t,"");try{s.value=n,r&&(s.type=r)}catch{s=new i(e,t,xt(r?yt({type:r},n):n))}return s}const tA=(()=>{const i=_f();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class s3{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(C.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Ss(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return xE(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:r}=this.hls.config;if(!n&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=_f();if(o)for(let a=0;a<s.length;a++){const c=s[a].type;if(c===xi.emsg&&!n||!r)continue;const h=Qv(s[a].data),d=s[a].pts;let p=d+s[a].duration;p>tA&&(p=tA),p-d<=0&&(p=d+r3);for(let T=0;T<h.length;T++){const b=h[T];if(!Wv(b)){this.updateId3CueEnds(d,c);const _=g0(o,d,p,b,c);_&&this.id3Track.addCue(_)}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===tA&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:c}}=o;if(s&&(a||c)){let h;r==="audio"?h=d=>d.type===xi.audioId3&&c:r==="video"?h=d=>d.type===xi.emsg&&a:h=d=>d.type===xi.audioId3&&c||d.type===xi.emsg&&a,Tf(s,t,n,h)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:r,enableDateRangeMetadataCues:s,interstitialsController:o}=this.hls.config;if(!s)return;const a=_f();if(n&&r&&!o){const{fragmentStart:_,fragmentEnd:w}=e;let L=this.assetCue;L?(L.startTime=_,L.endTime=w):a&&(L=this.assetCue=g0(a,_,w,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),L&&(L.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(L),L.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:c}=this,{dateRanges:h}=e,d=Object.keys(h);let p=this.dateRangeCuesAppended;if(c&&t){var y;if((y=c.cues)!=null&&y.length){const _=Object.keys(p).filter(w=>!d.includes(w));for(let w=_.length;w--;){var T;const L=_[w],P=(T=p[L])==null?void 0:T.cues;delete p[L],P&&Object.keys(P).forEach(R=>{const k=P[R];if(k){k.removeEventListener("enter",this.onEventCueEnter);try{c.removeCue(k)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const b=e.fragments[e.fragments.length-1];if(!(d.length===0||!be(b?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let _=0;_<d.length;_++){const w=d[_],L=h[w],P=L.startTime,R=p[w],k=R?.cues||{};let F=R?.durationKnown||!1,U=tA;const{duration:$,endDate:G}=L;if(G&&$!==null)U=P+$,F=!0;else if(L.endOnNext&&!F){const Q=d.reduce((K,te)=>{if(te!==L.id){const oe=h[te];if(oe.class===L.class&&oe.startDate>L.startDate&&(!K||L.startDate<K.startDate))return oe}return K},null);Q&&(U=Q.startTime,F=!0)}const W=Object.keys(L.attr);for(let Q=0;Q<W.length;Q++){const K=W[Q];if(!BC(K))continue;const te=k[K];if(te)F&&!(R!=null&&R.durationKnown)?te.endTime=U:Math.abs(te.startTime-P)>.01&&(te.startTime=P,te.endTime=U);else if(a){let oe=L.attr[K];NC(K)&&(oe=av(oe));const X=g0(a,P,U,{key:K,data:oe},xi.dateRange);X&&(X.id=w,this.id3Track.addCue(X),k[K]=X,o&&(K==="X-ASSET-LIST"||K==="X-ASSET-URL")&&X.addEventListener("enter",this.onEventCueEnter))}}p[w]={cues:k,dateRange:L,durationKnown:F}}}}}class o3{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:o}=this.config;if(!s||o===1||!n.live)return;const a=this.targetLatency;if(a===null)return;const c=r-a,h=Math.min(this.maxLatency,a+n.targetduration);if(c<h&&c>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,o)),y=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20,T=Math.min(p,Math.max(1,y));this.changeMediaPlaybackRate(t,T)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,c=this.hls.userConfig;let h=a&&n||t;(this._targetLatencyUpdated||c.liveSyncDuration||c.liveSyncDurationCount||h===0)&&(h=s!==void 0?s:o*r);const d=r;return h+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,d)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const r=n.edge,s=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===se.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,r;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class a3 extends Ol{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],s={},o={};let a=!1,c=!1,h=!1;t.levels.forEach(d=>{const p=d.attrs;let{audioCodec:y,videoCodec:T}=d;y&&(d.audioCodec=y=NA(y,n)||void 0),T&&(T=d.videoCodec=iC(T));const{width:b,height:_,unknownCodecs:w}=d;let L=w?w.length:0;if(w)for(let Q=L;Q--;){const K=w[Q];this.isAudioSupported(K)?(d.audioCodec=y=y?`${y},${K}`:K,L--,Bs.audio[y.substring(0,4)]=2):this.isVideoSupported(K)&&(d.videoCodec=T=T?`${T},${K}`:K,L--,Bs.video[T.substring(0,4)]=2)}if(a||(a=!!(b&&_)),c||(c=!!T),h||(h=!!y),L||y&&!this.isAudioSupported(y)||T&&!this.isVideoSupported(T)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:P,"FRAME-RATE":R,"HDCP-LEVEL":k,"PATHWAY-ID":F,RESOLUTION:U,"VIDEO-RANGE":$}=p,W=`${`${F||"."}-`}${d.bitrate}-${U}-${R}-${P}-${$}-${k}`;if(s[W])if(s[W].uri!==d.url&&!d.attrs["PATHWAY-ID"]){const Q=o[W]+=1;d.attrs["PATHWAY-ID"]=new Array(Q+1).join(".");const K=this.createLevel(d);s[W]=K,r.push(K)}else s[W].addGroupId("audio",p.AUDIO),s[W].addGroupId("text",p.SUBTITLES);else{const Q=this.createLevel(d);s[W]=Q,o[W]=1,r.push(Q)}}),this.filterAndSortMediaOptions(r,t,a,c,h)}createLevel(e){const t=new Ns(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(r.message),t.supportedResult=yv(r,[])}return t}isAudioSupported(e){return of(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return of(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,r,s){let o=[],a=[],c=e;if((n||r)&&s&&(c=c.filter(({videoCodec:w,videoRange:L,width:P,height:R})=>(!!w||!!(P&&R))&&cC(L))),c.length===0){Promise.resolve().then(()=>{if(this.hls){let w="no level with compatible codecs found in manifest",L=w;t.levels.length&&(L=`one or more CODECS in variant not supported: ${xt(t.levels.map(R=>R.attrs.CODECS).filter((R,k,F)=>F.indexOf(R)===k))}`,this.warn(L),w+=` (${L})`);const P=new Error(w);this.hls.trigger(C.ERROR,{type:Re.MEDIA_ERROR,details:se.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:P,reason:L})}});return}t.audioTracks&&(o=t.audioTracks.filter(w=>!w.audioCodec||this.isAudioSupported(w.audioCodec)),Km(o)),t.subtitles&&(a=t.subtitles,Km(a));const h=c.slice(0);c.sort((w,L)=>{if(w.attrs["HDCP-LEVEL"]!==L.attrs["HDCP-LEVEL"])return(w.attrs["HDCP-LEVEL"]||"")>(L.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&w.height!==L.height)return w.height-L.height;if(w.frameRate!==L.frameRate)return w.frameRate-L.frameRate;if(w.videoRange!==L.videoRange)return UA.indexOf(w.videoRange)-UA.indexOf(L.videoRange);if(w.videoCodec!==L.videoCodec){const P=$p(w.videoCodec),R=$p(L.videoCodec);if(P!==R)return R-P}if(w.uri===L.uri&&w.codecSet!==L.codecSet){const P=BA(w.codecSet),R=BA(L.codecSet);if(P!==R)return R-P}return w.averageBitrate!==L.averageBitrate?w.averageBitrate-L.averageBitrate:0});let d=h[0];if(this.steering&&(c=this.steering.filterParsedLevels(c),c.length!==h.length)){for(let w=0;w<h.length;w++)if(h[w].pathwayId===c[0].pathwayId){d=h[w];break}}this._levels=c;for(let w=0;w<c.length;w++)if(c[w]===d){var p;this._firstLevel=w;const L=d.bitrate,P=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${c.length} level(s) found, first bitrate: ${L}`),((p=this.hls.userConfig)==null?void 0:p.abrEwmaDefaultEstimate)===void 0){const R=Math.min(L,this.hls.config.abrEwmaDefaultEstimateMax);R>P&&P===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const y=s&&!r,T=this.hls.config,b=!!(T.audioStreamController&&T.audioTrackController),_={levels:c,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:b&&!y&&o.some(w=>!!w.url)};this.hls.trigger(C.MANIFEST_PARSED,_)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const d=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:d,reason:d.message}),p)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&r&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);const c={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(C.LEVEL_SWITCHING,c);const h=o.details;if(!h||h.live){const d=this.switchParams(o.uri,r?.details,h);this.loadPlaylist(d)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===st.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===we.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:s}=t,o=t.levelInfo;if(!o){var a;this.warn(`Invalid level index ${r}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let c=o.details;c===t.details&&c.advanced&&(c=void 0),this.playlistLoaded(r,t,c)}else(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],o=e.details,a=o?.age;this.log(`Loading level index ${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${s?" Pathway "+s:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${n}`),this.hls.trigger(C.LEVEL_LOADING,{url:n,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((s,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(a=>a.level=-1)),!1));Fv(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=n.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(C.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(C.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Km(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function GE(){return self.SourceBuffer||self.WebKitSourceBuffer}function uh(){if(!zn())return!1;const e=GE();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function VE(){if(!uh())return!1;const i=zn();return typeof i?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Wo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Wo(e,"audio"))))}function A3(){var i;const e=GE();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const l3=100;class u3 extends kl{constructor(e,t,n){super(e,t,n,"stream-controller",we.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,s=r?r.currentTime:null;if(s===null||!be(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const o=this.getFwdBufferInfoAtPos(r,s,we.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:r}=this;if(this.stopLoad(),this.setInterval(l3),this.level=-1,!this.startFragRequested){let s=r.startLevel;s===-1&&(r.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=r.firstAutoLevel),r.nextLoadLevel=s,this.level=r.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=fe.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=fe.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case fe.WAITING_LEVEL:{const{levels:e,level:t}=this,n=e?.[t],r=n?.details;if(r&&(!r.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(r))break;this.state=fe.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=fe.IDLE;break}break}case fe.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===fe.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[s]))return;const o=n[s],a=this.getMainFwdBufferInfo();if(a===null)return;const c=this.getLevelDetails();if(c&&this._streamEnded(a,c)){const _={};this.altAudio===2&&(_.type="video"),this.hls.trigger(C.BUFFER_EOS,_),this.state=fe.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const h=o.details;if(!h||this.state===fe.WAITING_LEVEL||this.waitForLive(o)){this.level=s,this.state=fe.WAITING_LEVEL,this.startFragRequested=!1;return}const d=a.len,p=this.getMaxBufferLength(o.maxBitrate);if(d>=p)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:a.end;let T=this.getNextFragment(y,h);if(this.couldBacktrack&&!this.fragPrevious&&T&&$t(T)&&this.fragmentTracker.getState(T)!==jt.OK){var b;const w=((b=this.backtrackFragment)!=null?b:T).sn-h.startSN,L=h.fragments[w-1];L&&T.cc===L.cc&&(T=L,this.fragmentTracker.removeFragment(L))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(T&&this.isLoopLoading(T,y)){if(!T.gap){const w=this.audioOnly&&!this.altAudio?St.AUDIO:St.VIDEO,L=(w===St.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;L&&this.afterBufferFlushed(L,w,we.MAIN)}T=this.getNextFragmentLoopLoading(T,h,a,we.MAIN,p)}T&&(T.initSegment&&!T.initSegment.data&&!this.bitrateTest&&(T=T.initSegment),this.loadFragment(T,o,y))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);r===jt.NOT_LOADED||r===jt.PARTIAL?$t(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,we.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,c=e[a],h=this.fragLastKbps;h&&this.fragCurrent?n=this.fragCurrent.duration*c.maxBitrate/(1e3*h)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const c=a.maxStartPTS?a.maxStartPTS:a.start,h=a.duration,d=Math.max(o.end,c+Math.min(Math.max(h-this.config.maxFragLookUpTolerance,h*(this.couldBacktrack?.5:.125)),h*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case fe.KEY_LOADING:case fe.FRAG_LOADING:case fe.FRAG_LOADING_WAITING_RETRY:case fe.PARSING:case fe.PARSED:this.state=fe.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;yi(n,"playing",this.onMediaPlaying),yi(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Ii(n,"playing",this.onMediaPlaying),Ii(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(C.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,r=!1;for(let s=0;s<t.levels.length;s++){const o=t.levels[s].audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,r=r||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&r&&!A3(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==fe.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=fe.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r,startFragRequested:s}=this,o=t.level,a=t.details,c=a.totalduration;if(!r){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${c}`);const h=t.levelInfo,d=this.fragCurrent;d&&(this.state===fe.FRAG_LOADING||this.state===fe.FRAG_LOADING_WAITING_RETRY)&&d.level!==t.level&&d.loader&&this.abortCurrentFrag();let p=0;if(a.live||(n=h.details)!=null&&n.live){var y;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;p=this.alignPlaylists(a,h.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(h.details=a,this.levelLastLoaded=h,s||this.setStartPosition(a,p),this.hls.trigger(C.LEVEL_UPDATED,{details:a,level:o}),this.state===fe.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=fe.IDLE}s&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,s=this.getLoadPosition(),o=e.fragmentStart,a=e.edge,c=s>=o-t.maxFragLookUpTolerance&&s<=a;if(r!==null&&n.duration>r&&(s<r||!c)){const d=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!c&&n.readyState<4||s<a-d)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),n.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var h;const p=Xe.bufferInfo(n,r,0);if(!((h=p.buffered)!=null&&h.length)){n.currentTime=r;return}if(p.start<=s){n.currentTime=r;return}const{nextStart:T}=Xe.bufferedInfo(p.buffered,s,0);T&&(n.currentTime=T)}else n.currentTime=r}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level];if(!a){this.warn(`Level ${n.level} not found on progress`);return}const c=a.details;if(!c){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const h=a.videoCodec,d=c.PTSKnown||!c.live,p=(t=n.initSegment)==null?void 0:t.data,y=this._getAudioCodec(a),T=this.transmuxer=this.transmuxer||new rE(this.hls,we.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),b=r?r.index:-1,_=b!==-1,w=new Pl(n.level,n.sn,n.stats.chunkCount,s.byteLength,b,_),L=this.initPTS[n.cc];T.push(s,p,y,h,n,r,c.totalduration,d,w,L)}onAudioTrackSwitching(e,t){const n=this.hls,r=this.altAudio===2;if($A(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.fragmentTracker.removeAllFragments(),n.once(C.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(C.AUDIO_TRACK_SWITCHED,t)}),n.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(C.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=$A(t.url,this.hls);if(n){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,s,o=!1;for(const a in n){const c=n[a];if(c.id==="main"){if(s=a,r=c,a==="video"){const h=n[a];h&&(this.videoBuffer=h.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t,s=n.type===we.MAIN;if(s){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===fe.PARSED&&(this.state=fe.IDLE);return}const a=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),$t(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}const o=this.media;o&&(!this._hasEnoughToStart&&Xe.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=fe.ERROR;return}switch(t.details){case se.FRAG_GAP:case se.FRAG_PARSING_ERROR:case se.FRAG_DECRYPT_ERROR:case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(we.MAIN,t);break;case se.LEVEL_LOAD_ERROR:case se.LEVEL_LOAD_TIMEOUT:case se.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===fe.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===st.LEVEL&&(this.state=fe.IDLE);break;case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case se.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case se.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=fe.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==St.AUDIO||!this.altAudio){const n=(t===St.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,we.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&n&&(n+=r);const s=this.getLevelDetails(),o=Xe.getBuffered(e),a=o.length?o.start(0):0,c=a-n,h=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||c>0&&(c<h||this.loadingParts&&c<2*(s?.partTarget||0)))&&(this.log(`adjusting start position by ${c} to match buffer start`),n+=c,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${a}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this,s=n?.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=fe.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=s.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),r.trigger(C.FRAG_LOADED,n),s.bitrateTest=!1}).catch(n=>{this.state===fe.STOPPED||this.state===fe.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:s}=e,o=this.getCurrentContext(s);if(!o){this.resetWhenMissingContext(s);return}const{frag:a,part:c,level:h}=o,{video:d,text:p,id3:y,initSegment:T}=r,{details:b}=h,_=this.altAudio?void 0:r.audio;if(this.fragContextChanged(a)){this.fragmentTracker.removeFragment(a);return}if(this.state=fe.PARSING,T){const w=T.tracks;if(w){const k=a.initSegment||a;if(this.unhandledEncryptionError(T,a))return;this._bufferInitSegment(h,w,k,s),n.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:k,id:t,tracks:w})}const L=T.initPTS,P=T.timescale,R=this.initPTS[a.cc];if(be(L)&&(!R||R.baseTime!==L||R.timescale!==P)){const k=T.trackId;this.initPTS[a.cc]={baseTime:L,timescale:P,trackId:k},n.trigger(C.INIT_PTS_FOUND,{frag:a,id:t,initPTS:L,timescale:P,trackId:k})}}if(d&&b){_&&d.type==="audiovideo"&&this.logMuxedErr(a);const w=b.fragments[a.sn-1-b.startSN],L=a.sn===b.startSN,P=!w||a.cc>w.cc;if(r.independent!==!1){const{startPTS:R,endPTS:k,startDTS:F,endDTS:U}=d;if(c)c.elementaryStreams[d.type]={startPTS:R,endPTS:k,startDTS:F,endDTS:U};else if(d.firstKeyFrame&&d.independent&&s.id===1&&!P&&(this.couldBacktrack=!0),d.dropped&&d.independent){const $=this.getMainFwdBufferInfo(),G=($?$.end:this.getLoadPosition())+this.config.maxBufferHole,W=d.firstKeyFramePTS?d.firstKeyFramePTS:R;if(!L&&G<W-this.config.maxBufferHole&&!P){this.backtrack(a);return}else P&&(a.gap=!0);a.setElementaryStreamInfo(d.type,a.start,k,a.start,U,!0)}else L&&R-(b.appliedTimelineOffset||0)>_A&&(a.gap=!0);a.setElementaryStreamInfo(d.type,R,k,F,U),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(d,a,c,s,L||P)}else if(L||P)a.gap=!0;else{this.backtrack(a);return}}if(_){const{startPTS:w,endPTS:L,startDTS:P,endDTS:R}=_;c&&(c.elementaryStreams[St.AUDIO]={startPTS:w,endPTS:L,startDTS:P,endDTS:R}),a.setElementaryStreamInfo(St.AUDIO,w,L,P,R),this.bufferFragmentData(_,a,c,s)}if(b&&y!=null&&y.samples.length){const w={id:t,frag:a,details:b,samples:y.samples};n.trigger(C.FRAG_PARSING_METADATA,w)}if(b&&p){const w={id:t,frag:a,details:b,samples:p.samples};n.trigger(C.FRAG_PARSING_USERDATA,w)}}logMuxedErr(e){this.warn(`${$t(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,r){if(this.state!==fe.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:s,video:o,audiovideo:a}=t;if(s){const h=e.audioCodec;let d=vA(s.codec,h);d==="mp4a"&&(d="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){d&&(d.indexOf("mp4a.40.5")!==-1?d="mp4a.40.2":d="mp4a.40.5");const y=s.metadata;y&&"channelCount"in y&&(y.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(d="mp4a.40.5")}d&&d.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),h&&h!==d&&this.log(`Swapping manifest audio codec "${h}" for "${d}"`),s.levelCodec=d,s.id=we.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${d||""}/${h||""}/${s.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=we.MAIN;const h=o.codec;if(h?.length===4)switch(h){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${h}]${o.codec!==h?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const c=Object.keys(t);if(c.length){if(this.hls.trigger(C.BUFFER_CODECS,t),!this.hls)return;c.forEach(h=>{const p=t[h].initSegment;p!=null&&p.byteLength&&this.hls.trigger(C.BUFFER_APPENDING,{type:h,data:p,frag:n,part:null,chunkMeta:r,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,we.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e?.[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=fe.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Xe.isBuffered(e,n)?t=this.getAppendedFrag(n):Xe.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(C.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(C.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return be(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(be(t)){const n=this.getLevelDetails(),r=this.currentFrag||(n?Qr(null,n.fragments,t):null);if(r){const s=r.programDateTime;if(s!==null){const o=s+(t-r.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class f3 extends tn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=se.KEY_LOAD_ERROR,n,r,s){return new Gn({type:Re.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let r=0,s=t.length;r<s;r++){const o=t[r];if(e.cc<=o.cc&&(!$t(e)||!$t(o)||e.sn<o.sn)||!n&&r==s-1)return this.emeController.selectKeySystemFormat(o).then(a=>{if(!this.emeController)return;o.setKeyFormat(a);const c=EA(a);if(c)return this.emeController.getKeySystemAccess([c])})}if(this.config.requireKeySystemAccessOnStart){const r=So(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,d))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const a=p0(s);let c=this.keyIdToKeyInfo[a];if((n=c)!=null&&n.decryptdata.key)return s.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((r=c)!=null&&r.keyLoadPromise){var h;switch((h=c.mediaKeySessionContext)==null?void 0:h.keyStatus){case"usable":case"usable-in-future":return c.keyLoadPromise.then(p=>{const{keyInfo:y}=p;return s.key=y.decryptdata.key,{frag:e,keyInfo:y}})}}switch(this.log(`Loading key ${Oi(s.keyId||[])} from ${e.type} ${e.level}`),c=this.keyIdToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(n);return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s.data&&(s.data.frag=t),s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,s=new r(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const c={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},h=n.keyLoadPolicy.default,d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,T,b,_)=>{const{frag:w,keyInfo:L,url:P}=b,R=p0(L.decryptdata)||P;if(!w.decryptdata||L!==this.keyIdToKeyInfo[R])return a(this.createKeyLoadError(w,se.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),_));L.decryptdata.key=w.decryptdata.key=new Uint8Array(y.data),w.keyLoader=null,L.loader=null,o({frag:w,keyInfo:L})},onError:(y,T,b,_)=>{this.resetLoader(T),a(this.createKeyLoadError(t,se.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),b,yt({url:c.url,data:void 0},y)))},onTimeout:(y,T,b)=>{this.resetLoader(T),a(this.createKeyLoadError(t,se.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),b))},onAbort:(y,T,b)=>{this.resetLoader(T),a(this.createKeyLoadError(t,se.INTERNAL_ABORTED,new Error("key loading aborted"),b))}};s.load(c,d,p)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null);const o=p0(n.decryptdata)||r;delete this.keyIdToKeyInfo[o],s&&s.destroy()}}function p0(i){const e=i.keyId;return e?Oi(e):i.uri}function Qm(i){const{type:e}=i;switch(e){case st.AUDIO_TRACK:return we.AUDIO;case st.SUBTITLE_TRACK:return we.SUBTITLE;default:return we.MAIN}}function m0(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class c3{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,s=n||r,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:st.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:s,url:o,deliveryDirectives:a,levelInfo:c}=t;this.load({id:n,level:r,pathwayId:s,responseType:"text",type:st.LEVEL,url:o,deliveryDirectives:a,levelOrTrack:c})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o,track:a}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:st.AUDIO_TRACK,url:s,deliveryDirectives:o,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o,track:a}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:st.SUBTITLE_TRACK,url:s,deliveryDirectives:o,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[st.LEVEL];if(n){const r=n.context;r&&!t.levels.some(s=>s===r.levelOrTrack)&&(n.abort(),delete this.loaders[st.LEVEL])}}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const h=this.hls.logger,d=r.context;if(d&&d.levelOrTrack===e.levelOrTrack&&(d.url===e.url||d.deliveryDirectives&&!e.deliveryDirectives)){d.url===e.url?h.log(`[playlist-loader]: ignore ${e.url} ongoing request`):h.log(`[playlist-loader]: ignore ${e.url} in favor of ${d.url}`);return}h.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===st.MANIFEST?s=n.manifestLoadPolicy.default:s=Et({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),be((t=e.deliveryDirectives)==null?void 0:t.part)){let h;if(e.type===st.LEVEL&&e.level!==null?h=this.hls.levels[e.level].details:e.type===st.AUDIO_TRACK&&e.id!==null?h=this.hls.audioTracks[e.id].details:e.type===st.SUBTITLE_TRACK&&e.id!==null&&(h=this.hls.subtitleTracks[e.id].details),h){const d=h.partTarget,p=h.targetduration;if(d&&p){const y=Math.max(d*3,p*.8)*1e3;s=Et({},s,{maxTimeToFirstByteMs:Math.min(y,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(h,d,p,y)=>{const T=this.getInternalLoader(p);this.resetInternalLoader(p.type);const b=h.data;if(b.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(h,p,new Error("no EXTM3U delimiter"),y||null,d);return}d.parsing.start=performance.now(),cn.isMediaPlaylist(b)||p.type!==st.MANIFEST?this.handleTrackOrLevelPlaylist(h,d,p,y||null,T):this.handleMasterPlaylist(h,d,p,y)},onError:(h,d,p,y)=>{this.handleNetworkError(d,p,!1,h,y)},onTimeout:(h,d,p)=>{this.handleNetworkError(d,p,!0,void 0,h)}};r.load(e,a,c)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,r){const s=this.hls,o=e.data,a=m0(e,n),c=cn.parseMasterPlaylist(o,a);if(c.playlistParsingError){this.handleManifestParsingError(e,n,c.playlistParsingError,r,t);return}const{contentSteering:h,levels:d,sessionData:p,sessionKeys:y,startTimeOffset:T,variableList:b}=c;this.variableList=b;const{AUDIO:_=[],SUBTITLES:w,"CLOSED-CAPTIONS":L}=cn.parseMasterPlaylistMedia(o,a,c);_.length&&!_.some(R=>!R.url)&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),_.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new wt({}),bitrate:0,url:""})),s.trigger(C.MANIFEST_LOADED,{levels:d,audioTracks:_,subtitles:w,captions:L,contentSteering:h,url:a,stats:t,networkDetails:r,sessionData:p,sessionKeys:y,startTimeOffset:T,variableList:b})}handleTrackOrLevelPlaylist(e,t,n,r,s){const o=this.hls,{id:a,level:c,type:h}=n,d=m0(e,n),p=be(c)?c:be(a)?a:0,y=Qm(n),T=cn.parseLevelPlaylist(e.data,d,p,y,0,this.variableList);if(h===st.MANIFEST){const b={attrs:new wt({}),bitrate:0,details:T,name:"",url:d};T.requestScheduled=t.loading.start+kv(T,0),o.trigger(C.MANIFEST_LOADED,{levels:[b],audioTracks:[],url:d,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=T,this.handlePlaylistLoaded(T,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(C.ERROR,{type:Re.NETWORK_ERROR,details:se.MANIFEST_PARSING_ERROR,fatal:t.type===st.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===st.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===st.AUDIO_TRACK||e.type===st.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let c=se.UNKNOWN,h=!1;const d=this.getInternalLoader(e);switch(e.type){case st.MANIFEST:c=n?se.MANIFEST_LOAD_TIMEOUT:se.MANIFEST_LOAD_ERROR,h=!0;break;case st.LEVEL:c=n?se.LEVEL_LOAD_TIMEOUT:se.LEVEL_LOAD_ERROR,h=!1;break;case st.AUDIO_TRACK:c=n?se.AUDIO_TRACK_LOAD_TIMEOUT:se.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case st.SUBTITLE_TRACK:c=n?se.SUBTITLE_TRACK_LOAD_TIMEOUT:se.SUBTITLE_LOAD_ERROR,h=!1;break}d&&this.resetInternalLoader(e.type);const p={type:Re.NETWORK_ERROR,details:c,fatal:h,url:e.url,loader:d,context:e,error:a,networkDetails:t,stats:s};if(r){const y=t?.url||e.url;p.response=yt({url:y,data:void 0},r)}this.hls.trigger(C.ERROR,p)}handlePlaylistLoaded(e,t,n,r,s,o){const a=this.hls,{type:c,level:h,id:d,groupId:p,deliveryDirectives:y}=r,T=m0(t,r),b=Qm(r),_=typeof r.level=="number"&&b===we.MAIN?h:void 0;if(!e.fragments.length){const L=e.playlistParsingError=new Error("No Segments found in Playlist");a.trigger(C.ERROR,{type:Re.NETWORK_ERROR,details:se.LEVEL_EMPTY_ERROR,fatal:!1,url:T,error:L,reason:L.message,response:t,context:r,level:_,parent:b,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const w=e.playlistParsingError;if(w){if(this.hls.logger.warn(`${w} ${e.url}`),!a.config.ignorePlaylistParsingErrors){a.trigger(C.ERROR,{type:Re.NETWORK_ERROR,details:se.LEVEL_PARSING_ERROR,fatal:!1,url:T,error:w,reason:w.message,response:t,context:r,level:_,parent:b,networkDetails:s,stats:n});return}e.playlistParsingError=null}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),c){case st.MANIFEST:case st.LEVEL:a.trigger(C.LEVEL_LOADED,{details:e,levelInfo:r.levelOrTrack||a.levels[0],level:_||0,id:d||0,stats:n,networkDetails:s,deliveryDirectives:y,withoutMultiVariant:c===st.MANIFEST});break;case st.AUDIO_TRACK:a.trigger(C.AUDIO_TRACK_LOADED,{details:e,track:r.levelOrTrack,id:d||0,groupId:p||"",stats:n,networkDetails:s,deliveryDirectives:y});break;case st.SUBTITLE_TRACK:a.trigger(C.SUBTITLE_TRACK_LOADED,{details:e,track:r.levelOrTrack,id:d||0,groupId:p||"",stats:n,networkDetails:s,deliveryDirectives:y});break}}}class jn{static get version(){return Yo}static isMSESupported(){return uh()}static isSupported(){return VE()}static getMediaSource(){return zn()}static get Events(){return C}static get MetadataSchema(){return xi}static get ErrorTypes(){return Re}static get ErrorDetails(){return se}static get DefaultConfig(){return jn.defaultConfig?jn.defaultConfig:qM}static set DefaultConfig(e){jn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Zc,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=FD(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=ZM(jn.DefaultConfig,e,t);this.userConfig=e,n.progressive&&JM(n,t);const{abrController:r,bufferController:s,capLevelController:o,errorController:a,fpsController:c}=n,h=new a(this),d=this.abrController=new r(this),p=new _C(this),y=n.interstitialsController,T=y?this.interstitialsController=new y(this,jn):null,b=this.bufferController=new s(this,p),_=this.capLevelController=new o(this),w=new c(this),L=new c3(this),P=n.contentSteeringController,R=P?new P(this):null,k=this.levelController=new a3(this,R),F=new s3(this),U=new f3(this.config,this.logger),$=this.streamController=new u3(this,p,U),G=this.gapController=new n3(this,p);_.setStreamController($),w.setStreamController($);const W=[L,k,$];T&&W.splice(1,0,T),R&&W.splice(1,0,R),this.networkControllers=W;const Q=[d,b,G,_,w,F,p];this.audioTrackController=this.createController(n.audioTrackController,W);const K=n.audioStreamController;K&&W.push(this.audioStreamController=new K(this,p,U)),this.subtitleTrackController=this.createController(n.subtitleTrackController,W);const te=n.subtitleStreamController;te&&W.push(this.subtititleStreamController=new te(this,p,U)),this.createController(n.timelineController,Q),U.emeController=this.emeController=this.createController(n.emeController,Q),this.cmcdController=this.createController(n.cmcdController,Q),this.latencyController=this.createController(o3,Q),this.coreComponents=Q,W.push(h);const oe=h.onErrorOut;typeof oe=="function"&&this.on(C.ERROR,oe,h),this.on(C.MANIFEST_LOADED,L.onManifestLoaded,L)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===C.ERROR;this.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(C.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(C.ERROR,{type:Re.OTHER_ERROR,details:se.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,r=t?e:{media:n};this._media=n,this.trigger(C.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(C.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(C.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,r=this._url=Gc.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(C.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[we.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[we.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[we.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=aM()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){fC(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let s=r;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=n)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=Tv(t);return vv(e,n,navigator.mediaCapabilities)}}jn.defaultConfig=void 0;const DU=Object.freeze(Object.defineProperty({__proto__:null,AbrController:Sv,AttrList:wt,AudioStreamController:sE,AudioTrackController:aE,BasePlaylistController:Ol,BaseSegment:Vc,BaseStreamController:kl,BufferController:lE,CMCDController:EE,CapLevelController:Fl,ChunkMetadata:Pl,ContentSteeringController:TE,Cues:UE,DateRange:Yc,EMEController:Hr,ErrorActionFlags:bi,ErrorController:_v,ErrorDetails:se,ErrorTypes:Re,Events:C,FPSController:bE,FetchLoader:bf,Fragment:yA,Hls:jn,HlsSkip:Oo,HlsUrlParameters:lf,KeySystemFormats:hi,KeySystems:Dt,Level:Ns,LevelDetails:Lv,LevelKey:ga,LoadStats:Dl,M3U8Parser:cn,MetadataSchema:xi,NetworkErrorAction:Ht,Part:Av,PlaylistLevelType:we,SubtitleStreamController:LE,SubtitleTrackController:wE,TimelineController:BE,XhrLoader:lh,default:jn,fetchSupported:$E,getMediaSource:zn,isMSESupported:uh,isSupported:VE,requestMediaKeySystemAccess:Xc},Symbol.toStringTag,{value:"Module"}));class pa{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const h3=()=>{if(!(typeof localStorage>"u"))return{get:i=>Promise.resolve(localStorage.getItem(i)),set:(i,e)=>Promise.resolve(localStorage.setItem(i,e)),remove:i=>Promise.resolve(localStorage.removeItem(i))}},ti={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:h3()},fh=i=>i?typeof i=="string"?{publicKey:i}:i.toString()==="[object Object]"?i:{}:{},d3=(i,e="https://api.emailjs.com")=>{if(!i)return;const t=fh(i);ti.publicKey=t.publicKey,ti.blockHeadless=t.blockHeadless,ti.storageProvider=t.storageProvider,ti.blockList=t.blockList,ti.limitRate=t.limitRate,ti.origin=t.origin||e},HE=async(i,e,t={})=>{const n=await fetch(ti.origin+i,{method:"POST",headers:t,body:e}),r=await n.text(),s=new pa(n.status,r);if(n.ok)return s;throw s},jE=(i,e,t)=>{if(!i||typeof i!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},g3=i=>{if(i&&i.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},KE=i=>i.webdriver||!i.languages||i.languages.length===0,QE=()=>new pa(451,"Unavailable For Headless Browser"),p3=(i,e)=>{if(!Array.isArray(i))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},m3=i=>!i.list?.length||!i.watchVariable,y3=(i,e)=>i instanceof FormData?i.get(e):i[e],WE=(i,e)=>{if(m3(i))return!1;p3(i.list,i.watchVariable);const t=y3(e,i.watchVariable);return typeof t!="string"?!1:i.list.includes(t)},YE=()=>new pa(403,"Forbidden"),v3=(i,e)=>{if(typeof i!="number"||i<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},E3=async(i,e,t)=>{const n=Number(await t.get(i)||0);return e-Date.now()+n},zE=async(i,e,t)=>{if(!e.throttle||!t)return!1;v3(e.throttle,e.id);const n=e.id||i;return await E3(n,e.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)},qE=()=>new pa(429,"Too Many Requests"),T3=async(i,e,t,n)=>{const r=fh(n),s=r.publicKey||ti.publicKey,o=r.blockHeadless||ti.blockHeadless,a=r.storageProvider||ti.storageProvider,c={...ti.blockList,...r.blockList},h={...ti.limitRate,...r.limitRate};return o&&KE(navigator)?Promise.reject(QE()):(jE(s,i,e),g3(t),t&&WE(c,t)?Promise.reject(YE()):await zE(location.pathname,h,a)?Promise.reject(qE()):HE("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:i,template_id:e,template_params:t}),{"Content-type":"application/json"}))},S3=i=>{if(!i||i.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},b3=i=>typeof i=="string"?document.querySelector(i):i,x3=async(i,e,t,n)=>{const r=fh(n),s=r.publicKey||ti.publicKey,o=r.blockHeadless||ti.blockHeadless,a=ti.storageProvider||r.storageProvider,c={...ti.blockList,...r.blockList},h={...ti.limitRate,...r.limitRate};if(o&&KE(navigator))return Promise.reject(QE());const d=b3(t);jE(s,i,e),S3(d);const p=new FormData(d);return WE(c,p)?Promise.reject(YE()):await zE(location.pathname,h,a)?Promise.reject(qE()):(p.append("lib_version","4.4.1"),p.append("service_id",i),p.append("template_id",e),p.append("user_id",s),HE("/api/v1.0/email/send-form",p))},CU={init:d3,send:T3,sendForm:x3,EmailJSResponseStatus:pa};function _3(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function w3(i,e,t){return e=M3(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Wm(i,e){return R3(i)||_3(i,e)||XE(i,e)||P3()}function I3(i){return L3(i)||D3(i)||XE(i)||C3()}function L3(i){if(Array.isArray(i))return wf(i)}function R3(i){if(Array.isArray(i))return i}function D3(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function XE(i,e){if(i){if(typeof i=="string")return wf(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wf(i,e)}}function wf(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function C3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k3(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function M3(i){var e=k3(i,"string");return typeof e=="symbol"?e:String(e)}var PU=function(e,t){var n=new Set(t);return Object.assign.apply(Object,[{}].concat(I3(Object.entries(e).filter(function(r){var s=Wm(r,1),o=s[0];return!n.has(o)}).map(function(r){var s=Wm(r,2),o=s[0],a=s[1];return w3({},o,a)}))))};function If(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var O3=typeof global=="object"&&global&&global.Object===Object&&global,F3=typeof self=="object"&&self&&self.Object===Object&&self,ZE=O3||F3||Function("return this")(),y0=function(){return ZE.Date.now()},B3=/\s/;function N3(i){for(var e=i.length;e--&&B3.test(i.charAt(e)););return e}var U3=/^\s+/;function $3(i){return i&&i.slice(0,N3(i)+1).replace(U3,"")}var WA=ZE.Symbol,JE=Object.prototype,G3=JE.hasOwnProperty,V3=JE.toString,po=WA?WA.toStringTag:void 0;function H3(i){var e=G3.call(i,po),t=i[po];try{i[po]=void 0;var n=!0}catch{}var r=V3.call(i);return n&&(e?i[po]=t:delete i[po]),r}var j3=Object.prototype,K3=j3.toString;function Q3(i){return K3.call(i)}var W3="[object Null]",Y3="[object Undefined]",Ym=WA?WA.toStringTag:void 0;function z3(i){return i==null?i===void 0?Y3:W3:Ym&&Ym in Object(i)?H3(i):Q3(i)}function q3(i){return i!=null&&typeof i=="object"}var X3="[object Symbol]";function Z3(i){return typeof i=="symbol"||q3(i)&&z3(i)==X3}var zm=NaN,J3=/^[-+]0x[0-9a-f]+$/i,eO=/^0b[01]+$/i,tO=/^0o[0-7]+$/i,iO=parseInt;function qm(i){if(typeof i=="number")return i;if(Z3(i))return zm;if(If(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=If(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=$3(i);var t=eO.test(i);return t||tO.test(i)?iO(i.slice(2),t?2:8):J3.test(i)?zm:+i}var nO="Expected a function",rO=Math.max,sO=Math.min;function oO(i,e,t){var n,r,s,o,a,c,h=0,d=!1,p=!1,y=!0;if(typeof i!="function")throw new TypeError(nO);e=qm(e)||0,If(t)&&(d=!!t.leading,p="maxWait"in t,s=p?rO(qm(t.maxWait)||0,e):s,y="trailing"in t?!!t.trailing:y);function T(U){var $=n,G=r;return n=r=void 0,h=U,o=i.apply(G,$),o}function b(U){return h=U,a=setTimeout(L,e),d?T(U):o}function _(U){var $=U-c,G=U-h,W=e-$;return p?sO(W,s-G):W}function w(U){var $=U-c,G=U-h;return c===void 0||$>=e||$<0||p&&G>=s}function L(){var U=y0();if(w(U))return P(U);a=setTimeout(L,_(U))}function P(U){return a=void 0,y&&n?T(U):(n=r=void 0,o)}function R(){a!==void 0&&clearTimeout(a),h=0,n=c=r=a=void 0}function k(){return a===void 0?o:P(y0())}function F(){var U=y0(),$=w(U);if(n=arguments,r=this,c=U,$){if(a===void 0)return b(c);if(p)return clearTimeout(a),a=setTimeout(L,e),T(c)}return a===void 0&&(a=setTimeout(L,e)),o}return F.cancel=R,F.flush=k,F}function Xm(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function aO(i){if(Array.isArray(i))return i}function AO(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function lO(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function uO(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(c=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function fO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cO(i,e){return aO(i)||uO(i,e)||hO(i,e)||fO()}function hO(i,e){if(i){if(typeof i=="string")return Xm(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Xm(i,e):void 0}}var dO=lO(function i(e,t){var n=t.default,r=n===void 0?null:n,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,c=a===void 0?function(h,d){}:a;AO(this,i),this.name=e,this.defaultVal=r,this.triggerUpdate=o,this.onChange=c});function eT(i){var e=i.stateInit,t=e===void 0?function(){return{}}:e,n=i.props,r=n===void 0?{}:n,s=i.methods,o=s===void 0?{}:s,a=i.aliases,c=a===void 0?{}:a,h=i.init,d=h===void 0?function(){}:h,p=i.update,y=p===void 0?function(){}:p,T=Object.keys(r).map(function(b){return new dO(b,r[b])});return function b(){for(var _=arguments.length,w=new Array(_),L=0;L<_;L++)w[L]=arguments[L];var P=!!(this instanceof b&&this.constructor),R=P?w.shift():void 0,k=w[0],F=k===void 0?{}:k,U=Object.assign({},t instanceof Function?t(F):t,{initialised:!1}),$={};function G(K){return W(K,F),Q(),G}var W=function(te,oe){d.call(G,te,U,oe),U.initialised=!0},Q=oO(function(){U.initialised&&(y.call(G,U,$),$={})},1);return T.forEach(function(K){G[K.name]=te(K);function te(oe){var Ae=oe.name,X=oe.triggerUpdate,Y=X===void 0?!1:X,ee=oe.onChange,re=ee===void 0?function(ge,pe){}:ee,ue=oe.defaultVal,Te=ue===void 0?null:ue;return function(ge){var pe=U[Ae];if(!arguments.length)return pe;var De=ge===void 0?Te:ge;return U[Ae]=De,re.call(G,De,U,pe),!$.hasOwnProperty(Ae)&&($[Ae]=pe),Y&&Q(),G}}}),Object.keys(o).forEach(function(K){G[K]=function(){for(var te,oe=arguments.length,Ae=new Array(oe),X=0;X<oe;X++)Ae[X]=arguments[X];return(te=o[K]).call.apply(te,[G,U].concat(Ae))}}),Object.entries(c).forEach(function(K){var te=cO(K,2),oe=te[0],Ae=te[1];return G[oe]=G[Ae]}),G.resetProps=function(){return T.forEach(function(K){G[K.name](K.defaultVal)}),G},G.resetProps(),U._rerender=Q,P&&R&&G(R),G}}var Ps=Object.freeze({Linear:Object.freeze({None:function(i){return i},In:function(i){return i},Out:function(i){return i},InOut:function(i){return i}}),Quadratic:Object.freeze({In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}}),Cubic:Object.freeze({In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}}),Quartic:Object.freeze({In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}}),Quintic:Object.freeze({In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}}),Sinusoidal:Object.freeze({In:function(i){return 1-Math.sin((1-i)*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))}}),Exponential:Object.freeze({In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}}),Circular:Object.freeze({In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}}),Elastic:Object.freeze({In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(i){var e=1.70158;return i===1?1:i*i*((e+1)*i-e)},Out:function(i){var e=1.70158;return i===0?0:--i*i*((e+1)*i+e)+1},InOut:function(i){var e=2.5949095;return(i*=2)<1?.5*(i*i*((e+1)*i-e)):.5*((i-=2)*i*((e+1)*i+e)+2)}}),Bounce:Object.freeze({In:function(i){return 1-Ps.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?Ps.Bounce.In(i*2)*.5:Ps.Bounce.Out(i*2-1)*.5+.5}}),generatePow:function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:function(e){return Math.pow(e,i)},Out:function(e){return 1-Math.pow(1-e,i)},InOut:function(e){return e<.5?Math.pow(e*2,i)/2:(1-Math.pow(2-e*2,i))/2+.5}}}}),bo=function(){return performance.now()},tT=(function(){function i(){this._tweens={},this._tweensAddedDuringUpdate={}}return i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},i.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},i.prototype.update=function(e,t){e===void 0&&(e=bo()),t===void 0&&(t=!1);var n=Object.keys(this._tweens);if(n.length===0)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var s=this._tweens[n[r]],o=!t;s&&s.update(e,o)===!1&&!t&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},i})(),Lf={Linear:function(i,e){var t=i.length-1,n=t*e,r=Math.floor(n),s=Lf.Utils.Linear;return e<0?s(i[0],i[1],n):e>1?s(i[t],i[t-1],t-n):s(i[r],i[r+1>t?t:r+1],n-r)},Utils:{Linear:function(i,e,t){return(e-i)*t+i}}},iT=(function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i})(),Rf=new tT,gO=(function(){function i(e,t){t===void 0&&(t=Rf),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ps.Linear.None,this._interpolationFunction=Lf.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=iT.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.getDuration=function(){return this._duration},i.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},i.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},i.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},i.prototype.start=function(e,t){if(e===void 0&&(e=bo()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},i.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},i.prototype._setupProperties=function(e,t,n,r,s){for(var o in n){var a=e[o],c=Array.isArray(a),h=c?"array":typeof a,d=!c&&Array.isArray(n[o]);if(!(h==="undefined"||h==="function")){if(d){var p=n[o];if(p.length===0)continue;for(var y=[a],T=0,b=p.length;T<b;T+=1){var _=this._handleRelativeValue(a,p[T]);if(isNaN(_)){d=!1;break}y.push(_)}d&&(n[o]=y)}if((h==="object"||c)&&a&&!d){t[o]=c?[]:{};var w=a;for(var L in w)t[o][L]=w[L];r[o]=c?[]:{};var p=n[o];if(!this._isDynamic){var P={};for(var L in p)P[L]=p[L];n[o]=p=P}this._setupProperties(w,t[o],p,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),c||(t[o]*=1),d?r[o]=n[o].slice().reverse():r[o]=t[o]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},i.prototype.pause=function(e){return e===void 0&&(e=bo()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},i.prototype.resume=function(e){return e===void 0&&(e=bo()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},i.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},i.prototype.group=function(e){return e===void 0&&(e=Rf),this._group=e,this},i.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},i.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},i.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},i.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},i.prototype.easing=function(e){return e===void 0&&(e=Ps.Linear.None),this._easingFunction=e,this},i.prototype.interpolation=function(e){return e===void 0&&(e=Lf.Linear),this._interpolationFunction=e,this},i.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},i.prototype.onStart=function(e){return this._onStartCallback=e,this},i.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},i.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},i.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},i.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},i.prototype.onStop=function(e){return this._onStopCallback=e,this},i.prototype.update=function(e,t){var n=this,r;if(e===void 0&&(e=bo()),t===void 0&&(t=!0),this._isPaused)return!0;var s,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=e-this._startTime,c=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),h=this._duration+this._repeat*c,d=function(){if(n._duration===0||a>h)return 1;var w=Math.trunc(a/c),L=a-w*c,P=Math.min(L/n._duration,1);return P===0&&a===n._duration?1:P},p=d(),y=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,y),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||a>=this._duration)if(this._repeat>0){var T=Math.min(Math.trunc((a-this._duration)/c)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=T);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=c*T,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var b=0,_=this._chainedTweens.length;b<_;b++)this._chainedTweens[b].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(e,t,n,r){for(var s in n)if(t[s]!==void 0){var o=t[s]||0,a=n[s],c=Array.isArray(e[s]),h=Array.isArray(a),d=!c&&h;d?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},i.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},i.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},i})();iT.nextId;var Cn=Rf;Cn.getAll.bind(Cn);Cn.removeAll.bind(Cn);Cn.add.bind(Cn);Cn.remove.bind(Cn);Cn.update.bind(Cn);function pO(i){const e=+this._x.call(null,i),t=+this._y.call(null,i),n=+this._z.call(null,i);return nT(this.cover(e,t,n),e,t,n,i)}function nT(i,e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n))return i;var s,o=i._root,a={data:r},c=i._x0,h=i._y0,d=i._z0,p=i._x1,y=i._y1,T=i._z1,b,_,w,L,P,R,k,F,U,$,G;if(!o)return i._root=a,i;for(;o.length;)if((k=e>=(b=(c+p)/2))?c=b:p=b,(F=t>=(_=(h+y)/2))?h=_:y=_,(U=n>=(w=(d+T)/2))?d=w:T=w,s=o,!(o=o[$=U<<2|F<<1|k]))return s[$]=a,i;if(L=+i._x.call(null,o.data),P=+i._y.call(null,o.data),R=+i._z.call(null,o.data),e===L&&t===P&&n===R)return a.next=o,s?s[$]=a:i._root=a,i;do s=s?s[$]=new Array(8):i._root=new Array(8),(k=e>=(b=(c+p)/2))?c=b:p=b,(F=t>=(_=(h+y)/2))?h=_:y=_,(U=n>=(w=(d+T)/2))?d=w:T=w;while(($=U<<2|F<<1|k)===(G=(R>=w)<<2|(P>=_)<<1|L>=b));return s[G]=o,s[$]=a,i}function mO(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,t=new Float64Array(e),n=new Float64Array(e),r=new Float64Array(e);let s=1/0,o=1/0,a=1/0,c=-1/0,h=-1/0,d=-1/0;for(let p=0,y,T,b,_;p<e;++p)isNaN(T=+this._x.call(null,y=i[p]))||isNaN(b=+this._y.call(null,y))||isNaN(_=+this._z.call(null,y))||(t[p]=T,n[p]=b,r[p]=_,T<s&&(s=T),T>c&&(c=T),b<o&&(o=b),b>h&&(h=b),_<a&&(a=_),_>d&&(d=_));if(s>c||o>h||a>d)return this;this.cover(s,o,a).cover(c,h,d);for(let p=0;p<e;++p)nT(this,t[p],n[p],r[p],i[p]);return this}function yO(i,e,t){if(isNaN(i=+i)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._z0,o=this._x1,a=this._y1,c=this._z1;if(isNaN(n))o=(n=Math.floor(i))+1,a=(r=Math.floor(e))+1,c=(s=Math.floor(t))+1;else{for(var h=o-n||1,d=this._root,p,y;n>i||i>=o||r>e||e>=a||s>t||t>=c;)switch(y=(t<s)<<2|(e<r)<<1|i<n,p=new Array(8),p[y]=d,d=p,h*=2,y){case 0:o=n+h,a=r+h,c=s+h;break;case 1:n=o-h,a=r+h,c=s+h;break;case 2:o=n+h,r=a-h,c=s+h;break;case 3:n=o-h,r=a-h,c=s+h;break;case 4:o=n+h,a=r+h,s=c-h;break;case 5:n=o-h,a=r+h,s=c-h;break;case 6:o=n+h,r=a-h,s=c-h;break;case 7:n=o-h,r=a-h,s=c-h;break}this._root&&this._root.length&&(this._root=d)}return this._x0=n,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=c,this}function vO(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function EO(i){return arguments.length?this.cover(+i[0][0],+i[0][1],+i[0][2]).cover(+i[1][0],+i[1][1],+i[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Tt(i,e,t,n,r,s,o){this.node=i,this.x0=e,this.y0=t,this.z0=n,this.x1=r,this.y1=s,this.z1=o}function TO(i,e,t,n){var r,s=this._x0,o=this._y0,a=this._z0,c,h,d,p,y,T,b=this._x1,_=this._y1,w=this._z1,L=[],P=this._root,R,k;for(P&&L.push(new Tt(P,s,o,a,b,_,w)),n==null?n=1/0:(s=i-n,o=e-n,a=t-n,b=i+n,_=e+n,w=t+n,n*=n);R=L.pop();)if(!(!(P=R.node)||(c=R.x0)>b||(h=R.y0)>_||(d=R.z0)>w||(p=R.x1)<s||(y=R.y1)<o||(T=R.z1)<a))if(P.length){var F=(c+p)/2,U=(h+y)/2,$=(d+T)/2;L.push(new Tt(P[7],F,U,$,p,y,T),new Tt(P[6],c,U,$,F,y,T),new Tt(P[5],F,h,$,p,U,T),new Tt(P[4],c,h,$,F,U,T),new Tt(P[3],F,U,d,p,y,$),new Tt(P[2],c,U,d,F,y,$),new Tt(P[1],F,h,d,p,U,$),new Tt(P[0],c,h,d,F,U,$)),(k=(t>=$)<<2|(e>=U)<<1|i>=F)&&(R=L[L.length-1],L[L.length-1]=L[L.length-1-k],L[L.length-1-k]=R)}else{var G=i-+this._x.call(null,P.data),W=e-+this._y.call(null,P.data),Q=t-+this._z.call(null,P.data),K=G*G+W*W+Q*Q;if(K<n){var te=Math.sqrt(n=K);s=i-te,o=e-te,a=t-te,b=i+te,_=e+te,w=t+te,r=P.data}}return r}const SO=(i,e,t,n,r,s)=>Math.sqrt((i-n)**2+(e-r)**2+(t-s)**2);function bO(i,e,t,n){const r=[],s=i-n,o=e-n,a=t-n,c=i+n,h=e+n,d=t+n;return this.visit((p,y,T,b,_,w,L)=>{if(!p.length)do{const P=p.data;SO(i,e,t,this._x(P),this._y(P),this._z(P))<=n&&r.push(P)}while(p=p.next);return y>c||T>h||b>d||_<s||w<o||L<a}),r}function xO(i){if(isNaN(y=+this._x.call(null,i))||isNaN(T=+this._y.call(null,i))||isNaN(b=+this._z.call(null,i)))return this;var e,t=this._root,n,r,s,o=this._x0,a=this._y0,c=this._z0,h=this._x1,d=this._y1,p=this._z1,y,T,b,_,w,L,P,R,k,F,U;if(!t)return this;if(t.length)for(;;){if((P=y>=(_=(o+h)/2))?o=_:h=_,(R=T>=(w=(a+d)/2))?a=w:d=w,(k=b>=(L=(c+p)/2))?c=L:p=L,e=t,!(t=t[F=k<<2|R<<1|P]))return this;if(!t.length)break;(e[F+1&7]||e[F+2&7]||e[F+3&7]||e[F+4&7]||e[F+5&7]||e[F+6&7]||e[F+7&7])&&(n=e,U=F)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[F]=s:delete e[F],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[U]=t:this._root=t),this):(this._root=s,this)}function _O(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}function wO(){return this._root}function IO(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function LO(i){var e=[],t,n=this._root,r,s,o,a,c,h,d;for(n&&e.push(new Tt(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!i(n=t.node,s=t.x0,o=t.y0,a=t.z0,c=t.x1,h=t.y1,d=t.z1)&&n.length){var p=(s+c)/2,y=(o+h)/2,T=(a+d)/2;(r=n[7])&&e.push(new Tt(r,p,y,T,c,h,d)),(r=n[6])&&e.push(new Tt(r,s,y,T,p,h,d)),(r=n[5])&&e.push(new Tt(r,p,o,T,c,y,d)),(r=n[4])&&e.push(new Tt(r,s,o,T,p,y,d)),(r=n[3])&&e.push(new Tt(r,p,y,a,c,h,T)),(r=n[2])&&e.push(new Tt(r,s,y,a,p,h,T)),(r=n[1])&&e.push(new Tt(r,p,o,a,c,y,T)),(r=n[0])&&e.push(new Tt(r,s,o,a,p,y,T))}return this}function RO(i){var e=[],t=[],n;for(this._root&&e.push(new Tt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var r=n.node;if(r.length){var s,o=n.x0,a=n.y0,c=n.z0,h=n.x1,d=n.y1,p=n.z1,y=(o+h)/2,T=(a+d)/2,b=(c+p)/2;(s=r[0])&&e.push(new Tt(s,o,a,c,y,T,b)),(s=r[1])&&e.push(new Tt(s,y,a,c,h,T,b)),(s=r[2])&&e.push(new Tt(s,o,T,c,y,d,b)),(s=r[3])&&e.push(new Tt(s,y,T,c,h,d,b)),(s=r[4])&&e.push(new Tt(s,o,a,b,y,T,p)),(s=r[5])&&e.push(new Tt(s,y,a,b,h,T,p)),(s=r[6])&&e.push(new Tt(s,o,T,b,y,d,p)),(s=r[7])&&e.push(new Tt(s,y,T,b,h,d,p))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function DO(i){return i[0]}function CO(i){return arguments.length?(this._x=i,this):this._x}function PO(i){return i[1]}function kO(i){return arguments.length?(this._y=i,this):this._y}function MO(i){return i[2]}function OO(i){return arguments.length?(this._z=i,this):this._z}function FO(i,e,t,n){var r=new ch(e??DO,t??PO,n??MO,NaN,NaN,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}function ch(i,e,t,n,r,s,o,a,c){this._x=i,this._y=e,this._z=t,this._x0=n,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=c,this._root=void 0}function Zm(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var ii=FO.prototype=ch.prototype;ii.copy=function(){var i=new ch(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=Zm(e),i;for(t=[{source:e,target:i._root=new Array(8)}];e=t.pop();)for(var r=0;r<8;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(8)}):e.target[r]=Zm(n));return i};ii.add=pO;ii.addAll=mO;ii.cover=yO;ii.data=vO;ii.extent=EO;ii.find=TO;ii.findAllWithinRadius=bO;ii.remove=xO;ii.removeAll=_O;ii.root=wO;ii.size=IO;ii.visit=LO;ii.visitAfter=RO;ii.x=CO;ii.y=kO;ii.z=OO;function wA(i,e){return i==null||e==null?NaN:i<e?-1:i>e?1:i>=e?0:NaN}function BO(i,e){return i==null||e==null?NaN:e<i?-1:e>i?1:e>=i?0:NaN}function rT(i){let e,t,n;i.length!==2?(e=wA,t=(a,c)=>wA(i(a),c),n=(a,c)=>i(a)-c):(e=i===wA||i===BO?i:NO,t=i,n=i);function r(a,c,h=0,d=a.length){if(h<d){if(e(c,c)!==0)return d;do{const p=h+d>>>1;t(a[p],c)<0?h=p+1:d=p}while(h<d)}return h}function s(a,c,h=0,d=a.length){if(h<d){if(e(c,c)!==0)return d;do{const p=h+d>>>1;t(a[p],c)<=0?h=p+1:d=p}while(h<d)}return h}function o(a,c,h=0,d=a.length){const p=r(a,c,h,d-1);return p>h&&n(a[p-1],c)>-n(a[p],c)?p-1:p}return{left:r,center:o,right:s}}function NO(){return 0}function UO(i){return i===null?NaN:+i}const $O=rT(wA),sT=$O.right;rT(UO).center;function oT(i,e){let t,n;if(e===void 0)for(const r of i)r!=null&&(t===void 0?r>=r&&(t=n=r):(t>r&&(t=r),n<r&&(n=r)));else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(t===void 0?s>=s&&(t=n=s):(t>s&&(t=s),n<s&&(n=s)))}return[t,n]}class Kn{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t=this._n,n,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(n=o,r=e[--t],o=n+r,s=r-(o-n),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,n=o+r,r==n-o&&(o=n))}return o}}const GO=Math.sqrt(50),VO=Math.sqrt(10),HO=Math.sqrt(2);function YA(i,e,t){const n=(e-i)/Math.max(0,t),r=Math.floor(Math.log10(n)),s=n/Math.pow(10,r),o=s>=GO?10:s>=VO?5:s>=HO?2:1;let a,c,h;return r<0?(h=Math.pow(10,-r)/o,a=Math.round(i*h),c=Math.round(e*h),a/h<i&&++a,c/h>e&&--c,h=-h):(h=Math.pow(10,r)*o,a=Math.round(i/h),c=Math.round(e/h),a*h<i&&++a,c*h>e&&--c),c<a&&.5<=t&&t<2?YA(i,e,t*2):[a,c,h]}function jO(i,e,t){if(e=+e,i=+i,t=+t,!(t>0))return[];if(i===e)return[i];const n=e<i,[r,s,o]=n?YA(e,i,t):YA(i,e,t);if(!(s>=r))return[];const a=s-r+1,c=new Array(a);if(n)if(o<0)for(let h=0;h<a;++h)c[h]=(s-h)/-o;else for(let h=0;h<a;++h)c[h]=(s-h)*o;else if(o<0)for(let h=0;h<a;++h)c[h]=(r+h)/-o;else for(let h=0;h<a;++h)c[h]=(r+h)*o;return c}function Df(i,e,t){return e=+e,i=+i,t=+t,YA(i,e,t)[2]}function KO(i,e,t){e=+e,i=+i,t=+t;const n=e<i,r=n?Df(e,i,t):Df(i,e,t);return(n?-1:1)*(r<0?1/-r:r)}function kU(i,e){let t;for(const n of i)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);return t}function MU(i,e){let t=0,n=0;if(e===void 0)for(let r of i)r!=null&&(r=+r)>=r&&(++t,n+=r);else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(s=+s)>=s&&(++t,n+=s)}if(t)return n/t}function*QO(i){for(const e of i)yield*e}function aT(i){return Array.from(QO(i))}function bs(i,e,t){i=+i,e=+e,t=(r=arguments.length)<2?(e=i,i=0,1):r<3?1:+t;for(var n=-1,r=Math.max(0,Math.ceil((e-i)/t))|0,s=new Array(r);++n<r;)s[n]=i+n*t;return s}function OU(i,e){let t=0;for(let n of i)(n=+n)&&(t+=n);return t}function AT(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i);break}return this}function hh(i,e,t){i.prototype=e.prototype=t,t.constructor=i}function lT(i,e){var t=Object.create(i.prototype);for(var n in e)t[n]=e[n];return t}function ma(){}var Zo=.7,zA=1/Zo,ks="\\s*([+-]?\\d+)\\s*",Jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",In="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",WO=/^#([0-9a-f]{3,8})$/,YO=new RegExp(`^rgb\\(${ks},${ks},${ks}\\)$`),zO=new RegExp(`^rgb\\(${In},${In},${In}\\)$`),qO=new RegExp(`^rgba\\(${ks},${ks},${ks},${Jo}\\)$`),XO=new RegExp(`^rgba\\(${In},${In},${In},${Jo}\\)$`),ZO=new RegExp(`^hsl\\(${Jo},${In},${In}\\)$`),JO=new RegExp(`^hsla\\(${Jo},${In},${In},${Jo}\\)$`),Jm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hh(ma,ea,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:e1,formatHex:e1,formatHex8:e4,formatHsl:t4,formatRgb:t1,toString:t1});function e1(){return this.rgb().formatHex()}function e4(){return this.rgb().formatHex8()}function t4(){return uT(this).formatHsl()}function t1(){return this.rgb().formatRgb()}function ea(i){var e,t;return i=(i+"").trim().toLowerCase(),(e=WO.exec(i))?(t=e[1].length,e=parseInt(e[1],16),t===6?i1(e):t===3?new Li(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?iA(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?iA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=YO.exec(i))?new Li(e[1],e[2],e[3],1):(e=zO.exec(i))?new Li(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=qO.exec(i))?iA(e[1],e[2],e[3],e[4]):(e=XO.exec(i))?iA(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ZO.exec(i))?s1(e[1],e[2]/100,e[3]/100,1):(e=JO.exec(i))?s1(e[1],e[2]/100,e[3]/100,e[4]):Jm.hasOwnProperty(i)?i1(Jm[i]):i==="transparent"?new Li(NaN,NaN,NaN,0):null}function i1(i){return new Li(i>>16&255,i>>8&255,i&255,1)}function iA(i,e,t,n){return n<=0&&(i=e=t=NaN),new Li(i,e,t,n)}function i4(i){return i instanceof ma||(i=ea(i)),i?(i=i.rgb(),new Li(i.r,i.g,i.b,i.opacity)):new Li}function Cf(i,e,t,n){return arguments.length===1?i4(i):new Li(i,e,t,n??1)}function Li(i,e,t,n){this.r=+i,this.g=+e,this.b=+t,this.opacity=+n}hh(Li,Cf,lT(ma,{brighter(i){return i=i==null?zA:Math.pow(zA,i),new Li(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=i==null?Zo:Math.pow(Zo,i),new Li(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new Li(jr(this.r),jr(this.g),jr(this.b),qA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:n1,formatHex:n1,formatHex8:n4,formatRgb:r1,toString:r1}));function n1(){return`#${Nr(this.r)}${Nr(this.g)}${Nr(this.b)}`}function n4(){return`#${Nr(this.r)}${Nr(this.g)}${Nr(this.b)}${Nr((isNaN(this.opacity)?1:this.opacity)*255)}`}function r1(){const i=qA(this.opacity);return`${i===1?"rgb(":"rgba("}${jr(this.r)}, ${jr(this.g)}, ${jr(this.b)}${i===1?")":`, ${i})`}`}function qA(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function jr(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function Nr(i){return i=jr(i),(i<16?"0":"")+i.toString(16)}function s1(i,e,t,n){return n<=0?i=e=t=NaN:t<=0||t>=1?i=e=NaN:e<=0&&(i=NaN),new fn(i,e,t,n)}function uT(i){if(i instanceof fn)return new fn(i.h,i.s,i.l,i.opacity);if(i instanceof ma||(i=ea(i)),!i)return new fn;if(i instanceof fn)return i;i=i.rgb();var e=i.r/255,t=i.g/255,n=i.b/255,r=Math.min(e,t,n),s=Math.max(e,t,n),o=NaN,a=s-r,c=(s+r)/2;return a?(e===s?o=(t-n)/a+(t<n)*6:t===s?o=(n-e)/a+2:o=(e-t)/a+4,a/=c<.5?s+r:2-s-r,o*=60):a=c>0&&c<1?0:o,new fn(o,a,c,i.opacity)}function r4(i,e,t,n){return arguments.length===1?uT(i):new fn(i,e,t,n??1)}function fn(i,e,t,n){this.h=+i,this.s=+e,this.l=+t,this.opacity=+n}hh(fn,r4,lT(ma,{brighter(i){return i=i==null?zA:Math.pow(zA,i),new fn(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=i==null?Zo:Math.pow(Zo,i),new fn(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+(this.h<0)*360,e=isNaN(i)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,r=2*t-n;return new Li(v0(i>=240?i-240:i+120,r,n),v0(i,r,n),v0(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new fn(o1(this.h),nA(this.s),nA(this.l),qA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=qA(this.opacity);return`${i===1?"hsl(":"hsla("}${o1(this.h)}, ${nA(this.s)*100}%, ${nA(this.l)*100}%${i===1?")":`, ${i})`}`}}));function o1(i){return i=(i||0)%360,i<0?i+360:i}function nA(i){return Math.max(0,Math.min(1,i||0))}function v0(i,e,t){return(i<60?e+(t-e)*i/60:i<180?t:i<240?e+(t-e)*(240-i)/60:e)*255}const dh=i=>()=>i;function s4(i,e){return function(t){return i+t*e}}function o4(i,e,t){return i=Math.pow(i,t),e=Math.pow(e,t)-i,t=1/t,function(n){return Math.pow(i+n*e,t)}}function a4(i){return(i=+i)==1?fT:function(e,t){return t-e?o4(e,t,i):dh(isNaN(e)?t:e)}}function fT(i,e){var t=e-i;return t?s4(i,t):dh(isNaN(i)?e:i)}const a1=(function i(e){var t=a4(e);function n(r,s){var o=t((r=Cf(r)).r,(s=Cf(s)).r),a=t(r.g,s.g),c=t(r.b,s.b),h=fT(r.opacity,s.opacity);return function(d){return r.r=o(d),r.g=a(d),r.b=c(d),r.opacity=h(d),r+""}}return n.gamma=i,n})(1);function cT(i,e){e||(e=[]);var t=i?Math.min(e.length,i.length):0,n=e.slice(),r;return function(s){for(r=0;r<t;++r)n[r]=i[r]*(1-s)+e[r]*s;return n}}function hT(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function FU(i,e){return(hT(e)?cT:dT)(i,e)}function dT(i,e){var t=e?e.length:0,n=i?Math.min(t,i.length):0,r=new Array(n),s=new Array(t),o;for(o=0;o<n;++o)r[o]=gh(i[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<n;++o)s[o]=r[o](a);return s}}function A4(i,e){var t=new Date;return i=+i,e=+e,function(n){return t.setTime(i*(1-n)+e*n),t}}function XA(i,e){return i=+i,e=+e,function(t){return i*(1-t)+e*t}}function l4(i,e){var t={},n={},r;(i===null||typeof i!="object")&&(i={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in i?t[r]=gh(i[r],e[r]):n[r]=e[r];return function(s){for(r in t)n[r]=t[r](s);return n}}var Pf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,E0=new RegExp(Pf.source,"g");function u4(i){return function(){return i}}function f4(i){return function(e){return i(e)+""}}function c4(i,e){var t=Pf.lastIndex=E0.lastIndex=0,n,r,s,o=-1,a=[],c=[];for(i=i+"",e=e+"";(n=Pf.exec(i))&&(r=E0.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:XA(n,r)})),t=E0.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?f4(c[0].x):u4(e):(e=c.length,function(h){for(var d=0,p;d<e;++d)a[(p=c[d]).i]=p.x(h);return a.join("")})}function gh(i,e){var t=typeof e,n;return e==null||t==="boolean"?dh(e):(t==="number"?XA:t==="string"?(n=ea(e))?(e=n,a1):c4:e instanceof ea?a1:e instanceof Date?A4:hT(e)?cT:Array.isArray(e)?dT:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?l4:XA)(i,e)}function h4(i,e){return i=+i,e=+e,function(t){return Math.round(i*(1-t)+e*t)}}function d4(i){return function(){return i}}function g4(i){return+i}var A1=[0,1];function xs(i){return i}function kf(i,e){return(e-=i=+i)?function(t){return(t-i)/e}:d4(isNaN(e)?NaN:.5)}function p4(i,e){var t;return i>e&&(t=i,i=e,e=t),function(n){return Math.max(i,Math.min(e,n))}}function m4(i,e,t){var n=i[0],r=i[1],s=e[0],o=e[1];return r<n?(n=kf(r,n),s=t(o,s)):(n=kf(n,r),s=t(s,o)),function(a){return s(n(a))}}function y4(i,e,t){var n=Math.min(i.length,e.length)-1,r=new Array(n),s=new Array(n),o=-1;for(i[n]<i[0]&&(i=i.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=kf(i[o],i[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var c=sT(i,a,1,n)-1;return s[c](r[c](a))}}function v4(i,e){return e.domain(i.domain()).range(i.range()).interpolate(i.interpolate()).clamp(i.clamp()).unknown(i.unknown())}function E4(){var i=A1,e=A1,t=gh,n,r,s,o=xs,a,c,h;function d(){var y=Math.min(i.length,e.length);return o!==xs&&(o=p4(i[0],i[y-1])),a=y>2?y4:m4,c=h=null,p}function p(y){return y==null||isNaN(y=+y)?s:(c||(c=a(i.map(n),e,t)))(n(o(y)))}return p.invert=function(y){return o(r((h||(h=a(e,i.map(n),XA)))(y)))},p.domain=function(y){return arguments.length?(i=Array.from(y,g4),d()):i.slice()},p.range=function(y){return arguments.length?(e=Array.from(y),d()):e.slice()},p.rangeRound=function(y){return e=Array.from(y),t=h4,d()},p.clamp=function(y){return arguments.length?(o=y?!0:xs,d()):o!==xs},p.interpolate=function(y){return arguments.length?(t=y,d()):t},p.unknown=function(y){return arguments.length?(s=y,p):s},function(y,T){return n=y,r=T,d()}}function T4(){return E4()(xs,xs)}function S4(i){return Math.abs(i=Math.round(i))>=1e21?i.toLocaleString("en").replace(/,/g,""):i.toString(10)}function ZA(i,e){if((t=(i=e?i.toExponential(e-1):i.toExponential()).indexOf("e"))<0)return null;var t,n=i.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+i.slice(t+1)]}function $s(i){return i=ZA(Math.abs(i)),i?i[1]:NaN}function b4(i,e){return function(t,n){for(var r=t.length,s=[],o=0,a=i[0],c=0;r>0&&a>0&&(c+a+1>n&&(a=Math.max(1,n-c)),s.push(t.substring(r-=a,r+a)),!((c+=a+1)>n));)a=i[o=(o+1)%i.length];return s.reverse().join(e)}}function x4(i){return function(e){return e.replace(/[0-9]/g,function(t){return i[+t]})}}var _4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function JA(i){if(!(e=_4.exec(i)))throw new Error("invalid format: "+i);var e;return new ph({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}JA.prototype=ph.prototype;function ph(i){this.fill=i.fill===void 0?" ":i.fill+"",this.align=i.align===void 0?">":i.align+"",this.sign=i.sign===void 0?"-":i.sign+"",this.symbol=i.symbol===void 0?"":i.symbol+"",this.zero=!!i.zero,this.width=i.width===void 0?void 0:+i.width,this.comma=!!i.comma,this.precision=i.precision===void 0?void 0:+i.precision,this.trim=!!i.trim,this.type=i.type===void 0?"":i.type+""}ph.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function w4(i){e:for(var e=i.length,t=1,n=-1,r;t<e;++t)switch(i[t]){case".":n=r=t;break;case"0":n===0&&(n=t),r=t;break;default:if(!+i[t])break e;n>0&&(n=0);break}return n>0?i.slice(0,n)+i.slice(r+1):i}var gT;function I4(i,e){var t=ZA(i,e);if(!t)return i+"";var n=t[0],r=t[1],s=r-(gT=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+ZA(i,Math.max(0,e+s-1))[0]}function l1(i,e){var t=ZA(i,e);if(!t)return i+"";var n=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}const u1={"%":(i,e)=>(i*100).toFixed(e),b:i=>Math.round(i).toString(2),c:i=>i+"",d:S4,e:(i,e)=>i.toExponential(e),f:(i,e)=>i.toFixed(e),g:(i,e)=>i.toPrecision(e),o:i=>Math.round(i).toString(8),p:(i,e)=>l1(i*100,e),r:l1,s:I4,X:i=>Math.round(i).toString(16).toUpperCase(),x:i=>Math.round(i).toString(16)};function f1(i){return i}var c1=Array.prototype.map,h1=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function L4(i){var e=i.grouping===void 0||i.thousands===void 0?f1:b4(c1.call(i.grouping,Number),i.thousands+""),t=i.currency===void 0?"":i.currency[0]+"",n=i.currency===void 0?"":i.currency[1]+"",r=i.decimal===void 0?".":i.decimal+"",s=i.numerals===void 0?f1:x4(c1.call(i.numerals,String)),o=i.percent===void 0?"%":i.percent+"",a=i.minus===void 0?"−":i.minus+"",c=i.nan===void 0?"NaN":i.nan+"";function h(p){p=JA(p);var y=p.fill,T=p.align,b=p.sign,_=p.symbol,w=p.zero,L=p.width,P=p.comma,R=p.precision,k=p.trim,F=p.type;F==="n"?(P=!0,F="g"):u1[F]||(R===void 0&&(R=12),k=!0,F="g"),(w||y==="0"&&T==="=")&&(w=!0,y="0",T="=");var U=_==="$"?t:_==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",$=_==="$"?n:/[%p]/.test(F)?o:"",G=u1[F],W=/[defgprs%]/.test(F);R=R===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function Q(K){var te=U,oe=$,Ae,X,Y;if(F==="c")oe=G(K)+oe,K="";else{K=+K;var ee=K<0||1/K<0;if(K=isNaN(K)?c:G(Math.abs(K),R),k&&(K=w4(K)),ee&&+K==0&&b!=="+"&&(ee=!1),te=(ee?b==="("?b:a:b==="-"||b==="("?"":b)+te,oe=(F==="s"?h1[8+gT/3]:"")+oe+(ee&&b==="("?")":""),W){for(Ae=-1,X=K.length;++Ae<X;)if(Y=K.charCodeAt(Ae),48>Y||Y>57){oe=(Y===46?r+K.slice(Ae+1):K.slice(Ae))+oe,K=K.slice(0,Ae);break}}}P&&!w&&(K=e(K,1/0));var re=te.length+K.length+oe.length,ue=re<L?new Array(L-re+1).join(y):"";switch(P&&w&&(K=e(ue+K,ue.length?L-oe.length:1/0),ue=""),T){case"<":K=te+K+oe+ue;break;case"=":K=te+ue+K+oe;break;case"^":K=ue.slice(0,re=ue.length>>1)+te+K+oe+ue.slice(re);break;default:K=ue+te+K+oe;break}return s(K)}return Q.toString=function(){return p+""},Q}function d(p,y){var T=h((p=JA(p),p.type="f",p)),b=Math.max(-8,Math.min(8,Math.floor($s(y)/3)))*3,_=Math.pow(10,-b),w=h1[8+b/3];return function(L){return T(_*L)+w}}return{format:h,formatPrefix:d}}var rA,pT,mT;R4({thousands:",",grouping:[3],currency:["$",""]});function R4(i){return rA=L4(i),pT=rA.format,mT=rA.formatPrefix,rA}function D4(i){return Math.max(0,-$s(Math.abs(i)))}function C4(i,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($s(e)/3)))*3-$s(Math.abs(i)))}function P4(i,e){return i=Math.abs(i),e=Math.abs(e)-i,Math.max(0,$s(e)-$s(i))+1}function k4(i,e,t,n){var r=KO(i,e,t),s;switch(n=JA(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(i),Math.abs(e));return n.precision==null&&!isNaN(s=C4(r,o))&&(n.precision=s),mT(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=P4(r,Math.max(Math.abs(i),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=D4(r))&&(n.precision=s-(n.type==="%")*2);break}}return pT(n)}function yT(i){var e=i.domain;return i.ticks=function(t){var n=e();return jO(n[0],n[n.length-1],t??10)},i.tickFormat=function(t,n){var r=e();return k4(r[0],r[r.length-1],t??10,n)},i.nice=function(t){t==null&&(t=10);var n=e(),r=0,s=n.length-1,o=n[r],a=n[s],c,h,d=10;for(a<o&&(h=o,o=a,a=h,h=r,r=s,s=h);d-- >0;){if(h=Df(o,a,t),h===c)return n[r]=o,n[s]=a,e(n);if(h>0)o=Math.floor(o/h)*h,a=Math.ceil(a/h)*h;else if(h<0)o=Math.ceil(o*h)/h,a=Math.floor(a*h)/h;else break;c=h}return i},i}function M4(){var i=T4();return i.copy=function(){return v4(i,M4())},AT.apply(i,arguments),yT(i)}function O4(){var i=0,e=1,t=1,n=[.5],r=[0,1],s;function o(c){return c!=null&&c<=c?r[sT(n,c,0,t)]:s}function a(){var c=-1;for(n=new Array(t);++c<t;)n[c]=((c+1)*e-(c-t)*i)/(t+1);return o}return o.domain=function(c){return arguments.length?([i,e]=c,i=+i,e=+e,a()):[i,e]},o.range=function(c){return arguments.length?(t=(r=Array.from(c)).length-1,a()):r.slice()},o.invertExtent=function(c){var h=r.indexOf(c);return h<0?[NaN,NaN]:h<1?[i,n[0]]:h>=t?[n[t-1],e]:[n[h-1],n[h]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return O4().domain([i,e]).range(r).unknown(s)},AT.apply(yT(o),arguments)}var ot=1e-6,el=1e-12,ft=Math.PI,Ri=ft/2,tl=ft/4,$i=ft*2,Ft=180/ft,Ye=ft/180,vt=Math.abs,mh=Math.atan,Ji=Math.atan2,Ze=Math.cos,sA=Math.ceil,F4=Math.exp,Mf=Math.hypot,B4=Math.log,He=Math.sin,N4=Math.sign||function(i){return i>0?1:i<0?-1:0},qn=Math.sqrt,U4=Math.tan;function $4(i){return i>1?0:i<-1?ft:Math.acos(i)}function Xn(i){return i>1?Ri:i<-1?-Ri:Math.asin(i)}function d1(i){return(i=He(i/2))*i}function ai(){}function il(i,e){i&&p1.hasOwnProperty(i.type)&&p1[i.type](i,e)}var g1={Feature:function(i,e){il(i.geometry,e)},FeatureCollection:function(i,e){for(var t=i.features,n=-1,r=t.length;++n<r;)il(t[n].geometry,e)}},p1={Sphere:function(i,e){e.sphere()},Point:function(i,e){i=i.coordinates,e.point(i[0],i[1],i[2])},MultiPoint:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)i=t[n],e.point(i[0],i[1],i[2])},LineString:function(i,e){Of(i.coordinates,e,0)},MultiLineString:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)Of(t[n],e,0)},Polygon:function(i,e){m1(i.coordinates,e)},MultiPolygon:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)m1(t[n],e)},GeometryCollection:function(i,e){for(var t=i.geometries,n=-1,r=t.length;++n<r;)il(t[n],e)}};function Of(i,e,t){var n=-1,r=i.length-t,s;for(e.lineStart();++n<r;)s=i[n],e.point(s[0],s[1],s[2]);e.lineEnd()}function m1(i,e){var t=-1,n=i.length;for(e.polygonStart();++t<n;)Of(i[t],e,1);e.polygonEnd()}function Nl(i,e){i&&g1.hasOwnProperty(i.type)?g1[i.type](i,e):il(i,e)}var nl=new Kn,y1=new Kn,vT,ET,Ff,Bf,Nf,Zn={point:ai,lineStart:ai,lineEnd:ai,polygonStart:function(){nl=new Kn,Zn.lineStart=G4,Zn.lineEnd=V4},polygonEnd:function(){var i=+nl;y1.add(i<0?$i+i:i),this.lineStart=this.lineEnd=this.point=ai},sphere:function(){y1.add($i)}};function G4(){Zn.point=H4}function V4(){TT(vT,ET)}function H4(i,e){Zn.point=TT,vT=i,ET=e,i*=Ye,e*=Ye,Ff=i,Bf=Ze(e=e/2+tl),Nf=He(e)}function TT(i,e){i*=Ye,e*=Ye,e=e/2+tl;var t=i-Ff,n=t>=0?1:-1,r=n*t,s=Ze(e),o=He(e),a=Nf*o,c=Bf*s+a*Ze(r),h=a*n*He(r);nl.add(Ji(h,c)),Ff=i,Bf=s,Nf=o}function rl(i){return[Ji(i[1],i[0]),Xn(i[2])]}function Wr(i){var e=i[0],t=i[1],n=Ze(t);return[n*Ze(e),n*He(e),He(t)]}function oA(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Gs(i,e){return[i[1]*e[2]-i[2]*e[1],i[2]*e[0]-i[0]*e[2],i[0]*e[1]-i[1]*e[0]]}function T0(i,e){i[0]+=e[0],i[1]+=e[1],i[2]+=e[2]}function aA(i,e){return[i[0]*e,i[1]*e,i[2]*e]}function sl(i){var e=qn(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]/=e,i[1]/=e,i[2]/=e}var Rt,_i,Mt,Ni,kr,ST,bT,Ms,Uo,cr,Jn,Hn={point:Uf,lineStart:v1,lineEnd:E1,polygonStart:function(){Hn.point=_T,Hn.lineStart=j4,Hn.lineEnd=K4,Uo=new Kn,Zn.polygonStart()},polygonEnd:function(){Zn.polygonEnd(),Hn.point=Uf,Hn.lineStart=v1,Hn.lineEnd=E1,nl<0?(Rt=-(Mt=180),_i=-(Ni=90)):Uo>ot?Ni=90:Uo<-ot&&(_i=-90),Jn[0]=Rt,Jn[1]=Mt},sphere:function(){Rt=-(Mt=180),_i=-(Ni=90)}};function Uf(i,e){cr.push(Jn=[Rt=i,Mt=i]),e<_i&&(_i=e),e>Ni&&(Ni=e)}function xT(i,e){var t=Wr([i*Ye,e*Ye]);if(Ms){var n=Gs(Ms,t),r=[n[1],-n[0],0],s=Gs(r,n);sl(s),s=rl(s);var o=i-kr,a=o>0?1:-1,c=s[0]*Ft*a,h,d=vt(o)>180;d^(a*kr<c&&c<a*i)?(h=s[1]*Ft,h>Ni&&(Ni=h)):(c=(c+360)%360-180,d^(a*kr<c&&c<a*i)?(h=-s[1]*Ft,h<_i&&(_i=h)):(e<_i&&(_i=e),e>Ni&&(Ni=e))),d?i<kr?Fi(Rt,i)>Fi(Rt,Mt)&&(Mt=i):Fi(i,Mt)>Fi(Rt,Mt)&&(Rt=i):Mt>=Rt?(i<Rt&&(Rt=i),i>Mt&&(Mt=i)):i>kr?Fi(Rt,i)>Fi(Rt,Mt)&&(Mt=i):Fi(i,Mt)>Fi(Rt,Mt)&&(Rt=i)}else cr.push(Jn=[Rt=i,Mt=i]);e<_i&&(_i=e),e>Ni&&(Ni=e),Ms=t,kr=i}function v1(){Hn.point=xT}function E1(){Jn[0]=Rt,Jn[1]=Mt,Hn.point=Uf,Ms=null}function _T(i,e){if(Ms){var t=i-kr;Uo.add(vt(t)>180?t+(t>0?360:-360):t)}else ST=i,bT=e;Zn.point(i,e),xT(i,e)}function j4(){Zn.lineStart()}function K4(){_T(ST,bT),Zn.lineEnd(),vt(Uo)>ot&&(Rt=-(Mt=180)),Jn[0]=Rt,Jn[1]=Mt,Ms=null}function Fi(i,e){return(e-=i)<0?e+360:e}function Q4(i,e){return i[0]-e[0]}function T1(i,e){return i[0]<=i[1]?i[0]<=e&&e<=i[1]:e<i[0]||i[1]<e}function BU(i){var e,t,n,r,s,o,a;if(Ni=Mt=-(Rt=_i=1/0),cr=[],Nl(i,Hn),t=cr.length){for(cr.sort(Q4),e=1,n=cr[0],s=[n];e<t;++e)r=cr[e],T1(n,r[0])||T1(n,r[1])?(Fi(n[0],r[1])>Fi(n[0],n[1])&&(n[1]=r[1]),Fi(r[0],n[1])>Fi(n[0],n[1])&&(n[0]=r[0])):s.push(n=r);for(o=-1/0,t=s.length-1,e=0,n=s[t];e<=t;n=r,++e)r=s[e],(a=Fi(n[1],r[0]))>o&&(o=a,Rt=r[0],Mt=n[1])}return cr=Jn=null,Rt===1/0||_i===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rt,_i],[Mt,Ni]]}var xo,ol,al,Al,ll,ul,fl,cl,$f,Gf,Vf,wT,IT,di,gi,pi,hn={sphere:ai,point:yh,lineStart:S1,lineEnd:b1,polygonStart:function(){hn.lineStart=z4,hn.lineEnd=q4},polygonEnd:function(){hn.lineStart=S1,hn.lineEnd=b1}};function yh(i,e){i*=Ye,e*=Ye;var t=Ze(e);ya(t*Ze(i),t*He(i),He(e))}function ya(i,e,t){++xo,al+=(i-al)/xo,Al+=(e-Al)/xo,ll+=(t-ll)/xo}function S1(){hn.point=W4}function W4(i,e){i*=Ye,e*=Ye;var t=Ze(e);di=t*Ze(i),gi=t*He(i),pi=He(e),hn.point=Y4,ya(di,gi,pi)}function Y4(i,e){i*=Ye,e*=Ye;var t=Ze(e),n=t*Ze(i),r=t*He(i),s=He(e),o=Ji(qn((o=gi*s-pi*r)*o+(o=pi*n-di*s)*o+(o=di*r-gi*n)*o),di*n+gi*r+pi*s);ol+=o,ul+=o*(di+(di=n)),fl+=o*(gi+(gi=r)),cl+=o*(pi+(pi=s)),ya(di,gi,pi)}function b1(){hn.point=yh}function z4(){hn.point=X4}function q4(){LT(wT,IT),hn.point=yh}function X4(i,e){wT=i,IT=e,i*=Ye,e*=Ye,hn.point=LT;var t=Ze(e);di=t*Ze(i),gi=t*He(i),pi=He(e),ya(di,gi,pi)}function LT(i,e){i*=Ye,e*=Ye;var t=Ze(e),n=t*Ze(i),r=t*He(i),s=He(e),o=gi*s-pi*r,a=pi*n-di*s,c=di*r-gi*n,h=Mf(o,a,c),d=Xn(h),p=h&&-d/h;$f.add(p*o),Gf.add(p*a),Vf.add(p*c),ol+=d,ul+=d*(di+(di=n)),fl+=d*(gi+(gi=r)),cl+=d*(pi+(pi=s)),ya(di,gi,pi)}function x1(i){xo=ol=al=Al=ll=ul=fl=cl=0,$f=new Kn,Gf=new Kn,Vf=new Kn,Nl(i,hn);var e=+$f,t=+Gf,n=+Vf,r=Mf(e,t,n);return r<el&&(e=ul,t=fl,n=cl,ol<ot&&(e=al,t=Al,n=ll),r=Mf(e,t,n),r<el)?[NaN,NaN]:[Ji(t,e)*Ft,Xn(n/r)*Ft]}function Hf(i,e){function t(n,r){return n=i(n,r),e(n[0],n[1])}return i.invert&&e.invert&&(t.invert=function(n,r){return n=e.invert(n,r),n&&i.invert(n[0],n[1])}),t}function jf(i,e){return vt(i)>ft&&(i-=Math.round(i/$i)*$i),[i,e]}jf.invert=jf;function RT(i,e,t){return(i%=$i)?e||t?Hf(w1(i),I1(e,t)):w1(i):e||t?I1(e,t):jf}function _1(i){return function(e,t){return e+=i,vt(e)>ft&&(e-=Math.round(e/$i)*$i),[e,t]}}function w1(i){var e=_1(i);return e.invert=_1(-i),e}function I1(i,e){var t=Ze(i),n=He(i),r=Ze(e),s=He(e);function o(a,c){var h=Ze(c),d=Ze(a)*h,p=He(a)*h,y=He(c),T=y*t+d*n;return[Ji(p*r-T*s,d*t-y*n),Xn(T*r+p*s)]}return o.invert=function(a,c){var h=Ze(c),d=Ze(a)*h,p=He(a)*h,y=He(c),T=y*r-p*s;return[Ji(p*r+y*s,d*t+T*n),Xn(T*t-d*n)]},o}function Z4(i){i=RT(i[0]*Ye,i[1]*Ye,i.length>2?i[2]*Ye:0);function e(t){return t=i(t[0]*Ye,t[1]*Ye),t[0]*=Ft,t[1]*=Ft,t}return e.invert=function(t){return t=i.invert(t[0]*Ye,t[1]*Ye),t[0]*=Ft,t[1]*=Ft,t},e}function J4(i,e,t,n,r,s){if(t){var o=Ze(e),a=He(e),c=n*t;r==null?(r=e+n*$i,s=e-c/2):(r=L1(o,r),s=L1(o,s),(n>0?r<s:r>s)&&(r+=n*$i));for(var h,d=r;n>0?d>s:d<s;d-=c)h=rl([o,-a*Ze(d),-a*He(d)]),i.point(h[0],h[1])}}function L1(i,e){e=Wr(e),e[0]-=i,sl(e);var t=$4(-e[1]);return((-e[2]<0?-t:t)+$i-ot)%$i}function DT(){var i=[],e;return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){i.push(e=[])},lineEnd:ai,rejoin:function(){i.length>1&&i.push(i.pop().concat(i.shift()))},result:function(){var t=i;return i=[],e=null,t}}}function IA(i,e){return vt(i[0]-e[0])<ot&&vt(i[1]-e[1])<ot}function AA(i,e,t,n){this.x=i,this.z=e,this.o=t,this.e=n,this.v=!1,this.n=this.p=null}function CT(i,e,t,n,r){var s=[],o=[],a,c;if(i.forEach(function(b){if(!((_=b.length-1)<=0)){var _,w=b[0],L=b[_],P;if(IA(w,L)){if(!w[2]&&!L[2]){for(r.lineStart(),a=0;a<_;++a)r.point((w=b[a])[0],w[1]);r.lineEnd();return}L[0]+=2*ot}s.push(P=new AA(w,b,null,!0)),o.push(P.o=new AA(w,null,P,!1)),s.push(P=new AA(L,b,null,!1)),o.push(P.o=new AA(L,null,P,!0))}}),!!s.length){for(o.sort(e),R1(s),R1(o),a=0,c=o.length;a<c;++a)o[a].e=t=!t;for(var h=s[0],d,p;;){for(var y=h,T=!0;y.v;)if((y=y.n)===h)return;d=y.z,r.lineStart();do{if(y.v=y.o.v=!0,y.e){if(T)for(a=0,c=d.length;a<c;++a)r.point((p=d[a])[0],p[1]);else n(y.x,y.n.x,1,r);y=y.n}else{if(T)for(d=y.p.z,a=d.length-1;a>=0;--a)r.point((p=d[a])[0],p[1]);else n(y.x,y.p.x,-1,r);y=y.p}y=y.o,d=y.z,T=!T}while(!y.v);r.lineEnd()}}}function R1(i){if(e=i.length){for(var e,t=0,n=i[0],r;++t<e;)n.n=r=i[t],r.p=n,n=r;n.n=r=i[0],r.p=n}}function S0(i){return vt(i[0])<=ft?i[0]:N4(i[0])*((vt(i[0])+ft)%$i-ft)}function PT(i,e){var t=S0(e),n=e[1],r=He(n),s=[He(t),-Ze(t),0],o=0,a=0,c=new Kn;r===1?n=Ri+ot:r===-1&&(n=-Ri-ot);for(var h=0,d=i.length;h<d;++h)if(y=(p=i[h]).length)for(var p,y,T=p[y-1],b=S0(T),_=T[1]/2+tl,w=He(_),L=Ze(_),P=0;P<y;++P,b=k,w=U,L=$,T=R){var R=p[P],k=S0(R),F=R[1]/2+tl,U=He(F),$=Ze(F),G=k-b,W=G>=0?1:-1,Q=W*G,K=Q>ft,te=w*U;if(c.add(Ji(te*W*He(Q),L*$+te*Ze(Q))),o+=K?G+W*$i:G,K^b>=t^k>=t){var oe=Gs(Wr(T),Wr(R));sl(oe);var Ae=Gs(s,oe);sl(Ae);var X=(K^G>=0?-1:1)*Xn(Ae[2]);(n>X||n===X&&(oe[0]||oe[1]))&&(a+=K^G>=0?1:-1)}}return(o<-ot||o<ot&&c<-el)^a&1}function kT(i,e,t,n){return function(r){var s=e(r),o=DT(),a=e(o),c=!1,h,d,p,y={point:T,lineStart:_,lineEnd:w,polygonStart:function(){y.point=L,y.lineStart=P,y.lineEnd=R,d=[],h=[]},polygonEnd:function(){y.point=T,y.lineStart=_,y.lineEnd=w,d=aT(d);var k=PT(h,n);d.length?(c||(r.polygonStart(),c=!0),CT(d,t8,k,t,r)):k&&(c||(r.polygonStart(),c=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),c&&(r.polygonEnd(),c=!1),d=h=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function T(k,F){i(k,F)&&r.point(k,F)}function b(k,F){s.point(k,F)}function _(){y.point=b,s.lineStart()}function w(){y.point=T,s.lineEnd()}function L(k,F){p.push([k,F]),a.point(k,F)}function P(){a.lineStart(),p=[]}function R(){L(p[0][0],p[0][1]),a.lineEnd();var k=a.clean(),F=o.result(),U,$=F.length,G,W,Q;if(p.pop(),h.push(p),p=null,!!$){if(k&1){if(W=F[0],(G=W.length-1)>0){for(c||(r.polygonStart(),c=!0),r.lineStart(),U=0;U<G;++U)r.point((Q=W[U])[0],Q[1]);r.lineEnd()}return}$>1&&k&2&&F.push(F.pop().concat(F.shift())),d.push(F.filter(e8))}}return y}}function e8(i){return i.length>1}function t8(i,e){return((i=i.x)[0]<0?i[1]-Ri-ot:Ri-i[1])-((e=e.x)[0]<0?e[1]-Ri-ot:Ri-e[1])}const D1=kT(function(){return!0},i8,r8,[-ft,-Ri]);function i8(i){var e=NaN,t=NaN,n=NaN,r;return{lineStart:function(){i.lineStart(),r=1},point:function(s,o){var a=s>0?ft:-ft,c=vt(s-e);vt(c-ft)<ot?(i.point(e,t=(t+o)/2>0?Ri:-Ri),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(a,t),i.point(s,t),r=0):n!==a&&c>=ft&&(vt(e-n)<ot&&(e-=n*ot),vt(s-a)<ot&&(s-=a*ot),t=n8(e,t,s,o),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(a,t),r=0),i.point(e=s,t=o),n=a},lineEnd:function(){i.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function n8(i,e,t,n){var r,s,o=He(i-t);return vt(o)>ot?mh((He(e)*(s=Ze(n))*He(t)-He(n)*(r=Ze(e))*He(i))/(r*s*o)):(e+n)/2}function r8(i,e,t,n){var r;if(i==null)r=t*Ri,n.point(-ft,r),n.point(0,r),n.point(ft,r),n.point(ft,0),n.point(ft,-r),n.point(0,-r),n.point(-ft,-r),n.point(-ft,0),n.point(-ft,r);else if(vt(i[0]-e[0])>ot){var s=i[0]<e[0]?ft:-ft;r=t*s/2,n.point(-s,r),n.point(0,r),n.point(s,r)}else n.point(e[0],e[1])}function s8(i){var e=Ze(i),t=2*Ye,n=e>0,r=vt(e)>ot;function s(d,p,y,T){J4(T,i,t,y,d,p)}function o(d,p){return Ze(d)*Ze(p)>e}function a(d){var p,y,T,b,_;return{lineStart:function(){b=T=!1,_=1},point:function(w,L){var P=[w,L],R,k=o(w,L),F=n?k?0:h(w,L):k?h(w+(w<0?ft:-ft),L):0;if(!p&&(b=T=k)&&d.lineStart(),k!==T&&(R=c(p,P),(!R||IA(p,R)||IA(P,R))&&(P[2]=1)),k!==T)_=0,k?(d.lineStart(),R=c(P,p),d.point(R[0],R[1])):(R=c(p,P),d.point(R[0],R[1],2),d.lineEnd()),p=R;else if(r&&p&&n^k){var U;!(F&y)&&(U=c(P,p,!0))&&(_=0,n?(d.lineStart(),d.point(U[0][0],U[0][1]),d.point(U[1][0],U[1][1]),d.lineEnd()):(d.point(U[1][0],U[1][1]),d.lineEnd(),d.lineStart(),d.point(U[0][0],U[0][1],3)))}k&&(!p||!IA(p,P))&&d.point(P[0],P[1]),p=P,T=k,y=F},lineEnd:function(){T&&d.lineEnd(),p=null},clean:function(){return _|(b&&T)<<1}}}function c(d,p,y){var T=Wr(d),b=Wr(p),_=[1,0,0],w=Gs(T,b),L=oA(w,w),P=w[0],R=L-P*P;if(!R)return!y&&d;var k=e*L/R,F=-e*P/R,U=Gs(_,w),$=aA(_,k),G=aA(w,F);T0($,G);var W=U,Q=oA($,W),K=oA(W,W),te=Q*Q-K*(oA($,$)-1);if(!(te<0)){var oe=qn(te),Ae=aA(W,(-Q-oe)/K);if(T0(Ae,$),Ae=rl(Ae),!y)return Ae;var X=d[0],Y=p[0],ee=d[1],re=p[1],ue;Y<X&&(ue=X,X=Y,Y=ue);var Te=Y-X,ge=vt(Te-ft)<ot,pe=ge||Te<ot;if(!ge&&re<ee&&(ue=ee,ee=re,re=ue),pe?ge?ee+re>0^Ae[1]<(vt(Ae[0]-X)<ot?ee:re):ee<=Ae[1]&&Ae[1]<=re:Te>ft^(X<=Ae[0]&&Ae[0]<=Y)){var De=aA(W,(-Q+oe)/K);return T0(De,$),[Ae,rl(De)]}}}function h(d,p){var y=n?i:ft-i,T=0;return d<-y?T|=1:d>y&&(T|=2),p<-y?T|=4:p>y&&(T|=8),T}return kT(o,a,s,n?[0,-i]:[-ft,i-ft])}function o8(i,e,t,n,r,s){var o=i[0],a=i[1],c=e[0],h=e[1],d=0,p=1,y=c-o,T=h-a,b;if(b=t-o,!(!y&&b>0)){if(b/=y,y<0){if(b<d)return;b<p&&(p=b)}else if(y>0){if(b>p)return;b>d&&(d=b)}if(b=r-o,!(!y&&b<0)){if(b/=y,y<0){if(b>p)return;b>d&&(d=b)}else if(y>0){if(b<d)return;b<p&&(p=b)}if(b=n-a,!(!T&&b>0)){if(b/=T,T<0){if(b<d)return;b<p&&(p=b)}else if(T>0){if(b>p)return;b>d&&(d=b)}if(b=s-a,!(!T&&b<0)){if(b/=T,T<0){if(b>p)return;b>d&&(d=b)}else if(T>0){if(b<d)return;b<p&&(p=b)}return d>0&&(i[0]=o+d*y,i[1]=a+d*T),p<1&&(e[0]=o+p*y,e[1]=a+p*T),!0}}}}}var _o=1e9,lA=-_o;function a8(i,e,t,n){function r(h,d){return i<=h&&h<=t&&e<=d&&d<=n}function s(h,d,p,y){var T=0,b=0;if(h==null||(T=o(h,p))!==(b=o(d,p))||c(h,d)<0^p>0)do y.point(T===0||T===3?i:t,T>1?n:e);while((T=(T+p+4)%4)!==b);else y.point(d[0],d[1])}function o(h,d){return vt(h[0]-i)<ot?d>0?0:3:vt(h[0]-t)<ot?d>0?2:1:vt(h[1]-e)<ot?d>0?1:0:d>0?3:2}function a(h,d){return c(h.x,d.x)}function c(h,d){var p=o(h,1),y=o(d,1);return p!==y?p-y:p===0?d[1]-h[1]:p===1?h[0]-d[0]:p===2?h[1]-d[1]:d[0]-h[0]}return function(h){var d=h,p=DT(),y,T,b,_,w,L,P,R,k,F,U,$={point:G,lineStart:te,lineEnd:oe,polygonStart:Q,polygonEnd:K};function G(X,Y){r(X,Y)&&d.point(X,Y)}function W(){for(var X=0,Y=0,ee=T.length;Y<ee;++Y)for(var re=T[Y],ue=1,Te=re.length,ge=re[0],pe,De,ze=ge[0],Me=ge[1];ue<Te;++ue)pe=ze,De=Me,ge=re[ue],ze=ge[0],Me=ge[1],De<=n?Me>n&&(ze-pe)*(n-De)>(Me-De)*(i-pe)&&++X:Me<=n&&(ze-pe)*(n-De)<(Me-De)*(i-pe)&&--X;return X}function Q(){d=p,y=[],T=[],U=!0}function K(){var X=W(),Y=U&&X,ee=(y=aT(y)).length;(Y||ee)&&(h.polygonStart(),Y&&(h.lineStart(),s(null,null,1,h),h.lineEnd()),ee&&CT(y,a,X,s,h),h.polygonEnd()),d=h,y=T=b=null}function te(){$.point=Ae,T&&T.push(b=[]),F=!0,k=!1,P=R=NaN}function oe(){y&&(Ae(_,w),L&&k&&p.rejoin(),y.push(p.result())),$.point=G,k&&d.lineEnd()}function Ae(X,Y){var ee=r(X,Y);if(T&&b.push([X,Y]),F)_=X,w=Y,L=ee,F=!1,ee&&(d.lineStart(),d.point(X,Y));else if(ee&&k)d.point(X,Y);else{var re=[P=Math.max(lA,Math.min(_o,P)),R=Math.max(lA,Math.min(_o,R))],ue=[X=Math.max(lA,Math.min(_o,X)),Y=Math.max(lA,Math.min(_o,Y))];o8(re,ue,i,e,t,n)?(k||(d.lineStart(),d.point(re[0],re[1])),d.point(ue[0],ue[1]),ee||d.lineEnd(),U=!1):ee&&(d.lineStart(),d.point(X,Y),U=!1)}P=X,R=Y,k=ee}return $}}var Kf,Qf,LA,RA,Vs={sphere:ai,point:ai,lineStart:A8,lineEnd:ai,polygonStart:ai,polygonEnd:ai};function A8(){Vs.point=u8,Vs.lineEnd=l8}function l8(){Vs.point=Vs.lineEnd=ai}function u8(i,e){i*=Ye,e*=Ye,Qf=i,LA=He(e),RA=Ze(e),Vs.point=f8}function f8(i,e){i*=Ye,e*=Ye;var t=He(e),n=Ze(e),r=vt(i-Qf),s=Ze(r),o=He(r),a=n*o,c=RA*t-LA*n*s,h=LA*t+RA*n*s;Kf.add(Ji(qn(a*a+c*c),h)),Qf=i,LA=t,RA=n}function c8(i){return Kf=new Kn,Nl(i,Vs),+Kf}var Wf=[null,null],h8={type:"LineString",coordinates:Wf};function ta(i,e){return Wf[0]=i,Wf[1]=e,c8(h8)}var C1={Feature:function(i,e){return hl(i.geometry,e)},FeatureCollection:function(i,e){for(var t=i.features,n=-1,r=t.length;++n<r;)if(hl(t[n].geometry,e))return!0;return!1}},P1={Sphere:function(){return!0},Point:function(i,e){return k1(i.coordinates,e)},MultiPoint:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(k1(t[n],e))return!0;return!1},LineString:function(i,e){return M1(i.coordinates,e)},MultiLineString:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(M1(t[n],e))return!0;return!1},Polygon:function(i,e){return O1(i.coordinates,e)},MultiPolygon:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(O1(t[n],e))return!0;return!1},GeometryCollection:function(i,e){for(var t=i.geometries,n=-1,r=t.length;++n<r;)if(hl(t[n],e))return!0;return!1}};function hl(i,e){return i&&P1.hasOwnProperty(i.type)?P1[i.type](i,e):!1}function k1(i,e){return ta(i,e)===0}function M1(i,e){for(var t,n,r,s=0,o=i.length;s<o;s++){if(n=ta(i[s],e),n===0||s>0&&(r=ta(i[s],i[s-1]),r>0&&t<=r&&n<=r&&(t+n-r)*(1-Math.pow((t-n)/r,2))<el*r))return!0;t=n}return!1}function O1(i,e){return!!PT(i.map(d8),MT(e))}function d8(i){return i=i.map(MT),i.pop(),i}function MT(i){return[i[0]*Ye,i[1]*Ye]}function NU(i,e){return(i&&C1.hasOwnProperty(i.type)?C1[i.type]:hl)(i,e)}function F1(i,e,t){var n=bs(i,e-ot,t).concat(e);return function(r){return n.map(function(s){return[r,s]})}}function B1(i,e,t){var n=bs(i,e-ot,t).concat(e);return function(r){return n.map(function(s){return[s,r]})}}function g8(){var i,e,t,n,r,s,o,a,c=10,h=c,d=90,p=360,y,T,b,_,w=2.5;function L(){return{type:"MultiLineString",coordinates:P()}}function P(){return bs(sA(n/d)*d,t,d).map(b).concat(bs(sA(a/p)*p,o,p).map(_)).concat(bs(sA(e/c)*c,i,c).filter(function(R){return vt(R%d)>ot}).map(y)).concat(bs(sA(s/h)*h,r,h).filter(function(R){return vt(R%p)>ot}).map(T))}return L.lines=function(){return P().map(function(R){return{type:"LineString",coordinates:R}})},L.outline=function(){return{type:"Polygon",coordinates:[b(n).concat(_(o).slice(1),b(t).reverse().slice(1),_(a).reverse().slice(1))]}},L.extent=function(R){return arguments.length?L.extentMajor(R).extentMinor(R):L.extentMinor()},L.extentMajor=function(R){return arguments.length?(n=+R[0][0],t=+R[1][0],a=+R[0][1],o=+R[1][1],n>t&&(R=n,n=t,t=R),a>o&&(R=a,a=o,o=R),L.precision(w)):[[n,a],[t,o]]},L.extentMinor=function(R){return arguments.length?(e=+R[0][0],i=+R[1][0],s=+R[0][1],r=+R[1][1],e>i&&(R=e,e=i,i=R),s>r&&(R=s,s=r,r=R),L.precision(w)):[[e,s],[i,r]]},L.step=function(R){return arguments.length?L.stepMajor(R).stepMinor(R):L.stepMinor()},L.stepMajor=function(R){return arguments.length?(d=+R[0],p=+R[1],L):[d,p]},L.stepMinor=function(R){return arguments.length?(c=+R[0],h=+R[1],L):[c,h]},L.precision=function(R){return arguments.length?(w=+R,y=F1(s,r,90),T=B1(e,i,w),b=F1(a,o,90),_=B1(n,t,w),L):w},L.extentMajor([[-180,-90+ot],[180,90-ot]]).extentMinor([[-180,-80-ot],[180,80+ot]])}function UU(){return g8()()}function $U(i,e){var t=i[0]*Ye,n=i[1]*Ye,r=e[0]*Ye,s=e[1]*Ye,o=Ze(n),a=He(n),c=Ze(s),h=He(s),d=o*Ze(t),p=o*He(t),y=c*Ze(r),T=c*He(r),b=2*Xn(qn(d1(s-n)+o*c*d1(r-t))),_=He(b),w=b?function(L){var P=He(L*=b)/_,R=He(b-L)/_,k=R*d+P*y,F=R*p+P*T,U=R*a+P*h;return[Ji(F,k)*Ft,Ji(U,qn(k*k+F*F))*Ft]}:function(){return[t*Ft,n*Ft]};return w.distance=b,w}const N1=i=>i;var Hs=1/0,dl=Hs,ia=-Hs,gl=ia,U1={point:p8,lineStart:ai,lineEnd:ai,polygonStart:ai,polygonEnd:ai,result:function(){var i=[[Hs,dl],[ia,gl]];return ia=gl=-(dl=Hs=1/0),i}};function p8(i,e){i<Hs&&(Hs=i),i>ia&&(ia=i),e<dl&&(dl=e),e>gl&&(gl=e)}function vh(i){return function(e){var t=new Yf;for(var n in i)t[n]=i[n];return t.stream=e,t}}function Yf(){}Yf.prototype={constructor:Yf,point:function(i,e){this.stream.point(i,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Eh(i,e,t){var n=i.clipExtent&&i.clipExtent();return i.scale(150).translate([0,0]),n!=null&&i.clipExtent(null),Nl(t,i.stream(U1)),e(U1.result()),n!=null&&i.clipExtent(n),i}function OT(i,e,t){return Eh(i,function(n){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),s/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,c=+e[0][1]+(s-o*(n[1][1]+n[0][1]))/2;i.scale(150*o).translate([a,c])},t)}function m8(i,e,t){return OT(i,[[0,0],e],t)}function y8(i,e,t){return Eh(i,function(n){var r=+e,s=r/(n[1][0]-n[0][0]),o=(r-s*(n[1][0]+n[0][0]))/2,a=-s*n[0][1];i.scale(150*s).translate([o,a])},t)}function v8(i,e,t){return Eh(i,function(n){var r=+e,s=r/(n[1][1]-n[0][1]),o=-s*n[0][0],a=(r-s*(n[1][1]+n[0][1]))/2;i.scale(150*s).translate([o,a])},t)}var $1=16,E8=Ze(30*Ye);function G1(i,e){return+e?S8(i,e):T8(i)}function T8(i){return vh({point:function(e,t){e=i(e,t),this.stream.point(e[0],e[1])}})}function S8(i,e){function t(n,r,s,o,a,c,h,d,p,y,T,b,_,w){var L=h-n,P=d-r,R=L*L+P*P;if(R>4*e&&_--){var k=o+y,F=a+T,U=c+b,$=qn(k*k+F*F+U*U),G=Xn(U/=$),W=vt(vt(U)-1)<ot||vt(s-p)<ot?(s+p)/2:Ji(F,k),Q=i(W,G),K=Q[0],te=Q[1],oe=K-n,Ae=te-r,X=P*oe-L*Ae;(X*X/R>e||vt((L*oe+P*Ae)/R-.5)>.3||o*y+a*T+c*b<E8)&&(t(n,r,s,o,a,c,K,te,W,k/=$,F/=$,U,_,w),w.point(K,te),t(K,te,W,k,F,U,h,d,p,y,T,b,_,w))}}return function(n){var r,s,o,a,c,h,d,p,y,T,b,_,w={point:L,lineStart:P,lineEnd:k,polygonStart:function(){n.polygonStart(),w.lineStart=F},polygonEnd:function(){n.polygonEnd(),w.lineStart=P}};function L(G,W){G=i(G,W),n.point(G[0],G[1])}function P(){p=NaN,w.point=R,n.lineStart()}function R(G,W){var Q=Wr([G,W]),K=i(G,W);t(p,y,d,T,b,_,p=K[0],y=K[1],d=G,T=Q[0],b=Q[1],_=Q[2],$1,n),n.point(p,y)}function k(){w.point=L,n.lineEnd()}function F(){P(),w.point=U,w.lineEnd=$}function U(G,W){R(r=G,W),s=p,o=y,a=T,c=b,h=_,w.point=R}function $(){t(p,y,d,T,b,_,s,o,r,a,c,h,$1,n),w.lineEnd=k,k()}return w}}var b8=vh({point:function(i,e){this.stream.point(i*Ye,e*Ye)}});function x8(i){return vh({point:function(e,t){var n=i(e,t);return this.stream.point(n[0],n[1])}})}function _8(i,e,t,n,r){function s(o,a){return o*=n,a*=r,[e+i*o,t-i*a]}return s.invert=function(o,a){return[(o-e)/i*n,(t-a)/i*r]},s}function V1(i,e,t,n,r,s){if(!s)return _8(i,e,t,n,r);var o=Ze(s),a=He(s),c=o*i,h=a*i,d=o/i,p=a/i,y=(a*t-o*e)/i,T=(a*e+o*t)/i;function b(_,w){return _*=n,w*=r,[c*_-h*w+e,t-h*_-c*w]}return b.invert=function(_,w){return[n*(d*_-p*w+y),r*(T-p*_-d*w)]},b}function w8(i){return I8(function(){return i})()}function I8(i){var e,t=150,n=480,r=250,s=0,o=0,a=0,c=0,h=0,d,p=0,y=1,T=1,b=null,_=D1,w=null,L,P,R,k=N1,F=.5,U,$,G,W,Q;function K(X){return G(X[0]*Ye,X[1]*Ye)}function te(X){return X=G.invert(X[0],X[1]),X&&[X[0]*Ft,X[1]*Ft]}K.stream=function(X){return W&&Q===X?W:W=b8(x8(d)(_(U(k(Q=X)))))},K.preclip=function(X){return arguments.length?(_=X,b=void 0,Ae()):_},K.postclip=function(X){return arguments.length?(k=X,w=L=P=R=null,Ae()):k},K.clipAngle=function(X){return arguments.length?(_=+X?s8(b=X*Ye):(b=null,D1),Ae()):b*Ft},K.clipExtent=function(X){return arguments.length?(k=X==null?(w=L=P=R=null,N1):a8(w=+X[0][0],L=+X[0][1],P=+X[1][0],R=+X[1][1]),Ae()):w==null?null:[[w,L],[P,R]]},K.scale=function(X){return arguments.length?(t=+X,oe()):t},K.translate=function(X){return arguments.length?(n=+X[0],r=+X[1],oe()):[n,r]},K.center=function(X){return arguments.length?(s=X[0]%360*Ye,o=X[1]%360*Ye,oe()):[s*Ft,o*Ft]},K.rotate=function(X){return arguments.length?(a=X[0]%360*Ye,c=X[1]%360*Ye,h=X.length>2?X[2]%360*Ye:0,oe()):[a*Ft,c*Ft,h*Ft]},K.angle=function(X){return arguments.length?(p=X%360*Ye,oe()):p*Ft},K.reflectX=function(X){return arguments.length?(y=X?-1:1,oe()):y<0},K.reflectY=function(X){return arguments.length?(T=X?-1:1,oe()):T<0},K.precision=function(X){return arguments.length?(U=G1($,F=X*X),Ae()):qn(F)},K.fitExtent=function(X,Y){return OT(K,X,Y)},K.fitSize=function(X,Y){return m8(K,X,Y)},K.fitWidth=function(X,Y){return y8(K,X,Y)},K.fitHeight=function(X,Y){return v8(K,X,Y)};function oe(){var X=V1(t,0,0,y,T,p).apply(null,e(s,o)),Y=V1(t,n-X[0],r-X[1],y,T,p);return d=RT(a,c,h),$=Hf(e,Y),G=Hf(d,$),U=G1($,F),Ae()}function Ae(){return W=Q=null,K}return function(){return e=i.apply(this,arguments),K.invert=e.invert&&te,oe()}}function L8(i){return function(e,t){var n=qn(e*e+t*t),r=i(n),s=He(r),o=Ze(r);return[Ji(e*s,n*o),Xn(n&&t*s/n)]}}function R8(i,e){return[i,B4(U4((Ri+e)/2))]}R8.invert=function(i,e){return[i,2*mh(F4(e))-Ri]};function FT(i,e){var t=Ze(e),n=1+Ze(i)*t;return[t*He(i)/n,He(e)/n]}FT.invert=L8(function(i){return 2*mh(i)});function D8(){return w8(FT).scale(250).clipAngle(142)}function GU(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=BT(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,h;if(n&&(s=O8(i,e,s,t)),i.length>80*t){a=i[0],c=i[1];let d=a,p=c;for(let y=t;y<r;y+=t){const T=i[y],b=i[y+1];T<a&&(a=T),b<c&&(c=b),T>d&&(d=T),b>p&&(p=b)}h=Math.max(d-a,p-c),h=h!==0?32767/h:0}return na(s,o,t,a,c,h,0),o}function BT(i,e,t,n,r){let s;if(r===Q8(i,e,t,n)>0)for(let o=e;o<t;o+=n)s=H1(o/n|0,i[o],i[o+1],s);else for(let o=t-n;o>=e;o-=n)s=H1(o/n|0,i[o],i[o+1],s);return s&&js(s,s.next)&&(sa(s),s=s.next),s}function Yr(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(js(t,t.next)||Pt(t.prev,t,t.next)===0)){if(sa(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function na(i,e,t,n,r,s,o){if(!i)return;!o&&s&&$8(i,n,r,s);let a=i;for(;i.prev!==i.next;){const c=i.prev,h=i.next;if(s?P8(i,n,r,s):C8(i)){e.push(c.i,i.i,h.i),sa(i),i=h.next,a=h.next;continue}if(i=h,i===a){o?o===1?(i=k8(Yr(i),e),na(i,e,t,n,r,s,2)):o===2&&M8(i,e,t,n,r,s):na(Yr(i),e,t,n,r,s,1);break}}}function C8(i){const e=i.prev,t=i,n=i.next;if(Pt(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,c=t.y,h=n.y,d=Math.min(r,s,o),p=Math.min(a,c,h),y=Math.max(r,s,o),T=Math.max(a,c,h);let b=n.next;for(;b!==e;){if(b.x>=d&&b.x<=y&&b.y>=p&&b.y<=T&&wo(r,a,s,c,o,h,b.x,b.y)&&Pt(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function P8(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Pt(r,s,o)>=0)return!1;const a=r.x,c=s.x,h=o.x,d=r.y,p=s.y,y=o.y,T=Math.min(a,c,h),b=Math.min(d,p,y),_=Math.max(a,c,h),w=Math.max(d,p,y),L=zf(T,b,e,t,n),P=zf(_,w,e,t,n);let R=i.prevZ,k=i.nextZ;for(;R&&R.z>=L&&k&&k.z<=P;){if(R.x>=T&&R.x<=_&&R.y>=b&&R.y<=w&&R!==r&&R!==o&&wo(a,d,c,p,h,y,R.x,R.y)&&Pt(R.prev,R,R.next)>=0||(R=R.prevZ,k.x>=T&&k.x<=_&&k.y>=b&&k.y<=w&&k!==r&&k!==o&&wo(a,d,c,p,h,y,k.x,k.y)&&Pt(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;R&&R.z>=L;){if(R.x>=T&&R.x<=_&&R.y>=b&&R.y<=w&&R!==r&&R!==o&&wo(a,d,c,p,h,y,R.x,R.y)&&Pt(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;k&&k.z<=P;){if(k.x>=T&&k.x<=_&&k.y>=b&&k.y<=w&&k!==r&&k!==o&&wo(a,d,c,p,h,y,k.x,k.y)&&Pt(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function k8(i,e){let t=i;do{const n=t.prev,r=t.next.next;!js(n,r)&&UT(n,t,t.next,r)&&ra(n,r)&&ra(r,n)&&(e.push(n.i,t.i,r.i),sa(t),sa(t.next),t=i=r),t=t.next}while(t!==i);return Yr(t)}function M8(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&H8(o,a)){let c=$T(o,a);o=Yr(o,o.next),c=Yr(c,c.next),na(o,e,t,n,r,s,0),na(c,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function O8(i,e,t,n){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*n,c=s<o-1?e[s+1]*n:i.length,h=BT(i,a,c,n,!1);h===h.next&&(h.steiner=!0),r.push(V8(h))}r.sort(F8);for(let s=0;s<r.length;s++)t=B8(r[s],t);return t}function F8(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function B8(i,e){const t=N8(i,e);if(!t)return e;const n=$T(t,i);return Yr(n,n.next),Yr(t,t.next)}function N8(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;if(js(i,t))return t;do{if(js(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=n&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===n))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,c=o.x,h=o.y;let d=1/0;t=o;do{if(n>=t.x&&t.x>=c&&n!==t.x&&NT(r<h?n:s,r,c,h,r<h?s:n,r,t.x,t.y)){const p=Math.abs(r-t.y)/(n-t.x);ra(t,i)&&(p<d||p===d&&(t.x>o.x||t.x===o.x&&U8(o,t)))&&(o=t,d=p)}t=t.next}while(t!==a);return o}function U8(i,e){return Pt(i.prev,i,e.prev)<0&&Pt(e.next,i,i.next)<0}function $8(i,e,t,n){let r=i;do r.z===0&&(r.z=zf(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,G8(r)}function G8(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let o=n,a=0;for(let h=0;h<t&&(a++,o=o.nextZ,!!o);h++);let c=t;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,c--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=o}s.nextZ=null,t*=2}while(e>1);return i}function zf(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function V8(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function NT(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function wo(i,e,t,n,r,s,o,a){return!(i===o&&e===a)&&NT(i,e,t,n,r,s,o,a)}function H8(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!j8(i,e)&&(ra(i,e)&&ra(e,i)&&K8(i,e)&&(Pt(i.prev,i,e.prev)||Pt(i,e.prev,e))||js(i,e)&&Pt(i.prev,i,i.next)>0&&Pt(e.prev,e,e.next)>0)}function Pt(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function js(i,e){return i.x===e.x&&i.y===e.y}function UT(i,e,t,n){const r=fA(Pt(i,e,t)),s=fA(Pt(i,e,n)),o=fA(Pt(t,n,i)),a=fA(Pt(t,n,e));return!!(r!==s&&o!==a||r===0&&uA(i,t,e)||s===0&&uA(i,n,e)||o===0&&uA(t,i,n)||a===0&&uA(t,e,n))}function uA(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function fA(i){return i>0?1:i<0?-1:0}function j8(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&UT(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function ra(i,e){return Pt(i.prev,i,i.next)<0?Pt(i,e,i.next)>=0&&Pt(i,i.prev,e)>=0:Pt(i,e,i.prev)<0||Pt(i,i.next,e)<0}function K8(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function $T(i,e){const t=qf(i.i,i.x,i.y),n=qf(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function H1(i,e,t,n){const r=qf(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function sa(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function qf(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Q8(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}function VU(i){const e=[],t=[],n=i[0][0].length;let r=0,s=0;for(const o of i){for(const a of o)for(let c=0;c<n;c++)e.push(a[c]);s&&(r+=s,t.push(r)),s=o.length}return{vertices:e,holes:t,dimensions:n}}var GT=(function(i){return typeof i=="function"?i:typeof i=="string"?function(e){return e[i]}:function(e){return i}});function pl(i){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pl(i)}var W8=/^\s+/,Y8=/\s+$/;function ke(i,e){if(i=i||"",e=e||{},i instanceof ke)return i;if(!(this instanceof ke))return new ke(i,e);var t=z8(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}ke.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,n,r,s,o,a;return t=e.r/255,n=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=VT(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=K1(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=K1(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=j1(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=j1(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return Q1(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return J8(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(It(this._r,255)*100)+"%",g:Math.round(It(this._g,255)*100)+"%",b:Math.round(It(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(It(this._r,255)*100)+"%, "+Math.round(It(this._g,255)*100)+"%, "+Math.round(It(this._b,255)*100)+"%)":"rgba("+Math.round(It(this._r,255)*100)+"%, "+Math.round(It(this._g,255)*100)+"%, "+Math.round(It(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:fF[Q1(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+W1(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=ke(e);n="#"+W1(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return ke(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(nF,arguments)},brighten:function(){return this._applyModification(rF,arguments)},darken:function(){return this._applyModification(sF,arguments)},desaturate:function(){return this._applyModification(eF,arguments)},saturate:function(){return this._applyModification(tF,arguments)},greyscale:function(){return this._applyModification(iF,arguments)},spin:function(){return this._applyModification(oF,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(lF,arguments)},complement:function(){return this._applyCombination(aF,arguments)},monochromatic:function(){return this._applyCombination(uF,arguments)},splitcomplement:function(){return this._applyCombination(AF,arguments)},triad:function(){return this._applyCombination(Y1,[3])},tetrad:function(){return this._applyCombination(Y1,[4])}};ke.fromRatio=function(i,e){if(pl(i)=="object"){var t={};for(var n in i)i.hasOwnProperty(n)&&(n==="a"?t[n]=i[n]:t[n]=Io(i[n]));i=t}return ke(i,e)};function z8(i){var e={r:0,g:0,b:0},t=1,n=null,r=null,s=null,o=!1,a=!1;return typeof i=="string"&&(i=gF(i)),pl(i)=="object"&&($n(i.r)&&$n(i.g)&&$n(i.b)?(e=q8(i.r,i.g,i.b),o=!0,a=String(i.r).substr(-1)==="%"?"prgb":"rgb"):$n(i.h)&&$n(i.s)&&$n(i.v)?(n=Io(i.s),r=Io(i.v),e=Z8(i.h,n,r),o=!0,a="hsv"):$n(i.h)&&$n(i.s)&&$n(i.l)&&(n=Io(i.s),s=Io(i.l),e=X8(i.h,n,s),o=!0,a="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=VT(t),{ok:o,format:i.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function q8(i,e,t){return{r:It(i,255)*255,g:It(e,255)*255,b:It(t,255)*255}}function j1(i,e,t){i=It(i,255),e=It(e,255),t=It(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,o,a=(n+r)/2;if(n==r)s=o=0;else{var c=n-r;switch(o=a>.5?c/(2-n-r):c/(n+r),n){case i:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-i)/c+2;break;case t:s=(i-e)/c+4;break}s/=6}return{h:s,s:o,l:a}}function X8(i,e,t){var n,r,s;i=It(i,360),e=It(e,100),t=It(t,100);function o(h,d,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?h+(d-h)*6*p:p<1/2?d:p<2/3?h+(d-h)*(2/3-p)*6:h}if(e===0)n=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;n=o(c,a,i+1/3),r=o(c,a,i),s=o(c,a,i-1/3)}return{r:n*255,g:r*255,b:s*255}}function K1(i,e,t){i=It(i,255),e=It(e,255),t=It(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,o,a=n,c=n-r;if(o=n===0?0:c/n,n==r)s=0;else{switch(n){case i:s=(e-t)/c+(e<t?6:0);break;case e:s=(t-i)/c+2;break;case t:s=(i-e)/c+4;break}s/=6}return{h:s,s:o,v:a}}function Z8(i,e,t){i=It(i,360)*6,e=It(e,100),t=It(t,100);var n=Math.floor(i),r=i-n,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),c=n%6,h=[t,o,s,s,a,t][c],d=[a,t,t,o,s,s][c],p=[s,s,a,t,t,o][c];return{r:h*255,g:d*255,b:p*255}}function Q1(i,e,t,n){var r=[dn(Math.round(i).toString(16)),dn(Math.round(e).toString(16)),dn(Math.round(t).toString(16))];return n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function J8(i,e,t,n,r){var s=[dn(Math.round(i).toString(16)),dn(Math.round(e).toString(16)),dn(Math.round(t).toString(16)),dn(HT(n))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function W1(i,e,t,n){var r=[dn(HT(n)),dn(Math.round(i).toString(16)),dn(Math.round(e).toString(16)),dn(Math.round(t).toString(16))];return r.join("")}ke.equals=function(i,e){return!i||!e?!1:ke(i).toRgbString()==ke(e).toRgbString()};ke.random=function(){return ke.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function eF(i,e){e=e===0?0:e||10;var t=ke(i).toHsl();return t.s-=e/100,t.s=Ul(t.s),ke(t)}function tF(i,e){e=e===0?0:e||10;var t=ke(i).toHsl();return t.s+=e/100,t.s=Ul(t.s),ke(t)}function iF(i){return ke(i).desaturate(100)}function nF(i,e){e=e===0?0:e||10;var t=ke(i).toHsl();return t.l+=e/100,t.l=Ul(t.l),ke(t)}function rF(i,e){e=e===0?0:e||10;var t=ke(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),ke(t)}function sF(i,e){e=e===0?0:e||10;var t=ke(i).toHsl();return t.l-=e/100,t.l=Ul(t.l),ke(t)}function oF(i,e){var t=ke(i).toHsl(),n=(t.h+e)%360;return t.h=n<0?360+n:n,ke(t)}function aF(i){var e=ke(i).toHsl();return e.h=(e.h+180)%360,ke(e)}function Y1(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=ke(i).toHsl(),n=[ke(i)],r=360/e,s=1;s<e;s++)n.push(ke({h:(t.h+s*r)%360,s:t.s,l:t.l}));return n}function AF(i){var e=ke(i).toHsl(),t=e.h;return[ke(i),ke({h:(t+72)%360,s:e.s,l:e.l}),ke({h:(t+216)%360,s:e.s,l:e.l})]}function lF(i,e,t){e=e||6,t=t||30;var n=ke(i).toHsl(),r=360/t,s=[ke(i)];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(ke(n));return s}function uF(i,e){e=e||6;for(var t=ke(i).toHsv(),n=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(ke({h:n,s:r,v:s})),s=(s+a)%1;return o}ke.mix=function(i,e,t){t=t===0?0:t||50;var n=ke(i).toRgb(),r=ke(e).toRgb(),s=t/100,o={r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a};return ke(o)};ke.readability=function(i,e){var t=ke(i),n=ke(e);return(Math.max(t.getLuminance(),n.getLuminance())+.05)/(Math.min(t.getLuminance(),n.getLuminance())+.05)};ke.isReadable=function(i,e,t){var n=ke.readability(i,e),r,s;switch(s=!1,r=pF(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=n>=4.5;break;case"AAlarge":s=n>=3;break;case"AAAsmall":s=n>=7;break}return s};ke.mostReadable=function(i,e,t){var n=null,r=0,s,o,a,c;t=t||{},o=t.includeFallbackColors,a=t.level,c=t.size;for(var h=0;h<e.length;h++)s=ke.readability(i,e[h]),s>r&&(r=s,n=ke(e[h]));return ke.isReadable(i,n,{level:a,size:c})||!o?n:(t.includeFallbackColors=!1,ke.mostReadable(i,["#fff","#000"],t))};var Xf=ke.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},fF=ke.hexNames=cF(Xf);function cF(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function VT(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function It(i,e){hF(i)&&(i="100%");var t=dF(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}function Ul(i){return Math.min(1,Math.max(0,i))}function Mi(i){return parseInt(i,16)}function hF(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}function dF(i){return typeof i=="string"&&i.indexOf("%")!=-1}function dn(i){return i.length==1?"0"+i:""+i}function Io(i){return i<=1&&(i=i*100+"%"),i}function HT(i){return Math.round(parseFloat(i)*255).toString(16)}function z1(i){return Mi(i)/255}var An=(function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function $n(i){return!!An.CSS_UNIT.exec(i)}function gF(i){i=i.replace(W8,"").replace(Y8,"").toLowerCase();var e=!1;if(Xf[i])i=Xf[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=An.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=An.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=An.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=An.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=An.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=An.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=An.hex8.exec(i))?{r:Mi(t[1]),g:Mi(t[2]),b:Mi(t[3]),a:z1(t[4]),format:e?"name":"hex8"}:(t=An.hex6.exec(i))?{r:Mi(t[1]),g:Mi(t[2]),b:Mi(t[3]),format:e?"name":"hex"}:(t=An.hex4.exec(i))?{r:Mi(t[1]+""+t[1]),g:Mi(t[2]+""+t[2]),b:Mi(t[3]+""+t[3]),a:z1(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=An.hex3.exec(i))?{r:Mi(t[1]+""+t[1]),g:Mi(t[2]+""+t[2]),b:Mi(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function pF(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function Zf(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function mF(i){if(Array.isArray(i))return i}function yF(i){if(Array.isArray(i))return Zf(i)}function jT(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function vF(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EF(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function si(i,e){return i.get(jT(i,e))}function fs(i,e,t){vF(i,e),e.set(i,t)}function cA(i,e,t){return i.set(jT(i,e),t),t}function TF(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,DF(n.key),n)}}function SF(i,e,t){return e&&TF(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function bF(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function xF(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(c=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function _F(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IF(i,e){return mF(i)||xF(i,e)||KT(i,e)||_F()}function LF(i){return yF(i)||bF(i)||KT(i)||wF()}function RF(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function DF(i){var e=RF(i,"string");return typeof e=="symbol"?e:e+""}function KT(i,e){if(i){if(typeof i=="string")return Zf(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Zf(i,e):void 0}}var cs=new WeakMap,mo=new WeakMap,hs=new WeakMap,b0=new WeakMap,x0=new WeakMap,_0=new WeakMap,HU=(function(){function i(){EF(this,i),fs(this,cs,new Map),fs(this,mo,new Map),fs(this,hs,function(e){return e}),fs(this,b0,function(){return{}}),fs(this,x0,function(){}),fs(this,_0,function(){})}return SF(i,[{key:"getObj",value:function(t){return si(cs,this).get(si(hs,this).call(this,t))}},{key:"getData",value:function(t){return si(mo,this).get(t)}},{key:"entries",value:function(){return LF(si(mo,this).entries()).map(function(t){var n=IF(t,2),r=n[0],s=n[1];return[s,r]})}},{key:"id",value:function(t){return cA(hs,this,GT(t)),this}},{key:"onCreateObj",value:function(t){return cA(b0,this,t),this}},{key:"onUpdateObj",value:function(t){return cA(x0,this,t),this}},{key:"onRemoveObj",value:function(t){return cA(_0,this,t),this}},{key:"digest",value:function(t){var n=this;t.filter(function(s){return!si(cs,n).has(si(hs,n).call(n,s))}).forEach(function(s){var o=si(b0,n).call(n,s);si(cs,n).set(si(hs,n).call(n,s),o),si(mo,n).set(o,s)});var r=new Map(t.map(function(s){return[si(hs,n).call(n,s),s]}));return si(cs,this).forEach(function(s,o){r.has(o)?si(x0,n).call(n,s,r.get(o)):(si(_0,n).call(n,s,o),si(cs,n).delete(o),si(mo,n).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])})(),DA={exports:{}},CF=DA.exports,q1;function PF(){return q1||(q1=1,(function(i,e){(function(t,n){i.exports=n()})(CF,function(){return(function(t){function n(s){if(r[s])return r[s].exports;var o=r[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)})([function(t,n,r){var s=r(1),o=(function(){function a(c,h,d){c===void 0&&(c=NaN),h===void 0&&(h=NaN),d===void 0&&(d=!1),this._minFPS=h,this._maxFPS=c,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,d||this.resume()}return a.prototype.updateOnce=function(c){c(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(c){this._timeScale!==c&&(this._timeScale=c)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var c=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return c.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(c,h){h===void 0&&(h=!0),this._currentTick++,this._currentTime+=c,this._tickDeltaTime=c,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),h&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a})();Object.defineProperty(n,"__esModule",{value:!0}),n.default=o},function(t,n,r){(function(s,o){t.exports=o()})(this,function(){return(function(s){function o(c){if(a[c])return a[c].exports;var h=a[c]={exports:{},id:c,loaded:!1};return s[c].call(h.exports,h,h.exports,o),h.loaded=!0,h.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)})([function(s,o){var a=(function(){function c(){this.functions=[]}return c.prototype.add=function(h){return this.functions.indexOf(h)===-1&&(this.functions.push(h),!0)},c.prototype.remove=function(h){var d=this.functions.indexOf(h);return d>-1&&(this.functions.splice(d,1),!0)},c.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},c.prototype.dispatch=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];var p=this.functions.concat();p.forEach(function(y){y.apply(void 0,h)})},Object.defineProperty(c.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),c})();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})})(DA)),DA.exports}var kF=PF();const jU=Qs(kF),Qn=11102230246251565e-32,oi=134217729,MF=(3+8*Qn)*Qn;function w0(i,e,t,n,r){let s,o,a,c,h=e[0],d=n[0],p=0,y=0;d>h==d>-h?(s=h,h=e[++p]):(s=d,d=n[++y]);let T=0;if(p<i&&y<t)for(d>h==d>-h?(o=h+s,a=s-(o-h),h=e[++p]):(o=d+s,a=s-(o-d),d=n[++y]),s=o,a!==0&&(r[T++]=a);p<i&&y<t;)d>h==d>-h?(o=s+h,c=o-s,a=s-(o-c)+(h-c),h=e[++p]):(o=s+d,c=o-s,a=s-(o-c)+(d-c),d=n[++y]),s=o,a!==0&&(r[T++]=a);for(;p<i;)o=s+h,c=o-s,a=s-(o-c)+(h-c),h=e[++p],s=o,a!==0&&(r[T++]=a);for(;y<t;)o=s+d,c=o-s,a=s-(o-c)+(d-c),d=n[++y],s=o,a!==0&&(r[T++]=a);return(s!==0||T===0)&&(r[T++]=s),T}function OF(i,e){let t=e[0];for(let n=1;n<i;n++)t+=e[n];return t}function va(i){return new Float64Array(i)}const FF=(3+16*Qn)*Qn,BF=(2+12*Qn)*Qn,NF=(9+64*Qn)*Qn*Qn,ds=va(4),X1=va(8),Z1=va(12),J1=va(16),ci=va(4);function UF(i,e,t,n,r,s,o){let a,c,h,d,p,y,T,b,_,w,L,P,R,k,F,U,$,G;const W=i-r,Q=t-r,K=e-s,te=n-s;k=W*te,y=oi*W,T=y-(y-W),b=W-T,y=oi*te,_=y-(y-te),w=te-_,F=b*w-(k-T*_-b*_-T*w),U=K*Q,y=oi*K,T=y-(y-K),b=K-T,y=oi*Q,_=y-(y-Q),w=Q-_,$=b*w-(U-T*_-b*_-T*w),L=F-$,p=F-L,ds[0]=F-(L+p)+(p-$),P=k+L,p=P-k,R=k-(P-p)+(L-p),L=R-U,p=R-L,ds[1]=R-(L+p)+(p-U),G=P+L,p=G-P,ds[2]=P-(G-p)+(L-p),ds[3]=G;let oe=OF(4,ds),Ae=BF*o;if(oe>=Ae||-oe>=Ae||(p=i-W,a=i-(W+p)+(p-r),p=t-Q,h=t-(Q+p)+(p-r),p=e-K,c=e-(K+p)+(p-s),p=n-te,d=n-(te+p)+(p-s),a===0&&c===0&&h===0&&d===0)||(Ae=NF*o+MF*Math.abs(oe),oe+=W*d+te*a-(K*h+Q*c),oe>=Ae||-oe>=Ae))return oe;k=a*te,y=oi*a,T=y-(y-a),b=a-T,y=oi*te,_=y-(y-te),w=te-_,F=b*w-(k-T*_-b*_-T*w),U=c*Q,y=oi*c,T=y-(y-c),b=c-T,y=oi*Q,_=y-(y-Q),w=Q-_,$=b*w-(U-T*_-b*_-T*w),L=F-$,p=F-L,ci[0]=F-(L+p)+(p-$),P=k+L,p=P-k,R=k-(P-p)+(L-p),L=R-U,p=R-L,ci[1]=R-(L+p)+(p-U),G=P+L,p=G-P,ci[2]=P-(G-p)+(L-p),ci[3]=G;const X=w0(4,ds,4,ci,X1);k=W*d,y=oi*W,T=y-(y-W),b=W-T,y=oi*d,_=y-(y-d),w=d-_,F=b*w-(k-T*_-b*_-T*w),U=K*h,y=oi*K,T=y-(y-K),b=K-T,y=oi*h,_=y-(y-h),w=h-_,$=b*w-(U-T*_-b*_-T*w),L=F-$,p=F-L,ci[0]=F-(L+p)+(p-$),P=k+L,p=P-k,R=k-(P-p)+(L-p),L=R-U,p=R-L,ci[1]=R-(L+p)+(p-U),G=P+L,p=G-P,ci[2]=P-(G-p)+(L-p),ci[3]=G;const Y=w0(X,X1,4,ci,Z1);k=a*d,y=oi*a,T=y-(y-a),b=a-T,y=oi*d,_=y-(y-d),w=d-_,F=b*w-(k-T*_-b*_-T*w),U=c*h,y=oi*c,T=y-(y-c),b=c-T,y=oi*h,_=y-(y-h),w=h-_,$=b*w-(U-T*_-b*_-T*w),L=F-$,p=F-L,ci[0]=F-(L+p)+(p-$),P=k+L,p=P-k,R=k-(P-p)+(L-p),L=R-U,p=R-L,ci[1]=R-(L+p)+(p-U),G=P+L,p=G-P,ci[2]=P-(G-p)+(L-p),ci[3]=G;const ee=w0(Y,Z1,4,ci,J1);return J1[ee-1]}function Lo(i,e,t,n,r,s){const o=(e-s)*(t-r),a=(i-r)*(n-s),c=o-a,h=Math.abs(o+a);return Math.abs(c)>=FF*h?c:-UF(i,e,t,n,r,s,h)}const ey=Math.pow(2,-52),hA=new Uint32Array(512);class ml{static from(e,t=jF,n=KF){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=n(a)}return new ml(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:s}=this,o=e.length>>1;let a=1/0,c=1/0,h=-1/0,d=-1/0;for(let W=0;W<o;W++){const Q=e[2*W],K=e[2*W+1];Q<a&&(a=Q),K<c&&(c=K),Q>h&&(h=Q),K>d&&(d=K),this._ids[W]=W}const p=(a+h)/2,y=(c+d)/2;let T,b,_;for(let W=0,Q=1/0;W<o;W++){const K=I0(p,y,e[2*W],e[2*W+1]);K<Q&&(T=W,Q=K)}const w=e[2*T],L=e[2*T+1];for(let W=0,Q=1/0;W<o;W++){if(W===T)continue;const K=I0(w,L,e[2*W],e[2*W+1]);K<Q&&K>0&&(b=W,Q=K)}let P=e[2*b],R=e[2*b+1],k=1/0;for(let W=0;W<o;W++){if(W===T||W===b)continue;const Q=VF(w,L,P,R,e[2*W],e[2*W+1]);Q<k&&(_=W,k=Q)}let F=e[2*_],U=e[2*_+1];if(k===1/0){for(let K=0;K<o;K++)this._dists[K]=e[2*K]-e[0]||e[2*K+1]-e[1];_s(this._ids,this._dists,0,o-1);const W=new Uint32Array(o);let Q=0;for(let K=0,te=-1/0;K<o;K++){const oe=this._ids[K],Ae=this._dists[oe];Ae>te&&(W[Q++]=oe,te=Ae)}this.hull=W.subarray(0,Q),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Lo(w,L,P,R,F,U)<0){const W=b,Q=P,K=R;b=_,P=F,R=U,_=W,F=Q,U=K}const $=HF(w,L,P,R,F,U);this._cx=$.x,this._cy=$.y;for(let W=0;W<o;W++)this._dists[W]=I0(e[2*W],e[2*W+1],$.x,$.y);_s(this._ids,this._dists,0,o-1),this._hullStart=T;let G=3;n[T]=t[_]=b,n[b]=t[T]=_,n[_]=t[b]=T,r[T]=0,r[b]=1,r[_]=2,s.fill(-1),s[this._hashKey(w,L)]=T,s[this._hashKey(P,R)]=b,s[this._hashKey(F,U)]=_,this.trianglesLen=0,this._addTriangle(T,b,_,-1,-1,-1);for(let W=0,Q,K;W<this._ids.length;W++){const te=this._ids[W],oe=e[2*te],Ae=e[2*te+1];if(W>0&&Math.abs(oe-Q)<=ey&&Math.abs(Ae-K)<=ey||(Q=oe,K=Ae,te===T||te===b||te===_))continue;let X=0;for(let Te=0,ge=this._hashKey(oe,Ae);Te<this._hashSize&&(X=s[(ge+Te)%this._hashSize],!(X!==-1&&X!==n[X]));Te++);X=t[X];let Y=X,ee;for(;ee=n[Y],Lo(oe,Ae,e[2*Y],e[2*Y+1],e[2*ee],e[2*ee+1])>=0;)if(Y=ee,Y===X){Y=-1;break}if(Y===-1)continue;let re=this._addTriangle(Y,te,n[Y],-1,-1,r[Y]);r[te]=this._legalize(re+2),r[Y]=re,G++;let ue=n[Y];for(;ee=n[ue],Lo(oe,Ae,e[2*ue],e[2*ue+1],e[2*ee],e[2*ee+1])<0;)re=this._addTriangle(ue,te,ee,r[te],-1,r[ue]),r[te]=this._legalize(re+2),n[ue]=ue,G--,ue=ee;if(Y===X)for(;ee=t[Y],Lo(oe,Ae,e[2*ee],e[2*ee+1],e[2*Y],e[2*Y+1])<0;)re=this._addTriangle(ee,te,Y,-1,r[Y],r[ee]),this._legalize(re+2),r[ee]=re,n[Y]=Y,G--,Y=ee;this._hullStart=t[te]=Y,n[Y]=t[ue]=te,n[te]=ue,s[this._hashKey(oe,Ae)]=te,s[this._hashKey(e[2*Y],e[2*Y+1])]=Y}this.hull=new Uint32Array(G);for(let W=0,Q=this._hullStart;W<G;W++)this.hull[W]=Q,Q=n[Q];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor($F(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let s=0,o=0;for(;;){const a=n[e],c=e-e%3;if(o=c+(e+2)%3,a===-1){if(s===0)break;e=hA[--s];continue}const h=a-a%3,d=c+(e+1)%3,p=h+(a+2)%3,y=t[o],T=t[e],b=t[d],_=t[p];if(GF(r[2*y],r[2*y+1],r[2*T],r[2*T+1],r[2*b],r[2*b+1],r[2*_],r[2*_+1])){t[e]=_,t[a]=y;const L=n[p];if(L===-1){let R=this._hullStart;do{if(this._hullTri[R]===p){this._hullTri[R]=e;break}R=this._hullPrev[R]}while(R!==this._hullStart)}this._link(e,L),this._link(a,n[o]),this._link(o,p);const P=h+(a+1)%3;s<hA.length&&(hA[s++]=P)}else{if(s===0)break;e=hA[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function $F(i,e){const t=i/(Math.abs(i)+Math.abs(e));return(e>0?3-t:1+t)/4}function I0(i,e,t,n){const r=i-t,s=e-n;return r*r+s*s}function GF(i,e,t,n,r,s,o,a){const c=i-o,h=e-a,d=t-o,p=n-a,y=r-o,T=s-a,b=c*c+h*h,_=d*d+p*p,w=y*y+T*T;return c*(p*w-_*T)-h*(d*w-_*y)+b*(d*T-p*y)<0}function VF(i,e,t,n,r,s){const o=t-i,a=n-e,c=r-i,h=s-e,d=o*o+a*a,p=c*c+h*h,y=.5/(o*h-a*c),T=(h*d-a*p)*y,b=(o*p-c*d)*y;return T*T+b*b}function HF(i,e,t,n,r,s){const o=t-i,a=n-e,c=r-i,h=s-e,d=o*o+a*a,p=c*c+h*h,y=.5/(o*h-a*c),T=i+(h*d-a*p)*y,b=e+(o*p-c*d)*y;return{x:T,y:b}}function _s(i,e,t,n){if(n-t<=20)for(let r=t+1;r<=n;r++){const s=i[r],o=e[s];let a=r-1;for(;a>=t&&e[i[a]]>o;)i[a+1]=i[a--];i[a+1]=s}else{const r=t+n>>1;let s=t+1,o=n;yo(i,r,s),e[i[t]]>e[i[n]]&&yo(i,t,n),e[i[s]]>e[i[n]]&&yo(i,s,n),e[i[t]]>e[i[s]]&&yo(i,t,s);const a=i[s],c=e[a];for(;;){do s++;while(e[i[s]]<c);do o--;while(e[i[o]]>c);if(o<s)break;yo(i,s,o)}i[t+1]=i[o],i[o]=a,n-s+1>=o-t?(_s(i,e,s,n),_s(i,e,t,o-1)):(_s(i,e,t,o-1),_s(i,e,s,n))}}function yo(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}function jF(i){return i[0]}function KF(i){return i[1]}function QF(i,e){var t,n,r=0,s,o,a,c,h,d,p,y=i[0],T=i[1],b=e.length;for(t=0;t<b;t++){n=0;var _=e[t],w=_.length-1;if(d=_[0],d[0]!==_[w][0]&&d[1]!==_[w][1])throw new Error("First and last coordinates in a ring must be the same");for(o=d[0]-y,a=d[1]-T,n;n<w;n++){if(p=_[n+1],c=p[0]-y,h=p[1]-T,a===0&&h===0){if(c<=0&&o>=0||o<=0&&c>=0)return 0}else if(h>=0&&a<=0||h<=0&&a>=0){if(s=Lo(o,c,a,h,0,0),s===0)return 0;(s>0&&h>0&&a<=0||s<0&&h<=0&&a>0)&&r++}d=p,a=h,o=c}}return r%2!==0}function WF(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function YF(i){return i.type==="Feature"?i.geometry:i}function zF(i,e,t={}){if(!i)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=WF(i),r=YF(e),s=r.type,o=e.bbox;let a=r.coordinates;if(o&&qF(n,o)===!1)return!1;s==="Polygon"&&(a=[a]);let c=!1;for(var h=0;h<a.length;++h){const d=QF(n,a[h]);if(d===0)return!t.ignoreBoundary;d&&(c=!0)}return c}function qF(i,e){return e[0]<=i[0]&&e[1]<=i[1]&&e[2]>=i[0]&&e[3]>=i[1]}var KU=zF;const ty=1e-6;class Ur{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){e=+e,t=+t,n=+n;const r=e+n,s=t;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>ty||Math.abs(this._y1-s)>ty)&&(this._+="L"+r+","+s),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=s}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class Jf{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class XF{constructor(e,[t,n,r,s]=[0,0,960,500]){if(!((r=+r)>=(t=+t))||!((s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=t,this.ymax=s,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let _=0,w=0,L=n.length,P,R;_<L;_+=3,w+=2){const k=n[_]*2,F=n[_+1]*2,U=n[_+2]*2,$=e[k],G=e[k+1],W=e[F],Q=e[F+1],K=e[U],te=e[U+1],oe=W-$,Ae=Q-G,X=K-$,Y=te-G,ee=(oe*Y-Ae*X)*2;if(Math.abs(ee)<1e-9){if(s===void 0){s=o=0;for(const ue of t)s+=e[ue*2],o+=e[ue*2+1];s/=t.length,o/=t.length}const re=1e9*Math.sign((s-$)*Y-(o-G)*X);P=($+K)/2-re*Y,R=(G+te)/2+re*X}else{const re=1/ee,ue=oe*oe+Ae*Ae,Te=X*X+Y*Y;P=$+(Y*ue-Ae*Te)*re,R=G+(oe*Te-X*ue)*re}a[w]=P,a[w+1]=R}let c=t[t.length-1],h,d=c*4,p,y=e[2*c],T,b=e[2*c+1];r.fill(0);for(let _=0;_<t.length;++_)c=t[_],h=d,p=y,T=b,d=c*4,y=e[2*c],b=e[2*c+1],r[h+2]=r[d]=T-b,r[h+3]=r[d+1]=y-p}render(e){const t=e==null?e=new Ur:void 0,{delaunay:{halfedges:n,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let d=0,p=n.length;d<p;++d){const y=n[d];if(y<d)continue;const T=Math.floor(d/3)*2,b=Math.floor(y/3)*2,_=o[T],w=o[T+1],L=o[b],P=o[b+1];this._renderSegment(_,w,L,P,e)}let c,h=s[s.length-1];for(let d=0;d<s.length;++d){c=h,h=s[d];const p=Math.floor(r[h]/3)*2,y=o[p],T=o[p+1],b=c*4,_=this._project(y,T,a[b+2],a[b+3]);_&&this._renderSegment(y,T,_[0],_[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new Ur:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=t==null?t=new Ur:void 0,r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&t.lineTo(r[o],r[o+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const r=this.cellPolygon(t);r&&(r.index=t,yield r)}}cellPolygon(e){const t=new Jf;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,s){let o;const a=this._regioncode(e,t),c=this._regioncode(n,r);a===0&&c===0?(s.moveTo(e,t),s.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,n){return t=+t,t!==t||(n=+n,n!==n)?!1:this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const r=this._clip(n);if(r){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,c=r.length;a<c;a+=2)if(t[s]===r[a]&&t[s+1]===r[a+1]&&t[(s+2)%o]===r[(a+c-2)%c]&&t[(s+3)%o]===r[(a+c-1)%c]){yield n;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:s}}=this,o=n[e];if(o===-1)return null;const a=[];let c=o;do{const h=Math.floor(c/3);if(a.push(t[h*2],t[h*2+1]),c=c%3===2?c-2:c+1,s[c]!==e)break;c=r[c]}while(c!==o&&c!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:n}=this,r=e*4;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let r=null,s,o,a=t[n-2],c=t[n-1],h,d=this._regioncode(a,c),p,y=0;for(let T=0;T<n;T+=2)if(s=a,o=c,a=t[T],c=t[T+1],h=d,d=this._regioncode(a,c),h===0&&d===0)p=y,y=0,r?r.push(a,c):r=[a,c];else{let b,_,w,L,P;if(h===0){if((b=this._clipSegment(s,o,a,c,h,d))===null)continue;[_,w,L,P]=b}else{if((b=this._clipSegment(a,c,s,o,d,h))===null)continue;[L,P,_,w]=b,p=y,y=this._edgecode(_,w),p&&y&&this._edge(e,p,y,r,r.length),r?r.push(_,w):r=[_,w]}p=y,y=this._edgecode(L,P),p&&y&&this._edge(e,p,y,r,r.length),r?r.push(L,P):r=[L,P]}if(r)p=y,y=this._edgecode(r[0],r[1]),p&&y&&this._edge(e,p,y,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,t,n,r,s,o){const a=s<o;for(a&&([e,t,n,r,s,o]=[n,r,e,t,o,s]);;){if(s===0&&o===0)return a?[n,r,e,t]:[e,t,n,r];if(s&o)return null;let c,h,d=s||o;d&8?(c=e+(n-e)*(this.ymax-t)/(r-t),h=this.ymax):d&4?(c=e+(n-e)*(this.ymin-t)/(r-t),h=this.ymin):d&2?(h=t+(r-t)*(this.xmax-e)/(n-e),c=this.xmax):(h=t+(r-t)*(this.xmin-e)/(n-e),c=this.xmin),s?(e=c,t=h,s=this._regioncode(e,t)):(n=c,r=h,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,s,o){let a=Array.from(t),c;if((c=this._project(a[0],a[1],n,r))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(c[0],c[1]),a=this._clipFinite(e,a))for(let h=0,d=a.length,p,y=this._edgecode(a[d-2],a[d-1]);h<d;h+=2)p=y,y=this._edgecode(a[h],a[h+1]),p&&y&&(h=this._edge(e,p,y,a,h),d=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,n,r,s){for(;t!==n;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(e,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(e,t,n,r){let s=1/0,o,a,c;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<s&&(c=this.ymin,a=e+(s=o)*n)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<s&&(c=this.ymax,a=e+(s=o)*n)}if(n>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/n)<s&&(a=this.xmax,c=t+(s=o)*r)}else if(n<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/n)<s&&(a=this.xmin,c=t+(s=o)*r)}return[a,c]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}const ZF=2*Math.PI,gs=Math.pow;function JF(i){return i[0]}function eB(i){return i[1]}function tB(i){const{triangles:e,coords:t}=i;for(let n=0;n<e.length;n+=3){const r=2*e[n],s=2*e[n+1],o=2*e[n+2];if((t[o]-t[r])*(t[s+1]-t[r+1])-(t[s]-t[r])*(t[o+1]-t[r+1])>1e-10)return!1}return!0}function iB(i,e,t){return[i+Math.sin(i+e)*t,e+Math.cos(i-e)*t]}class Th{static from(e,t=JF,n=eB,r){return new Th("length"in e?nB(e,t,n,r):Float64Array.from(rB(e,t,n,r)))}constructor(e){this._delaunator=new ml(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&tB(e)){this.collinear=Int32Array.from({length:t.length/2},(y,T)=>T).sort((y,T)=>t[2*y]-t[2*T]||t[2*y+1]-t[2*T+1]);const c=this.collinear[0],h=this.collinear[this.collinear.length-1],d=[t[2*c],t[2*c+1],t[2*h],t[2*h+1]],p=1e-8*Math.hypot(d[3]-d[1],d[2]-d[0]);for(let y=0,T=t.length/2;y<T;++y){const b=iB(t[2*y],t[2*y+1],p);t[2*y]=b[0],t[2*y+1]=b[1]}this._delaunator=new ml(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,h=n.length;c<h;++c){const d=s[c%3===2?c-2:c+1];(n[c]===-1||o[d]===-1)&&(o[d]=c)}for(let c=0,h=r.length;c<h;++c)a[r[c]]=c;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new XF(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const p=a.indexOf(e);p>0&&(yield a[p-1]),p<a.length-1&&(yield a[p+1]);return}const c=t[e];if(c===-1)return;let h=c,d=-1;do{if(yield d=o[h],h=h%3===2?h-2:h+1,o[h]!==e)return;if(h=s[h],h===-1){const p=n[(r[e]+1)%n.length];p!==d&&(yield p);return}}while(h!==c)}find(e,t,n=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const r=n;let s;for(;(s=this._step(n,e,t))>=0&&s!==n&&s!==r;)n=s;return s}_step(e,t,n){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:c,points:h}=this;if(r[e]===-1||!h.length)return(e+1)%(h.length>>1);let d=e,p=gs(t-h[e*2],2)+gs(n-h[e*2+1],2);const y=r[e];let T=y;do{let b=c[T];const _=gs(t-h[b*2],2)+gs(n-h[b*2+1],2);if(_<p&&(p=_,d=b),T=T%3===2?T-2:T+1,c[T]!==e)break;if(T=a[T],T===-1){if(T=s[(o[e]+1)%s.length],T!==b&&gs(t-h[T*2],2)+gs(n-h[T*2+1],2)<p)return T;break}}while(T!==y);return d}render(e){const t=e==null?e=new Ur:void 0,{points:n,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const c=r[o];if(c<o)continue;const h=s[o]*2,d=s[c]*2;e.moveTo(n[h],n[h+1]),e.lineTo(n[d],n[d+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const n=e==null?e=new Ur:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],c=r[s+1];e.moveTo(a+t,c),e.arc(a,c,t,0,ZF)}return n&&n.value()}renderHull(e){const t=e==null?e=new Ur:void 0,{hull:n,points:r}=this,s=n[0]*2,o=n.length;e.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const c=2*n[a];e.lineTo(r[c],r[c+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new Jf;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=t==null?t=new Ur:void 0,{points:r,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,c=s[e+2]*2;return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[c],r[c+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new Jf;return this.renderTriangle(e,t),t.value()}}function nB(i,e,t,n){const r=i.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=i[o];s[o*2]=e.call(n,a,o,i),s[o*2+1]=t.call(n,a,o,i)}return s}function*rB(i,e,t,n){let r=0;for(const s of i)yield e.call(n,s,r,i),yield t.call(n,s,r,i),++r}const Sh=Math.PI,iy=Sh/2,ny=180/Sh,ry=Sh/180,sB=Math.atan2,sy=Math.cos,oB=Math.max,aB=Math.min,oy=Math.sin,AB=Math.sign||function(i){return i>0?1:i<0?-1:0},QT=Math.sqrt;function lB(i){return i>1?iy:i<-1?-iy:Math.asin(i)}function WT(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Bi(i,e){return[i[1]*e[2]-i[2]*e[1],i[2]*e[0]-i[0]*e[2],i[0]*e[1]-i[1]*e[0]]}function yl(i,e){return[i[0]+e[0],i[1]+e[1],i[2]+e[2]]}function vl(i){var e=QT(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);return[i[0]/e,i[1]/e,i[2]/e]}function bh(i){return[sB(i[1],i[0])*ny,lB(oB(-1,aB(1,i[2])))*ny]}function Ln(i){const e=i[0]*ry,t=i[1]*ry,n=sy(t);return[n*sy(e),n*oy(e),oy(t)]}function xh(i){return i=i.map(e=>Ln(e)),WT(i[0],Bi(i[2],i[1]))}function uB(i){const e=cB(i),t=dB(e),n=hB(t,i),r=pB(t,i.length),s=fB(r,i),o=gB(t,i),{polygons:a,centers:c}=mB(o,t,i),h=yB(a),d=EB(t,i),p=vB(n,t);return{delaunay:e,edges:n,triangles:t,centers:c,neighbors:r,polygons:a,mesh:h,hull:d,urquhart:p,find:s}}function fB(i,e){function t(n,r){let s=n[0]-r[0],o=n[1]-r[1],a=n[2]-r[2];return s*s+o*o+a*a}return function(r,s,o){o===void 0&&(o=0);let a,c,h=o;const d=Ln([r,s]);do a=o,o=null,c=t(d,Ln(e[a])),i[a].forEach(p=>{let y=t(d,Ln(e[p]));if(y<c){c=y,o=p,h=p;return}});while(o!==null);return h}}function cB(i){if(i.length<2)return{};let e=0;for(;isNaN(i[e][0]+i[e][1])&&e++<i.length;);const t=Z4(i[e]),n=D8().translate([0,0]).scale(1).rotate(t.invert([180,0]));i=i.map(n);const r=[];let s=1;for(let p=0,y=i.length;p<y;p++){let T=i[p][0]**2+i[p][1]**2;!isFinite(T)||T>1e32?r.push(p):T>s&&(s=T)}const o=1e6*QT(s);r.forEach(p=>i[p]=[o,0]),i.push([0,o]),i.push([-o,0]),i.push([0,-o]);const a=Th.from(i);a.projection=n;const{triangles:c,halfedges:h,inedges:d}=a;for(let p=0,y=h.length;p<y;p++)if(h[p]<0){const T=p%3==2?p-2:p+1,b=p%3==0?p+2:p-1,_=h[T],w=h[b];h[_]=w,h[w]=_,h[T]=h[b]=-1,c[p]=c[T]=c[b]=e,d[c[_]]=_%3==0?_+2:_-1,d[c[w]]=w%3==0?w+2:w-1,p+=2-p%3}else c[p]>i.length-3-1&&(c[p]=e);return a}function hB(i,e){const t=new Set;return e.length===2?[[0,1]]:(i.forEach(n=>{if(n[0]!==n[1]&&!(xh(n.map(r=>e[r]))<0))for(let r=0,s;r<3;r++)s=(r+1)%3,t.add(oT([n[r],n[s]]).join("-"))}),Array.from(t,n=>n.split("-").map(Number)))}function dB(i){const{triangles:e}=i;if(!e)return[];const t=[];for(let n=0,r=e.length/3;n<r;n++){const s=e[3*n],o=e[3*n+1],a=e[3*n+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function gB(i,e){return i.map(t=>{const n=t.map(s=>e[s]).map(Ln),r=yl(yl(Bi(n[1],n[0]),Bi(n[2],n[1])),Bi(n[0],n[2]));return bh(vl(r))})}function pB(i,e){const t=[];return i.forEach(n=>{for(let r=0;r<3;r++){const s=n[r],o=n[(r+1)%3];t[s]=t[s]||[],t[s].push(o)}}),i.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function mB(i,e,t){const n=[],r=i.slice();if(e.length===0){if(t.length<2)return{polygons:n,centers:r};if(t.length===2){const a=Ln(t[0]),c=Ln(t[1]),h=vl(yl(a,c)),d=vl(Bi(a,c)),p=Bi(h,d),y=[h,Bi(h,p),Bi(Bi(h,p),p),Bi(Bi(Bi(h,p),p),p)].map(bh).map(o);return n.push(y),n.push(y.slice().reverse()),{polygons:n,centers:r}}}e.forEach((a,c)=>{for(let h=0;h<3;h++){const d=a[h],p=a[(h+1)%3],y=a[(h+2)%3];n[d]=n[d]||[],n[d].push([p,y,c,[d,p,y]])}});const s=n.map(a=>{const c=[a[0][2]];let h=a[0][1];for(let d=1;d<a.length;d++)for(let p=0;p<a.length;p++)if(a[p][0]==h){h=a[p][1],c.push(a[p][2]);break}if(c.length>2)return c;if(c.length==2){const d=ay(t[a[0][3][0]],t[a[0][3][1]],r[c[0]]),p=ay(t[a[0][3][2]],t[a[0][3][0]],r[c[0]]),y=o(d),T=o(p);return[c[0],T,c[1],y]}});function o(a){let c=-1;return r.slice(e.length,1/0).forEach((h,d)=>{h[0]===a[0]&&h[1]===a[1]&&(c=d+e.length)}),c<0&&(c=r.length,r.push(a)),c}return{polygons:s,centers:r}}function ay(i,e,t){i=Ln(i),e=Ln(e),t=Ln(t);const n=AB(WT(Bi(e,i),t));return bh(vl(yl(i,e)).map(r=>n*r))}function yB(i){const e=[];return i.forEach(t=>{if(!t)return;let n=t[t.length-1];for(let r of t)r>n&&e.push([n,r]),n=r}),e}function vB(i,e){return function(t){const n=new Map,r=new Map;return i.forEach((s,o)=>{const a=s.join("-");n.set(a,t[o]),r.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let c=0;c<3;c++){let h=oT([s[c],s[(c+1)%3]]).join("-");n.get(h)>o&&(o=n.get(h),a=h)}r.set(a,!1)}),i.map(s=>r.get(s.join("-")))}}function EB(i,e){const t=new Set,n=[];i.map(a=>{if(!(xh(a.map(c=>e[c>e.length?0:c]))>1e-12))for(let c=0;c<3;c++){let h=[a[c],a[(c+1)%3]],d=`${h[0]}-${h[1]}`;t.has(d)?t.delete(d):t.add(`${h[1]}-${h[0]}`)}});const r=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),r.set(a[0],a[1]),s=a[0]}),s===void 0)return n;let o=s;do{n.push(o);let a=r.get(o);r.set(o,-1),o=a}while(o>-1&&o!==s);return n}function QU(i){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const n=e._data.map(r=>[e._vx(r),e._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));e.points=n.map(r=>[r[0],r[1]]),e.valid=n.map(r=>r[2]),e.delaunay=uB(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return x1(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return x1(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const n={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((r,s)=>n.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&n.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),n},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((n,r)=>(n=n.map(s=>e.points[s]),n.center=e.delaunay.centers[r],n)).filter(n=>xh(n)>0).map(n=>({type:"Feature",properties:{circumcenter:n.center},geometry:{type:"Polygon",coordinates:[[...n,n[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const n=e.delaunay.edges.map(s=>ta(e.points[s[0]],e.points[s[1]])),r=e.delaunay.urquhart(n);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:n[o],urquhart:!!r[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(n=>[e.points[n[0]],e.points[n[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:n,polygons:r}=e.delaunay,s=[];for(const o of r)if(o)for(let a=o.length,c=o[a-1],h=o[0],d=0;d<a;c=h,h=o[++d])h>c&&s.push([n[c],n[h]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,n,r){if(e._found=e.delaunay.find(t,n,e._found),!r||ta([t,n],e.points[e._found])<r)return e._found},e.hull=function(t){t!==void 0&&e(t);const n=e.delaunay.hull,r=e.points;return n.length===0?null:{type:"Polygon",coordinates:[[...n.map(s=>r[s]),r[n[0]]]]}},i?e(i):e}function ec(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function TB(i){if(Array.isArray(i))return i}function SB(i){if(Array.isArray(i))return ec(i)}function bB(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function xB(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(c=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function _B(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IB(i,e){if(i==null)return{};var t,n,r=LB(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.includes(t)||{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function LB(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.includes(n))continue;t[n]=i[n]}return t}function RB(i,e){return TB(i)||xB(i,e)||YT(i,e)||_B()}function DB(i){return SB(i)||bB(i)||YT(i)||wB()}function CB(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function PB(i){var e=CB(i,"string");return typeof e=="symbol"?e:e+""}function YT(i,e){if(i){if(typeof i=="string")return ec(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ec(i,e):void 0}}var WU=(function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=i.reduce(function(a,c){var h=a,d=c;return r.forEach(function(p,y){var T=p.keyAccessor,b=p.isProp,_;if(b){var w=d,L=w[T],P=IB(w,[T].map(PB));_=L,d=P}else _=T(d,y);y+1<r.length?(h.hasOwnProperty(_)||(h[_]={}),h=h[_]):t?(h.hasOwnProperty(_)||(h[_]=[]),h[_].push(d)):h[_]=d}),a},{});t instanceof Function&&(function a(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;h===r.length?Object.keys(c).forEach(function(d){return c[d]=t(c[d])}):Object.values(c).forEach(function(d){return a(d,h+1)})})(s);var o=s;return n&&(o=[],(function a(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];h.length===r.length?o.push({keys:h,vals:c}):Object.entries(c).forEach(function(d){var p=RB(d,2),y=p[0],T=p[1];return a(T,[].concat(DB(h),[y]))})})(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o}),at=(function(i){i=i||{};var e=typeof i<"u"?i:{},t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);var r="";function s(le){return e.locateFile?e.locateFile(le,r):r+le}var o;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(ce,Se,de){var l=new XMLHttpRequest;l.open("GET",ce,!0),l.responseType="arraybuffer",l.onload=function(){if(l.status==200||l.status==0&&l.response){Se(l.response);return}var lt=jl(ce);if(lt){Se(lt.buffer);return}de()},l.onerror=de,l.send(null)};var a=e.print||(()=>{}).bind(console),c=e.printErr||(()=>{}).bind(console);for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);t=null,e.arguments&&e.arguments;var h=0,d=function(le){h=le},p=function(){return h},y=8;function T(le,ce,Se,de){switch(Se=Se||"i8",Se.charAt(Se.length-1)==="*"&&(Se="i32"),Se){case"i1":te[le>>0]=ce;break;case"i8":te[le>>0]=ce;break;case"i16":Ae[le>>1]=ce;break;case"i32":X[le>>2]=ce;break;case"i64":zr=[ce>>>0,(rn=ce,+Xs(rn)>=1?rn>0?(At(+Ih(rn/4294967296),4294967295)|0)>>>0:~~+Zs((rn-+(~~rn>>>0))/4294967296)>>>0:0)],X[le>>2]=zr[0],X[le+4>>2]=zr[1];break;case"float":Y[le>>2]=ce;break;case"double":ee[le>>3]=ce;break;default:qr("invalid type for setValue: "+Se)}}function b(le,ce,Se){switch(ce=ce||"i8",ce.charAt(ce.length-1)==="*"&&(ce="i32"),ce){case"i1":return te[le>>0];case"i8":return te[le>>0];case"i16":return Ae[le>>1];case"i32":return X[le>>2];case"i64":return X[le>>2];case"float":return Y[le>>2];case"double":return ee[le>>3];default:qr("invalid type for getValue: "+ce)}return null}var _=!1;function w(le,ce){le||qr("Assertion failed: "+ce)}function L(le){var ce=e["_"+le];return w(ce,"Cannot call unknown function "+le+", make sure it is exported"),ce}function P(le,ce,Se,de,l){var M={string:function(tt){var Hi=0;if(tt!=null&&tt!==0){var wa=(tt.length<<2)+1;Hi=Lh(wa),G(tt,Hi,wa)}return Hi},array:function(tt){var Hi=Lh(tt.length);return W(tt,Hi),Hi}};function lt(tt){return ce==="string"?U(tt):ce==="boolean"?!!tt:tt}var ht=L(le),Yt=[],et=0;if(de)for(var ut=0;ut<de.length;ut++){var er=M[Se[ut]];er?(et===0&&(et=PS()),Yt[ut]=er(de[ut])):Yt[ut]=de[ut]}var ct=ht.apply(null,Yt);return ct=lt(ct),et!==0&&CS(et),ct}function R(le,ce,Se,de){Se=Se||[];var l=Se.every(function(lt){return lt==="number"}),M=ce!=="string";return M&&l&&!de?L(le):function(){return P(le,ce,Se,arguments)}}var k=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function F(le,ce,Se){for(var de=ce+Se,l=ce;le[l]&&!(l>=de);)++l;if(l-ce>16&&le.subarray&&k)return k.decode(le.subarray(ce,l));for(var M="";ce<l;){var lt=le[ce++];if(!(lt&128)){M+=String.fromCharCode(lt);continue}var ht=le[ce++]&63;if((lt&224)==192){M+=String.fromCharCode((lt&31)<<6|ht);continue}var Yt=le[ce++]&63;if((lt&240)==224?lt=(lt&15)<<12|ht<<6|Yt:lt=(lt&7)<<18|ht<<12|Yt<<6|le[ce++]&63,lt<65536)M+=String.fromCharCode(lt);else{var et=lt-65536;M+=String.fromCharCode(55296|et>>10,56320|et&1023)}}return M}function U(le,ce){return le?F(oe,le,ce):""}function $(le,ce,Se,de){if(!(de>0))return 0;for(var l=Se,M=Se+de-1,lt=0;lt<le.length;++lt){var ht=le.charCodeAt(lt);if(ht>=55296&&ht<=57343){var Yt=le.charCodeAt(++lt);ht=65536+((ht&1023)<<10)|Yt&1023}if(ht<=127){if(Se>=M)break;ce[Se++]=ht}else if(ht<=2047){if(Se+1>=M)break;ce[Se++]=192|ht>>6,ce[Se++]=128|ht&63}else if(ht<=65535){if(Se+2>=M)break;ce[Se++]=224|ht>>12,ce[Se++]=128|ht>>6&63,ce[Se++]=128|ht&63}else{if(Se+3>=M)break;ce[Se++]=240|ht>>18,ce[Se++]=128|ht>>12&63,ce[Se++]=128|ht>>6&63,ce[Se++]=128|ht&63}}return ce[Se]=0,Se-l}function G(le,ce,Se){return $(le,oe,ce,Se)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function W(le,ce){te.set(le,ce)}function Q(le,ce){return le%ce>0&&(le+=ce-le%ce),le}var K,te,oe,Ae,X,Y,ee;function re(le){K=le,e.HEAP8=te=new Int8Array(le),e.HEAP16=Ae=new Int16Array(le),e.HEAP32=X=new Int32Array(le),e.HEAPU8=oe=new Uint8Array(le),e.HEAPU16=new Uint16Array(le),e.HEAPU32=new Uint32Array(le),e.HEAPF32=Y=new Float32Array(le),e.HEAPF64=ee=new Float64Array(le)}var ue=5271520,Te=28608,ge=e.TOTAL_MEMORY||33554432;e.buffer?K=e.buffer:K=new ArrayBuffer(ge),ge=K.byteLength,re(K),X[Te>>2]=ue;function pe(le){for(;le.length>0;){var ce=le.shift();if(typeof ce=="function"){ce();continue}var Se=ce.func;typeof Se=="number"?ce.arg===void 0?e.dynCall_v(Se):e.dynCall_vi(Se,ce.arg):Se(ce.arg===void 0?null:ce.arg)}}var De=[],ze=[],Me=[],rt=[];function Qt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Pn(e.preRun.shift());pe(De)}function Gt(){pe(ze)}function vi(){pe(Me)}function Vi(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Hl(e.postRun.shift());pe(rt)}function Pn(le){De.unshift(le)}function Hl(le){rt.unshift(le)}var Xs=Math.abs,Zs=Math.ceil,Ih=Math.floor,At=Math.min,_t=0,Wt=null;function kn(le){_t++,e.monitorRunDependencies&&e.monitorRunDependencies(_t)}function Pi(le){if(_t--,e.monitorRunDependencies&&e.monitorRunDependencies(_t),_t==0&&Wt){var ce=Wt;Wt=null,ce()}}e.preloadedImages={},e.preloadedAudios={};var li=null,nn="data:application/octet-stream;base64,";function Js(le){return String.prototype.startsWith?le.startsWith(nn):le.indexOf(nn)===0}var rn,zr;li="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Er=28624;function Ta(le,ce,Se,de){qr("Assertion failed: "+U(le)+", at: "+[ce?U(ce):"unknown filename",Se,de?U(de):"unknown function"])}function Sa(){return te.length}function ba(le,ce,Se){oe.set(oe.subarray(ce,ce+Se),le)}function xa(le){return e.___errno_location&&(X[e.___errno_location()>>2]=le),le}function Tr(le){qr("OOM")}function xS(le){try{var ce=new ArrayBuffer(le);return ce.byteLength!=le?void 0:(new Int8Array(ce).set(te),DS(ce),re(ce),1)}catch{}}function _S(le){var ce=Sa(),Se=16777216,de=2147483648-Se;if(le>de)return!1;for(var l=16777216,M=Math.max(ce,l);M<le;)M<=536870912?M=Q(2*M,Se):M=Math.min(Q((3*M+2147483648)/4,Se),de);var lt=xS(M);return!!lt}var wS=typeof atob=="function"?atob:function(le){var ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Se="",de,l,M,lt,ht,Yt,et,ut=0;le=le.replace(/[^A-Za-z0-9\+\/\=]/g,"");do lt=ce.indexOf(le.charAt(ut++)),ht=ce.indexOf(le.charAt(ut++)),Yt=ce.indexOf(le.charAt(ut++)),et=ce.indexOf(le.charAt(ut++)),de=lt<<2|ht>>4,l=(ht&15)<<4|Yt>>2,M=(Yt&3)<<6|et,Se=Se+String.fromCharCode(de),Yt!==64&&(Se=Se+String.fromCharCode(l)),et!==64&&(Se=Se+String.fromCharCode(M));while(ut<le.length);return Se};function IS(le){try{for(var ce=wS(le),Se=new Uint8Array(ce.length),de=0;de<ce.length;++de)Se[de]=ce.charCodeAt(de);return Se}catch{throw new Error("Converting base64 string to bytes failed.")}}function jl(le){if(Js(le))return IS(le.slice(nn.length))}var LS={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},RS={b:d,c:p,d:Ta,e:xa,f:Sa,g:ba,h:_S,i:Tr,o:Er,p:Te},me=(function(le,ce,Se){"almost asm";var de=new le.Int8Array(Se),l=new le.Int32Array(Se);new le.Uint8Array(Se),new le.Float32Array(Se);var M=new le.Float64Array(Se),lt=ce.o|0,ht=ce.p|0,Yt=le.Math.floor,et=le.Math.abs,ut=le.Math.sqrt,er=le.Math.pow,ct=le.Math.cos,tt=le.Math.sin,Hi=le.Math.tan,wa=le.Math.acos,kS=le.Math.asin,Wl=le.Math.atan,ji=le.Math.atan2,Xr=le.Math.ceil,gn=le.Math.imul,Yl=le.Math.min,MS=le.Math.max,Mn=le.Math.clz32,Qe=ce.b,N=ce.c,Ne=ce.d,Ph=ce.e,OS=ce.f,FS=ce.g,BS=ce.h,NS=ce.i,O=28640;function US(A){return de=new Int8Array(A),l=new Int32Array(A),M=new Float64Array(A),Se=A,!0}function $S(A){A=A|0;var u=0;return u=O,O=O+A|0,O=O+15&-16,u|0}function GS(){return O|0}function VS(A){A=A|0,O=A}function HS(A,u){A=A|0,O=A}function jS(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;return(A|0)<0?(u=2,u|0):(A|0)>13780509?(u=Ca(15,u)|0,u|0):(f=((A|0)<0)<<31>>31,m=qt(A|0,f|0,3,0)|0,g=N()|0,f=Ce(A|0,f|0,1,0)|0,f=qt(m|0,g|0,f|0,N()|0)|0,f=Ce(f|0,N()|0,1,0)|0,A=N()|0,l[u>>2]=f,l[u+4>>2]=A,u=0,u|0)}function kh(A,u,f,g){return A=A|0,u=u|0,f=f|0,g=g|0,Mh(A,u,f,g,0)|0}function Mh(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0;if(x=O,O=O+16|0,E=x,!(Oh(A,u,f,g,m)|0))return g=0,O=x,g|0;do if((f|0)>=0){if((f|0)>13780509){if(v=Ca(15,E)|0,v|0)break;S=E,E=l[S>>2]|0,S=l[S+4>>2]|0}else v=((f|0)<0)<<31>>31,I=qt(f|0,v|0,3,0)|0,S=N()|0,v=Ce(f|0,v|0,1,0)|0,v=qt(I|0,S|0,v|0,N()|0)|0,v=Ce(v|0,N()|0,1,0)|0,S=N()|0,l[E>>2]=v,l[E+4>>2]=S,E=v;if(sr(g|0,0,E<<3|0)|0,m|0){sr(m|0,0,E<<2|0)|0,v=pn(A,u,f,g,m,E,S,0)|0;break}v=Ti(E,4)|0,v?(I=pn(A,u,f,g,v,E,S,0)|0,Pe(v),v=I):v=13}else v=2;while(!1);return I=v,O=x,I|0}function Oh(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0;if(z=O,O=O+16|0,H=z,j=z+8|0,V=H,l[V>>2]=A,l[V+4>>2]=u,(f|0)<0)return j=2,O=z,j|0;if(v=g,l[v>>2]=A,l[v+4>>2]=u,v=(m|0)!=0,v&&(l[m>>2]=0),mt(A,u)|0)return j=9,O=z,j|0;l[j>>2]=0;e:do if((f|0)>=1)if(v)for(D=1,I=0,B=0,V=1,v=A;;){if(!(I|B)){if(v=zt(v,u,4,j,H)|0,v|0)break e;if(u=H,v=l[u>>2]|0,u=l[u+4>>2]|0,mt(v,u)|0){v=9;break e}}if(v=zt(v,u,l[26800+(B<<2)>>2]|0,j,H)|0,v|0)break e;if(u=H,v=l[u>>2]|0,u=l[u+4>>2]|0,A=g+(D<<3)|0,l[A>>2]=v,l[A+4>>2]=u,l[m+(D<<2)>>2]=V,A=I+1|0,E=(A|0)==(V|0),S=B+1|0,x=(S|0)==6,mt(v,u)|0){v=9;break e}if(V=V+(x&E&1)|0,(V|0)>(f|0)){v=0;break}else D=D+1|0,I=E?0:A,B=E?x?0:S:B}else for(D=1,I=0,B=0,V=1,v=A;;){if(!(I|B)){if(v=zt(v,u,4,j,H)|0,v|0)break e;if(u=H,v=l[u>>2]|0,u=l[u+4>>2]|0,mt(v,u)|0){v=9;break e}}if(v=zt(v,u,l[26800+(B<<2)>>2]|0,j,H)|0,v|0)break e;if(u=H,v=l[u>>2]|0,u=l[u+4>>2]|0,A=g+(D<<3)|0,l[A>>2]=v,l[A+4>>2]=u,A=I+1|0,E=(A|0)==(V|0),S=B+1|0,x=(S|0)==6,mt(v,u)|0){v=9;break e}if(V=V+(x&E&1)|0,(V|0)>(f|0)){v=0;break}else D=D+1|0,I=E?0:A,B=E?x?0:S:B}else v=0;while(!1);return j=v,O=z,j|0}function pn(A,u,f,g,m,v,E,S){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0,E=E|0,S=S|0;var x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0;if(z=O,O=O+16|0,H=z+8|0,j=z,x=ns(A|0,u|0,v|0,E|0)|0,D=N()|0,B=g+(x<<3)|0,Z=B,ae=l[Z>>2]|0,Z=l[Z+4>>2]|0,I=(ae|0)==(A|0)&(Z|0)==(u|0),!((ae|0)==0&(Z|0)==0|I))do x=Ce(x|0,D|0,1,0)|0,x=is(x|0,N()|0,v|0,E|0)|0,D=N()|0,B=g+(x<<3)|0,ae=B,Z=l[ae>>2]|0,ae=l[ae+4>>2]|0,I=(Z|0)==(A|0)&(ae|0)==(u|0);while(!((Z|0)==0&(ae|0)==0|I));if(x=m+(x<<2)|0,I&&(l[x>>2]|0)<=(S|0)||(ae=B,l[ae>>2]=A,l[ae+4>>2]=u,l[x>>2]=S,(S|0)>=(f|0)))return ae=0,O=z,ae|0;switch(I=S+1|0,l[H>>2]=0,x=zt(A,u,2,H,j)|0,x|0){case 9:{V=9;break}case 0:{x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x||(V=9);break}}e:do if((V|0)==9){switch(l[H>>2]=0,x=zt(A,u,3,H,j)|0,x|0){case 9:break;case 0:{if(x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x|0)break e;break}default:break e}switch(l[H>>2]=0,x=zt(A,u,1,H,j)|0,x|0){case 9:break;case 0:{if(x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x|0)break e;break}default:break e}switch(l[H>>2]=0,x=zt(A,u,5,H,j)|0,x|0){case 9:break;case 0:{if(x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x|0)break e;break}default:break e}switch(l[H>>2]=0,x=zt(A,u,4,H,j)|0,x|0){case 9:break;case 0:{if(x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x|0)break e;break}default:break e}switch(l[H>>2]=0,x=zt(A,u,6,H,j)|0,x|0){case 9:break;case 0:{if(x=j,x=pn(l[x>>2]|0,l[x+4>>2]|0,f,g,m,v,E,I)|0,x|0)break e;break}default:break e}return ae=0,O=z,ae|0}while(!1);return ae=x,O=z,ae|0}function zt(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0;if(f>>>0>6)return m=1,m|0;if(B=(l[g>>2]|0)%6|0,l[g>>2]=B,(B|0)>0){v=0;do f=xr(f)|0,v=v+1|0;while((v|0)<(l[g>>2]|0))}if(B=he(A|0,u|0,45)|0,N()|0,D=B&127,D>>>0>121)return m=5,m|0;x=Ei(A,u)|0,v=he(A|0,u|0,52)|0,N()|0,v=v&15;e:do if(!v)I=8;else{for(;;){if(E=(15-v|0)*3|0,S=he(A|0,u|0,E|0)|0,N()|0,S=S&7,(S|0)==7){u=5;break}if(j=(Ki(v)|0)==0,v=v+-1|0,V=Ee(7,0,E|0)|0,u=u&~(N()|0),H=Ee(l[(j?432:16)+(S*28|0)+(f<<2)>>2]|0,0,E|0)|0,E=N()|0,f=l[(j?640:224)+(S*28|0)+(f<<2)>>2]|0,A=H|A&~V,u=E|u,!f){f=0;break e}if(!v){I=8;break e}}return u|0}while(!1);(I|0)==8&&(j=l[848+(D*28|0)+(f<<2)>>2]|0,H=Ee(j|0,0,45)|0,A=H|A,u=N()|0|u&-1040385,f=l[4272+(D*28|0)+(f<<2)>>2]|0,(j&127|0)==127&&(j=Ee(l[848+(D*28|0)+20>>2]|0,0,45)|0,u=N()|0|u&-1040385,f=l[4272+(D*28|0)+20>>2]|0,A=_r(j|A,u)|0,u=N()|0,l[g>>2]=(l[g>>2]|0)+1)),S=he(A|0,u|0,45)|0,N()|0,S=S&127;e:do if(bt(S)|0){t:do if((Ei(A,u)|0)==1){if((D|0)!=(S|0))if(Uh(S,l[7696+(D*28|0)>>2]|0)|0){A=lu(A,u)|0,E=1,u=N()|0;break}else Ne(27795,26864,533,26872);switch(x|0){case 3:{A=_r(A,u)|0,u=N()|0,l[g>>2]=(l[g>>2]|0)+1,E=0;break t}case 5:{A=lu(A,u)|0,u=N()|0,l[g>>2]=(l[g>>2]|0)+5,E=0;break t}case 0:return j=9,j|0;default:return j=1,j|0}}else E=0;while(!1);if((f|0)>0){v=0;do A=Au(A,u)|0,u=N()|0,v=v+1|0;while((v|0)!=(f|0))}if((D|0)!=(S|0)){if(!(ql(S)|0)){if((E|0)!=0|(Ei(A,u)|0)!=5)break;l[g>>2]=(l[g>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(Ei(A,u)|0)!=3&&(l[g>>2]=(l[g>>2]|0)+1)}}else if((f|0)>0){v=0;do A=_r(A,u)|0,u=N()|0,v=v+1|0;while((v|0)!=(f|0))}while(!1);return l[g>>2]=((l[g>>2]|0)+f|0)%6|0,j=m,l[j>>2]=A,l[j+4>>2]=u,j=0,j|0}function KS(A,u,f,g){return A=A|0,u=u|0,f=f|0,g=g|0,Fh(A,u,f,g)|0?(sr(g|0,0,f*48|0)|0,g=QS(A,u,f,g)|0,g|0):(g=0,g|0)}function Fh(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0;if(j=O,O=O+16|0,V=j,H=j+8|0,B=V,l[B>>2]=A,l[B+4>>2]=u,(f|0)<0)return H=2,O=j,H|0;if(!f)return H=g,l[H>>2]=A,l[H+4>>2]=u,H=0,O=j,H|0;l[H>>2]=0;e:do if(mt(A,u)|0)A=9;else{m=0,B=A;do{if(A=zt(B,u,4,H,V)|0,A|0)break e;if(u=V,B=l[u>>2]|0,u=l[u+4>>2]|0,m=m+1|0,mt(B,u)|0){A=9;break e}}while((m|0)<(f|0));D=g,l[D>>2]=B,l[D+4>>2]=u,D=f+-1|0,I=0,A=1;do{if(m=26800+(I<<2)|0,(I|0)==5)for(E=l[m>>2]|0,v=0,m=A;;){if(A=V,A=zt(l[A>>2]|0,l[A+4>>2]|0,E,H,V)|0,A|0)break e;if((v|0)!=(D|0))if(x=V,S=l[x>>2]|0,x=l[x+4>>2]|0,A=g+(m<<3)|0,l[A>>2]=S,l[A+4>>2]=x,!(mt(S,x)|0))A=m+1|0;else{A=9;break e}else A=m;if(v=v+1|0,(v|0)>=(f|0))break;m=A}else for(E=V,x=l[m>>2]|0,S=0,m=A,v=l[E>>2]|0,E=l[E+4>>2]|0;;){if(A=zt(v,E,x,H,V)|0,A|0)break e;if(E=V,v=l[E>>2]|0,E=l[E+4>>2]|0,A=g+(m<<3)|0,l[A>>2]=v,l[A+4>>2]=E,A=m+1|0,mt(v,E)|0){A=9;break e}if(S=S+1|0,(S|0)>=(f|0))break;m=A}I=I+1|0}while(I>>>0<6);A=V,A=(B|0)==(l[A>>2]|0)&&(u|0)==(l[A+4>>2]|0)?0:9}while(!1);return H=A,O=j,H|0}function QS(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;if(B=O,O=O+16|0,E=B,!f)return l[g>>2]=A,l[g+4>>2]=u,g=0,O=B,g|0;do if((f|0)>=0){if((f|0)>13780509){if(m=Ca(15,E)|0,m|0)break;v=E,m=l[v>>2]|0,v=l[v+4>>2]|0}else m=((f|0)<0)<<31>>31,D=qt(f|0,m|0,3,0)|0,v=N()|0,m=Ce(f|0,m|0,1,0)|0,m=qt(D|0,v|0,m|0,N()|0)|0,m=Ce(m|0,N()|0,1,0)|0,v=N()|0,D=E,l[D>>2]=m,l[D+4>>2]=v;if(I=Ti(m,8)|0,!I)m=13;else{if(D=Ti(m,4)|0,!D){Pe(I),m=13;break}if(m=pn(A,u,f,I,D,m,v,0)|0,m|0){Pe(I),Pe(D);break}if(u=l[E>>2]|0,E=l[E+4>>2]|0,(E|0)>0|(E|0)==0&u>>>0>0){m=0,S=0,x=0;do A=I+(S<<3)|0,v=l[A>>2]|0,A=l[A+4>>2]|0,!((v|0)==0&(A|0)==0)&&(l[D+(S<<2)>>2]|0)==(f|0)&&(V=g+(m<<3)|0,l[V>>2]=v,l[V+4>>2]=A,m=m+1|0),S=Ce(S|0,x|0,1,0)|0,x=N()|0;while((x|0)<(E|0)|(x|0)==(E|0)&S>>>0<u>>>0)}Pe(I),Pe(D),m=0}}else m=2;while(!1);return V=m,O=B,V|0}function zl(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0;for(S=O,O=O+16|0,v=S,E=S+8|0,m=(mt(A,u)|0)==0,m=m?1:2;;){if(l[E>>2]=0,I=(zt(A,u,m,E,v)|0)==0,x=v,I&((l[x>>2]|0)==(f|0)?(l[x+4>>2]|0)==(g|0):0)){A=4;break}if(m=m+1|0,m>>>0>=7){m=7,A=4;break}}return(A|0)==4?(O=S,m|0):0}function WS(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0;if(S=O,O=O+48|0,m=S+16|0,v=S+8|0,E=S,f=so(f)|0,f|0)return E=f,O=S,E|0;if(I=A,x=l[I+4>>2]|0,f=v,l[f>>2]=l[I>>2],l[f+4>>2]=x,ud(v,m),f=Hh(m,u,E)|0,!f){if(u=l[v>>2]|0,v=l[A+8>>2]|0,(v|0)>0){m=l[A+12>>2]|0,f=0;do u=(l[m+(f<<3)>>2]|0)+u|0,f=f+1|0;while((f|0)<(v|0))}f=E,m=l[f>>2]|0,f=l[f+4>>2]|0,v=((u|0)<0)<<31>>31,(f|0)<(v|0)|(f|0)==(v|0)&m>>>0<u>>>0?(f=E,l[f>>2]=u,l[f+4>>2]=v,f=v):u=m,x=Ce(u|0,f|0,12,0)|0,I=N()|0,f=E,l[f>>2]=x,l[f+4>>2]=I,f=g,l[f>>2]=x,l[f+4>>2]=I,f=0}return I=f,O=S,I|0}function Bh(A,u,f,g,m,v,E){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0,E=E|0;var S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0,Le=0,ye=0,Je=0,dt=0,qe=0,gt=0,fi=0,xd=0;if(dt=O,O=O+64|0,Be=dt+48|0,Le=dt+32|0,ye=dt+24|0,ve=dt+8|0,Ie=dt,x=l[A>>2]|0,(x|0)<=0)return Je=0,O=dt,Je|0;for(xe=A+4|0,je=Be+8|0,We=Le+8|0,it=ve+8|0,S=0,J=0;;){I=l[xe>>2]|0,ie=I+(J<<4)|0,l[Be>>2]=l[ie>>2],l[Be+4>>2]=l[ie+4>>2],l[Be+8>>2]=l[ie+8>>2],l[Be+12>>2]=l[ie+12>>2],(J|0)==(x+-1|0)?(l[Le>>2]=l[I>>2],l[Le+4>>2]=l[I+4>>2],l[Le+8>>2]=l[I+8>>2],l[Le+12>>2]=l[I+12>>2]):(ie=I+(J+1<<4)|0,l[Le>>2]=l[ie>>2],l[Le+4>>2]=l[ie+4>>2],l[Le+8>>2]=l[ie+8>>2],l[Le+12>>2]=l[ie+12>>2]),x=sb(Be,Le,g,ye)|0;e:do if(x)I=0,S=x;else if(x=ye,I=l[x>>2]|0,x=l[x+4>>2]|0,(x|0)>0|(x|0)==0&I>>>0>0){ae=0,ie=0;t:for(;;){if(gt=1/(+(I>>>0)+4294967296*+(x|0)),xd=+M[Be>>3],x=Jt(I|0,x|0,ae|0,ie|0)|0,fi=+(x>>>0)+4294967296*+(N()|0),qe=+(ae>>>0)+4294967296*+(ie|0),M[ve>>3]=gt*(xd*fi)+gt*(+M[Le>>3]*qe),M[it>>3]=gt*(+M[je>>3]*fi)+gt*(+M[We>>3]*qe),x=uu(ve,g,Ie)|0,x|0){S=x;break}Z=Ie,z=l[Z>>2]|0,Z=l[Z+4>>2]|0,V=ns(z|0,Z|0,u|0,f|0)|0,D=N()|0,x=E+(V<<3)|0,B=x,I=l[B>>2]|0,B=l[B+4>>2]|0;i:do if((I|0)==0&(B|0)==0)q=x,Je=16;else for(H=0,j=0;;){if((H|0)>(f|0)|(H|0)==(f|0)&j>>>0>u>>>0){S=1;break t}if((I|0)==(z|0)&(B|0)==(Z|0))break i;if(x=Ce(V|0,D|0,1,0)|0,V=is(x|0,N()|0,u|0,f|0)|0,D=N()|0,j=Ce(j|0,H|0,1,0)|0,H=N()|0,x=E+(V<<3)|0,B=x,I=l[B>>2]|0,B=l[B+4>>2]|0,(I|0)==0&(B|0)==0){q=x,Je=16;break}}while(!1);if((Je|0)==16&&(Je=0,!((z|0)==0&(Z|0)==0))&&(j=q,l[j>>2]=z,l[j+4>>2]=Z,j=v+(l[m>>2]<<3)|0,l[j>>2]=z,l[j+4>>2]=Z,j=m,j=Ce(l[j>>2]|0,l[j+4>>2]|0,1,0)|0,z=N()|0,Z=m,l[Z>>2]=j,l[Z+4>>2]=z),ae=Ce(ae|0,ie|0,1,0)|0,ie=N()|0,x=ye,I=l[x>>2]|0,x=l[x+4>>2]|0,!((x|0)>(ie|0)|(x|0)==(ie|0)&I>>>0>ae>>>0)){I=1;break e}}I=0}else I=1;while(!1);if(J=J+1|0,!I){Je=21;break}if(x=l[A>>2]|0,(J|0)>=(x|0)){S=0,Je=21;break}}return(Je|0)==21?(O=dt,S|0):0}function YS(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0,Le=0,ye=0,Je=0,dt=0,qe=0,gt=0,fi=0;if(fi=O,O=O+112|0,Je=fi+80|0,x=fi+72|0,dt=fi,qe=fi+56|0,m=so(f)|0,m|0)return gt=m,O=fi,gt|0;if(I=A+8|0,gt=mn((l[I>>2]<<5)+32|0)|0,!gt)return gt=13,O=fi,gt|0;if(mu(A,gt),m=so(f)|0,!m){if(Le=A,ye=l[Le+4>>2]|0,m=x,l[m>>2]=l[Le>>2],l[m+4>>2]=ye,ud(x,Je),m=Hh(Je,u,dt)|0,m)Le=0,ye=0;else{if(m=l[x>>2]|0,v=l[I>>2]|0,(v|0)>0){E=l[A+12>>2]|0,f=0;do m=(l[E+(f<<3)>>2]|0)+m|0,f=f+1|0;while((f|0)!=(v|0));f=m}else f=m;m=dt,v=l[m>>2]|0,m=l[m+4>>2]|0,E=((f|0)<0)<<31>>31,(m|0)<(E|0)|(m|0)==(E|0)&v>>>0<f>>>0?(m=dt,l[m>>2]=f,l[m+4>>2]=E,m=E):f=v,Le=Ce(f|0,m|0,12,0)|0,ye=N()|0,m=dt,l[m>>2]=Le,l[m+4>>2]=ye,m=0}if(!m){if(f=Ti(Le,8)|0,!f)return Pe(gt),gt=13,O=fi,gt|0;if(S=Ti(Le,8)|0,!S)return Pe(gt),Pe(f),gt=13,O=fi,gt|0;it=Je,l[it>>2]=0,l[it+4>>2]=0,it=A,Be=l[it+4>>2]|0,m=x,l[m>>2]=l[it>>2],l[m+4>>2]=Be,m=Bh(x,Le,ye,u,Je,f,S)|0;e:do if(m)Pe(f),Pe(S),Pe(gt);else{t:do if((l[I>>2]|0)>0){for(E=A+12|0,v=0;m=Bh((l[E>>2]|0)+(v<<3)|0,Le,ye,u,Je,f,S)|0,v=v+1|0,!(m|0);)if((v|0)>=(l[I>>2]|0))break t;Pe(f),Pe(S),Pe(gt);break e}while(!1);(ye|0)>0|(ye|0)==0&Le>>>0>0&&sr(S|0,0,Le<<3|0)|0,Be=Je,it=l[Be+4>>2]|0;t:do if((it|0)>0|(it|0)==0&(l[Be>>2]|0)>>>0>0){xe=f,je=S,We=f,it=S,Be=f,m=f,q=f,ve=S,Ie=S,f=S;i:for(;;){for(Z=0,ae=0,ie=0,J=0,v=0,E=0;;){S=dt,x=S+56|0;do l[S>>2]=0,S=S+4|0;while((S|0)<(x|0));if(u=xe+(Z<<3)|0,I=l[u>>2]|0,u=l[u+4>>2]|0,Oh(I,u,1,dt,0)|0){S=dt,x=S+56|0;do l[S>>2]=0,S=S+4|0;while((S|0)<(x|0));S=Ti(7,4)|0,S|0&&(pn(I,u,1,dt,S,7,0,0)|0,Pe(S))}for(z=0;;){j=dt+(z<<3)|0,H=l[j>>2]|0,j=l[j+4>>2]|0;n:do if((H|0)==0&(j|0)==0)S=v,x=E;else{if(D=ns(H|0,j|0,Le|0,ye|0)|0,I=N()|0,S=g+(D<<3)|0,u=S,x=l[u>>2]|0,u=l[u+4>>2]|0,!((x|0)==0&(u|0)==0)){B=0,V=0;do{if((B|0)>(ye|0)|(B|0)==(ye|0)&V>>>0>Le>>>0)break i;if((x|0)==(H|0)&(u|0)==(j|0)){S=v,x=E;break n}S=Ce(D|0,I|0,1,0)|0,D=is(S|0,N()|0,Le|0,ye|0)|0,I=N()|0,V=Ce(V|0,B|0,1,0)|0,B=N()|0,S=g+(D<<3)|0,u=S,x=l[u>>2]|0,u=l[u+4>>2]|0}while(!((x|0)==0&(u|0)==0))}if((H|0)==0&(j|0)==0){S=v,x=E;break}wr(H,j,qe)|0,yu(A,gt,qe)|0&&(V=Ce(v|0,E|0,1,0)|0,E=N()|0,B=S,l[B>>2]=H,l[B+4>>2]=j,v=je+(v<<3)|0,l[v>>2]=H,l[v+4>>2]=j,v=V),S=v,x=E}while(!1);if(z=z+1|0,z>>>0>=7)break;v=S,E=x}if(Z=Ce(Z|0,ae|0,1,0)|0,ae=N()|0,ie=Ce(ie|0,J|0,1,0)|0,J=N()|0,E=Je,v=l[E>>2]|0,E=l[E+4>>2]|0,(J|0)<(E|0)|(J|0)==(E|0)&ie>>>0<v>>>0)v=S,E=x;else break}if((E|0)>0|(E|0)==0&v>>>0>0){v=0,E=0;do J=xe+(v<<3)|0,l[J>>2]=0,l[J+4>>2]=0,v=Ce(v|0,E|0,1,0)|0,E=N()|0,J=Je,ie=l[J+4>>2]|0;while((E|0)<(ie|0)|((E|0)==(ie|0)?v>>>0<(l[J>>2]|0)>>>0:0))}if(J=Je,l[J>>2]=S,l[J+4>>2]=x,(x|0)>0|(x|0)==0&S>>>0>0)z=f,Z=Ie,ae=Be,ie=ve,J=je,f=q,Ie=m,ve=We,q=z,m=Z,Be=it,it=ae,We=ie,je=xe,xe=J;else break t}Pe(We),Pe(it),Pe(gt),m=1;break e}else m=S;while(!1);Pe(gt),Pe(f),Pe(m),m=0}while(!1);return gt=m,O=fi,gt|0}}return Pe(gt),gt=m,O=fi,gt|0}function zS(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(D=O,O=O+176|0,x=D,(u|0)<1)return gd(f,0,0),I=0,O=D,I|0;for(S=A,S=he(l[S>>2]|0,l[S+4>>2]|0,52)|0,N()|0,gd(f,(u|0)>6?u:6,S&15),S=0;g=A+(S<<3)|0,g=es(l[g>>2]|0,l[g+4>>2]|0,x)|0,!(g|0);){if(g=l[x>>2]|0,(g|0)>0){E=0;do v=x+8+(E<<4)|0,E=E+1|0,g=x+8+(((E|0)%(g|0)|0)<<4)|0,m=bx(f,g,v)|0,m?yd(f,m)|0:Sx(f,v,g)|0,g=l[x>>2]|0;while((E|0)<(g|0))}if(S=S+1|0,(S|0)>=(u|0)){g=0,I=13;break}}return(I|0)==13?(O=D,g|0):(pd(f),I=g,O=D,I|0)}function qS(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;if(v=O,O=O+32|0,g=v,m=v+16|0,A=zS(A,u,m)|0,A|0)return f=A,O=v,f|0;if(l[f>>2]=0,l[f+4>>2]=0,l[f+8>>2]=0,A=md(m)|0,A|0)do{u=Xb(f)|0;do Zb(u,A)|0,E=A+16|0,l[g>>2]=l[E>>2],l[g+4>>2]=l[E+4>>2],l[g+8>>2]=l[E+8>>2],l[g+12>>2]=l[E+12>>2],yd(m,A)|0,A=xx(m,g)|0;while((A|0)!=0);A=md(m)|0}while((A|0)!=0);return pd(m),A=Jb(f)|0,A?(od(f),E=A,O=v,E|0):(E=0,O=v,E|0)}function bt(A){return A=A|0,A>>>0>121?(A=0,A|0):(A=l[7696+(A*28|0)+16>>2]|0,A|0)}function ql(A){return A=A|0,(A|0)==4|(A|0)==117|0}function Nh(A){return A=A|0,l[11120+((l[A>>2]|0)*216|0)+((l[A+4>>2]|0)*72|0)+((l[A+8>>2]|0)*24|0)+(l[A+12>>2]<<3)>>2]|0}function XS(A){return A=A|0,l[11120+((l[A>>2]|0)*216|0)+((l[A+4>>2]|0)*72|0)+((l[A+8>>2]|0)*24|0)+(l[A+12>>2]<<3)+4>>2]|0}function ZS(A,u){A=A|0,u=u|0,A=7696+(A*28|0)|0,l[u>>2]=l[A>>2],l[u+4>>2]=l[A+4>>2],l[u+8>>2]=l[A+8>>2],l[u+12>>2]=l[A+12>>2]}function JS(A,u){A=A|0,u=u|0;var f=0,g=0;if(u>>>0>20)return u=-1,u|0;do if((l[11120+(u*216|0)>>2]|0)!=(A|0))if((l[11120+(u*216|0)+8>>2]|0)!=(A|0))if((l[11120+(u*216|0)+16>>2]|0)!=(A|0))if((l[11120+(u*216|0)+24>>2]|0)!=(A|0))if((l[11120+(u*216|0)+32>>2]|0)!=(A|0))if((l[11120+(u*216|0)+40>>2]|0)!=(A|0))if((l[11120+(u*216|0)+48>>2]|0)!=(A|0))if((l[11120+(u*216|0)+56>>2]|0)!=(A|0))if((l[11120+(u*216|0)+64>>2]|0)!=(A|0))if((l[11120+(u*216|0)+72>>2]|0)!=(A|0))if((l[11120+(u*216|0)+80>>2]|0)!=(A|0))if((l[11120+(u*216|0)+88>>2]|0)!=(A|0))if((l[11120+(u*216|0)+96>>2]|0)!=(A|0))if((l[11120+(u*216|0)+104>>2]|0)!=(A|0))if((l[11120+(u*216|0)+112>>2]|0)!=(A|0))if((l[11120+(u*216|0)+120>>2]|0)!=(A|0))if((l[11120+(u*216|0)+128>>2]|0)!=(A|0))if((l[11120+(u*216|0)+136>>2]|0)==(A|0))A=2,f=1,g=2;else{if((l[11120+(u*216|0)+144>>2]|0)==(A|0)){A=0,f=2,g=0;break}if((l[11120+(u*216|0)+152>>2]|0)==(A|0)){A=0,f=2,g=1;break}if((l[11120+(u*216|0)+160>>2]|0)==(A|0)){A=0,f=2,g=2;break}if((l[11120+(u*216|0)+168>>2]|0)==(A|0)){A=1,f=2,g=0;break}if((l[11120+(u*216|0)+176>>2]|0)==(A|0)){A=1,f=2,g=1;break}if((l[11120+(u*216|0)+184>>2]|0)==(A|0)){A=1,f=2,g=2;break}if((l[11120+(u*216|0)+192>>2]|0)==(A|0)){A=2,f=2,g=0;break}if((l[11120+(u*216|0)+200>>2]|0)==(A|0)){A=2,f=2,g=1;break}if((l[11120+(u*216|0)+208>>2]|0)==(A|0)){A=2,f=2,g=2;break}else A=-1;return A|0}else A=2,f=1,g=1;else A=2,f=1,g=0;else A=1,f=1,g=2;else A=1,f=1,g=1;else A=1,f=1,g=0;else A=0,f=1,g=2;else A=0,f=1,g=1;else A=0,f=1,g=0;else A=2,f=0,g=2;else A=2,f=0,g=1;else A=2,f=0,g=0;else A=1,f=0,g=2;else A=1,f=0,g=1;else A=1,f=0,g=0;else A=0,f=0,g=2;else A=0,f=0,g=1;else A=0,f=0,g=0;while(!1);return u=l[11120+(u*216|0)+(f*72|0)+(A*24|0)+(g<<3)+4>>2]|0,u|0}function Uh(A,u){return A=A|0,u=u|0,(l[7696+(A*28|0)+20>>2]|0)==(u|0)?(u=1,u|0):(u=(l[7696+(A*28|0)+24>>2]|0)==(u|0),u|0)}function Xl(A,u){return A=A|0,u=u|0,l[848+(A*28|0)+(u<<2)>>2]|0}function Zl(A,u){return A=A|0,u=u|0,(l[848+(A*28|0)>>2]|0)==(u|0)?(u=0,u|0):(l[848+(A*28|0)+4>>2]|0)==(u|0)?(u=1,u|0):(l[848+(A*28|0)+8>>2]|0)==(u|0)?(u=2,u|0):(l[848+(A*28|0)+12>>2]|0)==(u|0)?(u=3,u|0):(l[848+(A*28|0)+16>>2]|0)==(u|0)?(u=4,u|0):(l[848+(A*28|0)+20>>2]|0)==(u|0)?(u=5,u|0):((l[848+(A*28|0)+24>>2]|0)==(u|0)?6:7)|0}function eb(){return 122}function tb(A){A=A|0;var u=0,f=0,g=0;u=0;do Ee(u|0,0,45)|0,g=N()|0|134225919,f=A+(u<<3)|0,l[f>>2]=-1,l[f+4>>2]=g,u=u+1|0;while((u|0)!=122);return 0}function ib(A){A=A|0;var u=0,f=0,g=0;return g=+M[A+16>>3],f=+M[A+24>>3],u=g-f,+(g<f?u+6.283185307179586:u)}function $h(A){return A=A|0,+M[A+16>>3]<+M[A+24>>3]|0}function nb(A){return A=A|0,+(+M[A>>3]-+M[A+8>>3])}function Jl(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;return f=+M[u>>3],!(f>=+M[A+8>>3])||!(f<=+M[A>>3])?(u=0,u|0):(g=+M[A+16>>3],f=+M[A+24>>3],m=+M[u+8>>3],u=m>=f,A=m<=g&1,g<f?u&&(A=1):u||(A=0),u=(A|0)!=0,u|0)}function eu(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;return+M[A>>3]<+M[u+8>>3]||+M[A+8>>3]>+M[u>>3]?(g=0,g|0):(v=+M[A+16>>3],f=A+24|0,D=+M[f>>3],E=v<D,g=u+16|0,I=+M[g>>3],m=u+24|0,x=+M[m>>3],S=I<x,u=D-I<x-v,A=E?S|u?1:2:0,u=S?E?1:u?2:1:0,v=+ki(v,A),v<+ki(+M[m>>3],u)||(D=+ki(+M[f>>3],A),D>+ki(+M[g>>3],u))?(S=0,S|0):(S=1,S|0))}function rb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0;v=+M[A+16>>3],x=+M[A+24>>3],A=v<x,S=+M[u+16>>3],E=+M[u+24>>3],m=S<E,u=x-S<E-v,l[f>>2]=A?m|u?1:2:0,l[g>>2]=m?A?1:u?2:1:0}function Gh(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;return+M[A>>3]<+M[u>>3]||+M[A+8>>3]>+M[u+8>>3]?(g=0,g|0):(g=A+16|0,x=+M[g>>3],v=+M[A+24>>3],E=x<v,f=u+16|0,D=+M[f>>3],m=u+24|0,I=+M[m>>3],S=D<I,u=v-D<I-x,A=E?S|u?1:2:0,u=S?E?1:u?2:1:0,v=+ki(v,A),v<=+ki(+M[m>>3],u)?(D=+ki(+M[g>>3],A),S=D>=+ki(+M[f>>3],u),S|0):(S=0,S|0))}function Vh(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0;m=O,O=O+176|0,g=m,l[g>>2]=4,S=+M[u>>3],M[g+8>>3]=S,v=+M[u+16>>3],M[g+16>>3]=v,M[g+24>>3]=S,S=+M[u+24>>3],M[g+32>>3]=S,E=+M[u+8>>3],M[g+40>>3]=E,M[g+48>>3]=S,M[g+56>>3]=E,M[g+64>>3]=v,u=g+72|0,f=u+96|0;do l[u>>2]=0,u=u+4|0;while((u|0)<(f|0));rs(A|0,g|0,168)|0,O=m}function Hh(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0;j=O,O=O+288|0,D=j+264|0,B=j+96|0,I=j,S=I,x=S+96|0;do l[S>>2]=0,S=S+4|0;while((S|0)<(x|0));return u=cu(u,I)|0,u|0?(H=u,O=j,H|0):(x=I,I=l[x>>2]|0,x=l[x+4>>2]|0,wr(I,x,D)|0,es(I,x,B)|0,E=+no(D,B+8|0),M[D>>3]=+M[A>>3],x=D+8|0,M[x>>3]=+M[A+16>>3],M[B>>3]=+M[A+8>>3],I=B+8|0,M[I>>3]=+M[A+24>>3],m=+no(D,B),Z=+M[x>>3]-+M[I>>3],v=+et(+Z),z=+M[D>>3]-+M[B>>3],g=+et(+z),!(Z==0|z==0)&&(Z=+Sd(+v,+g),Z=+Xr(+(m*m/+Ma(+(Z/+Ma(+v,+g)),3)/(E*(E*2.59807621135)*.8))),M[lt>>3]=Z,V=~~Z>>>0,H=+et(Z)>=1?Z>0?~~+Yl(+Yt(Z/4294967296),4294967295)>>>0:~~+Xr((Z-+(~~Z>>>0))/4294967296)>>>0:0,(l[lt+4>>2]&2146435072|0)!=2146435072)?(B=(V|0)==0&(H|0)==0,u=f,l[u>>2]=B?1:V,l[u+4>>2]=B?0:H,u=0):u=1,H=u,O=j,H|0)}function sb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0;I=O,O=O+288|0,E=I+264|0,S=I+96|0,x=I,m=x,v=m+96|0;do l[m>>2]=0,m=m+4|0;while((m|0)<(v|0));return f=cu(f,x)|0,f|0?(g=f,O=I,g|0):(f=x,m=l[f>>2]|0,f=l[f+4>>2]|0,wr(m,f,E)|0,es(m,f,S)|0,D=+no(E,S+8|0),D=+Xr(+(+no(A,u)/(D*2))),M[lt>>3]=D,f=~~D>>>0,m=+et(D)>=1?D>0?~~+Yl(+Yt(D/4294967296),4294967295)>>>0:~~+Xr((D-+(~~D>>>0))/4294967296)>>>0:0,(l[lt+4>>2]&2146435072|0)==2146435072?(g=1,O=I,g|0):(x=(f|0)==0&(m|0)==0,l[g>>2]=x?1:f,l[g+4>>2]=x?0:m,g=0,O=I,g|0))}function ob(A,u){A=A|0,u=+u;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;v=A+16|0,E=+M[v>>3],f=A+24|0,m=+M[f>>3],g=E-m,g=E<m?g+6.283185307179586:g,I=+M[A>>3],S=A+8|0,x=+M[S>>3],D=I-x,g=(g*u-g)*.5,u=(D*u-D)*.5,I=I+u,M[A>>3]=I>1.5707963267948966?1.5707963267948966:I,u=x-u,M[S>>3]=u<-1.5707963267948966?-1.5707963267948966:u,u=E+g,u=u>3.141592653589793?u+-6.283185307179586:u,M[v>>3]=u<-3.141592653589793?u+6.283185307179586:u,u=m-g,u=u>3.141592653589793?u+-6.283185307179586:u,M[f>>3]=u<-3.141592653589793?u+6.283185307179586:u}function ab(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0,l[A>>2]=u,l[A+4>>2]=f,l[A+8>>2]=g}function Ab(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;B=u+8|0,l[B>>2]=0,x=+M[A>>3],E=+et(+x),I=+M[A+8>>3],S=+et(+I)*1.1547005383792515,E=E+S*.5,f=~~E,A=~~S,E=E-+(f|0),S=S-+(A|0);do if(E<.5)if(E<.3333333333333333)if(l[u>>2]=f,S<(E+1)*.5){l[u+4>>2]=A;break}else{A=A+1|0,l[u+4>>2]=A;break}else if(V=1-E,A=(!(S<V)&1)+A|0,l[u+4>>2]=A,V<=S&S<E*2){f=f+1|0,l[u>>2]=f;break}else{l[u>>2]=f;break}else{if(!(E<.6666666666666666))if(f=f+1|0,l[u>>2]=f,S<E*.5){l[u+4>>2]=A;break}else{A=A+1|0,l[u+4>>2]=A;break}if(S<1-E){if(l[u+4>>2]=A,E*2+-1<S){l[u>>2]=f;break}}else A=A+1|0,l[u+4>>2]=A;f=f+1|0,l[u>>2]=f}while(!1);do if(x<0)if(A&1){D=(A+1|0)/2|0,D=Jt(f|0,((f|0)<0)<<31>>31|0,D|0,((D|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-((+(D>>>0)+4294967296*+(N()|0))*2+1)),l[u>>2]=f;break}else{D=(A|0)/2|0,D=Jt(f|0,((f|0)<0)<<31>>31|0,D|0,((D|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-(+(D>>>0)+4294967296*+(N()|0))*2),l[u>>2]=f;break}while(!1);D=u+4|0,I<0&&(f=f-((A<<1|1|0)/2|0)|0,l[u>>2]=f,A=0-A|0,l[D>>2]=A),g=A-f|0,(f|0)<0?(m=0-f|0,l[D>>2]=g,l[B>>2]=m,l[u>>2]=0,A=g,f=0):m=0,(A|0)<0&&(f=f-A|0,l[u>>2]=f,m=m-A|0,l[B>>2]=m,l[D>>2]=0,A=0),v=f-m|0,g=A-m|0,(m|0)<0&&(l[u>>2]=v,l[D>>2]=g,l[B>>2]=0,A=g,f=v,m=0),g=(A|0)<(f|0)?A:f,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(l[u>>2]=f-g,l[D>>2]=A-g,l[B>>2]=m-g)}function ri(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0;u=l[A>>2]|0,E=A+4|0,f=l[E>>2]|0,(u|0)<0&&(f=f-u|0,l[E>>2]=f,v=A+8|0,l[v>>2]=(l[v>>2]|0)-u,l[A>>2]=0,u=0),(f|0)<0?(u=u-f|0,l[A>>2]=u,v=A+8|0,m=(l[v>>2]|0)-f|0,l[v>>2]=m,l[E>>2]=0,f=0):(m=A+8|0,v=m,m=l[m>>2]|0),(m|0)<0&&(u=u-m|0,l[A>>2]=u,f=f-m|0,l[E>>2]=f,l[v>>2]=0,m=0),g=(f|0)<(u|0)?f:u,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(l[A>>2]=u-g,l[E>>2]=f-g,l[v>>2]=m-g)}function Sr(A,u){A=A|0,u=u|0;var f=0,g=0;g=l[A+8>>2]|0,f=+((l[A+4>>2]|0)-g|0),M[u>>3]=+((l[A>>2]|0)-g|0)-f*.5,M[u+8>>3]=f*.8660254037844386}function ui(A,u,f){A=A|0,u=u|0,f=f|0,l[f>>2]=(l[u>>2]|0)+(l[A>>2]|0),l[f+4>>2]=(l[u+4>>2]|0)+(l[A+4>>2]|0),l[f+8>>2]=(l[u+8>>2]|0)+(l[A+8>>2]|0)}function tu(A,u,f){A=A|0,u=u|0,f=f|0,l[f>>2]=(l[A>>2]|0)-(l[u>>2]|0),l[f+4>>2]=(l[A+4>>2]|0)-(l[u+4>>2]|0),l[f+8>>2]=(l[A+8>>2]|0)-(l[u+8>>2]|0)}function jh(A,u){A=A|0,u=u|0;var f=0,g=0;f=gn(l[A>>2]|0,u)|0,l[A>>2]=f,f=A+4|0,g=gn(l[f>>2]|0,u)|0,l[f>>2]=g,A=A+8|0,u=gn(l[A>>2]|0,u)|0,l[A>>2]=u}function Ia(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;E=l[A>>2]|0,S=(E|0)<0,g=(l[A+4>>2]|0)-(S?E:0)|0,v=(g|0)<0,m=(v?0-g|0:0)+((l[A+8>>2]|0)-(S?E:0))|0,f=(m|0)<0,A=f?0:m,u=(v?0:g)-(f?m:0)|0,m=(S?0:E)-(v?g:0)-(f?m:0)|0,f=(u|0)<(m|0)?u:m,f=(A|0)<(f|0)?A:f,g=(f|0)>0,A=A-(g?f:0)|0,u=u-(g?f:0)|0;e:do switch(m-(g?f:0)|0){case 0:switch(u|0){case 0:return S=(A|0)==0?0:(A|0)==1?1:7,S|0;case 1:return S=(A|0)==0?2:(A|0)==1?3:7,S|0;default:break e}case 1:switch(u|0){case 0:return S=(A|0)==0?4:(A|0)==1?5:7,S|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(!1);return S=7,S|0}function lb(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0;if(x=A+8|0,E=l[x>>2]|0,S=(l[A>>2]|0)-E|0,I=A+4|0,E=(l[I>>2]|0)-E|0,S>>>0>715827881|E>>>0>715827881){if(g=(S|0)>0,m=2147483647-S|0,v=-2147483648-S|0,(g?(m|0)<(S|0):(v|0)>(S|0))||(f=S<<1,g?(2147483647-f|0)<(S|0):(-2147483648-f|0)>(S|0))||((E|0)>0?(2147483647-E|0)<(E|0):(-2147483648-E|0)>(E|0))||(u=S*3|0,f=E<<1,(g?(m|0)<(f|0):(v|0)>(f|0))||((S|0)>-1?(u|-2147483648|0)>=(E|0):(u^-2147483648|0)<(E|0))))return I=1,I|0}else f=E<<1,u=S*3|0;return g=nr(+(u-E|0)*.14285714285714285)|0,l[A>>2]=g,m=nr(+(f+S|0)*.14285714285714285)|0,l[I>>2]=m,l[x>>2]=0,f=(m|0)<(g|0),u=f?g:m,f=f?m:g,(f|0)<0&&(((f|0)==-2147483648||((u|0)>0?(2147483647-u|0)<(f|0):(-2147483648-u|0)>(f|0)))&&Ne(27795,26892,354,26903),((u|0)>-1?(u|-2147483648|0)>=(f|0):(u^-2147483648|0)<(f|0))&&Ne(27795,26892,354,26903)),u=m-g|0,(g|0)<0?(f=0-g|0,l[I>>2]=u,l[x>>2]=f,l[A>>2]=0,g=0):(u=m,f=0),(u|0)<0&&(g=g-u|0,l[A>>2]=g,f=f-u|0,l[x>>2]=f,l[I>>2]=0,u=0),v=g-f|0,m=u-f|0,(f|0)<0?(l[A>>2]=v,l[I>>2]=m,l[x>>2]=0,u=m,m=v,f=0):m=g,g=(u|0)<(m|0)?u:m,g=(f|0)<(g|0)?f:g,(g|0)<=0?(I=0,I|0):(l[A>>2]=m-g,l[I>>2]=u-g,l[x>>2]=f-g,I=0,I|0)}function ub(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0;if(E=A+8|0,m=l[E>>2]|0,v=(l[A>>2]|0)-m|0,S=A+4|0,m=(l[S>>2]|0)-m|0,v>>>0>715827881|m>>>0>715827881){if(f=(v|0)>0,(f?(2147483647-v|0)<(v|0):(-2147483648-v|0)>(v|0))||(u=v<<1,g=(m|0)>0,g?(2147483647-m|0)<(m|0):(-2147483648-m|0)>(m|0)))return S=1,S|0;if(x=m<<1,(g?(2147483647-x|0)<(m|0):(-2147483648-x|0)>(m|0))||(f?(2147483647-u|0)<(m|0):(-2147483648-u|0)>(m|0))||(f=m*3|0,(m|0)>-1?(f|-2147483648|0)>=(v|0):(f^-2147483648|0)<(v|0)))return x=1,x|0}else f=m*3|0,u=v<<1;return g=nr(+(u+m|0)*.14285714285714285)|0,l[A>>2]=g,m=nr(+(f-v|0)*.14285714285714285)|0,l[S>>2]=m,l[E>>2]=0,f=(m|0)<(g|0),u=f?g:m,f=f?m:g,(f|0)<0&&(((f|0)==-2147483648||((u|0)>0?(2147483647-u|0)<(f|0):(-2147483648-u|0)>(f|0)))&&Ne(27795,26892,402,26917),((u|0)>-1?(u|-2147483648|0)>=(f|0):(u^-2147483648|0)<(f|0))&&Ne(27795,26892,402,26917)),u=m-g|0,(g|0)<0?(f=0-g|0,l[S>>2]=u,l[E>>2]=f,l[A>>2]=0,g=0):(u=m,f=0),(u|0)<0&&(g=g-u|0,l[A>>2]=g,f=f-u|0,l[E>>2]=f,l[S>>2]=0,u=0),v=g-f|0,m=u-f|0,(f|0)<0?(l[A>>2]=v,l[S>>2]=m,l[E>>2]=0,u=m,m=v,f=0):m=g,g=(u|0)<(m|0)?u:m,g=(f|0)<(g|0)?f:g,(g|0)<=0?(x=0,x|0):(l[A>>2]=m-g,l[S>>2]=u-g,l[E>>2]=f-g,x=0,x|0)}function fb(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;E=A+8|0,f=l[E>>2]|0,u=(l[A>>2]|0)-f|0,S=A+4|0,f=(l[S>>2]|0)-f|0,g=nr(+((u*3|0)-f|0)*.14285714285714285)|0,l[A>>2]=g,u=nr(+((f<<1)+u|0)*.14285714285714285)|0,l[S>>2]=u,l[E>>2]=0,f=u-g|0,(g|0)<0?(v=0-g|0,l[S>>2]=f,l[E>>2]=v,l[A>>2]=0,u=f,g=0,f=v):f=0,(u|0)<0&&(g=g-u|0,l[A>>2]=g,f=f-u|0,l[E>>2]=f,l[S>>2]=0,u=0),v=g-f|0,m=u-f|0,(f|0)<0?(l[A>>2]=v,l[S>>2]=m,l[E>>2]=0,u=m,m=v,f=0):m=g,g=(u|0)<(m|0)?u:m,g=(f|0)<(g|0)?f:g,!((g|0)<=0)&&(l[A>>2]=m-g,l[S>>2]=u-g,l[E>>2]=f-g)}function Kh(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;E=A+8|0,f=l[E>>2]|0,u=(l[A>>2]|0)-f|0,S=A+4|0,f=(l[S>>2]|0)-f|0,g=nr(+((u<<1)+f|0)*.14285714285714285)|0,l[A>>2]=g,u=nr(+((f*3|0)-u|0)*.14285714285714285)|0,l[S>>2]=u,l[E>>2]=0,f=u-g|0,(g|0)<0?(v=0-g|0,l[S>>2]=f,l[E>>2]=v,l[A>>2]=0,u=f,g=0,f=v):f=0,(u|0)<0&&(g=g-u|0,l[A>>2]=g,f=f-u|0,l[E>>2]=f,l[S>>2]=0,u=0),v=g-f|0,m=u-f|0,(f|0)<0?(l[A>>2]=v,l[S>>2]=m,l[E>>2]=0,u=m,m=v,f=0):m=g,g=(u|0)<(m|0)?u:m,g=(f|0)<(g|0)?f:g,!((g|0)<=0)&&(l[A>>2]=m-g,l[S>>2]=u-g,l[E>>2]=f-g)}function La(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;u=l[A>>2]|0,E=A+4|0,f=l[E>>2]|0,S=A+8|0,g=l[S>>2]|0,m=f+(u*3|0)|0,l[A>>2]=m,f=g+(f*3|0)|0,l[E>>2]=f,u=(g*3|0)+u|0,l[S>>2]=u,g=f-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=g,l[S>>2]=u,l[A>>2]=0,f=g,g=0):g=m,(f|0)<0&&(g=g-f|0,l[A>>2]=g,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=g-u|0,m=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=m,l[S>>2]=0,g=v,u=0):m=f,f=(m|0)<(g|0)?m:g,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=g-f,l[E>>2]=m-f,l[S>>2]=u-f)}function br(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;m=l[A>>2]|0,E=A+4|0,u=l[E>>2]|0,S=A+8|0,f=l[S>>2]|0,g=(u*3|0)+m|0,m=f+(m*3|0)|0,l[A>>2]=m,l[E>>2]=g,u=(f*3|0)+u|0,l[S>>2]=u,f=g-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=f,l[S>>2]=u,l[A>>2]=0,m=0):f=g,(f|0)<0&&(m=m-f|0,l[A>>2]=m,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=m-u|0,g=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=g,l[S>>2]=0,m=v,u=0):g=f,f=(g|0)<(m|0)?g:m,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=m-f,l[E>>2]=g-f,l[S>>2]=u-f)}function Qh(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0;(u+-1|0)>>>0>=6||(m=(l[15440+(u*12|0)>>2]|0)+(l[A>>2]|0)|0,l[A>>2]=m,S=A+4|0,g=(l[15440+(u*12|0)+4>>2]|0)+(l[S>>2]|0)|0,l[S>>2]=g,E=A+8|0,u=(l[15440+(u*12|0)+8>>2]|0)+(l[E>>2]|0)|0,l[E>>2]=u,f=g-m|0,(m|0)<0?(u=u-m|0,l[S>>2]=f,l[E>>2]=u,l[A>>2]=0,g=0):(f=g,g=m),(f|0)<0&&(g=g-f|0,l[A>>2]=g,u=u-f|0,l[E>>2]=u,l[S>>2]=0,f=0),v=g-u|0,m=f-u|0,(u|0)<0?(l[A>>2]=v,l[S>>2]=m,l[E>>2]=0,g=v,u=0):m=f,f=(m|0)<(g|0)?m:g,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=g-f,l[S>>2]=m-f,l[E>>2]=u-f))}function Wh(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;m=l[A>>2]|0,E=A+4|0,u=l[E>>2]|0,S=A+8|0,f=l[S>>2]|0,g=u+m|0,m=f+m|0,l[A>>2]=m,l[E>>2]=g,u=f+u|0,l[S>>2]=u,f=g-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=f,l[S>>2]=u,l[A>>2]=0,g=0):(f=g,g=m),(f|0)<0&&(g=g-f|0,l[A>>2]=g,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=g-u|0,m=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=m,l[S>>2]=0,g=v,u=0):m=f,f=(m|0)<(g|0)?m:g,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=g-f,l[E>>2]=m-f,l[S>>2]=u-f)}function Ra(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;u=l[A>>2]|0,E=A+4|0,g=l[E>>2]|0,S=A+8|0,f=l[S>>2]|0,m=g+u|0,l[A>>2]=m,g=f+g|0,l[E>>2]=g,u=f+u|0,l[S>>2]=u,f=g-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=f,l[S>>2]=u,l[A>>2]=0,g=0):(f=g,g=m),(f|0)<0&&(g=g-f|0,l[A>>2]=g,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=g-u|0,m=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=m,l[S>>2]=0,g=v,u=0):m=f,f=(m|0)<(g|0)?m:g,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=g-f,l[E>>2]=m-f,l[S>>2]=u-f)}function xr(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function tr(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function Yh(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;u=l[A>>2]|0,E=A+4|0,f=l[E>>2]|0,S=A+8|0,g=l[S>>2]|0,m=f+(u<<1)|0,l[A>>2]=m,f=g+(f<<1)|0,l[E>>2]=f,u=(g<<1)+u|0,l[S>>2]=u,g=f-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=g,l[S>>2]=u,l[A>>2]=0,f=g,g=0):g=m,(f|0)<0&&(g=g-f|0,l[A>>2]=g,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=g-u|0,m=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=m,l[S>>2]=0,g=v,u=0):m=f,f=(m|0)<(g|0)?m:g,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=g-f,l[E>>2]=m-f,l[S>>2]=u-f)}function zh(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;m=l[A>>2]|0,E=A+4|0,u=l[E>>2]|0,S=A+8|0,f=l[S>>2]|0,g=(u<<1)+m|0,m=f+(m<<1)|0,l[A>>2]=m,l[E>>2]=g,u=(f<<1)+u|0,l[S>>2]=u,f=g-m|0,(m|0)<0?(u=u-m|0,l[E>>2]=f,l[S>>2]=u,l[A>>2]=0,m=0):f=g,(f|0)<0&&(m=m-f|0,l[A>>2]=m,u=u-f|0,l[S>>2]=u,l[E>>2]=0,f=0),v=m-u|0,g=f-u|0,(u|0)<0?(l[A>>2]=v,l[E>>2]=g,l[S>>2]=0,m=v,u=0):g=f,f=(g|0)<(m|0)?g:m,f=(u|0)<(f|0)?u:f,!((f|0)<=0)&&(l[A>>2]=m-f,l[E>>2]=g-f,l[S>>2]=u-f)}function iu(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0;return E=(l[A>>2]|0)-(l[u>>2]|0)|0,S=(E|0)<0,g=(l[A+4>>2]|0)-(l[u+4>>2]|0)-(S?E:0)|0,v=(g|0)<0,m=(S?0-E|0:0)+(l[A+8>>2]|0)-(l[u+8>>2]|0)+(v?0-g|0:0)|0,A=(m|0)<0,u=A?0:m,f=(v?0:g)-(A?m:0)|0,m=(S?0:E)-(v?g:0)-(A?m:0)|0,A=(f|0)<(m|0)?f:m,A=(u|0)<(A|0)?u:A,g=(A|0)>0,u=u-(g?A:0)|0,f=f-(g?A:0)|0,A=m-(g?A:0)|0,A=(A|0)>-1?A:0-A|0,f=(f|0)>-1?f:0-f|0,u=(u|0)>-1?u:0-u|0,u=(f|0)>(u|0)?f:u,((A|0)>(u|0)?A:u)|0}function cb(A,u){A=A|0,u=u|0;var f=0;f=l[A+8>>2]|0,l[u>>2]=(l[A>>2]|0)-f,l[u+4>>2]=(l[A+4>>2]|0)-f}function hb(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0;return g=l[A>>2]|0,l[u>>2]=g,m=l[A+4>>2]|0,E=u+4|0,l[E>>2]=m,S=u+8|0,l[S>>2]=0,f=(m|0)<(g|0),A=f?g:m,f=f?m:g,(f|0)<0&&((f|0)==-2147483648||((A|0)>0?(2147483647-A|0)<(f|0):(-2147483648-A|0)>(f|0))||((A|0)>-1?(A|-2147483648|0)>=(f|0):(A^-2147483648|0)<(f|0)))?(u=1,u|0):(A=m-g|0,(g|0)<0?(f=0-g|0,l[E>>2]=A,l[S>>2]=f,l[u>>2]=0,g=0):(A=m,f=0),(A|0)<0&&(g=g-A|0,l[u>>2]=g,f=f-A|0,l[S>>2]=f,l[E>>2]=0,A=0),v=g-f|0,m=A-f|0,(f|0)<0?(l[u>>2]=v,l[E>>2]=m,l[S>>2]=0,A=m,m=v,f=0):m=g,g=(A|0)<(m|0)?A:m,g=(f|0)<(g|0)?f:g,(g|0)<=0?(u=0,u|0):(l[u>>2]=m-g,l[E>>2]=A-g,l[S>>2]=f-g,u=0,u|0))}function qh(A){A=A|0;var u=0,f=0,g=0,m=0;u=A+8|0,m=l[u>>2]|0,f=m-(l[A>>2]|0)|0,l[A>>2]=f,g=A+4|0,A=(l[g>>2]|0)-m|0,l[g>>2]=A,l[u>>2]=0-(A+f)}function db(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;f=l[A>>2]|0,u=0-f|0,l[A>>2]=u,E=A+8|0,l[E>>2]=0,S=A+4|0,g=l[S>>2]|0,m=g+f|0,(f|0)>0?(l[S>>2]=m,l[E>>2]=f,l[A>>2]=0,u=0,g=m):f=0,(g|0)<0?(v=u-g|0,l[A>>2]=v,f=f-g|0,l[E>>2]=f,l[S>>2]=0,m=v-f|0,u=0-f|0,(f|0)<0?(l[A>>2]=m,l[S>>2]=u,l[E>>2]=0,g=u,f=0):(g=0,m=v)):m=u,u=(g|0)<(m|0)?g:m,u=(f|0)<(u|0)?f:u,!((u|0)<=0)&&(l[A>>2]=m-u,l[S>>2]=g-u,l[E>>2]=f-u)}function gb(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0;if(B=O,O=O+64|0,D=B,S=B+56|0,!(!0&(u&2013265920|0)==134217728&(!0&(g&2013265920|0)==134217728)))return m=5,O=B,m|0;if((A|0)==(f|0)&(u|0)==(g|0))return l[m>>2]=0,m=0,O=B,m|0;if(E=he(A|0,u|0,52)|0,N()|0,E=E&15,I=he(f|0,g|0,52)|0,N()|0,(E|0)!=(I&15|0))return m=12,O=B,m|0;if(v=E+-1|0,E>>>0>1){au(A,u,v,D)|0,au(f,g,v,S)|0,I=D,x=l[I>>2]|0,I=l[I+4>>2]|0;e:do if((x|0)==(l[S>>2]|0)&&(I|0)==(l[S+4>>2]|0)){E=(E^15)*3|0,v=he(A|0,u|0,E|0)|0,N()|0,v=v&7,E=he(f|0,g|0,E|0)|0,N()|0,E=E&7;do if((v|0)==0|(E|0)==0)l[m>>2]=1,v=0;else if((v|0)==7)v=5;else{if((v|0)==1|(E|0)==1&&mt(x,I)|0){v=5;break}if((l[15536+(v<<2)>>2]|0)!=(E|0)&&(l[15568+(v<<2)>>2]|0)!=(E|0))break e;l[m>>2]=1,v=0}while(!1);return m=v,O=B,m|0}while(!1)}v=D,E=v+56|0;do l[v>>2]=0,v=v+4|0;while((v|0)<(E|0));return kh(A,u,1,D)|0,u=D,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0))&&(u=D+8|0,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0)))&&(u=D+16|0,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0)))&&(u=D+24|0,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0)))&&(u=D+32|0,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0)))&&(u=D+40|0,!((l[u>>2]|0)==(f|0)&&(l[u+4>>2]|0)==(g|0)))?(v=D+48|0,v=((l[v>>2]|0)==(f|0)?(l[v+4>>2]|0)==(g|0):0)&1):v=1,l[m>>2]=v,m=0,O=B,m|0}function pb(A,u,f,g,m){return A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,f=zl(A,u,f,g)|0,(f|0)==7?(m=11,m|0):(g=Ee(f|0,0,56)|0,u=u&-2130706433|(N()|0)|268435456,l[m>>2]=A|g,l[m+4>>2]=u,m=0,m|0)}function mb(A,u,f){return A=A|0,u=u|0,f=f|0,!0&(u&2013265920|0)==268435456?(l[f>>2]=A,l[f+4>>2]=u&-2130706433|134217728,f=0,f|0):(f=6,f|0)}function yb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;return m=O,O=O+16|0,g=m,l[g>>2]=0,!0&(u&2013265920|0)==268435456?(v=he(A|0,u|0,56)|0,N()|0,g=zt(A,u&-2130706433|134217728,v&7,g,f)|0,O=m,g|0):(g=6,O=m,g|0)}function vb(A,u){A=A|0,u=u|0;var f=0;switch(f=he(A|0,u|0,56)|0,N()|0,f&7){case 0:case 7:return f=0,f|0}return f=u&-2130706433|134217728,!(!0&(u&2013265920|0)==268435456)||!0&(u&117440512|0)==16777216&(mt(A,f)|0)!=0?(f=0,f|0):(f=su(A,f)|0,f|0)}function Eb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;return m=O,O=O+16|0,g=m,!0&(u&2013265920|0)==268435456?(v=u&-2130706433|134217728,E=f,l[E>>2]=A,l[E+4>>2]=v,l[g>>2]=0,u=he(A|0,u|0,56)|0,N()|0,g=zt(A,v,u&7,g,f+8|0)|0,O=m,g|0):(g=6,O=m,g|0)}function Tb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0;return m=(mt(A,u)|0)==0,u=u&-2130706433,g=f,l[g>>2]=m?A:0,l[g+4>>2]=m?u|285212672:0,g=f+8|0,l[g>>2]=A,l[g+4>>2]=u|301989888,g=f+16|0,l[g>>2]=A,l[g+4>>2]=u|318767104,g=f+24|0,l[g>>2]=A,l[g+4>>2]=u|335544320,g=f+32|0,l[g>>2]=A,l[g+4>>2]=u|352321536,f=f+40|0,l[f>>2]=A,l[f+4>>2]=u|369098752,0}function Da(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;return E=O,O=O+16|0,m=E,v=u&-2130706433|134217728,!0&(u&2013265920|0)==268435456?(g=he(A|0,u|0,56)|0,N()|0,g=yx(A,v,g&7)|0,(g|0)==-1?(l[f>>2]=0,v=6,O=E,v|0):(Jr(A,v,m)|0&&Ne(27795,26932,282,26947),u=he(A|0,u|0,52)|0,N()|0,u=u&15,mt(A,v)|0?nu(m,u,g,2,f):ru(m,u,g,2,f),v=0,O=E,v|0)):(v=6,O=E,v|0)}function Sb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0;g=O,O=O+16|0,m=g,bb(A,u,f,m),Ab(m,f+4|0),O=g}function bb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0;if(S=O,O=O+16|0,x=S,xb(A,f,x),v=+wa(+(1-+M[x>>3]*.5)),v<1e-16){l[g>>2]=0,l[g+4>>2]=0,l[g+8>>2]=0,l[g+12>>2]=0,O=S;return}if(x=l[f>>2]|0,m=+M[15920+(x*24|0)>>3],m=+io(m-+io(+Gb(15600+(x<<4)|0,A))),Ki(u)|0?E=+io(m+-.3334731722518321):E=m,m=+Hi(+v)*2.618033988749896,(u|0)>0){A=0;do m=m*2.6457513110645907,A=A+1|0;while((A|0)!=(u|0))}v=+ct(+E)*m,M[g>>3]=v,E=+tt(+E)*m,M[g+8>>3]=E,O=S}function xb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;if(v=O,O=O+32|0,m=v,mx(A,m),l[u>>2]=0,M[f>>3]=5,g=+Nt(16400,m),g<+M[f>>3]&&(l[u>>2]=0,M[f>>3]=g),g=+Nt(16424,m),g<+M[f>>3]&&(l[u>>2]=1,M[f>>3]=g),g=+Nt(16448,m),g<+M[f>>3]&&(l[u>>2]=2,M[f>>3]=g),g=+Nt(16472,m),g<+M[f>>3]&&(l[u>>2]=3,M[f>>3]=g),g=+Nt(16496,m),g<+M[f>>3]&&(l[u>>2]=4,M[f>>3]=g),g=+Nt(16520,m),g<+M[f>>3]&&(l[u>>2]=5,M[f>>3]=g),g=+Nt(16544,m),g<+M[f>>3]&&(l[u>>2]=6,M[f>>3]=g),g=+Nt(16568,m),g<+M[f>>3]&&(l[u>>2]=7,M[f>>3]=g),g=+Nt(16592,m),g<+M[f>>3]&&(l[u>>2]=8,M[f>>3]=g),g=+Nt(16616,m),g<+M[f>>3]&&(l[u>>2]=9,M[f>>3]=g),g=+Nt(16640,m),g<+M[f>>3]&&(l[u>>2]=10,M[f>>3]=g),g=+Nt(16664,m),g<+M[f>>3]&&(l[u>>2]=11,M[f>>3]=g),g=+Nt(16688,m),g<+M[f>>3]&&(l[u>>2]=12,M[f>>3]=g),g=+Nt(16712,m),g<+M[f>>3]&&(l[u>>2]=13,M[f>>3]=g),g=+Nt(16736,m),g<+M[f>>3]&&(l[u>>2]=14,M[f>>3]=g),g=+Nt(16760,m),g<+M[f>>3]&&(l[u>>2]=15,M[f>>3]=g),g=+Nt(16784,m),g<+M[f>>3]&&(l[u>>2]=16,M[f>>3]=g),g=+Nt(16808,m),g<+M[f>>3]&&(l[u>>2]=17,M[f>>3]=g),g=+Nt(16832,m),g<+M[f>>3]&&(l[u>>2]=18,M[f>>3]=g),g=+Nt(16856,m),!(g<+M[f>>3])){O=v;return}l[u>>2]=19,M[f>>3]=g,O=v}function eo(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0;if(v=+px(A),v<1e-16){u=15600+(u<<4)|0,l[m>>2]=l[u>>2],l[m+4>>2]=l[u+4>>2],l[m+8>>2]=l[u+8>>2],l[m+12>>2]=l[u+12>>2];return}if(E=+ji(+ +M[A+8>>3],+ +M[A>>3]),(f|0)>0){A=0;do v=v*.37796447300922725,A=A+1|0;while((A|0)!=(f|0))}S=v*.3333333333333333,g?(f=(Ki(f)|0)==0,v=+Wl(+((f?S:S*.37796447300922725)*.381966011250105))):(v=+Wl(+(v*.381966011250105)),Ki(f)|0&&(E=+io(E+.3334731722518321))),Vb(15600+(u<<4)|0,+io(+M[15920+(u*24|0)>>3]-E),v,m)}function _b(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0;g=O,O=O+16|0,m=g,Sr(A+4|0,m),eo(m,l[A>>2]|0,u,0,f),O=g}function nu(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0,Le=0,ye=0,Je=0,dt=0,qe=0;if(Je=O,O=O+272|0,v=Je+256|0,ie=Je+240|0,Be=Je,Le=Je+224|0,ye=Je+208|0,J=Je+176|0,q=Je+160|0,ve=Je+192|0,Ie=Je+144|0,xe=Je+128|0,je=Je+112|0,We=Je+96|0,it=Je+80|0,l[v>>2]=u,l[ie>>2]=l[A>>2],l[ie+4>>2]=l[A+4>>2],l[ie+8>>2]=l[A+8>>2],l[ie+12>>2]=l[A+12>>2],Xh(ie,v,Be),l[m>>2]=0,ie=g+f+((g|0)==5&1)|0,(ie|0)<=(f|0)){O=Je;return}x=l[v>>2]|0,I=Le+4|0,D=J+4|0,B=f+5|0,V=16880+(x<<2)|0,H=16960+(x<<2)|0,j=xe+8|0,z=je+8|0,Z=We+8|0,ae=ye+4|0,S=f;e:for(;;){E=Be+(((S|0)%5|0)<<4)|0,l[ye>>2]=l[E>>2],l[ye+4>>2]=l[E+4>>2],l[ye+8>>2]=l[E+8>>2],l[ye+12>>2]=l[E+12>>2];do;while((Zr(ye,x,0,1)|0)==2);if((S|0)>(f|0)&(Ki(u)|0)!=0){if(l[J>>2]=l[ye>>2],l[J+4>>2]=l[ye+4>>2],l[J+8>>2]=l[ye+8>>2],l[J+12>>2]=l[ye+12>>2],Sr(I,q),g=l[J>>2]|0,v=l[17040+(g*80|0)+(l[Le>>2]<<2)>>2]|0,l[J>>2]=l[18640+(g*80|0)+(v*20|0)>>2],E=l[18640+(g*80|0)+(v*20|0)+16>>2]|0,(E|0)>0){A=0;do Wh(D),A=A+1|0;while((A|0)<(E|0))}switch(E=18640+(g*80|0)+(v*20|0)+4|0,l[ve>>2]=l[E>>2],l[ve+4>>2]=l[E+4>>2],l[ve+8>>2]=l[E+8>>2],jh(ve,(l[V>>2]|0)*3|0),ui(D,ve,D),ri(D),Sr(D,Ie),dt=+(l[H>>2]|0),M[xe>>3]=dt*3,M[j>>3]=0,qe=dt*-1.5,M[je>>3]=qe,M[z>>3]=dt*2.598076211353316,M[We>>3]=qe,M[Z>>3]=dt*-2.598076211353316,l[17040+((l[J>>2]|0)*80|0)+(l[ye>>2]<<2)>>2]|0){case 1:{A=je,g=xe;break}case 3:{A=We,g=je;break}case 2:{A=xe,g=We;break}default:{A=12;break e}}hd(q,Ie,g,A,it),eo(it,l[J>>2]|0,x,1,m+8+(l[m>>2]<<4)|0),l[m>>2]=(l[m>>2]|0)+1}if((S|0)<(B|0)&&(Sr(ae,J),eo(J,l[ye>>2]|0,x,1,m+8+(l[m>>2]<<4)|0),l[m>>2]=(l[m>>2]|0)+1),l[Le>>2]=l[ye>>2],l[Le+4>>2]=l[ye+4>>2],l[Le+8>>2]=l[ye+8>>2],l[Le+12>>2]=l[ye+12>>2],S=S+1|0,(S|0)>=(ie|0)){A=3;break}}if((A|0)==3){O=Je;return}else(A|0)==12&&Ne(26970,27017,572,27027)}function Xh(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0;x=O,O=O+128|0,g=x+64|0,m=x,v=g,E=20240,S=v+60|0;do l[v>>2]=l[E>>2],v=v+4|0,E=E+4|0;while((v|0)<(S|0));v=m,E=20304,S=v+60|0;do l[v>>2]=l[E>>2],v=v+4|0,E=E+4|0;while((v|0)<(S|0));S=(Ki(l[u>>2]|0)|0)==0,g=S?g:m,m=A+4|0,Yh(m),zh(m),Ki(l[u>>2]|0)|0&&(br(m),l[u>>2]=(l[u>>2]|0)+1),l[f>>2]=l[A>>2],u=f+4|0,ui(m,g,u),ri(u),l[f+16>>2]=l[A>>2],u=f+20|0,ui(m,g+12|0,u),ri(u),l[f+32>>2]=l[A>>2],u=f+36|0,ui(m,g+24|0,u),ri(u),l[f+48>>2]=l[A>>2],u=f+52|0,ui(m,g+36|0,u),ri(u),l[f+64>>2]=l[A>>2],f=f+68|0,ui(m,g+48|0,f),ri(f),O=x}function Zr(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0;if(j=O,O=O+32|0,V=j+12|0,S=j,H=A+4|0,B=l[16960+(u<<2)>>2]|0,D=(g|0)!=0,B=D?B*3|0:B,m=l[H>>2]|0,I=A+8|0,E=l[I>>2]|0,D){if(v=A+12|0,g=l[v>>2]|0,m=E+m+g|0,(m|0)==(B|0))return H=1,O=j,H|0;x=v}else x=A+12|0,g=l[x>>2]|0,m=E+m+g|0;if((m|0)<=(B|0))return H=0,O=j,H|0;do if((g|0)>0){if(g=l[A>>2]|0,(E|0)>0){v=18640+(g*80|0)+60|0,g=A;break}g=18640+(g*80|0)+40|0,f?(ab(V,B,0,0),tu(H,V,S),Ra(S),ui(S,V,H),v=g,g=A):(v=g,g=A)}else v=18640+((l[A>>2]|0)*80|0)+20|0,g=A;while(!1);if(l[g>>2]=l[v>>2],m=v+16|0,(l[m>>2]|0)>0){g=0;do Wh(H),g=g+1|0;while((g|0)<(l[m>>2]|0))}return A=v+4|0,l[V>>2]=l[A>>2],l[V+4>>2]=l[A+4>>2],l[V+8>>2]=l[A+8>>2],u=l[16880+(u<<2)>>2]|0,jh(V,D?u*3|0:u),ui(H,V,H),ri(H),D?g=((l[I>>2]|0)+(l[H>>2]|0)+(l[x>>2]|0)|0)==(B|0)?1:2:g=2,H=g,O=j,H|0}function wb(A,u){A=A|0,u=u|0;var f=0;do f=Zr(A,u,0,1)|0;while((f|0)==2);return f|0}function ru(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0;if(We=O,O=O+240|0,v=We+224|0,ve=We+208|0,Ie=We,xe=We+192|0,je=We+176|0,Z=We+160|0,ae=We+144|0,ie=We+128|0,J=We+112|0,q=We+96|0,l[v>>2]=u,l[ve>>2]=l[A>>2],l[ve+4>>2]=l[A+4>>2],l[ve+8>>2]=l[A+8>>2],l[ve+12>>2]=l[A+12>>2],Zh(ve,v,Ie),l[m>>2]=0,z=g+f+((g|0)==6&1)|0,(z|0)<=(f|0)){O=We;return}x=l[v>>2]|0,I=f+6|0,D=16960+(x<<2)|0,B=ae+8|0,V=ie+8|0,H=J+8|0,j=xe+4|0,E=0,S=f,g=-1;e:for(;;){if(v=(S|0)%6|0,A=Ie+(v<<4)|0,l[xe>>2]=l[A>>2],l[xe+4>>2]=l[A+4>>2],l[xe+8>>2]=l[A+8>>2],l[xe+12>>2]=l[A+12>>2],A=E,E=Zr(xe,x,0,1)|0,(S|0)>(f|0)&(Ki(u)|0)!=0&&(A|0)!=1&&(l[xe>>2]|0)!=(g|0)){switch(Sr(Ie+(((v+5|0)%6|0)<<4)+4|0,je),Sr(Ie+(v<<4)+4|0,Z),it=+(l[D>>2]|0),M[ae>>3]=it*3,M[B>>3]=0,Be=it*-1.5,M[ie>>3]=Be,M[V>>3]=it*2.598076211353316,M[J>>3]=Be,M[H>>3]=it*-2.598076211353316,v=l[ve>>2]|0,l[17040+(v*80|0)+(((g|0)==(v|0)?l[xe>>2]|0:g)<<2)>>2]|0){case 1:{A=ie,g=ae;break}case 3:{A=J,g=ie;break}case 2:{A=ae,g=J;break}default:{A=8;break e}}hd(je,Z,g,A,q),!(dd(je,q)|0)&&!(dd(Z,q)|0)&&(eo(q,l[ve>>2]|0,x,1,m+8+(l[m>>2]<<4)|0),l[m>>2]=(l[m>>2]|0)+1)}if((S|0)<(I|0)&&(Sr(j,je),eo(je,l[xe>>2]|0,x,1,m+8+(l[m>>2]<<4)|0),l[m>>2]=(l[m>>2]|0)+1),S=S+1|0,(S|0)>=(z|0)){A=3;break}else g=l[xe>>2]|0}if((A|0)==3){O=We;return}else(A|0)==8&&Ne(27054,27017,737,27099)}function Zh(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0;x=O,O=O+160|0,g=x+80|0,m=x,v=g,E=20368,S=v+72|0;do l[v>>2]=l[E>>2],v=v+4|0,E=E+4|0;while((v|0)<(S|0));v=m,E=20448,S=v+72|0;do l[v>>2]=l[E>>2],v=v+4|0,E=E+4|0;while((v|0)<(S|0));S=(Ki(l[u>>2]|0)|0)==0,g=S?g:m,m=A+4|0,Yh(m),zh(m),Ki(l[u>>2]|0)|0&&(br(m),l[u>>2]=(l[u>>2]|0)+1),l[f>>2]=l[A>>2],u=f+4|0,ui(m,g,u),ri(u),l[f+16>>2]=l[A>>2],u=f+20|0,ui(m,g+12|0,u),ri(u),l[f+32>>2]=l[A>>2],u=f+36|0,ui(m,g+24|0,u),ri(u),l[f+48>>2]=l[A>>2],u=f+52|0,ui(m,g+36|0,u),ri(u),l[f+64>>2]=l[A>>2],u=f+68|0,ui(m,g+48|0,u),ri(u),l[f+80>>2]=l[A>>2],f=f+84|0,ui(m,g+60|0,f),ri(f),O=x}function Ib(A,u){return A=A|0,u=u|0,u=he(A|0,u|0,52)|0,N()|0,u&15|0}function Jh(A,u){return A=A|0,u=u|0,u=he(A|0,u|0,45)|0,N()|0,u&127|0}function su(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0;return!(!0&(u&-16777216|0)==134217728)||(g=he(A|0,u|0,52)|0,N()|0,g=g&15,f=he(A|0,u|0,45)|0,N()|0,f=f&127,f>>>0>121)?(A=0,A|0):(E=(g^15)*3|0,m=he(A|0,u|0,E|0)|0,E=Ee(m|0,N()|0,E|0)|0,m=N()|0,v=Jt(-1227133514,-1171,E|0,m|0)|0,!((E&613566756&v|0)==0&(m&4681&(N()|0)|0)==0)||(E=(g*3|0)+19|0,v=Ee(~A|0,~u|0,E|0)|0,E=he(v|0,N()|0,E|0)|0,!((g|0)==15|(E|0)==0&(N()|0)==0))?(E=0,E|0):!(de[20528+f>>0]|0)||(u=u&8191,(A|0)==0&(u|0)==0)?(E=1,E|0):(E=Td(A|0,u|0)|0,N()|0,((63-E|0)%3|0|0)!=0|0))}function ou(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0;if(m=Ee(u|0,0,52)|0,v=N()|0,f=Ee(f|0,0,45)|0,f=v|(N()|0)|134225919,(u|0)<1){v=-1,g=f,u=A,l[u>>2]=v,A=A+4|0,l[A>>2]=g;return}for(v=1,m=-1;E=(15-v|0)*3|0,S=Ee(7,0,E|0)|0,f=f&~(N()|0),E=Ee(g|0,0,E|0)|0,m=m&~S|E,f=f|(N()|0),(v|0)!=(u|0);)v=v+1|0;S=A,E=S,l[E>>2]=m,S=S+4|0,l[S>>2]=f}function au(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0;if(v=he(A|0,u|0,52)|0,N()|0,v=v&15,f>>>0>15)return g=4,g|0;if((v|0)<(f|0))return g=12,g|0;if((v|0)==(f|0))return l[g>>2]=A,l[g+4>>2]=u,g=0,g|0;if(m=Ee(f|0,0,52)|0,m=m|A,A=N()|0|u&-15728641,(v|0)>(f|0))do u=Ee(7,0,(14-f|0)*3|0)|0,f=f+1|0,m=u|m,A=N()|0|A;while((f|0)<(v|0));return l[g>>2]=m,l[g+4>>2]=A,g=0,g|0}function to(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0;if(v=he(A|0,u|0,52)|0,N()|0,v=v&15,!((f|0)<16&(v|0)<=(f|0)))return g=4,g|0;m=f-v|0,f=he(A|0,u|0,45)|0,N()|0;e:do if(!(bt(f&127)|0))f=ir(7,0,m,((m|0)<0)<<31>>31)|0,m=N()|0;else{t:do if(v|0){for(f=1;E=Ee(7,0,(15-f|0)*3|0)|0,!!((E&A|0)==0&((N()|0)&u|0)==0);)if(f>>>0<v>>>0)f=f+1|0;else break t;f=ir(7,0,m,((m|0)<0)<<31>>31)|0,m=N()|0;break e}while(!1);f=ir(7,0,m,((m|0)<0)<<31>>31)|0,f=qt(f|0,N()|0,5,0)|0,f=Ce(f|0,N()|0,-5,-1)|0,f=rr(f|0,N()|0,6,0)|0,f=Ce(f|0,N()|0,1,0)|0,m=N()|0}while(!1);return E=g,l[E>>2]=f,l[E+4>>2]=m,E=0,E|0}function mt(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;if(m=he(A|0,u|0,45)|0,N()|0,!(bt(m&127)|0))return m=0,m|0;m=he(A|0,u|0,52)|0,N()|0,m=m&15;e:do if(!m)f=0;else for(g=1;;){if(f=he(A|0,u|0,(15-g|0)*3|0)|0,N()|0,f=f&7,f|0)break e;if(g>>>0<m>>>0)g=g+1|0;else{f=0;break}}while(!1);return m=(f|0)==0&1,m|0}function Lb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0;if(E=O,O=O+16|0,v=E,hu(v,A,u,f),u=v,A=l[u>>2]|0,u=l[u+4>>2]|0,(A|0)==0&(u|0)==0)return O=E,0;m=0,f=0;do S=g+(m<<3)|0,l[S>>2]=A,l[S+4>>2]=u,m=Ce(m|0,f|0,1,0)|0,f=N()|0,du(v),S=v,A=l[S>>2]|0,u=l[S+4>>2]|0;while(!((A|0)==0&(u|0)==0));return O=E,0}function ed(A,u,f,g){return A=A|0,u=u|0,f=f|0,g=g|0,(g|0)<(f|0)?(f=u,g=A,Qe(f|0),g|0):(f=Ee(-1,-1,((g-f|0)*3|0)+3|0)|0,g=Ee(~f|0,~(N()|0)|0,(15-g|0)*3|0)|0,f=~(N()|0)&u,g=~g&A,Qe(f|0),g|0)}function td(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0;return m=he(A|0,u|0,52)|0,N()|0,m=m&15,(f|0)<16&(m|0)<=(f|0)?((m|0)<(f|0)&&(m=Ee(-1,-1,((f+-1-m|0)*3|0)+3|0)|0,m=Ee(~m|0,~(N()|0)|0,(15-f|0)*3|0)|0,u=~(N()|0)&u,A=~m&A),m=Ee(f|0,0,52)|0,f=u&-15728641|(N()|0),l[g>>2]=A|m,l[g+4>>2]=f,g=0,g|0):(g=4,g|0)}function Rb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0,Le=0,ye=0;if((f|0)==0&(g|0)==0)return ye=0,ye|0;if(m=A,v=l[m>>2]|0,m=l[m+4>>2]|0,!0&(m&15728640|0)==0){if(!((g|0)>0|(g|0)==0&f>>>0>0)||(ye=u,l[ye>>2]=v,l[ye+4>>2]=m,(f|0)==1&(g|0)==0))return ye=0,ye|0;m=1,v=0;do Be=A+(m<<3)|0,Le=l[Be+4>>2]|0,ye=u+(m<<3)|0,l[ye>>2]=l[Be>>2],l[ye+4>>2]=Le,m=Ce(m|0,v|0,1,0)|0,v=N()|0;while((v|0)<(g|0)|(v|0)==(g|0)&m>>>0<f>>>0);return m=0,m|0}if(it=f<<3,Le=mn(it)|0,!Le)return ye=13,ye|0;if(rs(Le|0,A|0,it|0)|0,Be=Ti(f,8)|0,!Be)return Pe(Le),ye=13,ye|0;e:for(;;){m=Le,I=l[m>>2]|0,m=l[m+4>>2]|0,je=he(I|0,m|0,52)|0,N()|0,je=je&15,We=je+-1|0,xe=(je|0)!=0,Ie=(g|0)>0|(g|0)==0&f>>>0>0;t:do if(xe&Ie){if(ie=Ee(We|0,0,52)|0,J=N()|0,We>>>0>15){if(!((I|0)==0&(m|0)==0)){ye=16;break e}for(v=0,A=0;;){if(v=Ce(v|0,A|0,1,0)|0,A=N()|0,!((A|0)<(g|0)|(A|0)==(g|0)&v>>>0<f>>>0))break t;if(E=Le+(v<<3)|0,ve=l[E>>2]|0,E=l[E+4>>2]|0,!((ve|0)==0&(E|0)==0)){m=E,ye=16;break e}}}for(S=I,A=m,v=0,E=0;;){if(!((S|0)==0&(A|0)==0)){if(!(!0&(A&117440512|0)==0)){ye=21;break e}if(D=he(S|0,A|0,52)|0,N()|0,D=D&15,(D|0)<(We|0)){m=12,ye=27;break e}if((D|0)!=(We|0)&&(S=S|ie,A=A&-15728641|J,D>>>0>=je>>>0)){x=We;do ve=Ee(7,0,(14-x|0)*3|0)|0,x=x+1|0,S=ve|S,A=N()|0|A;while(x>>>0<D>>>0)}if(V=ns(S|0,A|0,f|0,g|0)|0,H=N()|0,x=Be+(V<<3)|0,D=x,B=l[D>>2]|0,D=l[D+4>>2]|0,!((B|0)==0&(D|0)==0)){Z=0,ae=0;do{if((Z|0)>(g|0)|(Z|0)==(g|0)&ae>>>0>f>>>0){ye=31;break e}if((B|0)==(S|0)&(D&-117440513|0)==(A|0)){j=he(B|0,D|0,56)|0,N()|0,j=j&7,z=j+1|0,ve=he(B|0,D|0,45)|0,N()|0;i:do if(!(bt(ve&127)|0))D=7;else{if(B=he(B|0,D|0,52)|0,N()|0,B=B&15,!B){D=6;break}for(D=1;;){if(ve=Ee(7,0,(15-D|0)*3|0)|0,!((ve&S|0)==0&((N()|0)&A|0)==0)){D=7;break i}if(D>>>0<B>>>0)D=D+1|0;else{D=6;break}}}while(!1);if((j+2|0)>>>0>D>>>0){ye=41;break e}ve=Ee(z|0,0,56)|0,A=N()|0|A&-117440513,q=x,l[q>>2]=0,l[q+4>>2]=0,S=ve|S}else V=Ce(V|0,H|0,1,0)|0,V=is(V|0,N()|0,f|0,g|0)|0,H=N()|0;ae=Ce(ae|0,Z|0,1,0)|0,Z=N()|0,x=Be+(V<<3)|0,D=x,B=l[D>>2]|0,D=l[D+4>>2]|0}while(!((B|0)==0&(D|0)==0))}ve=x,l[ve>>2]=S,l[ve+4>>2]=A}if(v=Ce(v|0,E|0,1,0)|0,E=N()|0,!((E|0)<(g|0)|(E|0)==(g|0)&v>>>0<f>>>0))break t;A=Le+(v<<3)|0,S=l[A>>2]|0,A=l[A+4>>2]|0}}while(!1);if(ve=Ce(f|0,g|0,5,0)|0,q=N()|0,q>>>0<0|(q|0)==0&ve>>>0<11){ye=85;break}if(ve=rr(f|0,g|0,6,0)|0,N()|0,ve=Ti(ve,8)|0,!ve){ye=48;break}do if(Ie){for(z=0,A=0,j=0,Z=0;;){if(D=Be+(z<<3)|0,E=D,v=l[E>>2]|0,E=l[E+4>>2]|0,(v|0)==0&(E|0)==0)q=j;else{B=he(v|0,E|0,56)|0,N()|0,B=B&7,S=B+1|0,V=E&-117440513,q=he(v|0,E|0,45)|0,N()|0;t:do if(bt(q&127)|0){if(H=he(v|0,E|0,52)|0,N()|0,H=H&15,H|0)for(x=1;;){if(q=Ee(7,0,(15-x|0)*3|0)|0,!((v&q|0)==0&(V&(N()|0)|0)==0))break t;if(x>>>0<H>>>0)x=x+1|0;else break}E=Ee(S|0,0,56)|0,v=E|v,E=N()|0|V,S=D,l[S>>2]=v,l[S+4>>2]=E,S=B+2|0}while(!1);(S|0)==7?(q=ve+(A<<3)|0,l[q>>2]=v,l[q+4>>2]=E&-117440513,A=Ce(A|0,j|0,1,0)|0,q=N()|0):q=j}if(z=Ce(z|0,Z|0,1,0)|0,Z=N()|0,(Z|0)<(g|0)|(Z|0)==(g|0)&z>>>0<f>>>0)j=q;else break}if(Ie){if(ae=We>>>0>15,ie=Ee(We|0,0,52)|0,J=N()|0,!xe){for(v=0,x=0,S=0,E=0;(I|0)==0&(m|0)==0||(We=u+(v<<3)|0,l[We>>2]=I,l[We+4>>2]=m,v=Ce(v|0,x|0,1,0)|0,x=N()|0),S=Ce(S|0,E|0,1,0)|0,E=N()|0,!!((E|0)<(g|0)|(E|0)==(g|0)&S>>>0<f>>>0);)m=Le+(S<<3)|0,I=l[m>>2]|0,m=l[m+4>>2]|0;m=q;break}for(v=0,x=0,E=0,S=0;;){do if(!((I|0)==0&(m|0)==0)){if(H=he(I|0,m|0,52)|0,N()|0,H=H&15,ae|(H|0)<(We|0)){ye=80;break e}if((H|0)!=(We|0)){if(D=I|ie,B=m&-15728641|J,H>>>0>=je>>>0){V=We;do xe=Ee(7,0,(14-V|0)*3|0)|0,V=V+1|0,D=xe|D,B=N()|0|B;while(V>>>0<H>>>0)}}else D=I,B=m;j=ns(D|0,B|0,f|0,g|0)|0,V=0,H=0,Z=N()|0;do{if((V|0)>(g|0)|(V|0)==(g|0)&H>>>0>f>>>0){ye=81;break e}if(xe=Be+(j<<3)|0,z=l[xe+4>>2]|0,(z&-117440513|0)==(B|0)&&(l[xe>>2]|0)==(D|0)){ye=65;break}xe=Ce(j|0,Z|0,1,0)|0,j=is(xe|0,N()|0,f|0,g|0)|0,Z=N()|0,H=Ce(H|0,V|0,1,0)|0,V=N()|0,xe=Be+(j<<3)|0}while(!((l[xe>>2]|0)==(D|0)&&(l[xe+4>>2]|0)==(B|0)));if((ye|0)==65&&(ye=0,!0&(z&117440512|0)==100663296))break;xe=u+(v<<3)|0,l[xe>>2]=I,l[xe+4>>2]=m,v=Ce(v|0,x|0,1,0)|0,x=N()|0}while(!1);if(E=Ce(E|0,S|0,1,0)|0,S=N()|0,!((S|0)<(g|0)|(S|0)==(g|0)&E>>>0<f>>>0))break;m=Le+(E<<3)|0,I=l[m>>2]|0,m=l[m+4>>2]|0}m=q}else v=0,m=q}else v=0,A=0,m=0;while(!1);if(sr(Be|0,0,it|0)|0,rs(Le|0,ve|0,A<<3|0)|0,Pe(ve),(A|0)==0&(m|0)==0){ye=89;break}else u=u+(v<<3)|0,g=m,f=A}if((ye|0)==16)!0&(m&117440512|0)==0?(m=4,ye=27):ye=21;else if((ye|0)==31)Ne(27795,27122,529,27132);else{if((ye|0)==41)return Pe(Le),Pe(Be),ye=10,ye|0;if((ye|0)==48)return Pe(Le),Pe(Be),ye=13,ye|0;(ye|0)==80?Ne(27795,27122,620,27132):(ye|0)==81?Ne(27795,27122,632,27132):(ye|0)==85&&(rs(u|0,Le|0,f<<3|0)|0,ye=89)}return(ye|0)==21?(Pe(Le),Pe(Be),ye=5,ye|0):(ye|0)==27?(Pe(Le),Pe(Be),ye=m,ye|0):(ye|0)==89?(Pe(Le),Pe(Be),ye=0,ye|0):0}function Db(A,u,f,g,m,v,E){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0,E=E|0;var S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0;if(z=O,O=O+16|0,j=z,!((f|0)>0|(f|0)==0&u>>>0>0))return j=0,O=z,j|0;if((E|0)>=16)return j=12,O=z,j|0;V=0,H=0,B=0,S=0;e:for(;;){if(I=A+(V<<3)|0,x=l[I>>2]|0,I=l[I+4>>2]|0,D=he(x|0,I|0,52)|0,N()|0,(D&15|0)>(E|0)){S=12,x=11;break}if(hu(j,x,I,E),D=j,I=l[D>>2]|0,D=l[D+4>>2]|0,(I|0)==0&(D|0)==0)x=B;else{x=B;do{if(!((S|0)<(v|0)|(S|0)==(v|0)&x>>>0<m>>>0)){x=10;break e}B=g+(x<<3)|0,l[B>>2]=I,l[B+4>>2]=D,x=Ce(x|0,S|0,1,0)|0,S=N()|0,du(j),B=j,I=l[B>>2]|0,D=l[B+4>>2]|0}while(!((I|0)==0&(D|0)==0))}if(V=Ce(V|0,H|0,1,0)|0,H=N()|0,(H|0)<(f|0)|(H|0)==(f|0)&V>>>0<u>>>0)B=x;else{S=0,x=11;break}}return(x|0)==10?(j=14,O=z,j|0):(x|0)==11?(O=z,S|0):0}function Cb(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;V=O,O=O+16|0,B=V;e:do if((f|0)>0|(f|0)==0&u>>>0>0){for(I=0,E=0,v=0,D=0;;){if(x=A+(I<<3)|0,S=l[x>>2]|0,x=l[x+4>>2]|0,!((S|0)==0&(x|0)==0)&&(x=(to(S,x,g,B)|0)==0,S=B,E=Ce(l[S>>2]|0,l[S+4>>2]|0,E|0,v|0)|0,v=N()|0,!x)){v=12;break}if(I=Ce(I|0,D|0,1,0)|0,D=N()|0,!((D|0)<(f|0)|(D|0)==(f|0)&I>>>0<u>>>0))break e}return O=V,v|0}else E=0,v=0;while(!1);return l[m>>2]=E,l[m+4>>2]=v,m=0,O=V,m|0}function Pb(A,u){return A=A|0,u=u|0,u=he(A|0,u|0,52)|0,N()|0,u&1|0}function Ei(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;if(m=he(A|0,u|0,52)|0,N()|0,m=m&15,!m)return m=0,m|0;for(g=1;;){if(f=he(A|0,u|0,(15-g|0)*3|0)|0,N()|0,f=f&7,f|0){g=5;break}if(g>>>0<m>>>0)g=g+1|0;else{f=0,g=5;break}}return(g|0)==5?f|0:0}function Au(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0;if(x=he(A|0,u|0,52)|0,N()|0,x=x&15,!x)return S=u,x=A,Qe(S|0),x|0;for(S=1,f=0;;){v=(15-S|0)*3|0,g=Ee(7,0,v|0)|0,m=N()|0,E=he(A|0,u|0,v|0)|0,N()|0,v=Ee(xr(E&7)|0,0,v|0)|0,E=N()|0,A=v|A&~g,u=E|u&~m;e:do if(!f)if((v&g|0)==0&(E&m|0)==0)f=0;else if(g=he(A|0,u|0,52)|0,N()|0,g=g&15,!g)f=1;else{f=1;t:for(;;){switch(E=he(A|0,u|0,(15-f|0)*3|0)|0,N()|0,E&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<g>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(E=(15-f|0)*3|0,m=he(A|0,u|0,E|0)|0,N()|0,v=Ee(7,0,E|0)|0,u=u&~(N()|0),E=Ee(xr(m&7)|0,0,E|0)|0,A=A&~v|E,u=u|(N()|0),f>>>0<g>>>0)f=f+1|0;else{f=1;break}}while(!1);if(S>>>0<x>>>0)S=S+1|0;else break}return Qe(u|0),A|0}function _r(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0;if(g=he(A|0,u|0,52)|0,N()|0,g=g&15,!g)return f=u,g=A,Qe(f|0),g|0;for(f=1;v=(15-f|0)*3|0,E=he(A|0,u|0,v|0)|0,N()|0,m=Ee(7,0,v|0)|0,u=u&~(N()|0),v=Ee(xr(E&7)|0,0,v|0)|0,A=v|A&~m,u=N()|0|u,f>>>0<g>>>0;)f=f+1|0;return Qe(u|0),A|0}function kb(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0;if(x=he(A|0,u|0,52)|0,N()|0,x=x&15,!x)return S=u,x=A,Qe(S|0),x|0;for(S=1,f=0;;){v=(15-S|0)*3|0,g=Ee(7,0,v|0)|0,m=N()|0,E=he(A|0,u|0,v|0)|0,N()|0,v=Ee(tr(E&7)|0,0,v|0)|0,E=N()|0,A=v|A&~g,u=E|u&~m;e:do if(!f)if((v&g|0)==0&(E&m|0)==0)f=0;else if(g=he(A|0,u|0,52)|0,N()|0,g=g&15,!g)f=1;else{f=1;t:for(;;){switch(E=he(A|0,u|0,(15-f|0)*3|0)|0,N()|0,E&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<g>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(m=(15-f|0)*3|0,v=Ee(7,0,m|0)|0,E=u&~(N()|0),u=he(A|0,u|0,m|0)|0,N()|0,u=Ee(tr(u&7)|0,0,m|0)|0,A=A&~v|u,u=E|(N()|0),f>>>0<g>>>0)f=f+1|0;else{f=1;break}}while(!1);if(S>>>0<x>>>0)S=S+1|0;else break}return Qe(u|0),A|0}function lu(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0;if(g=he(A|0,u|0,52)|0,N()|0,g=g&15,!g)return f=u,g=A,Qe(f|0),g|0;for(f=1;E=(15-f|0)*3|0,v=Ee(7,0,E|0)|0,m=u&~(N()|0),u=he(A|0,u|0,E|0)|0,N()|0,u=Ee(tr(u&7)|0,0,E|0)|0,A=u|A&~v,u=N()|0|m,f>>>0<g>>>0;)f=f+1|0;return Qe(u|0),A|0}function Mb(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(x=O,O=O+64|0,S=x+40|0,g=x+24|0,m=x+12|0,v=x,Ee(u|0,0,52)|0,f=N()|0|134225919,!u)return(l[A+4>>2]|0)>2||(l[A+8>>2]|0)>2||(l[A+12>>2]|0)>2?(E=0,S=0,Qe(E|0),O=x,S|0):(Ee(Nh(A)|0,0,45)|0,E=N()|0|f,S=-1,Qe(E|0),O=x,S|0);if(l[S>>2]=l[A>>2],l[S+4>>2]=l[A+4>>2],l[S+8>>2]=l[A+8>>2],l[S+12>>2]=l[A+12>>2],E=S+4|0,(u|0)>0)for(A=-1;l[g>>2]=l[E>>2],l[g+4>>2]=l[E+4>>2],l[g+8>>2]=l[E+8>>2],u&1?(fb(E),l[m>>2]=l[E>>2],l[m+4>>2]=l[E+4>>2],l[m+8>>2]=l[E+8>>2],La(m)):(Kh(E),l[m>>2]=l[E>>2],l[m+4>>2]=l[E+4>>2],l[m+8>>2]=l[E+8>>2],br(m)),tu(g,m,v),ri(v),D=(15-u|0)*3|0,I=Ee(7,0,D|0)|0,f=f&~(N()|0),D=Ee(Ia(v)|0,0,D|0)|0,A=D|A&~I,f=N()|0|f,(u|0)>1;)u=u+-1|0;else A=-1;e:do if((l[E>>2]|0)<=2&&(l[S+8>>2]|0)<=2&&(l[S+12>>2]|0)<=2){if(g=Nh(S)|0,u=Ee(g|0,0,45)|0,u=u|A,A=N()|0|f&-1040385,v=XS(S)|0,!(bt(g)|0)){if((v|0)<=0)break;for(m=0;;){if(g=he(u|0,A|0,52)|0,N()|0,g=g&15,g)for(f=1;D=(15-f|0)*3|0,S=he(u|0,A|0,D|0)|0,N()|0,I=Ee(7,0,D|0)|0,A=A&~(N()|0),D=Ee(xr(S&7)|0,0,D|0)|0,u=u&~I|D,A=A|(N()|0),f>>>0<g>>>0;)f=f+1|0;if(m=m+1|0,(m|0)==(v|0))break e}}m=he(u|0,A|0,52)|0,N()|0,m=m&15;t:do if(m){f=1;i:for(;;){switch(D=he(u|0,A|0,(15-f|0)*3|0)|0,N()|0,D&7){case 1:break i;case 0:break;default:break t}if(f>>>0<m>>>0)f=f+1|0;else break t}if(Uh(g,l[S>>2]|0)|0)for(f=1;S=(15-f|0)*3|0,I=Ee(7,0,S|0)|0,D=A&~(N()|0),A=he(u|0,A|0,S|0)|0,N()|0,A=Ee(tr(A&7)|0,0,S|0)|0,u=u&~I|A,A=D|(N()|0),f>>>0<m>>>0;)f=f+1|0;else for(f=1;D=(15-f|0)*3|0,S=he(u|0,A|0,D|0)|0,N()|0,I=Ee(7,0,D|0)|0,A=A&~(N()|0),D=Ee(xr(S&7)|0,0,D|0)|0,u=u&~I|D,A=A|(N()|0),f>>>0<m>>>0;)f=f+1|0}while(!1);if((v|0)>0){f=0;do u=Au(u,A)|0,A=N()|0,f=f+1|0;while((f|0)!=(v|0))}}else u=0,A=0;while(!1);return I=A,D=u,Qe(I|0),O=x,D|0}function Ki(A){return A=A|0,(A|0)%2|0|0}function uu(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0;return m=O,O=O+16|0,g=m,u>>>0>15?(g=4,O=m,g|0):(l[A+4>>2]&2146435072|0)==2146435072||(l[A+8+4>>2]&2146435072|0)==2146435072?(g=3,O=m,g|0):(Sb(A,u,g),u=Mb(g,u)|0,g=N()|0,l[f>>2]=u,l[f+4>>2]=g,(u|0)==0&(g|0)==0&&Ne(27795,27122,959,27145),g=0,O=m,g|0)}function fu(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;if(m=f+4|0,v=he(A|0,u|0,52)|0,N()|0,v=v&15,E=he(A|0,u|0,45)|0,N()|0,g=(v|0)==0,bt(E&127)|0){if(g)return E=1,E|0;g=1}else{if(g)return E=0,E|0;(l[m>>2]|0)==0&&(l[f+8>>2]|0)==0?g=(l[f+12>>2]|0)!=0&1:g=1}for(f=1;f&1?La(m):br(m),E=he(A|0,u|0,(15-f|0)*3|0)|0,N()|0,Qh(m,E&7),f>>>0<v>>>0;)f=f+1|0;return g|0}function Jr(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(D=O,O=O+16|0,x=D,I=he(A|0,u|0,45)|0,N()|0,I=I&127,I>>>0>121)return l[f>>2]=0,l[f+4>>2]=0,l[f+8>>2]=0,l[f+12>>2]=0,I=5,O=D,I|0;e:do if((bt(I)|0)!=0&&(v=he(A|0,u|0,52)|0,N()|0,v=v&15,(v|0)!=0)){g=1;t:for(;;){switch(S=he(A|0,u|0,(15-g|0)*3|0)|0,N()|0,S&7){case 5:break t;case 0:break;default:{g=u;break e}}if(g>>>0<v>>>0)g=g+1|0;else{g=u;break e}}for(m=1,g=u;u=(15-m|0)*3|0,E=Ee(7,0,u|0)|0,S=g&~(N()|0),g=he(A|0,g|0,u|0)|0,N()|0,g=Ee(tr(g&7)|0,0,u|0)|0,A=A&~E|g,g=S|(N()|0),m>>>0<v>>>0;)m=m+1|0}else g=u;while(!1);if(S=7696+(I*28|0)|0,l[f>>2]=l[S>>2],l[f+4>>2]=l[S+4>>2],l[f+8>>2]=l[S+8>>2],l[f+12>>2]=l[S+12>>2],!(fu(A,g,f)|0))return I=0,O=D,I|0;if(E=f+4|0,l[x>>2]=l[E>>2],l[x+4>>2]=l[E+4>>2],l[x+8>>2]=l[E+8>>2],v=he(A|0,g|0,52)|0,N()|0,S=v&15,v&1?(br(E),v=S+1|0):v=S,!(bt(I)|0))g=0;else{e:do if(!S)g=0;else for(u=1;;){if(m=he(A|0,g|0,(15-u|0)*3|0)|0,N()|0,m=m&7,m|0){g=m;break e}if(u>>>0<S>>>0)u=u+1|0;else{g=0;break}}while(!1);g=(g|0)==4&1}if(!(Zr(f,v,g,0)|0))(v|0)!=(S|0)&&(l[E>>2]=l[x>>2],l[E+4>>2]=l[x+4>>2],l[E+8>>2]=l[x+8>>2]);else{if(bt(I)|0)do;while((Zr(f,v,0,0)|0)!=0);(v|0)!=(S|0)&&Kh(E)}return I=0,O=D,I|0}function wr(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;return v=O,O=O+16|0,g=v,m=Jr(A,u,g)|0,m|0?(O=v,m|0):(m=he(A|0,u|0,52)|0,N()|0,_b(g,m&15,f),m=0,O=v,m|0)}function es(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0;if(E=O,O=O+16|0,v=E,g=Jr(A,u,v)|0,g|0)return v=g,O=E,v|0;g=he(A|0,u|0,45)|0,N()|0,g=(bt(g&127)|0)==0,m=he(A|0,u|0,52)|0,N()|0,m=m&15;e:do if(!g){if(m|0)for(g=1;;){if(S=Ee(7,0,(15-g|0)*3|0)|0,!((S&A|0)==0&((N()|0)&u|0)==0))break e;if(g>>>0<m>>>0)g=g+1|0;else break}return nu(v,m,0,5,f),S=0,O=E,S|0}while(!1);return ru(v,m,0,6,f),S=0,O=E,S|0}function Ob(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;if(m=he(A|0,u|0,45)|0,N()|0,!(bt(m&127)|0))return m=2,l[f>>2]=m,0;if(m=he(A|0,u|0,52)|0,N()|0,m=m&15,!m)return m=5,l[f>>2]=m,0;for(g=1;;){if(v=Ee(7,0,(15-g|0)*3|0)|0,!((v&A|0)==0&((N()|0)&u|0)==0)){g=2,A=6;break}if(g>>>0<m>>>0)g=g+1|0;else{g=5,A=6;break}}return(A|0)==6&&(l[f>>2]=g),0}function id(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0;B=O,O=O+128|0,I=B+112|0,v=B+96|0,D=B,m=he(A|0,u|0,52)|0,N()|0,S=m&15,l[I>>2]=S,E=he(A|0,u|0,45)|0,N()|0,E=E&127;e:do if(bt(E)|0){if(S|0)for(g=1;;){if(x=Ee(7,0,(15-g|0)*3|0)|0,!((x&A|0)==0&((N()|0)&u|0)==0)){m=0;break e}if(g>>>0<S>>>0)g=g+1|0;else break}if(m&1)m=1;else return x=Ee(S+1|0,0,52)|0,D=N()|0|u&-15728641,I=Ee(7,0,(14-S|0)*3|0)|0,D=id((x|A)&~I,D&~(N()|0),f)|0,O=B,D|0}else m=0;while(!1);if(g=Jr(A,u,v)|0,!g){m?(Xh(v,I,D),x=5):(Zh(v,I,D),x=6);e:do if(bt(E)|0)if(!S)A=5;else for(g=1;;){if(E=Ee(7,0,(15-g|0)*3|0)|0,!((E&A|0)==0&((N()|0)&u|0)==0)){A=2;break e}if(g>>>0<S>>>0)g=g+1|0;else{A=5;break}}else A=2;while(!1);sr(f|0,-1,A<<2|0)|0;e:do if(m)for(v=0;;){if(E=D+(v<<4)|0,wb(E,l[I>>2]|0)|0,E=l[E>>2]|0,S=l[f>>2]|0,(S|0)==-1|(S|0)==(E|0))g=f;else{m=0;do{if(m=m+1|0,m>>>0>=A>>>0){g=1;break e}g=f+(m<<2)|0,S=l[g>>2]|0}while(!((S|0)==-1|(S|0)==(E|0)))}if(l[g>>2]=E,v=v+1|0,v>>>0>=x>>>0){g=0;break}}else for(v=0;;){if(E=D+(v<<4)|0,Zr(E,l[I>>2]|0,0,1)|0,E=l[E>>2]|0,S=l[f>>2]|0,(S|0)==-1|(S|0)==(E|0))g=f;else{m=0;do{if(m=m+1|0,m>>>0>=A>>>0){g=1;break e}g=f+(m<<2)|0,S=l[g>>2]|0}while(!((S|0)==-1|(S|0)==(E|0)))}if(l[g>>2]=E,v=v+1|0,v>>>0>=x>>>0){g=0;break}}while(!1)}return D=g,O=B,D|0}function Fb(){return 12}function cu(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0;if(A>>>0>15)return S=4,S|0;if(Ee(A|0,0,52)|0,S=N()|0|134225919,!A){f=0,g=0;do bt(g)|0&&(Ee(g|0,0,45)|0,E=S|(N()|0),A=u+(f<<3)|0,l[A>>2]=-1,l[A+4>>2]=E,f=f+1|0),g=g+1|0;while((g|0)!=122);return f=0,f|0}f=0,E=0;do{if(bt(E)|0){for(Ee(E|0,0,45)|0,g=1,m=-1,v=S|(N()|0);x=Ee(7,0,(15-g|0)*3|0)|0,m=m&~x,v=v&~(N()|0),(g|0)!=(A|0);)g=g+1|0;x=u+(f<<3)|0,l[x>>2]=m,l[x+4>>2]=v,f=f+1|0}E=E+1|0}while((E|0)!=122);return f=0,f|0}function Bb(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0;if(ie=O,O=O+16|0,Z=ie,ae=he(A|0,u|0,52)|0,N()|0,ae=ae&15,f>>>0>15)return ae=4,O=ie,ae|0;if((ae|0)<(f|0))return ae=12,O=ie,ae|0;if((ae|0)!=(f|0))if(v=Ee(f|0,0,52)|0,v=v|A,S=N()|0|u&-15728641,(ae|0)>(f|0)){x=f;do z=Ee(7,0,(14-x|0)*3|0)|0,x=x+1|0,v=z|v,S=N()|0|S;while((x|0)<(ae|0));z=v}else z=v;else z=A,S=u;j=he(z|0,S|0,45)|0,N()|0;e:do if(bt(j&127)|0){if(x=he(z|0,S|0,52)|0,N()|0,x=x&15,x|0)for(v=1;;){if(j=Ee(7,0,(15-v|0)*3|0)|0,!((j&z|0)==0&((N()|0)&S|0)==0)){I=33;break e}if(v>>>0<x>>>0)v=v+1|0;else break}if(j=g,l[j>>2]=0,l[j+4>>2]=0,(ae|0)>(f|0)){for(j=u&-15728641,H=ae;;){if(V=H,H=H+-1|0,H>>>0>15|(ae|0)<(H|0)){I=19;break}if((ae|0)!=(H|0))if(v=Ee(H|0,0,52)|0,v=v|A,x=N()|0|j,(ae|0)<(V|0))B=v;else{I=H;do B=Ee(7,0,(14-I|0)*3|0)|0,I=I+1|0,v=B|v,x=N()|0|x;while((I|0)<(ae|0));B=v}else B=A,x=u;if(D=he(B|0,x|0,45)|0,N()|0,!(bt(D&127)|0))v=0;else{D=he(B|0,x|0,52)|0,N()|0,D=D&15;t:do if(!D)v=0;else for(I=1;;){if(v=he(B|0,x|0,(15-I|0)*3|0)|0,N()|0,v=v&7,v|0)break t;if(I>>>0<D>>>0)I=I+1|0;else{v=0;break}}while(!1);v=(v|0)==0&1}if(x=he(A|0,u|0,(15-V|0)*3|0)|0,N()|0,x=x&7,(x|0)==7){m=5,I=42;break}if(v=(v|0)!=0,(x|0)==1&v){m=5,I=42;break}if(B=x+(((x|0)!=0&v)<<31>>31)|0,B|0&&(I=ae-V|0,I=ir(7,0,I,((I|0)<0)<<31>>31)|0,D=N()|0,v?(v=qt(I|0,D|0,5,0)|0,v=Ce(v|0,N()|0,-5,-1)|0,v=rr(v|0,N()|0,6,0)|0,v=Ce(v|0,N()|0,1,0)|0,x=N()|0):(v=I,x=D),V=B+-1|0,V=qt(I|0,D|0,V|0,((V|0)<0)<<31>>31|0)|0,V=Ce(v|0,x|0,V|0,N()|0)|0,B=N()|0,D=g,D=Ce(V|0,B|0,l[D>>2]|0,l[D+4>>2]|0)|0,B=N()|0,V=g,l[V>>2]=D,l[V+4>>2]=B),(H|0)<=(f|0)){I=37;break}}if((I|0)==19)Ne(27795,27122,1276,27158);else if((I|0)==37){E=g,m=l[E+4>>2]|0,E=l[E>>2]|0;break}else if((I|0)==42)return O=ie,m|0}else m=0,E=0}else I=33;while(!1);e:do if((I|0)==33)if(j=g,l[j>>2]=0,l[j+4>>2]=0,(ae|0)>(f|0)){for(v=ae;;){if(m=he(A|0,u|0,(15-v|0)*3|0)|0,N()|0,m=m&7,(m|0)==7){m=5;break}if(E=ae-v|0,E=ir(7,0,E,((E|0)<0)<<31>>31)|0,m=qt(E|0,N()|0,m|0,0)|0,E=N()|0,j=g,E=Ce(l[j>>2]|0,l[j+4>>2]|0,m|0,E|0)|0,m=N()|0,j=g,l[j>>2]=E,l[j+4>>2]=m,v=v+-1|0,(v|0)<=(f|0))break e}return O=ie,m|0}else m=0,E=0;while(!1);return to(z,S,ae,Z)|0&&Ne(27795,27122,1236,27173),ae=Z,Z=l[ae+4>>2]|0,((m|0)>-1|(m|0)==-1&E>>>0>4294967295)&((Z|0)>(m|0)|((Z|0)==(m|0)?(l[ae>>2]|0)>>>0>E>>>0:0))?(ae=0,O=ie,ae|0):(Ne(27795,27122,1316,27158),0)}function Nb(A,u,f,g,m,v){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0;var E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0;if(B=O,O=O+16|0,E=B,m>>>0>15)return v=4,O=B,v|0;if(S=he(f|0,g|0,52)|0,N()|0,S=S&15,(S|0)>(m|0))return v=12,O=B,v|0;if(to(f,g,m,E)|0&&Ne(27795,27122,1236,27173),D=E,I=l[D+4>>2]|0,!(((u|0)>-1|(u|0)==-1&A>>>0>4294967295)&((I|0)>(u|0)|((I|0)==(u|0)?(l[D>>2]|0)>>>0>A>>>0:0))))return v=2,O=B,v|0;D=m-S|0,m=Ee(m|0,0,52)|0,x=N()|0|g&-15728641,I=v,l[I>>2]=m|f,l[I+4>>2]=x,I=he(f|0,g|0,45)|0,N()|0;e:do if(bt(I&127)|0){if(S|0)for(E=1;;){if(I=Ee(7,0,(15-E|0)*3|0)|0,!((I&f|0)==0&((N()|0)&g|0)==0))break e;if(E>>>0<S>>>0)E=E+1|0;else break}if((D|0)<1)return v=0,O=B,v|0;for(I=S^15,g=-1,x=1,E=1;;){S=D-x|0,S=ir(7,0,S,((S|0)<0)<<31>>31)|0,f=N()|0;do if(E)if(E=qt(S|0,f|0,5,0)|0,E=Ce(E|0,N()|0,-5,-1)|0,E=rr(E|0,N()|0,6,0)|0,m=N()|0,(u|0)>(m|0)|(u|0)==(m|0)&A>>>0>E>>>0){u=Ce(A|0,u|0,-1,-1)|0,u=Jt(u|0,N()|0,E|0,m|0)|0,E=N()|0,V=v,j=l[V>>2]|0,V=l[V+4>>2]|0,z=(I+g|0)*3|0,H=Ee(7,0,z|0)|0,V=V&~(N()|0),g=rr(u|0,E|0,S|0,f|0)|0,A=N()|0,m=Ce(g|0,A|0,2,0)|0,z=Ee(m|0,N()|0,z|0)|0,V=N()|0|V,m=v,l[m>>2]=z|j&~H,l[m+4>>2]=V,A=qt(g|0,A|0,S|0,f|0)|0,A=Jt(u|0,E|0,A|0,N()|0)|0,E=0,u=N()|0;break}else{z=v,H=l[z>>2]|0,z=l[z+4>>2]|0,j=Ee(7,0,(I+g|0)*3|0)|0,z=z&~(N()|0),E=v,l[E>>2]=H&~j,l[E+4>>2]=z,E=1;break}else H=v,m=l[H>>2]|0,H=l[H+4>>2]|0,g=(I+g|0)*3|0,V=Ee(7,0,g|0)|0,H=H&~(N()|0),z=rr(A|0,u|0,S|0,f|0)|0,E=N()|0,g=Ee(z|0,E|0,g|0)|0,H=N()|0|H,j=v,l[j>>2]=g|m&~V,l[j+4>>2]=H,E=qt(z|0,E|0,S|0,f|0)|0,A=Jt(A|0,u|0,E|0,N()|0)|0,E=0,u=N()|0;while(!1);if((D|0)>(x|0))g=~x,x=x+1|0;else{u=0;break}}return O=B,u|0}while(!1);if((D|0)<1)return z=0,O=B,z|0;for(m=S^15,E=1;;)if(j=D-E|0,j=ir(7,0,j,((j|0)<0)<<31>>31)|0,z=N()|0,x=v,f=l[x>>2]|0,x=l[x+4>>2]|0,S=(m-E|0)*3|0,g=Ee(7,0,S|0)|0,x=x&~(N()|0),V=rr(A|0,u|0,j|0,z|0)|0,H=N()|0,S=Ee(V|0,H|0,S|0)|0,x=N()|0|x,I=v,l[I>>2]=S|f&~g,l[I+4>>2]=x,z=qt(V|0,H|0,j|0,z|0)|0,A=Jt(A|0,u|0,z|0,N()|0)|0,u=N()|0,(D|0)<=(E|0)){u=0;break}else E=E+1|0;return O=B,u|0}function hu(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0;m=he(u|0,f|0,52)|0,N()|0,m=m&15,(u|0)==0&(f|0)==0|((g|0)>15|(m|0)>(g|0))?(v=-1,u=-1,f=0,m=0):(u=ed(u,f,m+1|0,g)|0,E=(N()|0)&-15728641,f=Ee(g|0,0,52)|0,f=u|f,E=E|(N()|0),u=(mt(f,E)|0)==0,v=m,u=u?-1:g,m=E),E=A,l[E>>2]=f,l[E+4>>2]=m,l[A+8>>2]=v,l[A+12>>2]=u}function nd(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0;if(m=he(A|0,u|0,52)|0,N()|0,m=m&15,v=g+8|0,l[v>>2]=m,(A|0)==0&(u|0)==0|((f|0)>15|(m|0)>(f|0))){f=g,l[f>>2]=0,l[f+4>>2]=0,l[v>>2]=-1,l[g+12>>2]=-1;return}if(A=ed(A,u,m+1|0,f)|0,v=(N()|0)&-15728641,m=Ee(f|0,0,52)|0,m=A|m,v=v|(N()|0),A=g,l[A>>2]=m,l[A+4>>2]=v,A=g+12|0,mt(m,v)|0){l[A>>2]=f;return}else{l[A>>2]=-1;return}}function du(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0;if(f=A,u=l[f>>2]|0,f=l[f+4>>2]|0,!((u|0)==0&(f|0)==0)&&(g=he(u|0,f|0,52)|0,N()|0,g=g&15,S=Ee(1,0,(g^15)*3|0)|0,u=Ce(S|0,N()|0,u|0,f|0)|0,f=N()|0,S=A,l[S>>2]=u,l[S+4>>2]=f,S=A+8|0,E=l[S>>2]|0,!((g|0)<(E|0)))){for(x=A+12|0,v=g;;){if((v|0)==(E|0)){g=5;break}if(I=(v|0)==(l[x>>2]|0),m=(15-v|0)*3|0,g=he(u|0,f|0,m|0)|0,N()|0,g=g&7,I&((g|0)==1&!0)){g=7;break}if(!((g|0)==7&!0)){g=10;break}if(I=Ee(1,0,m|0)|0,u=Ce(u|0,f|0,I|0,N()|0)|0,f=N()|0,I=A,l[I>>2]=u,l[I+4>>2]=f,(v|0)>(E|0))v=v+-1|0;else{g=10;break}}if((g|0)==5){I=A,l[I>>2]=0,l[I+4>>2]=0,l[S>>2]=-1,l[x>>2]=-1;return}else if((g|0)==7){E=Ee(1,0,m|0)|0,E=Ce(u|0,f|0,E|0,N()|0)|0,S=N()|0,I=A,l[I>>2]=E,l[I+4>>2]=S,l[x>>2]=v+-1;return}else if((g|0)==10)return}}function io(A){A=+A;var u=0;return u=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?u+-6.283185307179586:u)}function ts(A,u){return A=A|0,u=u|0,+et(+(+M[A>>3]-+M[u>>3]))<17453292519943298e-27?(u=+et(+(+M[A+8>>3]-+M[u+8>>3]))<17453292519943298e-27,u|0):(u=0,u|0)}function ki(A,u){switch(A=+A,u=u|0,u|0){case 1:{A=A<0?A+6.283185307179586:A;break}case 2:{A=A>0?A+-6.283185307179586:A;break}}return+A}function Ub(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;return m=+M[u>>3],g=+M[A>>3],v=+tt(+((m-g)*.5)),f=+tt(+((+M[u+8>>3]-+M[A+8>>3])*.5)),f=v*v+f*(+ct(+m)*+ct(+g)*f),+(+ji(+ +ut(+f),+ +ut(+(1-f)))*2)}function no(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;return m=+M[u>>3],g=+M[A>>3],v=+tt(+((m-g)*.5)),f=+tt(+((+M[u+8>>3]-+M[A+8>>3])*.5)),f=v*v+f*(+ct(+m)*+ct(+g)*f),+(+ji(+ +ut(+f),+ +ut(+(1-f)))*2*6371.007180918475)}function $b(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;return m=+M[u>>3],g=+M[A>>3],v=+tt(+((m-g)*.5)),f=+tt(+((+M[u+8>>3]-+M[A+8>>3])*.5)),f=v*v+f*(+ct(+m)*+ct(+g)*f),+(+ji(+ +ut(+f),+ +ut(+(1-f)))*2*6371.007180918475*1e3)}function Gb(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0;return v=+M[u>>3],g=+ct(+v),m=+M[u+8>>3]-+M[A+8>>3],E=g*+tt(+m),f=+M[A>>3],+ +ji(+E,+(+tt(+v)*+ct(+f)-+ct(+m)*(g*+tt(+f))))}function Vb(A,u,f,g){A=A|0,u=+u,f=+f,g=g|0;var m=0,v=0,E=0,S=0;if(f<1e-16){l[g>>2]=l[A>>2],l[g+4>>2]=l[A+4>>2],l[g+8>>2]=l[A+8>>2],l[g+12>>2]=l[A+12>>2];return}v=u<0?u+6.283185307179586:u,v=u>=6.283185307179586?v+-6.283185307179586:v;do if(v<1e-16)u=+M[A>>3]+f,M[g>>3]=u,m=g;else{if(m=+et(+(v+-3.141592653589793))<1e-16,u=+M[A>>3],m){u=u-f,M[g>>3]=u,m=g;break}if(E=+ct(+f),f=+tt(+f),u=E*+tt(+u)+ +ct(+v)*(f*+ct(+u)),u=u>1?1:u,u=+kS(+(u<-1?-1:u)),M[g>>3]=u,+et(+(u+-1.5707963267948966))<1e-16){M[g>>3]=1.5707963267948966,M[g+8>>3]=0;return}if(+et(+(u+1.5707963267948966))<1e-16){M[g>>3]=-1.5707963267948966,M[g+8>>3]=0;return}if(S=1/+ct(+u),v=f*+tt(+v)*S,f=+M[A>>3],u=S*((E-+tt(+u)*+tt(+f))/+ct(+f)),E=v>1?1:v,u=u>1?1:u,u=+M[A+8>>3]+ +ji(+(E<-1?-1:E),+(u<-1?-1:u)),u>3.141592653589793)do u=u+-6.283185307179586;while(u>3.141592653589793);if(u<-3.141592653589793)do u=u+6.283185307179586;while(u<-3.141592653589793);M[g+8>>3]=u;return}while(!1);if(+et(+(u+-1.5707963267948966))<1e-16){M[m>>3]=1.5707963267948966,M[g+8>>3]=0;return}if(+et(+(u+1.5707963267948966))<1e-16){M[m>>3]=-1.5707963267948966,M[g+8>>3]=0;return}if(u=+M[A+8>>3],u>3.141592653589793)do u=u+-6.283185307179586;while(u>3.141592653589793);if(u<-3.141592653589793)do u=u+6.283185307179586;while(u<-3.141592653589793);M[g+8>>3]=u}function rd(A,u){return A=A|0,u=u|0,A>>>0>15?(u=4,u|0):(M[u>>3]=+M[20656+(A<<3)>>3],u=0,u|0)}function Hb(A,u){return A=A|0,u=u|0,A>>>0>15?(u=4,u|0):(M[u>>3]=+M[20784+(A<<3)>>3],u=0,u|0)}function jb(A,u){return A=A|0,u=u|0,A>>>0>15?(u=4,u|0):(M[u>>3]=+M[20912+(A<<3)>>3],u=0,u|0)}function Kb(A,u){return A=A|0,u=u|0,A>>>0>15?(u=4,u|0):(M[u>>3]=+M[21040+(A<<3)>>3],u=0,u|0)}function Ca(A,u){A=A|0,u=u|0;var f=0;return A>>>0>15?(u=4,u|0):(f=ir(7,0,A,((A|0)<0)<<31>>31)|0,f=qt(f|0,N()|0,120,0)|0,A=N()|0,l[u>>2]=f|2,l[u+4>>2]=A,u=0,u|0)}function sd(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;return V=+M[u>>3],D=+M[A>>3],x=+tt(+((V-D)*.5)),v=+M[u+8>>3],I=+M[A+8>>3],E=+tt(+((v-I)*.5)),S=+ct(+D),B=+ct(+V),E=x*x+E*(B*S*E),E=+ji(+ +ut(+E),+ +ut(+(1-E)))*2,x=+M[f>>3],V=+tt(+((x-V)*.5)),g=+M[f+8>>3],v=+tt(+((g-v)*.5)),m=+ct(+x),v=V*V+v*(B*m*v),v=+ji(+ +ut(+v),+ +ut(+(1-v)))*2,x=+tt(+((D-x)*.5)),g=+tt(+((I-g)*.5)),g=x*x+g*(S*m*g),g=+ji(+ +ut(+g),+ +ut(+(1-g)))*2,m=(E+v+g)*.5,+(+Wl(+ +ut(+(+Hi(+(m*.5))*+Hi(+((m-E)*.5))*+Hi(+((m-v)*.5))*+Hi(+((m-g)*.5)))))*4)}function gu(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0;if(S=O,O=O+192|0,v=S+168|0,E=S,m=wr(A,u,v)|0,m|0)return f=m,O=S,f|0;if(es(A,u,E)|0&&Ne(27795,27190,415,27199),u=l[E>>2]|0,(u|0)>0){if(g=+sd(E+8|0,E+8+(((u|0)!=1&1)<<4)|0,v)+0,(u|0)!=1){A=1;do m=A,A=A+1|0,g=g+ +sd(E+8+(m<<4)|0,E+8+(((A|0)%(u|0)|0)<<4)|0,v);while((A|0)<(u|0))}}else g=0;return M[f>>3]=g,f=0,O=S,f|0}function Qb(A,u,f){return A=A|0,u=u|0,f=f|0,A=gu(A,u,f)|0,A|0||(M[f>>3]=+M[f>>3]*6371.007180918475*6371.007180918475),A|0}function Wb(A,u,f){return A=A|0,u=u|0,f=f|0,A=gu(A,u,f)|0,A|0||(M[f>>3]=+M[f>>3]*6371.007180918475*6371.007180918475*1e3*1e3),A|0}function Yb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(S=O,O=O+176|0,E=S,A=Da(A,u,E)|0,A|0)return E=A,O=S,E|0;if(M[f>>3]=0,A=l[E>>2]|0,(A|0)<=1)return E=0,O=S,E|0;u=A+-1|0,A=0,g=+M[E+8>>3],m=+M[E+16>>3],v=0;do A=A+1|0,I=g,g=+M[E+8+(A<<4)>>3],D=+tt(+((g-I)*.5)),x=m,m=+M[E+8+(A<<4)+8>>3],x=+tt(+((m-x)*.5)),x=D*D+x*(+ct(+g)*+ct(+I)*x),v=v+ +ji(+ +ut(+x),+ +ut(+(1-x)))*2;while((A|0)<(u|0));return M[f>>3]=v,E=0,O=S,E|0}function zb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(S=O,O=O+176|0,E=S,A=Da(A,u,E)|0,A|0)return E=A,v=+M[f>>3],v=v*6371.007180918475,M[f>>3]=v,O=S,E|0;if(M[f>>3]=0,A=l[E>>2]|0,(A|0)<=1)return E=0,v=0,v=v*6371.007180918475,M[f>>3]=v,O=S,E|0;u=A+-1|0,A=0,g=+M[E+8>>3],m=+M[E+16>>3],v=0;do A=A+1|0,I=g,g=+M[E+8+(A<<4)>>3],D=+tt(+((g-I)*.5)),x=m,m=+M[E+8+(A<<4)+8>>3],x=+tt(+((m-x)*.5)),x=D*D+x*(+ct(+I)*+ct(+g)*x),v=v+ +ji(+ +ut(+x),+ +ut(+(1-x)))*2;while((A|0)!=(u|0));return M[f>>3]=v,E=0,D=v,D=D*6371.007180918475,M[f>>3]=D,O=S,E|0}function qb(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(S=O,O=O+176|0,E=S,A=Da(A,u,E)|0,A|0)return E=A,v=+M[f>>3],v=v*6371.007180918475,v=v*1e3,M[f>>3]=v,O=S,E|0;if(M[f>>3]=0,A=l[E>>2]|0,(A|0)<=1)return E=0,v=0,v=v*6371.007180918475,v=v*1e3,M[f>>3]=v,O=S,E|0;u=A+-1|0,A=0,g=+M[E+8>>3],m=+M[E+16>>3],v=0;do A=A+1|0,I=g,g=+M[E+8+(A<<4)>>3],D=+tt(+((g-I)*.5)),x=m,m=+M[E+8+(A<<4)+8>>3],x=+tt(+((m-x)*.5)),x=D*D+x*(+ct(+I)*+ct(+g)*x),v=v+ +ji(+ +ut(+x),+ +ut(+(1-x)))*2;while((A|0)!=(u|0));return M[f>>3]=v,E=0,D=v,D=D*6371.007180918475,D=D*1e3,M[f>>3]=D,O=S,E|0}function Xb(A){A=A|0;var u=0,f=0,g=0;return u=Ti(1,12)|0,u||Ne(27280,27235,49,27293),f=A+4|0,g=l[f>>2]|0,g|0?(g=g+8|0,l[g>>2]=u,l[f>>2]=u,u|0):(l[A>>2]|0&&Ne(27310,27235,61,27333),g=A,l[g>>2]=u,l[f>>2]=u,u|0)}function Zb(A,u){A=A|0,u=u|0;var f=0,g=0;return g=mn(24)|0,g||Ne(27347,27235,78,27361),l[g>>2]=l[u>>2],l[g+4>>2]=l[u+4>>2],l[g+8>>2]=l[u+8>>2],l[g+12>>2]=l[u+12>>2],l[g+16>>2]=0,u=A+4|0,f=l[u>>2]|0,f|0?(l[f+16>>2]=g,l[u>>2]=g,g|0):(l[A>>2]|0&&Ne(27376,27235,82,27361),l[A>>2]=g,l[u>>2]=g,g|0)}function od(A){A=A|0;var u=0,f=0,g=0,m=0;if(A)for(g=1;;){if(u=l[A>>2]|0,u|0)do{if(f=l[u>>2]|0,f|0)do m=f,f=l[f+16>>2]|0,Pe(m);while((f|0)!=0);m=u,u=l[u+8>>2]|0,Pe(m)}while((u|0)!=0);if(u=A,A=l[A+8>>2]|0,g||Pe(u),A)g=0;else break}}function Jb(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0,We=0,it=0,Be=0,Le=0,ye=0,Je=0,dt=0,qe=0;if(m=A+8|0,l[m>>2]|0)return qe=1,qe|0;if(g=l[A>>2]|0,!g)return qe=0,qe|0;u=g,f=0;do f=f+1|0,u=l[u+8>>2]|0;while((u|0)!=0);if(f>>>0<2)return qe=0,qe|0;Je=mn(f<<2)|0,Je||Ne(27396,27235,317,27415),ye=mn(f<<5)|0,ye||Ne(27437,27235,321,27415),l[A>>2]=0,Ie=A+4|0,l[Ie>>2]=0,l[m>>2]=0,f=0,Le=0,ve=0,B=0;e:for(;;){if(D=l[g>>2]|0,D){v=0,E=D;do{if(x=+M[E+8>>3],u=E,E=l[E+16>>2]|0,I=(E|0)==0,m=I?D:E,S=+M[m+8>>3],+et(+(x-S))>3.141592653589793){qe=14;break}v=v+(S-x)*(+M[u>>3]+ +M[m>>3])}while(!I);if((qe|0)==14){qe=0,v=0,u=D;do q=+M[u+8>>3],Be=u+16|0,it=l[Be>>2]|0,it=(it|0)==0?D:it,J=+M[it+8>>3],v=v+(+M[u>>3]+ +M[it>>3])*((J<0?J+6.283185307179586:J)-(q<0?q+6.283185307179586:q)),u=l[((u|0)==0?g:Be)>>2]|0;while((u|0)!=0)}v>0?(l[Je+(Le<<2)>>2]=g,Le=Le+1|0,m=ve,u=B):qe=19}else qe=19;if((qe|0)==19){qe=0;do if(f){if(u=f+8|0,l[u>>2]|0){qe=21;break e}if(f=Ti(1,12)|0,!f){qe=23;break e}l[u>>2]=f,m=f+4|0,E=f,u=B}else if(B){m=Ie,E=B+8|0,u=g,f=A;break}else if(l[A>>2]|0){qe=27;break e}else{m=Ie,E=A,u=g,f=A;break}while(!1);if(l[E>>2]=g,l[m>>2]=g,E=ye+(ve<<5)|0,I=l[g>>2]|0,I){for(D=ye+(ve<<5)+8|0,M[D>>3]=17976931348623157e292,B=ye+(ve<<5)+24|0,M[B>>3]=17976931348623157e292,M[E>>3]=-17976931348623157e292,V=ye+(ve<<5)+16|0,M[V>>3]=-17976931348623157e292,ae=17976931348623157e292,ie=-17976931348623157e292,m=0,H=I,x=17976931348623157e292,z=17976931348623157e292,Z=-17976931348623157e292,S=-17976931348623157e292;v=+M[H>>3],q=+M[H+8>>3],H=l[H+16>>2]|0,j=(H|0)==0,J=+M[(j?I:H)+8>>3],v<x&&(M[D>>3]=v,x=v),q<z&&(M[B>>3]=q,z=q),v>Z?M[E>>3]=v:v=Z,q>S&&(M[V>>3]=q,S=q),ae=q>0&q<ae?q:ae,ie=q<0&q>ie?q:ie,m=m|+et(+(q-J))>3.141592653589793,!j;)Z=v;m&&(M[V>>3]=ie,M[B>>3]=ae)}else l[E>>2]=0,l[E+4>>2]=0,l[E+8>>2]=0,l[E+12>>2]=0,l[E+16>>2]=0,l[E+20>>2]=0,l[E+24>>2]=0,l[E+28>>2]=0;m=ve+1|0}if(Be=g+8|0,g=l[Be>>2]|0,l[Be>>2]=0,g)ve=m,B=u;else{qe=45;break}}if((qe|0)==21)Ne(27213,27235,35,27247);else if((qe|0)==23)Ne(27267,27235,37,27247);else if((qe|0)==27)Ne(27310,27235,61,27333);else if((qe|0)==45){e:do if((Le|0)>0){for(Be=(m|0)==0,We=m<<2,it=(A|0)==0,je=0,u=0;;){if(xe=l[Je+(je<<2)>>2]|0,Be)qe=73;else{if(ve=mn(We)|0,!ve){qe=50;break}if(Ie=mn(We)|0,!Ie){qe=52;break}t:do if(it)f=0;else{for(m=0,f=0,E=A;g=ye+(m<<5)|0,ad(l[E>>2]|0,g,l[xe>>2]|0)|0?(l[ve+(f<<2)>>2]=E,l[Ie+(f<<2)>>2]=g,j=f+1|0):j=f,E=l[E+8>>2]|0,E;)m=m+1|0,f=j;if((j|0)>0)if(g=l[ve>>2]|0,(j|0)==1)f=g;else for(V=0,H=-1,f=g,B=g;;){for(I=l[B>>2]|0,g=0,E=0;m=l[l[ve+(E<<2)>>2]>>2]|0,(m|0)==(I|0)?D=g:D=g+((ad(m,l[Ie+(E<<2)>>2]|0,l[I>>2]|0)|0)&1)|0,E=E+1|0,(E|0)!=(j|0);)g=D;if(m=(D|0)>(H|0),f=m?B:f,g=V+1|0,(g|0)==(j|0))break t;V=g,H=m?D:H,B=l[ve+(g<<2)>>2]|0}else f=0}while(!1);if(Pe(ve),Pe(Ie),f){if(m=f+4|0,g=l[m>>2]|0,g)f=g+8|0;else if(l[f>>2]|0){qe=70;break}l[f>>2]=xe,l[m>>2]=xe}else qe=73}if((qe|0)==73){if(qe=0,u=l[xe>>2]|0,u|0)do Ie=u,u=l[u+16>>2]|0,Pe(Ie);while((u|0)!=0);Pe(xe),u=1}if(je=je+1|0,(je|0)>=(Le|0)){dt=u;break e}}(qe|0)==50?Ne(27452,27235,249,27471):(qe|0)==52?Ne(27490,27235,252,27471):(qe|0)==70&&Ne(27310,27235,61,27333)}else dt=0;while(!1);return Pe(Je),Pe(ye),qe=dt,qe|0}return 0}function ad(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(!(Jl(u,f)|0)||(u=$h(u)|0,g=+M[f>>3],m=+M[f+8>>3],m=u&m<0?m+6.283185307179586:m,A=l[A>>2]|0,!A))return A=0,A|0;if(u){u=0,I=m,f=A;e:for(;;){for(;E=+M[f>>3],m=+M[f+8>>3],f=f+16|0,D=l[f>>2]|0,D=(D|0)==0?A:D,v=+M[D>>3],S=+M[D+8>>3],E>v?(x=E,E=S):(x=v,v=E,E=m,m=S),g=g==v|g==x?g+2220446049250313e-31:g,!!(g<v|g>x);)if(f=l[f>>2]|0,!f){f=22;break e}if(S=E<0?E+6.283185307179586:E,E=m<0?m+6.283185307179586:m,I=S==I|E==I?I+-2220446049250313e-31:I,x=S+(E-S)*((g-v)/(x-v)),(x<0?x+6.283185307179586:x)>I&&(u=u^1),f=l[f>>2]|0,!f){f=22;break}}if((f|0)==22)return u|0}else{u=0,I=m,f=A;e:for(;;){for(;E=+M[f>>3],m=+M[f+8>>3],f=f+16|0,D=l[f>>2]|0,D=(D|0)==0?A:D,v=+M[D>>3],S=+M[D+8>>3],E>v?(x=E,E=S):(x=v,v=E,E=m,m=S),g=g==v|g==x?g+2220446049250313e-31:g,!!(g<v|g>x);)if(f=l[f>>2]|0,!f){f=22;break e}if(I=E==I|m==I?I+-2220446049250313e-31:I,E+(m-E)*((g-v)/(x-v))>I&&(u=u^1),f=l[f>>2]|0,!f){f=22;break}}if((f|0)==22)return u|0}return 0}function On(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0;if(ie=O,O=O+32|0,ae=ie+16|0,Z=ie,v=he(A|0,u|0,52)|0,N()|0,v=v&15,H=he(f|0,g|0,52)|0,N()|0,(v|0)!=(H&15|0))return ae=12,O=ie,ae|0;if(I=he(A|0,u|0,45)|0,N()|0,I=I&127,D=he(f|0,g|0,45)|0,N()|0,D=D&127,I>>>0>121|D>>>0>121)return ae=5,O=ie,ae|0;if(H=(I|0)!=(D|0),H){if(S=Zl(I,D)|0,(S|0)==7)return ae=1,O=ie,ae|0;x=Zl(D,I)|0,(x|0)==7?Ne(27514,27538,161,27548):(j=S,E=x)}else j=0,E=0;B=bt(I)|0,V=bt(D)|0,l[ae>>2]=0,l[ae+4>>2]=0,l[ae+8>>2]=0,l[ae+12>>2]=0;do if(j){if(D=l[4272+(I*28|0)+(j<<2)>>2]|0,S=(D|0)>0,V)if(S){I=0,x=f,S=g;do x=kb(x,S)|0,S=N()|0,E=tr(E)|0,(E|0)==1&&(E=tr(1)|0),I=I+1|0;while((I|0)!=(D|0));D=E,I=x,x=S}else D=E,I=f,x=g;else if(S){I=0,x=f,S=g;do x=lu(x,S)|0,S=N()|0,E=tr(E)|0,I=I+1|0;while((I|0)!=(D|0));D=E,I=x,x=S}else D=E,I=f,x=g;if(fu(I,x,ae)|0,H||Ne(27563,27538,191,27548),S=(B|0)!=0,E=(V|0)!=0,S&E&&Ne(27590,27538,192,27548),S){if(E=Ei(A,u)|0,(E|0)==7){v=5;break}if(de[22e3+(E*7|0)+j>>0]|0){v=1;break}x=l[21168+(E*28|0)+(j<<2)>>2]|0,I=x}else if(E){if(E=Ei(I,x)|0,(E|0)==7){v=5;break}if(de[22e3+(E*7|0)+D>>0]|0){v=1;break}I=0,x=l[21168+(D*28|0)+(E<<2)>>2]|0}else I=0,x=0;if((I|x|0)<0)v=5;else{if((x|0)>0){S=ae+4|0,E=0;do Ra(S),E=E+1|0;while((E|0)!=(x|0))}if(l[Z>>2]=0,l[Z+4>>2]=0,l[Z+8>>2]=0,Qh(Z,j),v|0)for(;Ki(v)|0?La(Z):br(Z),(v|0)>1;)v=v+-1|0;if((I|0)>0){v=0;do Ra(Z),v=v+1|0;while((v|0)!=(I|0))}z=ae+4|0,ui(z,Z,z),ri(z),z=51}}else if(fu(f,g,ae)|0,(B|0)!=0&(V|0)!=0)if((D|0)!=(I|0)&&Ne(27621,27538,261,27548),E=Ei(A,u)|0,v=Ei(f,g)|0,(E|0)==7|(v|0)==7)v=5;else if(de[22e3+(E*7|0)+v>>0]|0)v=1;else if(E=l[21168+(E*28|0)+(v<<2)>>2]|0,(E|0)>0){S=ae+4|0,v=0;do Ra(S),v=v+1|0;while((v|0)!=(E|0));z=51}else z=51;else z=51;while(!1);return(z|0)==51&&(v=ae+4|0,l[m>>2]=l[v>>2],l[m+4>>2]=l[v+4>>2],l[m+8>>2]=l[v+8>>2],v=0),ae=v,O=ie,ae|0}function Ad(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0;if(z=O,O=O+48|0,I=z+36|0,E=z+24|0,S=z+12|0,x=z,m=he(A|0,u|0,52)|0,N()|0,m=m&15,V=he(A|0,u|0,45)|0,N()|0,V=V&127,V>>>0>121)return g=5,O=z,g|0;if(D=bt(V)|0,Ee(m|0,0,52)|0,Z=N()|0|134225919,v=g,l[v>>2]=-1,l[v+4>>2]=Z,!m)return m=Ia(f)|0,(m|0)==7||(m=Xl(V,m)|0,(m|0)==127)?(Z=1,O=z,Z|0):(H=Ee(m|0,0,45)|0,j=N()|0,V=g,j=l[V+4>>2]&-1040385|j,Z=g,l[Z>>2]=l[V>>2]|H,l[Z+4>>2]=j,Z=0,O=z,Z|0);for(l[I>>2]=l[f>>2],l[I+4>>2]=l[f+4>>2],l[I+8>>2]=l[f+8>>2],f=m;;){if(v=f,f=f+-1|0,l[E>>2]=l[I>>2],l[E+4>>2]=l[I+4>>2],l[E+8>>2]=l[I+8>>2],Ki(v)|0){if(m=lb(I)|0,m|0){f=13;break}l[S>>2]=l[I>>2],l[S+4>>2]=l[I+4>>2],l[S+8>>2]=l[I+8>>2],La(S)}else{if(m=ub(I)|0,m|0){f=13;break}l[S>>2]=l[I>>2],l[S+4>>2]=l[I+4>>2],l[S+8>>2]=l[I+8>>2],br(S)}if(tu(E,S,x),ri(x),m=g,ie=l[m>>2]|0,m=l[m+4>>2]|0,J=(15-v|0)*3|0,ae=Ee(7,0,J|0)|0,m=m&~(N()|0),J=Ee(Ia(x)|0,0,J|0)|0,m=N()|0|m,Z=g,l[Z>>2]=J|ie&~ae,l[Z+4>>2]=m,(v|0)<=1){f=14;break}}e:do if((f|0)!=13&&(f|0)==14)if((l[I>>2]|0)<=1&&(l[I+4>>2]|0)<=1&&(l[I+8>>2]|0)<=1){f=Ia(I)|0,m=Xl(V,f)|0,(m|0)==127?x=0:x=bt(m)|0;t:do if(f){if(D){if(m=Ei(A,u)|0,(m|0)==7){m=5;break e}if(v=l[21376+(m*28|0)+(f<<2)>>2]|0,(v|0)>0){m=f,f=0;do m=xr(m)|0,f=f+1|0;while((f|0)!=(v|0))}else m=f;if((m|0)==1){m=9;break e}f=Xl(V,m)|0,(f|0)==127&&Ne(27648,27538,411,27678),bt(f)|0?Ne(27693,27538,412,27678):(j=f,H=v,B=m)}else j=m,H=0,B=f;if(S=l[4272+(V*28|0)+(B<<2)>>2]|0,(S|0)<=-1&&Ne(27724,27538,419,27678),!x){if((H|0)<0){m=5;break e}if(H|0){v=g,m=0,f=l[v>>2]|0,v=l[v+4>>2]|0;do f=_r(f,v)|0,v=N()|0,J=g,l[J>>2]=f,l[J+4>>2]=v,m=m+1|0;while((m|0)<(H|0))}if((S|0)<=0){m=j,f=58;break}for(v=g,m=0,f=l[v>>2]|0,v=l[v+4>>2]|0;;)if(f=_r(f,v)|0,v=N()|0,J=g,l[J>>2]=f,l[J+4>>2]=v,m=m+1|0,(m|0)==(S|0)){m=j,f=58;break t}}if(E=Zl(j,V)|0,(E|0)==7&&Ne(27514,27538,428,27678),m=g,f=l[m>>2]|0,m=l[m+4>>2]|0,(S|0)>0){v=0;do f=_r(f,m)|0,m=N()|0,J=g,l[J>>2]=f,l[J+4>>2]=m,v=v+1|0;while((v|0)!=(S|0))}if(m=Ei(f,m)|0,(m|0)==7&&Ne(27795,27538,440,27678),f=ql(j)|0,f=l[(f?21792:21584)+(E*28|0)+(m<<2)>>2]|0,(f|0)<0&&Ne(27795,27538,454,27678),!f)m=j,f=58;else{E=g,m=0,v=l[E>>2]|0,E=l[E+4>>2]|0;do v=Au(v,E)|0,E=N()|0,J=g,l[J>>2]=v,l[J+4>>2]=E,m=m+1|0;while((m|0)<(f|0));m=j,f=58}}else if((D|0)!=0&(x|0)!=0){if(f=Ei(A,u)|0,v=g,v=Ei(l[v>>2]|0,l[v+4>>2]|0)|0,(f|0)==7|(v|0)==7){m=5;break e}if(v=l[21376+(f*28|0)+(v<<2)>>2]|0,(v|0)<0){m=5;break e}if(!v)f=59;else{S=g,f=0,E=l[S>>2]|0,S=l[S+4>>2]|0;do E=_r(E,S)|0,S=N()|0,J=g,l[J>>2]=E,l[J+4>>2]=S,f=f+1|0;while((f|0)<(v|0));f=58}}else f=58;while(!1);if((f|0)==58&&x&&(f=59),(f|0)==59&&(J=g,(Ei(l[J>>2]|0,l[J+4>>2]|0)|0)==1)){m=9;break}J=g,ae=l[J>>2]|0,J=l[J+4>>2]&-1040385,ie=Ee(m|0,0,45)|0,J=J|(N()|0),m=g,l[m>>2]=ae|ie,l[m+4>>2]=J,m=0}else m=1;while(!1);return J=m,O=z,J|0}function ex(A,u,f,g,m,v){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0;var E=0,S=0;return S=O,O=O+16|0,E=S,m?A=15:(A=On(A,u,f,g,E)|0,A||(cb(E,v),A=0)),O=S,A|0}function tx(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0;return E=O,O=O+16|0,v=E,g?f=15:(f=hb(f,v)|0,f||(f=Ad(A,u,v,m)|0)),O=E,f|0}function ix(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0;return x=O,O=O+32|0,E=x+12|0,S=x,v=On(A,u,A,u,E)|0,v|0?(S=v,O=x,S|0):(A=On(A,u,f,g,S)|0,A|0?(S=A,O=x,S|0):(E=iu(E,S)|0,S=m,l[S>>2]=E,l[S+4>>2]=((E|0)<0)<<31>>31,S=0,O=x,S|0))}function nx(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0;return x=O,O=O+32|0,E=x+12|0,S=x,v=On(A,u,A,u,E)|0,!v&&(v=On(A,u,f,g,S)|0,!v)?(g=iu(E,S)|0,g=Ce(g|0,((g|0)<0)<<31>>31|0,1,0)|0,E=N()|0,S=m,l[S>>2]=g,l[S+4>>2]=E,S=0,O=x,S|0):(S=v,O=x,S|0)}function rx(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0;if(xe=O,O=O+48|0,ve=xe+24|0,E=xe+12|0,Ie=xe,v=On(A,u,A,u,ve)|0,!v&&(v=On(A,u,f,g,E)|0,!v)){J=iu(ve,E)|0,q=((J|0)<0)<<31>>31,l[ve>>2]=0,l[ve+4>>2]=0,l[ve+8>>2]=0,l[E>>2]=0,l[E+4>>2]=0,l[E+8>>2]=0,On(A,u,A,u,ve)|0&&Ne(27795,27538,692,27747),On(A,u,f,g,E)|0&&Ne(27795,27538,697,27747),qh(ve),qh(E),D=(J|0)==0?0:1/+(J|0),f=l[ve>>2]|0,z=D*+((l[E>>2]|0)-f|0),Z=ve+4|0,g=l[Z>>2]|0,ae=D*+((l[E+4>>2]|0)-g|0),ie=ve+8|0,v=l[ie>>2]|0,D=D*+((l[E+8>>2]|0)-v|0),l[Ie>>2]=f,B=Ie+4|0,l[B>>2]=g,V=Ie+8|0,l[V>>2]=v;e:do if((J|0)<0)v=0;else for(H=0,j=0;;){x=+(j>>>0)+4294967296*+(H|0),je=z*x+ +(f|0),S=ae*x+ +(g|0),x=D*x+ +(v|0),f=~~+Oa(+je),E=~~+Oa(+S),v=~~+Oa(+x),je=+et(+(+(f|0)-je)),S=+et(+(+(E|0)-S)),x=+et(+(+(v|0)-x));do if(je>S&je>x)f=0-(E+v)|0,g=E;else if(I=0-f|0,S>x){g=I-v|0;break}else{g=E,v=I-E|0;break}while(!1);if(l[Ie>>2]=f,l[B>>2]=g,l[V>>2]=v,db(Ie),v=Ad(A,u,Ie,m+(j<<3)|0)|0,v|0)break e;if(!((H|0)<(q|0)|(H|0)==(q|0)&j>>>0<J>>>0)){v=0;break e}f=Ce(j|0,H|0,1,0)|0,g=N()|0,H=g,j=f,f=l[ve>>2]|0,g=l[Z>>2]|0,v=l[ie>>2]|0}while(!1);return Ie=v,O=xe,Ie|0}return Ie=v,O=xe,Ie|0}function ir(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0;if((f|0)==0&(g|0)==0)return m=0,v=1,Qe(m|0),v|0;v=A,m=u,A=1,u=0;do E=(f&1|0)==0&!0,A=qt((E?1:v)|0,(E?0:m)|0,A|0,u|0)|0,u=N()|0,f=Ed(f|0,g|0,1)|0,g=N()|0,v=qt(v|0,m|0,v|0,m|0)|0,m=N()|0;while(!((f|0)==0&(g|0)==0));return Qe(u|0),A|0}function pu(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0;S=O,O=O+16|0,v=S,E=he(A|0,u|0,52)|0,N()|0,E=E&15;do if(E){if(m=wr(A,u,v)|0,!m){I=+M[v>>3],x=1/+ct(+I),D=+M[25968+(E<<3)>>3],M[f>>3]=I+D,M[f+8>>3]=I-D,I=+M[v+8>>3],x=D*x,M[f+16>>3]=x+I,M[f+24>>3]=I-x;break}return E=m,O=S,E|0}else{if(m=he(A|0,u|0,45)|0,N()|0,m=m&127,m>>>0>121)return E=5,O=S,E|0;v=22064+(m<<5)|0,l[f>>2]=l[v>>2],l[f+4>>2]=l[v+4>>2],l[f+8>>2]=l[v+8>>2],l[f+12>>2]=l[v+12>>2],l[f+16>>2]=l[v+16>>2],l[f+20>>2]=l[v+20>>2],l[f+24>>2]=l[v+24>>2],l[f+28>>2]=l[v+28>>2];break}while(!1);return ob(f,g?1.4:1.1),g=26096+(E<<3)|0,(l[g>>2]|0)==(A|0)&&(l[g+4>>2]|0)==(u|0)&&(M[f>>3]=1.5707963267948966),E=26224+(E<<3)|0,(l[E>>2]|0)==(A|0)&&(l[E+4>>2]|0)==(u|0)&&(M[f+8>>3]=-1.5707963267948966),+M[f>>3]!=1.5707963267948966&&+M[f+8>>3]!=-1.5707963267948966?(E=0,O=S,E|0):(M[f+16>>3]=3.141592653589793,M[f+24>>3]=-3.141592653589793,E=0,O=S,E|0)}function sx(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0;I=O,O=O+48|0,E=I+32|0,v=I+40|0,S=I,ou(E,0,0,0),x=l[E>>2]|0,E=l[E+4>>2]|0;do if(f>>>0<=15){if(m=so(g)|0,m|0){g=S,l[g>>2]=0,l[g+4>>2]=0,l[S+8>>2]=m,l[S+12>>2]=-1,g=S+16|0,x=S+29|0,l[g>>2]=0,l[g+4>>2]=0,l[g+8>>2]=0,de[g+12>>0]=0,de[x>>0]=de[v>>0]|0,de[x+1>>0]=de[v+1>>0]|0,de[x+2>>0]=de[v+2>>0]|0;break}if(m=Ti((l[u+8>>2]|0)+1|0,32)|0,m){mu(u,m),D=S,l[D>>2]=x,l[D+4>>2]=E,l[S+8>>2]=0,l[S+12>>2]=f,l[S+16>>2]=g,l[S+20>>2]=u,l[S+24>>2]=m,de[S+28>>0]=0,x=S+29|0,de[x>>0]=de[v>>0]|0,de[x+1>>0]=de[v+1>>0]|0,de[x+2>>0]=de[v+2>>0]|0;break}else{g=S,l[g>>2]=0,l[g+4>>2]=0,l[S+8>>2]=13,l[S+12>>2]=-1,g=S+16|0,x=S+29|0,l[g>>2]=0,l[g+4>>2]=0,l[g+8>>2]=0,de[g+12>>0]=0,de[x>>0]=de[v>>0]|0,de[x+1>>0]=de[v+1>>0]|0,de[x+2>>0]=de[v+2>>0]|0;break}}else x=S,l[x>>2]=0,l[x+4>>2]=0,l[S+8>>2]=4,l[S+12>>2]=-1,x=S+16|0,D=S+29|0,l[x>>2]=0,l[x+4>>2]=0,l[x+8>>2]=0,de[x+12>>0]=0,de[D>>0]=de[v>>0]|0,de[D+1>>0]=de[v+1>>0]|0,de[D+2>>0]=de[v+2>>0]|0;while(!1);Pa(S),l[A>>2]=l[S>>2],l[A+4>>2]=l[S+4>>2],l[A+8>>2]=l[S+8>>2],l[A+12>>2]=l[S+12>>2],l[A+16>>2]=l[S+16>>2],l[A+20>>2]=l[S+20>>2],l[A+24>>2]=l[S+24>>2],l[A+28>>2]=l[S+28>>2],O=I}function Pa(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0;if(q=O,O=O+336|0,H=q+168|0,j=q,g=A,f=l[g>>2]|0,g=l[g+4>>2]|0,(f|0)==0&(g|0)==0){O=q;return}if(u=A+28|0,de[u>>0]|0?(f=ld(f,g)|0,g=N()|0):de[u>>0]=1,J=A+20|0,!(l[l[J>>2]>>2]|0)){u=A+24|0,f=l[u>>2]|0,f|0&&Pe(f),ie=A,l[ie>>2]=0,l[ie+4>>2]=0,l[A+8>>2]=0,l[J>>2]=0,l[A+12>>2]=-1,l[A+16>>2]=0,l[u>>2]=0,O=q;return}ie=A+16|0,u=l[ie>>2]|0,m=u&15;e:do if((f|0)==0&(g|0)==0)ae=A+24|0;else{z=A+12|0,B=(m|0)==3,D=u&255,x=(m|1|0)==3,V=A+24|0,I=(m+-1|0)>>>0<3,E=(m|2|0)==3,S=j+8|0;t:for(;;){if(v=he(f|0,g|0,52)|0,N()|0,v=v&15,(v|0)==(l[z>>2]|0)){switch(D&15){case 0:case 2:case 3:{if(m=wr(f,g,H)|0,m|0){Z=15;break t}if(yu(l[J>>2]|0,l[V>>2]|0,H)|0){Z=19;break t}break}}if(x&&(m=l[(l[J>>2]|0)+4>>2]|0,l[H>>2]=l[m>>2],l[H+4>>2]=l[m+4>>2],l[H+8>>2]=l[m+8>>2],l[H+12>>2]=l[m+12>>2],Jl(26832,H)|0)){if(uu(l[(l[J>>2]|0)+4>>2]|0,v,j)|0){Z=25;break}if(m=j,(l[m>>2]|0)==(f|0)&&(l[m+4>>2]|0)==(g|0)){Z=29;break}}if(I){if(m=es(f,g,H)|0,m|0){Z=32;break}if(pu(f,g,j,0)|0){Z=36;break}if(E&&fd(l[J>>2]|0,l[V>>2]|0,H,j)|0){Z=42;break}if(x&&cd(l[J>>2]|0,l[V>>2]|0,H,j)|0){Z=42;break}}if(B){if(u=pu(f,g,H,1)|0,m=l[V>>2]|0,u|0){Z=45;break}if(eu(m,H)|0){if(Vh(j,H),Gh(H,l[V>>2]|0)|0){Z=53;break}if(yu(l[J>>2]|0,l[V>>2]|0,S)|0){Z=53;break}if(cd(l[J>>2]|0,l[V>>2]|0,j,H)|0){Z=53;break}}}}do if((v|0)<(l[z>>2]|0)){if(u=pu(f,g,H,1)|0,m=l[V>>2]|0,u|0){Z=58;break t}if(!(eu(m,H)|0)){Z=73;break}if(Gh(l[V>>2]|0,H)|0&&(Vh(j,H),fd(l[J>>2]|0,l[V>>2]|0,j,H)|0)){Z=65;break t}if(f=td(f,g,v+1|0,j)|0,f|0){Z=67;break t}g=j,f=l[g>>2]|0,g=l[g+4>>2]|0}else Z=73;while(!1);if((Z|0)==73&&(Z=0,f=ld(f,g)|0,g=N()|0),(f|0)==0&(g|0)==0){ae=V;break e}}switch(Z|0){case 15:{u=l[V>>2]|0,u|0&&Pe(u),Z=A,l[Z>>2]=0,l[Z+4>>2]=0,l[J>>2]=0,l[z>>2]=-1,l[ie>>2]=0,l[V>>2]=0,l[A+8>>2]=m,Z=20;break}case 19:{l[A>>2]=f,l[A+4>>2]=g,Z=20;break}case 25:{Ne(27795,27761,470,27772);break}case 29:{l[A>>2]=f,l[A+4>>2]=g,O=q;return}case 32:{u=l[V>>2]|0,u|0&&Pe(u),ae=A,l[ae>>2]=0,l[ae+4>>2]=0,l[J>>2]=0,l[z>>2]=-1,l[ie>>2]=0,l[V>>2]=0,l[A+8>>2]=m,O=q;return}case 36:{Ne(27795,27761,493,27772);break}case 42:{l[A>>2]=f,l[A+4>>2]=g,O=q;return}case 45:{m|0&&Pe(m),Z=A,l[Z>>2]=0,l[Z+4>>2]=0,l[J>>2]=0,l[z>>2]=-1,l[ie>>2]=0,l[V>>2]=0,l[A+8>>2]=u,Z=55;break}case 53:{l[A>>2]=f,l[A+4>>2]=g,Z=55;break}case 58:{m|0&&Pe(m),Z=A,l[Z>>2]=0,l[Z+4>>2]=0,l[J>>2]=0,l[z>>2]=-1,l[ie>>2]=0,l[V>>2]=0,l[A+8>>2]=u,Z=71;break}case 65:{l[A>>2]=f,l[A+4>>2]=g,Z=71;break}case 67:{u=l[V>>2]|0,u|0&&Pe(u),ae=A,l[ae>>2]=0,l[ae+4>>2]=0,l[J>>2]=0,l[z>>2]=-1,l[ie>>2]=0,l[V>>2]=0,l[A+8>>2]=f,O=q;return}}if((Z|0)==20){O=q;return}else if((Z|0)==55){O=q;return}else if((Z|0)==71){O=q;return}}while(!1);u=l[ae>>2]|0,u|0&&Pe(u),Z=A,l[Z>>2]=0,l[Z+4>>2]=0,l[A+8>>2]=0,l[J>>2]=0,l[A+12>>2]=-1,l[ie>>2]=0,l[ae>>2]=0,O=q}function ld(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0;B=O,O=O+16|0,D=B,g=he(A|0,u|0,52)|0,N()|0,g=g&15,f=he(A|0,u|0,45)|0,N()|0;do if(g){for(;f=Ee(g+4095|0,0,52)|0,m=N()|0|u&-15728641,v=(15-g|0)*3|0,E=Ee(7,0,v|0)|0,S=N()|0,f=f|A|E,m=m|S,x=he(A|0,u|0,v|0)|0,N()|0,x=x&7,g=g+-1|0,!(x>>>0<6);)if(g)u=m,A=f;else{I=4;break}if((I|0)==4){f=he(f|0,m|0,45)|0,N()|0;break}return D=(x|0)==0&(mt(f,m)|0)!=0,D=Ee((D?2:1)+x|0,0,v|0)|0,I=N()|0|u&~S,D=D|A&~E,Qe(I|0),O=B,D|0}while(!1);return f=f&127,f>>>0>120?(I=0,D=0,Qe(I|0),O=B,D|0):(ou(D,0,f+1|0,0),I=l[D+4>>2]|0,D=l[D>>2]|0,Qe(I|0),O=B,D|0)}function ox(A,u,f,g,m,v){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0,v=v|0;var E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0;Z=O,O=O+160|0,B=Z+80|0,S=Z+64|0,V=Z+112|0,z=Z,sx(B,A,u,f),I=B,hu(S,l[I>>2]|0,l[I+4>>2]|0,u),I=S,x=l[I>>2]|0,I=l[I+4>>2]|0,E=l[B+8>>2]|0,H=V+4|0,l[H>>2]=l[B>>2],l[H+4>>2]=l[B+4>>2],l[H+8>>2]=l[B+8>>2],l[H+12>>2]=l[B+12>>2],l[H+16>>2]=l[B+16>>2],l[H+20>>2]=l[B+20>>2],l[H+24>>2]=l[B+24>>2],l[H+28>>2]=l[B+28>>2],H=z,l[H>>2]=x,l[H+4>>2]=I,H=z+8|0,l[H>>2]=E,A=z+12|0,u=V,f=A+36|0;do l[A>>2]=l[u>>2],A=A+4|0,u=u+4|0;while((A|0)<(f|0));if(V=z+48|0,l[V>>2]=l[S>>2],l[V+4>>2]=l[S+4>>2],l[V+8>>2]=l[S+8>>2],l[V+12>>2]=l[S+12>>2],(x|0)==0&(I|0)==0)return z=E,O=Z,z|0;f=z+16|0,D=z+24|0,B=z+28|0,E=0,S=0,u=x,A=I;do{if(!((E|0)<(m|0)|(E|0)==(m|0)&S>>>0<g>>>0)){j=4;break}if(I=S,S=Ce(S|0,E|0,1,0)|0,E=N()|0,I=v+(I<<3)|0,l[I>>2]=u,l[I+4>>2]=A,du(V),A=V,u=l[A>>2]|0,A=l[A+4>>2]|0,(u|0)==0&(A|0)==0){if(Pa(f),u=f,A=l[u>>2]|0,u=l[u+4>>2]|0,(A|0)==0&(u|0)==0){j=10;break}nd(A,u,l[B>>2]|0,V),A=V,u=l[A>>2]|0,A=l[A+4>>2]|0}I=z,l[I>>2]=u,l[I+4>>2]=A}while(!((u|0)==0&(A|0)==0));return(j|0)==4?(A=z+40|0,u=l[A>>2]|0,u|0&&Pe(u),j=z+16|0,l[j>>2]=0,l[j+4>>2]=0,l[D>>2]=0,l[z+36>>2]=0,l[B>>2]=-1,l[z+32>>2]=0,l[A>>2]=0,nd(0,0,0,V),l[z>>2]=0,l[z+4>>2]=0,l[H>>2]=0,z=14,O=Z,z|0):((j|0)==10&&(l[z>>2]=0,l[z+4>>2]=0,l[H>>2]=l[D>>2]),z=l[H>>2]|0,O=Z,z|0)}function ax(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0;if(B=O,O=O+48|0,x=B+32|0,S=B+40|0,I=B,!(l[A>>2]|0))return D=g,l[D>>2]=0,l[D+4>>2]=0,D=0,O=B,D|0;ou(x,0,0,0),E=x,m=l[E>>2]|0,E=l[E+4>>2]|0;do if(u>>>0>15)D=I,l[D>>2]=0,l[D+4>>2]=0,l[I+8>>2]=4,l[I+12>>2]=-1,D=I+16|0,f=I+29|0,l[D>>2]=0,l[D+4>>2]=0,l[D+8>>2]=0,de[D+12>>0]=0,de[f>>0]=de[S>>0]|0,de[f+1>>0]=de[S+1>>0]|0,de[f+2>>0]=de[S+2>>0]|0,f=4,D=9;else{if(f=so(f)|0,f|0){x=I,l[x>>2]=0,l[x+4>>2]=0,l[I+8>>2]=f,l[I+12>>2]=-1,x=I+16|0,D=I+29|0,l[x>>2]=0,l[x+4>>2]=0,l[x+8>>2]=0,de[x+12>>0]=0,de[D>>0]=de[S>>0]|0,de[D+1>>0]=de[S+1>>0]|0,de[D+2>>0]=de[S+2>>0]|0,D=9;break}if(f=Ti((l[A+8>>2]|0)+1|0,32)|0,!f){D=I,l[D>>2]=0,l[D+4>>2]=0,l[I+8>>2]=13,l[I+12>>2]=-1,D=I+16|0,f=I+29|0,l[D>>2]=0,l[D+4>>2]=0,l[D+8>>2]=0,de[D+12>>0]=0,de[f>>0]=de[S>>0]|0,de[f+1>>0]=de[S+1>>0]|0,de[f+2>>0]=de[S+2>>0]|0,f=13,D=9;break}mu(A,f),H=I,l[H>>2]=m,l[H+4>>2]=E,E=I+8|0,l[E>>2]=0,l[I+12>>2]=u,l[I+20>>2]=A,l[I+24>>2]=f,de[I+28>>0]=0,m=I+29|0,de[m>>0]=de[S>>0]|0,de[m+1>>0]=de[S+1>>0]|0,de[m+2>>0]=de[S+2>>0]|0,l[I+16>>2]=3,V=+nb(f),V=V*+ib(f),v=+et(+ +M[f>>3]),v=V/+ct(+ +Ma(+v,+ +et(+ +M[f+8>>3])))*6371.007180918475*6371.007180918475,m=I+12|0,f=l[m>>2]|0;e:do if((f|0)>0)do{if(rd(f+-1|0,x)|0,!(v/+M[x>>3]>10))break e;H=l[m>>2]|0,f=H+-1|0,l[m>>2]=f}while((H|0)>1);while(!1);if(Pa(I),m=g,l[m>>2]=0,l[m+4>>2]=0,m=I,f=l[m>>2]|0,m=l[m+4>>2]|0,!((f|0)==0&(m|0)==0))do to(f,m,u,x)|0,S=x,A=g,S=Ce(l[A>>2]|0,l[A+4>>2]|0,l[S>>2]|0,l[S+4>>2]|0)|0,A=N()|0,H=g,l[H>>2]=S,l[H+4>>2]=A,Pa(I),H=I,f=l[H>>2]|0,m=l[H+4>>2]|0;while(!((f|0)==0&(m|0)==0));f=l[E>>2]|0}while(!1);return H=f,O=B,H|0}function ro(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;if(!(Jl(u,f)|0)||(u=$h(u)|0,g=+M[f>>3],m=+M[f+8>>3],m=u&m<0?m+6.283185307179586:m,V=l[A>>2]|0,(V|0)<=0))return V=0,V|0;if(B=l[A+4>>2]|0,u){u=0,D=m,f=-1,A=0;e:for(;;){for(I=A;E=+M[B+(I<<4)>>3],m=+M[B+(I<<4)+8>>3],A=(f+2|0)%(V|0)|0,v=+M[B+(A<<4)>>3],S=+M[B+(A<<4)+8>>3],E>v?(x=E,E=S):(x=v,v=E,E=m,m=S),g=g==v|g==x?g+2220446049250313e-31:g,!!(g<v|g>x);)if(f=I+1|0,(f|0)>=(V|0)){f=22;break e}else A=I,I=f,f=A;if(S=E<0?E+6.283185307179586:E,E=m<0?m+6.283185307179586:m,D=S==D|E==D?D+-2220446049250313e-31:D,x=S+(E-S)*((g-v)/(x-v)),(x<0?x+6.283185307179586:x)>D&&(u=u^1),A=I+1|0,(A|0)>=(V|0)){f=22;break}else f=I}if((f|0)==22)return u|0}else{u=0,D=m,f=-1,A=0;e:for(;;){for(I=A;E=+M[B+(I<<4)>>3],m=+M[B+(I<<4)+8>>3],A=(f+2|0)%(V|0)|0,v=+M[B+(A<<4)>>3],S=+M[B+(A<<4)+8>>3],E>v?(x=E,E=S):(x=v,v=E,E=m,m=S),g=g==v|g==x?g+2220446049250313e-31:g,!!(g<v|g>x);)if(f=I+1|0,(f|0)>=(V|0)){f=22;break e}else A=I,I=f,f=A;if(D=E==D|m==D?D+-2220446049250313e-31:D,E+(m-E)*((g-v)/(x-v))>D&&(u=u^1),A=I+1|0,(A|0)>=(V|0)){f=22;break}else f=I}if((f|0)==22)return u|0}return 0}function ud(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0;if(j=l[A>>2]|0,!j){l[u>>2]=0,l[u+4>>2]=0,l[u+8>>2]=0,l[u+12>>2]=0,l[u+16>>2]=0,l[u+20>>2]=0,l[u+24>>2]=0,l[u+28>>2]=0;return}if(z=u+8|0,M[z>>3]=17976931348623157e292,Z=u+24|0,M[Z>>3]=17976931348623157e292,M[u>>3]=-17976931348623157e292,ae=u+16|0,M[ae>>3]=-17976931348623157e292,!((j|0)<=0)){for(V=l[A+4>>2]|0,I=17976931348623157e292,D=-17976931348623157e292,B=0,A=-1,v=17976931348623157e292,E=17976931348623157e292,x=-17976931348623157e292,g=-17976931348623157e292,H=0;f=+M[V+(H<<4)>>3],S=+M[V+(H<<4)+8>>3],A=A+2|0,m=+M[V+(((A|0)==(j|0)?0:A)<<4)+8>>3],f<v&&(M[z>>3]=f,v=f),S<E&&(M[Z>>3]=S,E=S),f>x?M[u>>3]=f:f=x,S>g&&(M[ae>>3]=S,g=S),I=S>0&S<I?S:I,D=S<0&S>D?S:D,B=B|+et(+(S-m))>3.141592653589793,A=H+1|0,(A|0)!=(j|0);)ie=H,x=f,H=A,A=ie;B&&(M[ae>>3]=D,M[Z>>3]=I)}}function so(A){return A=A|0,(A>>>0<4?0:15)|0}function mu(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0;if(j=l[A>>2]|0,j){if(z=u+8|0,M[z>>3]=17976931348623157e292,Z=u+24|0,M[Z>>3]=17976931348623157e292,M[u>>3]=-17976931348623157e292,ae=u+16|0,M[ae>>3]=-17976931348623157e292,(j|0)>0){for(m=l[A+4>>2]|0,V=17976931348623157e292,H=-17976931348623157e292,g=0,f=-1,x=17976931348623157e292,I=17976931348623157e292,B=-17976931348623157e292,E=-17976931348623157e292,ie=0;v=+M[m+(ie<<4)>>3],D=+M[m+(ie<<4)+8>>3],Ie=f+2|0,S=+M[m+(((Ie|0)==(j|0)?0:Ie)<<4)+8>>3],v<x&&(M[z>>3]=v,x=v),D<I&&(M[Z>>3]=D,I=D),v>B?M[u>>3]=v:v=B,D>E&&(M[ae>>3]=D,E=D),V=D>0&D<V?D:V,H=D<0&D>H?D:H,g=g|+et(+(D-S))>3.141592653589793,f=ie+1|0,(f|0)!=(j|0);)Ie=ie,B=v,ie=f,f=Ie;g&&(M[ae>>3]=H,M[Z>>3]=V)}}else l[u>>2]=0,l[u+4>>2]=0,l[u+8>>2]=0,l[u+12>>2]=0,l[u+16>>2]=0,l[u+20>>2]=0,l[u+24>>2]=0,l[u+28>>2]=0;if(Ie=A+8|0,f=l[Ie>>2]|0,!((f|0)<=0)){ve=A+12|0,q=0;do if(m=l[ve>>2]|0,g=q,q=q+1|0,Z=u+(q<<5)|0,ae=l[m+(g<<3)>>2]|0,ae){if(ie=u+(q<<5)+8|0,M[ie>>3]=17976931348623157e292,A=u+(q<<5)+24|0,M[A>>3]=17976931348623157e292,M[Z>>3]=-17976931348623157e292,J=u+(q<<5)+16|0,M[J>>3]=-17976931348623157e292,(ae|0)>0){for(j=l[m+(g<<3)+4>>2]|0,V=17976931348623157e292,H=-17976931348623157e292,m=0,g=-1,z=0,x=17976931348623157e292,I=17976931348623157e292,D=-17976931348623157e292,E=-17976931348623157e292;v=+M[j+(z<<4)>>3],B=+M[j+(z<<4)+8>>3],g=g+2|0,S=+M[j+(((g|0)==(ae|0)?0:g)<<4)+8>>3],v<x&&(M[ie>>3]=v,x=v),B<I&&(M[A>>3]=B,I=B),v>D?M[Z>>3]=v:v=D,B>E&&(M[J>>3]=B,E=B),V=B>0&B<V?B:V,H=B<0&B>H?B:H,m=m|+et(+(B-S))>3.141592653589793,g=z+1|0,(g|0)!=(ae|0);)xe=z,z=g,D=v,g=xe;m&&(M[J>>3]=H,M[A>>3]=V)}}else l[Z>>2]=0,l[Z+4>>2]=0,l[Z+8>>2]=0,l[Z+12>>2]=0,l[Z+16>>2]=0,l[Z+20>>2]=0,l[Z+24>>2]=0,l[Z+28>>2]=0,f=l[Ie>>2]|0;while((q|0)<(f|0))}}function yu(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;if(!(ro(A,u,f)|0))return m=0,m|0;if(m=A+8|0,(l[m>>2]|0)<=0)return m=1,m|0;for(g=A+12|0,A=0;;){if(v=A,A=A+1|0,ro((l[g>>2]|0)+(v<<3)|0,u+(A<<5)|0,f)|0){A=0,g=6;break}if((A|0)>=(l[m>>2]|0)){A=1,g=6;break}}return(g|0)==6?A|0:0}function fd(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0;if(I=O,O=O+16|0,S=I,E=f+8|0,!(ro(A,u,E)|0))return x=0,O=I,x|0;x=A+8|0;e:do if((l[x>>2]|0)>0){for(v=A+12|0,m=0;;){if(D=m,m=m+1|0,ro((l[v>>2]|0)+(D<<3)|0,u+(m<<5)|0,E)|0){m=0;break}if((m|0)>=(l[x>>2]|0))break e}return O=I,m|0}while(!1);if(ka(A,u,f,g)|0)return D=0,O=I,D|0;l[S>>2]=l[f>>2],l[S+4>>2]=E,m=l[x>>2]|0;e:do if((m|0)>0)for(A=A+12|0,E=0,v=m;;){if(m=l[A>>2]|0,(l[m+(E<<3)>>2]|0)>0){if(ro(S,g,l[m+(E<<3)+4>>2]|0)|0){m=0;break e}if(m=E+1|0,ka((l[A>>2]|0)+(E<<3)|0,u+(m<<5)|0,f,g)|0){m=0;break e}v=l[x>>2]|0}else m=E+1|0;if((m|0)<(v|0))E=m;else{m=1;break}}else m=1;while(!1);return D=m,O=I,D|0}function ka(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0,Ie=0,xe=0,je=0;if(Ie=O,O=O+176|0,ie=Ie+172|0,m=Ie+168|0,J=Ie,!(eu(u,g)|0))return A=0,O=Ie,A|0;if(rb(u,g,ie,m),rs(J|0,f|0,168)|0,(l[f>>2]|0)>0){u=0;do xe=J+8+(u<<4)+8|0,ae=+ki(+M[xe>>3],l[m>>2]|0),M[xe>>3]=ae,u=u+1|0;while((u|0)<(l[f>>2]|0))}z=+M[g>>3],Z=+M[g+8>>3],ae=+ki(+M[g+16>>3],l[m>>2]|0),H=+ki(+M[g+24>>3],l[m>>2]|0);e:do if((l[A>>2]|0)>0){if(g=A+4|0,m=l[J>>2]|0,(m|0)<=0){for(u=0;;)if(u=u+1|0,(u|0)>=(l[A>>2]|0)){u=0;break e}}for(f=0;;){if(u=l[g>>2]|0,V=+M[u+(f<<4)>>3],j=+ki(+M[u+(f<<4)+8>>3],l[ie>>2]|0),u=l[g>>2]|0,f=f+1|0,xe=(f|0)%(l[A>>2]|0)|0,v=+M[u+(xe<<4)>>3],E=+ki(+M[u+(xe<<4)+8>>3],l[ie>>2]|0),!(V>=z)|!(v>=z)&&!(V<=Z)|!(v<=Z)&&!(j<=H)|!(E<=H)&&!(j>=ae)|!(E>=ae)){B=v-V,I=E-j,u=0;do if(je=u,u=u+1|0,xe=(u|0)==(m|0)?0:u,v=+M[J+8+(je<<4)+8>>3],E=+M[J+8+(xe<<4)+8>>3]-v,S=+M[J+8+(je<<4)>>3],x=+M[J+8+(xe<<4)>>3]-S,D=B*E-I*x,D!=0&&(q=j-v,ve=V-S,x=(q*x-E*ve)/D,!(x<0|x>1))&&(D=(B*q-I*ve)/D,D>=0&D<=1)){u=1;break e}while((u|0)<(m|0))}if((f|0)>=(l[A>>2]|0)){u=0;break}}}else u=0;while(!1);return je=u,O=Ie,je|0}function cd(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0;if(ka(A,u,f,g)|0)return v=1,v|0;if(v=A+8|0,(l[v>>2]|0)<=0)return v=0,v|0;for(m=A+12|0,A=0;;){if(E=A,A=A+1|0,ka((l[m>>2]|0)+(E<<3)|0,u+(A<<5)|0,f,g)|0){A=1,m=6;break}if((A|0)>=(l[v>>2]|0)){A=0,m=6;break}}return(m|0)==6?A|0:0}function Ax(){return 8}function lx(){return 16}function ux(){return 168}function fx(){return 8}function cx(){return 16}function hx(){return 12}function dx(){return 8}function gx(A){return A=A|0,+(+((l[A>>2]|0)>>>0)+4294967296*+(l[A+4>>2]|0))}function px(A){A=A|0;var u=0,f=0;return f=+M[A>>3],u=+M[A+8>>3],+ +ut(+(f*f+u*u))}function hd(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0;I=+M[A>>3],x=+M[u>>3]-I,S=+M[A+8>>3],E=+M[u+8>>3]-S,B=+M[f>>3],v=+M[g>>3]-B,V=+M[f+8>>3],D=+M[g+8>>3]-V,v=(v*(S-V)-(I-B)*D)/(x*D-E*v),M[m>>3]=I+x*v,M[m+8>>3]=S+E*v}function dd(A,u){return A=A|0,u=u|0,+et(+(+M[A>>3]-+M[u>>3]))<11920928955078125e-23?(u=+et(+(+M[A+8>>3]-+M[u+8>>3]))<11920928955078125e-23,u|0):(u=0,u|0)}function Nt(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;return m=+M[A>>3]-+M[u>>3],g=+M[A+8>>3]-+M[u+8>>3],f=+M[A+16>>3]-+M[u+16>>3],+(m*m+g*g+f*f)}function mx(A,u){A=A|0,u=u|0;var f=0,g=0,m=0;f=+M[A>>3],g=+ct(+f),f=+tt(+f),M[u+16>>3]=f,f=+M[A+8>>3],m=g*+ct(+f),M[u>>3]=m,f=g*+tt(+f),M[u+8>>3]=f}function yx(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;if(v=O,O=O+16|0,m=v,g=mt(A,u)|0,(f+-1|0)>>>0>5||(g=(g|0)!=0,(f|0)==1&g))return m=-1,O=v,m|0;do if(oo(A,u,m)|0)g=-1;else if(g){g=((l[26352+(f<<2)>>2]|0)+5-(l[m>>2]|0)|0)%5|0;break}else{g=((l[26384+(f<<2)>>2]|0)+6-(l[m>>2]|0)|0)%6|0;break}while(!1);return m=g,O=v,m|0}function oo(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0,I=0;if(I=O,O=O+32|0,E=I+16|0,S=I,g=Jr(A,u,E)|0,g|0)return f=g,O=I,f|0;v=Jh(A,u)|0,x=Ei(A,u)|0,ZS(v,S),g=JS(v,l[E>>2]|0)|0;e:do if(bt(v)|0){do switch(v|0){case 4:{A=0;break}case 14:{A=1;break}case 24:{A=2;break}case 38:{A=3;break}case 49:{A=4;break}case 58:{A=5;break}case 63:{A=6;break}case 72:{A=7;break}case 83:{A=8;break}case 97:{A=9;break}case 107:{A=10;break}case 117:{A=11;break}default:{g=1;break e}}while(!1);if(m=l[26416+(A*24|0)+8>>2]|0,u=l[26416+(A*24|0)+16>>2]|0,A=l[E>>2]|0,(A|0)!=(l[S>>2]|0)&&(S=ql(v)|0,A=l[E>>2]|0,S|(A|0)==(u|0)&&(g=(g+1|0)%6|0)),(x|0)==3&(A|0)==(u|0)){g=(g+5|0)%6|0,m=22;break}(x|0)==5&(A|0)==(m|0)&&(g=(g+1|0)%6|0),m=22}else m=22;while(!1);return(m|0)==22&&(l[f>>2]=g,g=0),f=g,O=I,f|0}function Qi(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0;if(J=O,O=O+32|0,ie=J+24|0,Z=J+20|0,j=J+8|0,H=J+16|0,V=J,x=(mt(A,u)|0)==0,x=x?6:5,D=he(A|0,u|0,52)|0,N()|0,D=D&15,x>>>0<=f>>>0)return g=2,O=J,g|0;B=(D|0)==0,!B&&(z=Ee(7,0,(D^15)*3|0)|0,(z&A|0)==0&((N()|0)&u|0)==0)?m=f:v=4;e:do if((v|0)==4){if(m=(mt(A,u)|0)!=0,((m?4:5)|0)<(f|0)||oo(A,u,ie)|0||(v=(l[ie>>2]|0)+f|0,m?m=26704+(((v|0)%5|0)<<2)|0:m=26736+(((v|0)%6|0)<<2)|0,z=l[m>>2]|0,(z|0)==7))return g=1,O=J,g|0;l[Z>>2]=0,m=zt(A,u,z,Z,j)|0;do if(!m){if(S=j,I=l[S>>2]|0,S=l[S+4>>2]|0,E=S>>>0<u>>>0|(S|0)==(u|0)&I>>>0<A>>>0,v=E?I:A,E=E?S:u,!B&&(B=Ee(7,0,(D^15)*3|0)|0,(I&B|0)==0&(S&(N()|0)|0)==0))m=f;else{if(S=(f+-1+x|0)%(x|0)|0,m=mt(A,u)|0,(S|0)<0&&Ne(27795,27797,246,27806),x=(m|0)!=0,((x?4:5)|0)<(S|0)&&Ne(27795,27797,246,27806),oo(A,u,ie)|0&&Ne(27795,27797,246,27806),m=(l[ie>>2]|0)+S|0,x?m=26704+(((m|0)%5|0)<<2)|0:m=26736+(((m|0)%6|0)<<2)|0,S=l[m>>2]|0,(S|0)==7&&Ne(27795,27797,246,27806),l[H>>2]=0,m=zt(A,u,S,H,V)|0,m|0)break;I=V,x=l[I>>2]|0,I=l[I+4>>2]|0;do if(I>>>0<E>>>0|(I|0)==(E|0)&x>>>0<v>>>0){if(mt(x,I)|0?v=zl(x,I,A,u)|0:v=l[26800+((((l[H>>2]|0)+(l[26768+(S<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,m=mt(x,I)|0,(v+-1|0)>>>0>5){m=-1,v=x,E=I;break}if(m=(m|0)!=0,(v|0)==1&m){m=-1,v=x,E=I;break}do if(oo(x,I,ie)|0)m=-1;else if(m){m=((l[26352+(v<<2)>>2]|0)+5-(l[ie>>2]|0)|0)%5|0;break}else{m=((l[26384+(v<<2)>>2]|0)+6-(l[ie>>2]|0)|0)%6|0;break}while(!1);v=x,E=I}else m=f;while(!1);S=j,I=l[S>>2]|0,S=l[S+4>>2]|0}if((v|0)==(I|0)&(E|0)==(S|0)){if(x=(mt(I,S)|0)!=0,x?A=zl(I,S,A,u)|0:A=l[26800+((((l[Z>>2]|0)+(l[26768+(z<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,m=mt(I,S)|0,(A+-1|0)>>>0<=5&&(ae=(m|0)!=0,!((A|0)==1&ae)))do if(oo(I,S,ie)|0)m=-1;else if(ae){m=((l[26352+(A<<2)>>2]|0)+5-(l[ie>>2]|0)|0)%5|0;break}else{m=((l[26384+(A<<2)>>2]|0)+6-(l[ie>>2]|0)|0)%6|0;break}while(!1);else m=-1;m=m+1|0,m=(m|0)==6|x&(m|0)==5?0:m}u=E,A=v;break e}while(!1);return g=m,O=J,g|0}while(!1);return ae=Ee(m|0,0,56)|0,ie=N()|0|u&-2130706433|536870912,l[g>>2]=ae|A,l[g+4>>2]=ie,g=0,O=J,g|0}function vx(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;return v=(mt(A,u)|0)==0,g=Qi(A,u,0,f)|0,m=(g|0)==0,v?!m||(g=Qi(A,u,1,f+8|0)|0,g|0)||(g=Qi(A,u,2,f+16|0)|0,g|0)||(g=Qi(A,u,3,f+24|0)|0,g|0)||(g=Qi(A,u,4,f+32|0)|0,g)?(v=g,v|0):Qi(A,u,5,f+40|0)|0:!m||(g=Qi(A,u,1,f+8|0)|0,g|0)||(g=Qi(A,u,2,f+16|0)|0,g|0)||(g=Qi(A,u,3,f+24|0)|0,g|0)||(g=Qi(A,u,4,f+32|0)|0,g|0)?(v=g,v|0):(v=f+40|0,l[v>>2]=0,l[v+4>>2]=0,v=0,v|0)}function Ex(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0,S=0,x=0;return x=O,O=O+192|0,m=x,v=x+168|0,E=he(A|0,u|0,56)|0,N()|0,E=E&7,S=u&-2130706433|134217728,g=Jr(A,S,v)|0,g|0?(S=g,O=x,S|0):(u=he(A|0,u|0,52)|0,N()|0,u=u&15,mt(A,S)|0?nu(v,u,E,1,m):ru(v,u,E,1,m),S=m+8|0,l[f>>2]=l[S>>2],l[f+4>>2]=l[S+4>>2],l[f+8>>2]=l[S+8>>2],l[f+12>>2]=l[S+12>>2],S=0,O=x,S|0)}function Tx(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;return m=O,O=O+16|0,f=m,!(!0&(u&2013265920|0)==536870912)||(g=u&-2130706433|134217728,!(su(A,g)|0))?(g=0,O=m,g|0):(v=he(A|0,u|0,56)|0,N()|0,v=(Qi(A,g,v&7,f)|0)==0,g=f,g=v&((l[g>>2]|0)==(A|0)?(l[g+4>>2]|0)==(u|0):0)&1,O=m,g|0)}function gd(A,u,f){A=A|0,u=u|0,f=f|0;var g=0;(u|0)>0?(g=Ti(u,4)|0,l[A>>2]=g,g||Ne(27819,27842,40,27856)):l[A>>2]=0,l[A+4>>2]=u,l[A+8>>2]=0,l[A+12>>2]=f}function pd(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0;m=A+4|0,v=A+12|0,E=A+8|0;e:for(;;){for(f=l[m>>2]|0,u=0;;){if((u|0)>=(f|0))break e;if(g=l[A>>2]|0,S=l[g+(u<<2)>>2]|0,!S)u=u+1|0;else break}u=g+(~~(+et(+(+er(10,+ +(15-(l[v>>2]|0)|0))*(+M[S>>3]+ +M[S+8>>3])))%+(f|0))>>>0<<2)|0,f=l[u>>2]|0;t:do if(f|0){if(g=S+32|0,(f|0)==(S|0))l[u>>2]=l[g>>2];else{if(f=f+32|0,u=l[f>>2]|0,!u)break;for(;(u|0)!=(S|0);)if(f=u+32|0,u=l[f>>2]|0,!u)break t;l[f>>2]=l[g>>2]}Pe(S),l[E>>2]=(l[E>>2]|0)+-1}while(!1)}Pe(l[A>>2]|0)}function md(A){A=A|0;var u=0,f=0,g=0;for(g=l[A+4>>2]|0,f=0;;){if((f|0)>=(g|0)){u=0,f=4;break}if(u=l[(l[A>>2]|0)+(f<<2)>>2]|0,!u)f=f+1|0;else{f=4;break}}return(f|0)==4?u|0:0}function yd(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;if(f=~~(+et(+(+er(10,+ +(15-(l[A+12>>2]|0)|0))*(+M[u>>3]+ +M[u+8>>3])))%+(l[A+4>>2]|0))>>>0,f=(l[A>>2]|0)+(f<<2)|0,g=l[f>>2]|0,!g)return v=1,v|0;v=u+32|0;do if((g|0)!=(u|0)){if(f=l[g+32>>2]|0,!f)return v=1,v|0;for(m=f;;){if((m|0)==(u|0)){m=8;break}if(f=l[m+32>>2]|0,f)g=m,m=f;else{f=1,m=10;break}}if((m|0)==8){l[g+32>>2]=l[v>>2];break}else if((m|0)==10)return f|0}else l[f>>2]=l[v>>2];while(!1);return Pe(u),v=A+8|0,l[v>>2]=(l[v>>2]|0)+-1,v=0,v|0}function Sx(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;v=mn(40)|0,v||Ne(27872,27842,98,27885),l[v>>2]=l[u>>2],l[v+4>>2]=l[u+4>>2],l[v+8>>2]=l[u+8>>2],l[v+12>>2]=l[u+12>>2],m=v+16|0,l[m>>2]=l[f>>2],l[m+4>>2]=l[f+4>>2],l[m+8>>2]=l[f+8>>2],l[m+12>>2]=l[f+12>>2],l[v+32>>2]=0,m=~~(+et(+(+er(10,+ +(15-(l[A+12>>2]|0)|0))*(+M[u>>3]+ +M[u+8>>3])))%+(l[A+4>>2]|0))>>>0,m=(l[A>>2]|0)+(m<<2)|0,g=l[m>>2]|0;do if(!g)l[m>>2]=v;else{for(;!(ts(g,u)|0&&ts(g+16|0,f)|0);)if(m=l[g+32>>2]|0,g=(m|0)==0?g:m,!(l[g+32>>2]|0)){E=10;break}if((E|0)==10){l[g+32>>2]=v;break}return Pe(v),E=g,E|0}while(!1);return E=A+8|0,l[E>>2]=(l[E>>2]|0)+1,E=v,E|0}function bx(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0;if(m=~~(+et(+(+er(10,+ +(15-(l[A+12>>2]|0)|0))*(+M[u>>3]+ +M[u+8>>3])))%+(l[A+4>>2]|0))>>>0,m=l[(l[A>>2]|0)+(m<<2)>>2]|0,!m)return f=0,f|0;if(!f){for(A=m;;){if(ts(A,u)|0){g=10;break}if(A=l[A+32>>2]|0,!A){A=0,g=10;break}}if((g|0)==10)return A|0}for(A=m;;){if(ts(A,u)|0&&ts(A+16|0,f)|0){g=10;break}if(A=l[A+32>>2]|0,!A){A=0,g=10;break}}return(g|0)==10?A|0:0}function xx(A,u){A=A|0,u=u|0;var f=0;if(f=~~(+et(+(+er(10,+ +(15-(l[A+12>>2]|0)|0))*(+M[u>>3]+ +M[u+8>>3])))%+(l[A+4>>2]|0))>>>0,A=l[(l[A>>2]|0)+(f<<2)>>2]|0,!A)return f=0,f|0;for(;;){if(ts(A,u)|0){u=5;break}if(A=l[A+32>>2]|0,!A){A=0,u=5;break}}return(u|0)==5?A|0:0}function _x(){return 27904}function nr(A){return A=+A,~~+bd(+A)|0}function mn(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0,z=0,Z=0,ae=0,ie=0,J=0,q=0,ve=0;ve=O,O=O+16|0,V=ve;do if(A>>>0<245){if(I=A>>>0<11?16:A+11&-8,A=I>>>3,B=l[6977]|0,f=B>>>A,f&3|0)return u=(f&1^1)+A|0,A=27948+(u<<1<<2)|0,f=A+8|0,g=l[f>>2]|0,m=g+8|0,v=l[m>>2]|0,(v|0)==(A|0)?l[6977]=B&~(1<<u):(l[v+12>>2]=A,l[f>>2]=v),q=u<<3,l[g+4>>2]=q|3,q=g+q+4|0,l[q>>2]=l[q>>2]|1,q=m,O=ve,q|0;if(D=l[6979]|0,I>>>0>D>>>0){if(f|0)return u=2<<A,u=f<<A&(u|0-u),u=(u&0-u)+-1|0,S=u>>>12&16,u=u>>>S,f=u>>>5&8,u=u>>>f,v=u>>>2&4,u=u>>>v,A=u>>>1&2,u=u>>>A,g=u>>>1&1,g=(f|S|v|A|g)+(u>>>g)|0,u=27948+(g<<1<<2)|0,A=u+8|0,v=l[A>>2]|0,S=v+8|0,f=l[S>>2]|0,(f|0)==(u|0)?(A=B&~(1<<g),l[6977]=A):(l[f+12>>2]=u,l[A>>2]=f,A=B),q=g<<3,E=q-I|0,l[v+4>>2]=I|3,m=v+I|0,l[m+4>>2]=E|1,l[v+q>>2]=E,D|0&&(g=l[6982]|0,u=D>>>3,f=27948+(u<<1<<2)|0,u=1<<u,A&u?(A=f+8|0,u=l[A>>2]|0):(l[6977]=A|u,u=f,A=f+8|0),l[A>>2]=g,l[u+12>>2]=g,l[g+8>>2]=u,l[g+12>>2]=f),l[6979]=E,l[6982]=m,q=S,O=ve,q|0;if(v=l[6978]|0,v){for(f=(v&0-v)+-1|0,m=f>>>12&16,f=f>>>m,g=f>>>5&8,f=f>>>g,E=f>>>2&4,f=f>>>E,S=f>>>1&2,f=f>>>S,x=f>>>1&1,x=l[28212+((g|m|E|S|x)+(f>>>x)<<2)>>2]|0,f=x,S=x,x=(l[x+4>>2]&-8)-I|0;A=l[f+16>>2]|0,!(!A&&(A=l[f+20>>2]|0,!A));)E=(l[A+4>>2]&-8)-I|0,m=E>>>0<x>>>0,f=A,S=m?A:S,x=m?E:x;if(E=S+I|0,E>>>0>S>>>0){m=l[S+24>>2]|0,u=l[S+12>>2]|0;do if((u|0)==(S|0)){if(A=S+20|0,u=l[A>>2]|0,!u&&(A=S+16|0,u=l[A>>2]|0,!u)){f=0;break}for(;;)if(g=u+20|0,f=l[g>>2]|0,f)u=f,A=g;else if(g=u+16|0,f=l[g>>2]|0,f)u=f,A=g;else break;l[A>>2]=0,f=u}else f=l[S+8>>2]|0,l[f+12>>2]=u,l[u+8>>2]=f,f=u;while(!1);do if(m|0){if(u=l[S+28>>2]|0,A=28212+(u<<2)|0,(S|0)==(l[A>>2]|0)){if(l[A>>2]=f,!f){l[6978]=v&~(1<<u);break}}else if(q=m+16|0,l[((l[q>>2]|0)==(S|0)?q:m+20|0)>>2]=f,!f)break;l[f+24>>2]=m,u=l[S+16>>2]|0,u|0&&(l[f+16>>2]=u,l[u+24>>2]=f),u=l[S+20>>2]|0,u|0&&(l[f+20>>2]=u,l[u+24>>2]=f)}while(!1);return x>>>0<16?(q=x+I|0,l[S+4>>2]=q|3,q=S+q+4|0,l[q>>2]=l[q>>2]|1):(l[S+4>>2]=I|3,l[E+4>>2]=x|1,l[E+x>>2]=x,D|0&&(g=l[6982]|0,u=D>>>3,f=27948+(u<<1<<2)|0,u=1<<u,u&B?(A=f+8|0,u=l[A>>2]|0):(l[6977]=u|B,u=f,A=f+8|0),l[A>>2]=g,l[u+12>>2]=g,l[g+8>>2]=u,l[g+12>>2]=f),l[6979]=x,l[6982]=E),q=S+8|0,O=ve,q|0}else B=I}else B=I}else B=I}else if(A>>>0<=4294967231)if(A=A+11|0,I=A&-8,g=l[6978]|0,g){m=0-I|0,A=A>>>8,A?I>>>0>16777215?x=31:(B=(A+1048320|0)>>>16&8,z=A<<B,S=(z+520192|0)>>>16&4,z=z<<S,x=(z+245760|0)>>>16&2,x=14-(S|B|x)+(z<<x>>>15)|0,x=I>>>(x+7|0)&1|x<<1):x=0,f=l[28212+(x<<2)>>2]|0;e:do if(!f)f=0,A=0,z=61;else for(A=0,S=I<<((x|0)==31?0:25-(x>>>1)|0),v=0;;){if(E=(l[f+4>>2]&-8)-I|0,E>>>0<m>>>0)if(E)A=f,m=E;else{A=f,m=0,z=65;break e}if(z=l[f+20>>2]|0,f=l[f+16+(S>>>31<<2)>>2]|0,v=(z|0)==0|(z|0)==(f|0)?v:z,f)S=S<<1;else{f=v,z=61;break}}while(!1);if((z|0)==61){if((f|0)==0&(A|0)==0){if(A=2<<x,A=(A|0-A)&g,!A){B=I;break}B=(A&0-A)+-1|0,E=B>>>12&16,B=B>>>E,v=B>>>5&8,B=B>>>v,S=B>>>2&4,B=B>>>S,x=B>>>1&2,B=B>>>x,f=B>>>1&1,A=0,f=l[28212+((v|E|S|x|f)+(B>>>f)<<2)>>2]|0}f?z=65:(S=A,E=m)}if((z|0)==65)for(v=f;;)if(B=(l[v+4>>2]&-8)-I|0,f=B>>>0<m>>>0,m=f?B:m,A=f?v:A,f=l[v+16>>2]|0,f||(f=l[v+20>>2]|0),f)v=f;else{S=A,E=m;break}if((S|0)!=0&&E>>>0<((l[6979]|0)-I|0)>>>0&&(D=S+I|0,D>>>0>S>>>0)){v=l[S+24>>2]|0,u=l[S+12>>2]|0;do if((u|0)==(S|0)){if(A=S+20|0,u=l[A>>2]|0,!u&&(A=S+16|0,u=l[A>>2]|0,!u)){u=0;break}for(;;)if(m=u+20|0,f=l[m>>2]|0,f)u=f,A=m;else if(m=u+16|0,f=l[m>>2]|0,f)u=f,A=m;else break;l[A>>2]=0}else q=l[S+8>>2]|0,l[q+12>>2]=u,l[u+8>>2]=q;while(!1);do if(v){if(A=l[S+28>>2]|0,f=28212+(A<<2)|0,(S|0)==(l[f>>2]|0)){if(l[f>>2]=u,!u){g=g&~(1<<A),l[6978]=g;break}}else if(q=v+16|0,l[((l[q>>2]|0)==(S|0)?q:v+20|0)>>2]=u,!u)break;l[u+24>>2]=v,A=l[S+16>>2]|0,A|0&&(l[u+16>>2]=A,l[A+24>>2]=u),A=l[S+20>>2]|0,A&&(l[u+20>>2]=A,l[A+24>>2]=u)}while(!1);e:do if(E>>>0<16)q=E+I|0,l[S+4>>2]=q|3,q=S+q+4|0,l[q>>2]=l[q>>2]|1;else{if(l[S+4>>2]=I|3,l[D+4>>2]=E|1,l[D+E>>2]=E,u=E>>>3,E>>>0<256){f=27948+(u<<1<<2)|0,A=l[6977]|0,u=1<<u,A&u?(A=f+8|0,u=l[A>>2]|0):(l[6977]=A|u,u=f,A=f+8|0),l[A>>2]=D,l[u+12>>2]=D,l[D+8>>2]=u,l[D+12>>2]=f;break}if(u=E>>>8,u?E>>>0>16777215?f=31:(J=(u+1048320|0)>>>16&8,q=u<<J,ie=(q+520192|0)>>>16&4,q=q<<ie,f=(q+245760|0)>>>16&2,f=14-(ie|J|f)+(q<<f>>>15)|0,f=E>>>(f+7|0)&1|f<<1):f=0,u=28212+(f<<2)|0,l[D+28>>2]=f,A=D+16|0,l[A+4>>2]=0,l[A>>2]=0,A=1<<f,!(g&A)){l[6978]=g|A,l[u>>2]=D,l[D+24>>2]=u,l[D+12>>2]=D,l[D+8>>2]=D;break}u=l[u>>2]|0;t:do if((l[u+4>>2]&-8|0)!=(E|0)){for(g=E<<((f|0)==31?0:25-(f>>>1)|0);f=u+16+(g>>>31<<2)|0,A=l[f>>2]|0,!!A;)if((l[A+4>>2]&-8|0)==(E|0)){u=A;break t}else g=g<<1,u=A;l[f>>2]=D,l[D+24>>2]=u,l[D+12>>2]=D,l[D+8>>2]=D;break e}while(!1);J=u+8|0,q=l[J>>2]|0,l[q+12>>2]=D,l[J>>2]=D,l[D+8>>2]=q,l[D+12>>2]=u,l[D+24>>2]=0}while(!1);return q=S+8|0,O=ve,q|0}else B=I}else B=I;else B=-1;while(!1);if(f=l[6979]|0,f>>>0>=B>>>0)return u=f-B|0,A=l[6982]|0,u>>>0>15?(q=A+B|0,l[6982]=q,l[6979]=u,l[q+4>>2]=u|1,l[A+f>>2]=u,l[A+4>>2]=B|3):(l[6979]=0,l[6982]=0,l[A+4>>2]=f|3,q=A+f+4|0,l[q>>2]=l[q>>2]|1),q=A+8|0,O=ve,q|0;if(E=l[6980]|0,E>>>0>B>>>0)return ie=E-B|0,l[6980]=ie,q=l[6983]|0,J=q+B|0,l[6983]=J,l[J+4>>2]=ie|1,l[q+4>>2]=B|3,q=q+8|0,O=ve,q|0;if(l[7095]|0?A=l[7097]|0:(l[7097]=4096,l[7096]=4096,l[7098]=-1,l[7099]=-1,l[7100]=0,l[7088]=0,l[7095]=V&-16^1431655768,A=4096),S=B+48|0,x=B+47|0,v=A+x|0,m=0-A|0,I=v&m,I>>>0<=B>>>0||(A=l[7087]|0,A|0&&(D=l[7085]|0,V=D+I|0,V>>>0<=D>>>0|V>>>0>A>>>0)))return q=0,O=ve,q|0;e:do if(l[7088]&4)u=0,z=143;else{f=l[6983]|0;t:do if(f){for(g=28356;V=l[g>>2]|0,!(V>>>0<=f>>>0&&(V+(l[g+4>>2]|0)|0)>>>0>f>>>0);)if(A=l[g+8>>2]|0,A)g=A;else{z=128;break t}if(u=v-E&m,u>>>0<2147483647)if(A=or(u|0)|0,(A|0)==((l[g>>2]|0)+(l[g+4>>2]|0)|0)){if((A|0)!=-1){E=u,v=A,z=145;break e}}else g=A,z=136;else u=0}else z=128;while(!1);do if((z|0)==128)if(f=or(0)|0,(f|0)!=-1&&(u=f,H=l[7096]|0,j=H+-1|0,u=((j&u|0)==0?0:(j+u&0-H)-u|0)+I|0,H=l[7085]|0,j=u+H|0,u>>>0>B>>>0&u>>>0<2147483647)){if(V=l[7087]|0,V|0&&j>>>0<=H>>>0|j>>>0>V>>>0){u=0;break}if(A=or(u|0)|0,(A|0)==(f|0)){E=u,v=f,z=145;break e}else g=A,z=136}else u=0;while(!1);do if((z|0)==136){if(f=0-u|0,!(S>>>0>u>>>0&(u>>>0<2147483647&(g|0)!=-1)))if((g|0)==-1){u=0;break}else{E=u,v=g,z=145;break e}if(A=l[7097]|0,A=x-u+A&0-A,A>>>0>=2147483647){E=u,v=g,z=145;break e}if((or(A|0)|0)==-1){or(f|0)|0,u=0;break}else{E=A+u|0,v=g,z=145;break e}}while(!1);l[7088]=l[7088]|4,z=143}while(!1);if((z|0)==143&&I>>>0<2147483647&&(ie=or(I|0)|0,j=or(0)|0,Z=j-ie|0,ae=Z>>>0>(B+40|0)>>>0,!((ie|0)==-1|ae^1|ie>>>0<j>>>0&((ie|0)!=-1&(j|0)!=-1)^1))&&(E=ae?Z:u,v=ie,z=145),(z|0)==145){u=(l[7085]|0)+E|0,l[7085]=u,u>>>0>(l[7086]|0)>>>0&&(l[7086]=u),x=l[6983]|0;e:do if(x){for(u=28356;;){if(A=l[u>>2]|0,f=l[u+4>>2]|0,(v|0)==(A+f|0)){z=154;break}if(g=l[u+8>>2]|0,g)u=g;else break}if((z|0)==154&&(J=u+4|0,(l[u+12>>2]&8|0)==0)&&v>>>0>x>>>0&A>>>0<=x>>>0){l[J>>2]=f+E,q=(l[6980]|0)+E|0,ie=x+8|0,ie=(ie&7|0)==0?0:0-ie&7,J=x+ie|0,ie=q-ie|0,l[6983]=J,l[6980]=ie,l[J+4>>2]=ie|1,l[x+q+4>>2]=40,l[6984]=l[7099];break}for(v>>>0<(l[6981]|0)>>>0&&(l[6981]=v),f=v+E|0,u=28356;;){if((l[u>>2]|0)==(f|0)){z=162;break}if(A=l[u+8>>2]|0,A)u=A;else break}if((z|0)==162&&(l[u+12>>2]&8|0)==0){l[u>>2]=v,D=u+4|0,l[D>>2]=(l[D>>2]|0)+E,D=v+8|0,D=v+((D&7|0)==0?0:0-D&7)|0,u=f+8|0,u=f+((u&7|0)==0?0:0-u&7)|0,I=D+B|0,S=u-D-B|0,l[D+4>>2]=B|3;t:do if((x|0)==(u|0))q=(l[6980]|0)+S|0,l[6980]=q,l[6983]=I,l[I+4>>2]=q|1;else{if((l[6982]|0)==(u|0)){q=(l[6979]|0)+S|0,l[6979]=q,l[6982]=I,l[I+4>>2]=q|1,l[I+q>>2]=q;break}if(A=l[u+4>>2]|0,(A&3|0)==1){E=A&-8,g=A>>>3;i:do if(A>>>0<256)if(A=l[u+8>>2]|0,f=l[u+12>>2]|0,(f|0)==(A|0)){l[6977]=l[6977]&~(1<<g);break}else{l[A+12>>2]=f,l[f+8>>2]=A;break}else{v=l[u+24>>2]|0,A=l[u+12>>2]|0;do if((A|0)==(u|0)){if(f=u+16|0,g=f+4|0,A=l[g>>2]|0,A)f=g;else if(A=l[f>>2]|0,!A){A=0;break}for(;;)if(m=A+20|0,g=l[m>>2]|0,g)A=g,f=m;else if(m=A+16|0,g=l[m>>2]|0,g)A=g,f=m;else break;l[f>>2]=0}else q=l[u+8>>2]|0,l[q+12>>2]=A,l[A+8>>2]=q;while(!1);if(!v)break;f=l[u+28>>2]|0,g=28212+(f<<2)|0;do if((l[g>>2]|0)!=(u|0)){if(q=v+16|0,l[((l[q>>2]|0)==(u|0)?q:v+20|0)>>2]=A,!A)break i}else{if(l[g>>2]=A,A|0)break;l[6978]=l[6978]&~(1<<f);break i}while(!1);if(l[A+24>>2]=v,f=u+16|0,g=l[f>>2]|0,g|0&&(l[A+16>>2]=g,l[g+24>>2]=A),f=l[f+4>>2]|0,!f)break;l[A+20>>2]=f,l[f+24>>2]=A}while(!1);u=u+E|0,m=E+S|0}else m=S;if(u=u+4|0,l[u>>2]=l[u>>2]&-2,l[I+4>>2]=m|1,l[I+m>>2]=m,u=m>>>3,m>>>0<256){f=27948+(u<<1<<2)|0,A=l[6977]|0,u=1<<u,A&u?(A=f+8|0,u=l[A>>2]|0):(l[6977]=A|u,u=f,A=f+8|0),l[A>>2]=I,l[u+12>>2]=I,l[I+8>>2]=u,l[I+12>>2]=f;break}u=m>>>8;do if(!u)g=0;else{if(m>>>0>16777215){g=31;break}J=(u+1048320|0)>>>16&8,q=u<<J,ie=(q+520192|0)>>>16&4,q=q<<ie,g=(q+245760|0)>>>16&2,g=14-(ie|J|g)+(q<<g>>>15)|0,g=m>>>(g+7|0)&1|g<<1}while(!1);if(u=28212+(g<<2)|0,l[I+28>>2]=g,A=I+16|0,l[A+4>>2]=0,l[A>>2]=0,A=l[6978]|0,f=1<<g,!(A&f)){l[6978]=A|f,l[u>>2]=I,l[I+24>>2]=u,l[I+12>>2]=I,l[I+8>>2]=I;break}u=l[u>>2]|0;i:do if((l[u+4>>2]&-8|0)!=(m|0)){for(g=m<<((g|0)==31?0:25-(g>>>1)|0);f=u+16+(g>>>31<<2)|0,A=l[f>>2]|0,!!A;)if((l[A+4>>2]&-8|0)==(m|0)){u=A;break i}else g=g<<1,u=A;l[f>>2]=I,l[I+24>>2]=u,l[I+12>>2]=I,l[I+8>>2]=I;break t}while(!1);J=u+8|0,q=l[J>>2]|0,l[q+12>>2]=I,l[J>>2]=I,l[I+8>>2]=q,l[I+12>>2]=u,l[I+24>>2]=0}while(!1);return q=D+8|0,O=ve,q|0}for(u=28356;A=l[u>>2]|0,!(A>>>0<=x>>>0&&(q=A+(l[u+4>>2]|0)|0,q>>>0>x>>>0));)u=l[u+8>>2]|0;m=q+-47|0,A=m+8|0,A=m+((A&7|0)==0?0:0-A&7)|0,m=x+16|0,A=A>>>0<m>>>0?x:A,u=A+8|0,f=E+-40|0,ie=v+8|0,ie=(ie&7|0)==0?0:0-ie&7,J=v+ie|0,ie=f-ie|0,l[6983]=J,l[6980]=ie,l[J+4>>2]=ie|1,l[v+f+4>>2]=40,l[6984]=l[7099],f=A+4|0,l[f>>2]=27,l[u>>2]=l[7089],l[u+4>>2]=l[7090],l[u+8>>2]=l[7091],l[u+12>>2]=l[7092],l[7089]=v,l[7090]=E,l[7092]=0,l[7091]=u,u=A+24|0;do J=u,u=u+4|0,l[u>>2]=7;while((J+8|0)>>>0<q>>>0);if((A|0)!=(x|0)){if(v=A-x|0,l[f>>2]=l[f>>2]&-2,l[x+4>>2]=v|1,l[A>>2]=v,u=v>>>3,v>>>0<256){f=27948+(u<<1<<2)|0,A=l[6977]|0,u=1<<u,A&u?(A=f+8|0,u=l[A>>2]|0):(l[6977]=A|u,u=f,A=f+8|0),l[A>>2]=x,l[u+12>>2]=x,l[x+8>>2]=u,l[x+12>>2]=f;break}if(u=v>>>8,u?v>>>0>16777215?g=31:(J=(u+1048320|0)>>>16&8,q=u<<J,ie=(q+520192|0)>>>16&4,q=q<<ie,g=(q+245760|0)>>>16&2,g=14-(ie|J|g)+(q<<g>>>15)|0,g=v>>>(g+7|0)&1|g<<1):g=0,f=28212+(g<<2)|0,l[x+28>>2]=g,l[x+20>>2]=0,l[m>>2]=0,u=l[6978]|0,A=1<<g,!(u&A)){l[6978]=u|A,l[f>>2]=x,l[x+24>>2]=f,l[x+12>>2]=x,l[x+8>>2]=x;break}u=l[f>>2]|0;t:do if((l[u+4>>2]&-8|0)!=(v|0)){for(g=v<<((g|0)==31?0:25-(g>>>1)|0);f=u+16+(g>>>31<<2)|0,A=l[f>>2]|0,!!A;)if((l[A+4>>2]&-8|0)==(v|0)){u=A;break t}else g=g<<1,u=A;l[f>>2]=x,l[x+24>>2]=u,l[x+12>>2]=x,l[x+8>>2]=x;break e}while(!1);J=u+8|0,q=l[J>>2]|0,l[q+12>>2]=x,l[J>>2]=x,l[x+8>>2]=q,l[x+12>>2]=u,l[x+24>>2]=0}}else q=l[6981]|0,(q|0)==0|v>>>0<q>>>0&&(l[6981]=v),l[7089]=v,l[7090]=E,l[7092]=0,l[6986]=l[7095],l[6985]=-1,l[6990]=27948,l[6989]=27948,l[6992]=27956,l[6991]=27956,l[6994]=27964,l[6993]=27964,l[6996]=27972,l[6995]=27972,l[6998]=27980,l[6997]=27980,l[7e3]=27988,l[6999]=27988,l[7002]=27996,l[7001]=27996,l[7004]=28004,l[7003]=28004,l[7006]=28012,l[7005]=28012,l[7008]=28020,l[7007]=28020,l[7010]=28028,l[7009]=28028,l[7012]=28036,l[7011]=28036,l[7014]=28044,l[7013]=28044,l[7016]=28052,l[7015]=28052,l[7018]=28060,l[7017]=28060,l[7020]=28068,l[7019]=28068,l[7022]=28076,l[7021]=28076,l[7024]=28084,l[7023]=28084,l[7026]=28092,l[7025]=28092,l[7028]=28100,l[7027]=28100,l[7030]=28108,l[7029]=28108,l[7032]=28116,l[7031]=28116,l[7034]=28124,l[7033]=28124,l[7036]=28132,l[7035]=28132,l[7038]=28140,l[7037]=28140,l[7040]=28148,l[7039]=28148,l[7042]=28156,l[7041]=28156,l[7044]=28164,l[7043]=28164,l[7046]=28172,l[7045]=28172,l[7048]=28180,l[7047]=28180,l[7050]=28188,l[7049]=28188,l[7052]=28196,l[7051]=28196,q=E+-40|0,ie=v+8|0,ie=(ie&7|0)==0?0:0-ie&7,J=v+ie|0,ie=q-ie|0,l[6983]=J,l[6980]=ie,l[J+4>>2]=ie|1,l[v+q+4>>2]=40,l[6984]=l[7099];while(!1);if(u=l[6980]|0,u>>>0>B>>>0)return ie=u-B|0,l[6980]=ie,q=l[6983]|0,J=q+B|0,l[6983]=J,l[J+4>>2]=ie|1,l[q+4>>2]=B|3,q=q+8|0,O=ve,q|0}return q=_x()|0,l[q>>2]=12,q=0,O=ve,q|0}function Pe(A){A=A|0;var u=0,f=0,g=0,m=0,v=0,E=0,S=0,x=0;if(A){f=A+-8|0,m=l[6981]|0,A=l[A+-4>>2]|0,u=A&-8,x=f+u|0;do if(A&1)S=f,E=f;else{if(g=l[f>>2]|0,!(A&3)||(E=f+(0-g)|0,v=g+u|0,E>>>0<m>>>0))return;if((l[6982]|0)==(E|0)){if(A=x+4|0,u=l[A>>2]|0,(u&3|0)!=3){S=E,u=v;break}l[6979]=v,l[A>>2]=u&-2,l[E+4>>2]=v|1,l[E+v>>2]=v;return}if(f=g>>>3,g>>>0<256)if(A=l[E+8>>2]|0,u=l[E+12>>2]|0,(u|0)==(A|0)){l[6977]=l[6977]&~(1<<f),S=E,u=v;break}else{l[A+12>>2]=u,l[u+8>>2]=A,S=E,u=v;break}m=l[E+24>>2]|0,A=l[E+12>>2]|0;do if((A|0)==(E|0)){if(u=E+16|0,f=u+4|0,A=l[f>>2]|0,A)u=f;else if(A=l[u>>2]|0,!A){A=0;break}for(;;)if(g=A+20|0,f=l[g>>2]|0,f)A=f,u=g;else if(g=A+16|0,f=l[g>>2]|0,f)A=f,u=g;else break;l[u>>2]=0}else S=l[E+8>>2]|0,l[S+12>>2]=A,l[A+8>>2]=S;while(!1);if(m){if(u=l[E+28>>2]|0,f=28212+(u<<2)|0,(l[f>>2]|0)==(E|0)){if(l[f>>2]=A,!A){l[6978]=l[6978]&~(1<<u),S=E,u=v;break}}else if(S=m+16|0,l[((l[S>>2]|0)==(E|0)?S:m+20|0)>>2]=A,!A){S=E,u=v;break}l[A+24>>2]=m,u=E+16|0,f=l[u>>2]|0,f|0&&(l[A+16>>2]=f,l[f+24>>2]=A),u=l[u+4>>2]|0,u?(l[A+20>>2]=u,l[u+24>>2]=A,S=E,u=v):(S=E,u=v)}else S=E,u=v}while(!1);if(!(E>>>0>=x>>>0)&&(A=x+4|0,g=l[A>>2]|0,!!(g&1))){if(g&2)l[A>>2]=g&-2,l[S+4>>2]=u|1,l[E+u>>2]=u,m=u;else{if((l[6983]|0)==(x|0)){if(x=(l[6980]|0)+u|0,l[6980]=x,l[6983]=S,l[S+4>>2]=x|1,(S|0)!=(l[6982]|0))return;l[6982]=0,l[6979]=0;return}if((l[6982]|0)==(x|0)){x=(l[6979]|0)+u|0,l[6979]=x,l[6982]=E,l[S+4>>2]=x|1,l[E+x>>2]=x;return}m=(g&-8)+u|0,f=g>>>3;do if(g>>>0<256)if(u=l[x+8>>2]|0,A=l[x+12>>2]|0,(A|0)==(u|0)){l[6977]=l[6977]&~(1<<f);break}else{l[u+12>>2]=A,l[A+8>>2]=u;break}else{v=l[x+24>>2]|0,A=l[x+12>>2]|0;do if((A|0)==(x|0)){if(u=x+16|0,f=u+4|0,A=l[f>>2]|0,A)u=f;else if(A=l[u>>2]|0,!A){f=0;break}for(;;)if(g=A+20|0,f=l[g>>2]|0,f)A=f,u=g;else if(g=A+16|0,f=l[g>>2]|0,f)A=f,u=g;else break;l[u>>2]=0,f=A}else f=l[x+8>>2]|0,l[f+12>>2]=A,l[A+8>>2]=f,f=A;while(!1);if(v|0){if(A=l[x+28>>2]|0,u=28212+(A<<2)|0,(l[u>>2]|0)==(x|0)){if(l[u>>2]=f,!f){l[6978]=l[6978]&~(1<<A);break}}else if(g=v+16|0,l[((l[g>>2]|0)==(x|0)?g:v+20|0)>>2]=f,!f)break;l[f+24>>2]=v,A=x+16|0,u=l[A>>2]|0,u|0&&(l[f+16>>2]=u,l[u+24>>2]=f),A=l[A+4>>2]|0,A|0&&(l[f+20>>2]=A,l[A+24>>2]=f)}}while(!1);if(l[S+4>>2]=m|1,l[E+m>>2]=m,(S|0)==(l[6982]|0)){l[6979]=m;return}}if(A=m>>>3,m>>>0<256){f=27948+(A<<1<<2)|0,u=l[6977]|0,A=1<<A,u&A?(u=f+8|0,A=l[u>>2]|0):(l[6977]=u|A,A=f,u=f+8|0),l[u>>2]=S,l[A+12>>2]=S,l[S+8>>2]=A,l[S+12>>2]=f;return}A=m>>>8,A?m>>>0>16777215?g=31:(E=(A+1048320|0)>>>16&8,x=A<<E,v=(x+520192|0)>>>16&4,x=x<<v,g=(x+245760|0)>>>16&2,g=14-(v|E|g)+(x<<g>>>15)|0,g=m>>>(g+7|0)&1|g<<1):g=0,A=28212+(g<<2)|0,l[S+28>>2]=g,l[S+20>>2]=0,l[S+16>>2]=0,u=l[6978]|0,f=1<<g;e:do if(!(u&f))l[6978]=u|f,l[A>>2]=S,l[S+24>>2]=A,l[S+12>>2]=S,l[S+8>>2]=S;else{A=l[A>>2]|0;t:do if((l[A+4>>2]&-8|0)!=(m|0)){for(g=m<<((g|0)==31?0:25-(g>>>1)|0);f=A+16+(g>>>31<<2)|0,u=l[f>>2]|0,!!u;)if((l[u+4>>2]&-8|0)==(m|0)){A=u;break t}else g=g<<1,A=u;l[f>>2]=S,l[S+24>>2]=A,l[S+12>>2]=S,l[S+8>>2]=S;break e}while(!1);E=A+8|0,x=l[E>>2]|0,l[x+12>>2]=S,l[E>>2]=S,l[S+8>>2]=x,l[S+12>>2]=A,l[S+24>>2]=0}while(!1);if(x=(l[6985]|0)+-1|0,l[6985]=x,!(x|0)){for(A=28364;A=l[A>>2]|0,A;)A=A+8|0;l[6985]=-1}}}}function Ti(A,u){A=A|0,u=u|0;var f=0;return A?(f=gn(u,A)|0,(u|A)>>>0>65535&&(f=((f>>>0)/(A>>>0)|0|0)==(u|0)?f:-1)):f=0,A=mn(f)|0,!A||!(l[A+-4>>2]&3)||sr(A|0,0,f|0)|0,A|0}function Ce(A,u,f,g){return A=A|0,u=u|0,f=f|0,g=g|0,f=A+f>>>0,Qe(u+g+(f>>>0<A>>>0|0)>>>0|0),f|0|0}function Jt(A,u,f,g){return A=A|0,u=u|0,f=f|0,g=g|0,g=u-g-(f>>>0>A>>>0|0)>>>0,Qe(g|0),A-f>>>0|0|0}function vd(A){return A=A|0,(A?31-(Mn(A^A-1)|0)|0:32)|0}function vu(A,u,f,g,m){A=A|0,u=u|0,f=f|0,g=g|0,m=m|0;var v=0,E=0,S=0,x=0,I=0,D=0,B=0,V=0,H=0,j=0;if(D=A,x=u,I=x,E=f,V=g,S=V,!I)return v=(m|0)!=0,S?v?(l[m>>2]=A|0,l[m+4>>2]=u&0,V=0,m=0,Qe(V|0),m|0):(V=0,m=0,Qe(V|0),m|0):(v&&(l[m>>2]=(D>>>0)%(E>>>0),l[m+4>>2]=0),V=0,m=(D>>>0)/(E>>>0)>>>0,Qe(V|0),m|0);v=(S|0)==0;do if(E){if(!v){if(v=(Mn(S|0)|0)-(Mn(I|0)|0)|0,v>>>0<=31){B=v+1|0,S=31-v|0,u=v-31>>31,E=B,A=D>>>(B>>>0)&u|I<<S,u=I>>>(B>>>0)&u,v=0,S=D<<S;break}return m?(l[m>>2]=A|0,l[m+4>>2]=x|u&0,V=0,m=0,Qe(V|0),m|0):(V=0,m=0,Qe(V|0),m|0)}if(v=E-1|0,v&E|0){S=(Mn(E|0)|0)+33-(Mn(I|0)|0)|0,j=64-S|0,B=32-S|0,x=B>>31,H=S-32|0,u=H>>31,E=S,A=B-1>>31&I>>>(H>>>0)|(I<<B|D>>>(S>>>0))&u,u=u&I>>>(S>>>0),v=D<<j&x,S=(I<<j|D>>>(H>>>0))&x|D<<B&S-33>>31;break}return m|0&&(l[m>>2]=v&D,l[m+4>>2]=0),(E|0)==1?(H=x|u&0,j=A|0|0,Qe(H|0),j|0):(j=vd(E|0)|0,H=I>>>(j>>>0)|0,j=I<<32-j|D>>>(j>>>0)|0,Qe(H|0),j|0)}else{if(v)return m|0&&(l[m>>2]=(I>>>0)%(E>>>0),l[m+4>>2]=0),H=0,j=(I>>>0)/(E>>>0)>>>0,Qe(H|0),j|0;if(!D)return m|0&&(l[m>>2]=0,l[m+4>>2]=(I>>>0)%(S>>>0)),H=0,j=(I>>>0)/(S>>>0)>>>0,Qe(H|0),j|0;if(v=S-1|0,!(v&S))return m|0&&(l[m>>2]=A|0,l[m+4>>2]=v&I|u&0),H=0,j=I>>>((vd(S|0)|0)>>>0),Qe(H|0),j|0;if(v=(Mn(S|0)|0)-(Mn(I|0)|0)|0,v>>>0<=30){u=v+1|0,S=31-v|0,E=u,A=I<<S|D>>>(u>>>0),u=I>>>(u>>>0),v=0,S=D<<S;break}return m?(l[m>>2]=A|0,l[m+4>>2]=x|u&0,H=0,j=0,Qe(H|0),j|0):(H=0,j=0,Qe(H|0),j|0)}while(!1);if(!E)I=S,x=0,S=0;else{B=f|0|0,D=V|g&0,I=Ce(B|0,D|0,-1,-1)|0,f=N()|0,x=S,S=0;do g=x,x=v>>>31|x<<1,v=S|v<<1,g=A<<1|g>>>31|0,V=A>>>31|u<<1|0,Jt(I|0,f|0,g|0,V|0)|0,j=N()|0,H=j>>31|((j|0)<0?-1:0)<<1,S=H&1,A=Jt(g|0,V|0,H&B|0,(((j|0)<0?-1:0)>>31|((j|0)<0?-1:0)<<1)&D|0)|0,u=N()|0,E=E-1|0;while((E|0)!=0);I=x,x=0}return E=0,m|0&&(l[m>>2]=A,l[m+4>>2]=u),H=(v|0)>>>31|(I|E)<<1|(E<<1|v>>>31)&0|x,j=(v<<1|0)&-2|S,Qe(H|0),j|0}function rr(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0;return I=u>>31|((u|0)<0?-1:0)<<1,x=((u|0)<0?-1:0)>>31|((u|0)<0?-1:0)<<1,v=g>>31|((g|0)<0?-1:0)<<1,m=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,S=Jt(I^A|0,x^u|0,I|0,x|0)|0,E=N()|0,A=v^I,u=m^x,Jt((vu(S,E,Jt(v^f|0,m^g|0,v|0,m|0)|0,N()|0,0)|0)^A|0,(N()|0)^u|0,A|0,u|0)|0}function wx(A,u){A=A|0,u=u|0;var f=0,g=0,m=0,v=0;return v=A&65535,m=u&65535,f=gn(m,v)|0,g=A>>>16,A=(f>>>16)+(gn(m,g)|0)|0,m=u>>>16,u=gn(m,v)|0,Qe((A>>>16)+(gn(m,g)|0)+(((A&65535)+u|0)>>>16)|0),A+u<<16|f&65535|0|0}function qt(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0;return m=A,v=f,f=wx(m,v)|0,A=N()|0,Qe((gn(u,v)|0)+(gn(g,m)|0)+A|A&0|0),f|0|0|0}function is(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0,E=0,S=0,x=0,I=0;return m=O,O=O+16|0,S=m|0,E=u>>31|((u|0)<0?-1:0)<<1,v=((u|0)<0?-1:0)>>31|((u|0)<0?-1:0)<<1,I=g>>31|((g|0)<0?-1:0)<<1,x=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,A=Jt(E^A|0,v^u|0,E|0,v|0)|0,u=N()|0,vu(A,u,Jt(I^f|0,x^g|0,I|0,x|0)|0,N()|0,S)|0,g=Jt(l[S>>2]^E|0,l[S+4>>2]^v|0,E|0,v|0)|0,f=N()|0,O=m,Qe(f|0),g|0}function ns(A,u,f,g){A=A|0,u=u|0,f=f|0,g=g|0;var m=0,v=0;return v=O,O=O+16|0,m=v|0,vu(A,u,f,g,m)|0,O=v,Qe(l[m+4>>2]|0),l[m>>2]|0|0}function Ed(A,u,f){return A=A|0,u=u|0,f=f|0,(f|0)<32?(Qe(u>>f|0),A>>>f|(u&(1<<f)-1)<<32-f):(Qe(((u|0)<0?-1:0)|0),u>>f-32|0)}function he(A,u,f){return A=A|0,u=u|0,f=f|0,(f|0)<32?(Qe(u>>>f|0),A>>>f|(u&(1<<f)-1)<<32-f):(Qe(0),u>>>f-32|0)}function Ee(A,u,f){return A=A|0,u=u|0,f=f|0,(f|0)<32?(Qe(u<<f|(A&(1<<f)-1<<32-f)>>>32-f|0),A<<f):(Qe(A<<f-32|0),0)}function Td(A,u,f){return A=A|0,u=u|0,u=Mn(u)|0,(u|0)==32&&(u=u+(Mn(A)|0)|0),Qe(0),u|0}function Sd(A,u){return A=+A,u=+u,A!=A?+u:u!=u?+A:+MS(+A,+u)}function Ma(A,u){return A=+A,u=+u,A!=A?+u:u!=u?+A:+Yl(+A,+u)}function Oa(A){return A=+A,A>=0?+Yt(A+.5):+Xr(A-.5)}function rs(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0;if((f|0)>=8192)return FS(A|0,u|0,f|0)|0,A|0;if(v=A|0,m=A+f|0,(A&3)==(u&3)){for(;A&3;){if(!f)return v|0;de[A>>0]=de[u>>0]|0,A=A+1|0,u=u+1|0,f=f-1|0}for(f=m&-4|0,g=f-64|0;(A|0)<=(g|0);)l[A>>2]=l[u>>2],l[A+4>>2]=l[u+4>>2],l[A+8>>2]=l[u+8>>2],l[A+12>>2]=l[u+12>>2],l[A+16>>2]=l[u+16>>2],l[A+20>>2]=l[u+20>>2],l[A+24>>2]=l[u+24>>2],l[A+28>>2]=l[u+28>>2],l[A+32>>2]=l[u+32>>2],l[A+36>>2]=l[u+36>>2],l[A+40>>2]=l[u+40>>2],l[A+44>>2]=l[u+44>>2],l[A+48>>2]=l[u+48>>2],l[A+52>>2]=l[u+52>>2],l[A+56>>2]=l[u+56>>2],l[A+60>>2]=l[u+60>>2],A=A+64|0,u=u+64|0;for(;(A|0)<(f|0);)l[A>>2]=l[u>>2],A=A+4|0,u=u+4|0}else for(f=m-4|0;(A|0)<(f|0);)de[A>>0]=de[u>>0]|0,de[A+1>>0]=de[u+1>>0]|0,de[A+2>>0]=de[u+2>>0]|0,de[A+3>>0]=de[u+3>>0]|0,A=A+4|0,u=u+4|0;for(;(A|0)<(m|0);)de[A>>0]=de[u>>0]|0,A=A+1|0,u=u+1|0;return v|0}function sr(A,u,f){A=A|0,u=u|0,f=f|0;var g=0,m=0,v=0,E=0;if(v=A+f|0,u=u&255,(f|0)>=67){for(;A&3;)de[A>>0]=u,A=A+1|0;for(g=v&-4|0,E=u|u<<8|u<<16|u<<24,m=g-64|0;(A|0)<=(m|0);)l[A>>2]=E,l[A+4>>2]=E,l[A+8>>2]=E,l[A+12>>2]=E,l[A+16>>2]=E,l[A+20>>2]=E,l[A+24>>2]=E,l[A+28>>2]=E,l[A+32>>2]=E,l[A+36>>2]=E,l[A+40>>2]=E,l[A+44>>2]=E,l[A+48>>2]=E,l[A+52>>2]=E,l[A+56>>2]=E,l[A+60>>2]=E,A=A+64|0;for(;(A|0)<(g|0);)l[A>>2]=E,A=A+4|0}for(;(A|0)<(v|0);)de[A>>0]=u,A=A+1|0;return v-f|0}function bd(A){return A=+A,A>=0?+Yt(A+.5):+Xr(A-.5)}function or(A){A=A|0;var u=0,f=0,g=0;return g=OS()|0,f=l[ht>>2]|0,u=f+A|0,(A|0)>0&(u|0)<(f|0)|(u|0)<0?(NS(u|0)|0,Ph(12),-1):(u|0)>(g|0)&&!(BS(u|0)|0)?(Ph(12),-1):(l[ht>>2]=u,f|0)}return{___divdi3:rr,___muldi3:qt,___remdi3:is,___uremdi3:ns,_areNeighborCells:gb,_bitshift64Ashr:Ed,_bitshift64Lshr:he,_bitshift64Shl:Ee,_calloc:Ti,_cellAreaKm2:Qb,_cellAreaM2:Wb,_cellAreaRads2:gu,_cellToBoundary:es,_cellToCenterChild:td,_cellToChildPos:Bb,_cellToChildren:Lb,_cellToChildrenSize:to,_cellToLatLng:wr,_cellToLocalIj:ex,_cellToParent:au,_cellToVertex:Qi,_cellToVertexes:vx,_cellsToDirectedEdge:pb,_cellsToLinkedMultiPolygon:qS,_childPosToCell:Nb,_compactCells:Rb,_destroyLinkedMultiPolygon:od,_directedEdgeToBoundary:Da,_directedEdgeToCells:Eb,_edgeLengthKm:zb,_edgeLengthM:qb,_edgeLengthRads:Yb,_emscripten_replace_memory:US,_free:Pe,_getBaseCellNumber:Jh,_getDirectedEdgeDestination:yb,_getDirectedEdgeOrigin:mb,_getHexagonAreaAvgKm2:rd,_getHexagonAreaAvgM2:Hb,_getHexagonEdgeLengthAvgKm:jb,_getHexagonEdgeLengthAvgM:Kb,_getIcosahedronFaces:id,_getNumCells:Ca,_getPentagons:cu,_getRes0Cells:tb,_getResolution:Ib,_greatCircleDistanceKm:no,_greatCircleDistanceM:$b,_greatCircleDistanceRads:Ub,_gridDisk:kh,_gridDiskDistances:Mh,_gridDistance:ix,_gridPathCells:rx,_gridPathCellsSize:nx,_gridRing:KS,_gridRingUnsafe:Fh,_i64Add:Ce,_i64Subtract:Jt,_isPentagon:mt,_isResClassIII:Pb,_isValidCell:su,_isValidDirectedEdge:vb,_isValidVertex:Tx,_latLngToCell:uu,_llvm_ctlz_i64:Td,_llvm_maxnum_f64:Sd,_llvm_minnum_f64:Ma,_llvm_round_f64:Oa,_localIjToCell:tx,_malloc:mn,_maxFaceCount:Ob,_maxGridDiskSize:jS,_maxPolygonToCellsSize:WS,_maxPolygonToCellsSizeExperimental:ax,_memcpy:rs,_memset:sr,_originToDirectedEdges:Tb,_pentagonCount:Fb,_polygonToCells:YS,_polygonToCellsExperimental:ox,_readInt64AsDoubleFromPointer:gx,_res0CellCount:eb,_round:bd,_sbrk:or,_sizeOfCellBoundary:ux,_sizeOfCoordIJ:dx,_sizeOfGeoLoop:fx,_sizeOfGeoPolygon:cx,_sizeOfH3Index:Ax,_sizeOfLatLng:lx,_sizeOfLinkedGeoPolygon:hx,_uncompactCells:Db,_uncompactCellsSize:Cb,_vertexToLatLng:Ex,establishStackSpace:HS,stackAlloc:$S,stackRestore:VS,stackSave:GS}})(LS,RS,K);e.___divdi3=me.___divdi3,e.___muldi3=me.___muldi3,e.___remdi3=me.___remdi3,e.___uremdi3=me.___uremdi3,e._areNeighborCells=me._areNeighborCells,e._bitshift64Ashr=me._bitshift64Ashr,e._bitshift64Lshr=me._bitshift64Lshr,e._bitshift64Shl=me._bitshift64Shl,e._calloc=me._calloc,e._cellAreaKm2=me._cellAreaKm2,e._cellAreaM2=me._cellAreaM2,e._cellAreaRads2=me._cellAreaRads2,e._cellToBoundary=me._cellToBoundary,e._cellToCenterChild=me._cellToCenterChild,e._cellToChildPos=me._cellToChildPos,e._cellToChildren=me._cellToChildren,e._cellToChildrenSize=me._cellToChildrenSize,e._cellToLatLng=me._cellToLatLng,e._cellToLocalIj=me._cellToLocalIj,e._cellToParent=me._cellToParent,e._cellToVertex=me._cellToVertex,e._cellToVertexes=me._cellToVertexes,e._cellsToDirectedEdge=me._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=me._cellsToLinkedMultiPolygon,e._childPosToCell=me._childPosToCell,e._compactCells=me._compactCells,e._destroyLinkedMultiPolygon=me._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=me._directedEdgeToBoundary,e._directedEdgeToCells=me._directedEdgeToCells,e._edgeLengthKm=me._edgeLengthKm,e._edgeLengthM=me._edgeLengthM,e._edgeLengthRads=me._edgeLengthRads;var DS=e._emscripten_replace_memory=me._emscripten_replace_memory;e._free=me._free,e._getBaseCellNumber=me._getBaseCellNumber,e._getDirectedEdgeDestination=me._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=me._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=me._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=me._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=me._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=me._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=me._getIcosahedronFaces,e._getNumCells=me._getNumCells,e._getPentagons=me._getPentagons,e._getRes0Cells=me._getRes0Cells,e._getResolution=me._getResolution,e._greatCircleDistanceKm=me._greatCircleDistanceKm,e._greatCircleDistanceM=me._greatCircleDistanceM,e._greatCircleDistanceRads=me._greatCircleDistanceRads,e._gridDisk=me._gridDisk,e._gridDiskDistances=me._gridDiskDistances,e._gridDistance=me._gridDistance,e._gridPathCells=me._gridPathCells,e._gridPathCellsSize=me._gridPathCellsSize,e._gridRing=me._gridRing,e._gridRingUnsafe=me._gridRingUnsafe,e._i64Add=me._i64Add,e._i64Subtract=me._i64Subtract,e._isPentagon=me._isPentagon,e._isResClassIII=me._isResClassIII,e._isValidCell=me._isValidCell,e._isValidDirectedEdge=me._isValidDirectedEdge,e._isValidVertex=me._isValidVertex,e._latLngToCell=me._latLngToCell,e._llvm_ctlz_i64=me._llvm_ctlz_i64,e._llvm_maxnum_f64=me._llvm_maxnum_f64,e._llvm_minnum_f64=me._llvm_minnum_f64,e._llvm_round_f64=me._llvm_round_f64,e._localIjToCell=me._localIjToCell,e._malloc=me._malloc,e._maxFaceCount=me._maxFaceCount,e._maxGridDiskSize=me._maxGridDiskSize,e._maxPolygonToCellsSize=me._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=me._maxPolygonToCellsSizeExperimental,e._memcpy=me._memcpy,e._memset=me._memset,e._originToDirectedEdges=me._originToDirectedEdges,e._pentagonCount=me._pentagonCount,e._polygonToCells=me._polygonToCells,e._polygonToCellsExperimental=me._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=me._readInt64AsDoubleFromPointer,e._res0CellCount=me._res0CellCount,e._round=me._round,e._sbrk=me._sbrk,e._sizeOfCellBoundary=me._sizeOfCellBoundary,e._sizeOfCoordIJ=me._sizeOfCoordIJ,e._sizeOfGeoLoop=me._sizeOfGeoLoop,e._sizeOfGeoPolygon=me._sizeOfGeoPolygon,e._sizeOfH3Index=me._sizeOfH3Index,e._sizeOfLatLng=me._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=me._sizeOfLinkedGeoPolygon,e._uncompactCells=me._uncompactCells,e._uncompactCellsSize=me._uncompactCellsSize,e._vertexToLatLng=me._vertexToLatLng,e.establishStackSpace=me.establishStackSpace;var Lh=e.stackAlloc=me.stackAlloc,CS=e.stackRestore=me.stackRestore,PS=e.stackSave=me.stackSave;if(e.asm=me,e.cwrap=R,e.setValue=T,e.getValue=b,li){Js(li)||(li=s(li));{kn();var Kl=function(le){le.byteLength&&(le=new Uint8Array(le)),oe.set(le,y),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Pi()},Rh=function(){o(li,Kl,function(){throw"could not load memory initializer "+li})},Dh=jl(li);if(Dh)Kl(Dh.buffer);else if(e.memoryInitializerRequest){var Ch=function(){var le=e.memoryInitializerRequest,ce=le.response;if(le.status!==200&&le.status!==0){var Se=jl(e.memoryInitializerRequestURL);if(Se)ce=Se.buffer;else{Rh();return}}Kl(ce)};e.memoryInitializerRequest.response?setTimeout(Ch,0):e.memoryInitializerRequest.addEventListener("load",Ch)}else Rh()}}var _a;Wt=function le(){_a||Ql(),_a||(Wt=le)};function Ql(le){if(_t>0||(Qt(),_t>0))return;function ce(){_a||(_a=!0,!_&&(Gt(),vi(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Vi()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ce()},1)):ce()}e.run=Ql;function qr(le){throw e.onAbort&&e.onAbort(le),le+="",a(le),c(le),_=!0,"abort("+le+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=qr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Ql(),i})(typeof at=="object"?at:{}),Ge="number",Fe=Ge,vo=Ge,Ue=Ge,$e=Ge,Zt=Ge,_e=Ge,kB=[["sizeOfH3Index",Ge],["sizeOfLatLng",Ge],["sizeOfCellBoundary",Ge],["sizeOfGeoLoop",Ge],["sizeOfGeoPolygon",Ge],["sizeOfLinkedGeoPolygon",Ge],["sizeOfCoordIJ",Ge],["readInt64AsDoubleFromPointer",Ge],["isValidCell",vo,[Ue,$e]],["latLngToCell",Fe,[Ge,Ge,Zt,_e]],["cellToLatLng",Fe,[Ue,$e,_e]],["cellToBoundary",Fe,[Ue,$e,_e]],["maxGridDiskSize",Fe,[Ge,_e]],["gridDisk",Fe,[Ue,$e,Ge,_e]],["gridDiskDistances",Fe,[Ue,$e,Ge,_e,_e]],["gridRing",Fe,[Ue,$e,Ge,_e]],["gridRingUnsafe",Fe,[Ue,$e,Ge,_e]],["maxPolygonToCellsSize",Fe,[_e,Zt,Ge,_e]],["polygonToCells",Fe,[_e,Zt,Ge,_e]],["maxPolygonToCellsSizeExperimental",Fe,[_e,Zt,Ge,_e]],["polygonToCellsExperimental",Fe,[_e,Zt,Ge,Ge,Ge,_e]],["cellsToLinkedMultiPolygon",Fe,[_e,Ge,_e]],["destroyLinkedMultiPolygon",null,[_e]],["compactCells",Fe,[_e,_e,Ge,Ge]],["uncompactCells",Fe,[_e,Ge,Ge,_e,Ge,Zt]],["uncompactCellsSize",Fe,[_e,Ge,Ge,Zt,_e]],["isPentagon",vo,[Ue,$e]],["isResClassIII",vo,[Ue,$e]],["getBaseCellNumber",Ge,[Ue,$e]],["getResolution",Ge,[Ue,$e]],["maxFaceCount",Fe,[Ue,$e,_e]],["getIcosahedronFaces",Fe,[Ue,$e,_e]],["cellToParent",Fe,[Ue,$e,Zt,_e]],["cellToChildren",Fe,[Ue,$e,Zt,_e]],["cellToCenterChild",Fe,[Ue,$e,Zt,_e]],["cellToChildrenSize",Fe,[Ue,$e,Zt,_e]],["cellToChildPos",Fe,[Ue,$e,Zt,_e]],["childPosToCell",Fe,[Ge,Ge,Ue,$e,Zt,_e]],["areNeighborCells",Fe,[Ue,$e,Ue,$e,_e]],["cellsToDirectedEdge",Fe,[Ue,$e,Ue,$e,_e]],["getDirectedEdgeOrigin",Fe,[Ue,$e,_e]],["getDirectedEdgeDestination",Fe,[Ue,$e,_e]],["isValidDirectedEdge",vo,[Ue,$e]],["directedEdgeToCells",Fe,[Ue,$e,_e]],["originToDirectedEdges",Fe,[Ue,$e,_e]],["directedEdgeToBoundary",Fe,[Ue,$e,_e]],["gridDistance",Fe,[Ue,$e,Ue,$e,_e]],["gridPathCells",Fe,[Ue,$e,Ue,$e,_e]],["gridPathCellsSize",Fe,[Ue,$e,Ue,$e,_e]],["cellToLocalIj",Fe,[Ue,$e,Ue,$e,Ge,_e]],["localIjToCell",Fe,[Ue,$e,_e,Ge,_e]],["getHexagonAreaAvgM2",Fe,[Zt,_e]],["getHexagonAreaAvgKm2",Fe,[Zt,_e]],["getHexagonEdgeLengthAvgM",Fe,[Zt,_e]],["getHexagonEdgeLengthAvgKm",Fe,[Zt,_e]],["greatCircleDistanceM",Ge,[_e,_e]],["greatCircleDistanceKm",Ge,[_e,_e]],["greatCircleDistanceRads",Ge,[_e,_e]],["cellAreaM2",Fe,[Ue,$e,_e]],["cellAreaKm2",Fe,[Ue,$e,_e]],["cellAreaRads2",Fe,[Ue,$e,_e]],["edgeLengthM",Fe,[Ue,$e,_e]],["edgeLengthKm",Fe,[Ue,$e,_e]],["edgeLengthRads",Fe,[Ue,$e,_e]],["getNumCells",Fe,[Zt,_e]],["getRes0Cells",Fe,[_e]],["res0CellCount",Ge],["getPentagons",Fe,[Ge,_e]],["pentagonCount",Ge],["cellToVertex",Fe,[Ue,$e,Ge,_e]],["cellToVertexes",Fe,[Ue,$e,_e]],["vertexToLatLng",Fe,[Ue,$e,_e]],["isValidVertex",vo,[Ue,$e]]],MB=0,OB=1,FB=2,BB=3,zT=4,NB=5,UB=6,$B=7,GB=8,VB=9,HB=10,jB=11,KB=12,QB=13,WB=14,YB=15,ni={};ni[MB]="Success";ni[OB]="The operation failed but a more specific error is not available";ni[FB]="Argument was outside of acceptable range";ni[BB]="Latitude or longitude arguments were outside of acceptable range";ni[zT]="Resolution argument was outside of acceptable range";ni[NB]="Cell argument was not valid";ni[UB]="Directed edge argument was not valid";ni[$B]="Undirected edge argument was not valid";ni[GB]="Vertex argument was not valid";ni[VB]="Pentagon distortion was encountered";ni[HB]="Duplicate input";ni[jB]="Cell arguments were not neighbors";ni[KB]="Cell arguments had incompatible resolutions";ni[QB]="Memory allocation failed";ni[WB]="Bounds of provided memory were insufficient";ni[YB]="Mode or flags argument was not valid";var zB=1e3,qT=1001,XT=1002,$l={};$l[zB]="Unknown unit";$l[qT]="Array length out of bounds";$l[XT]="Got unexpected null value for H3 index";var qB="Unknown error";function ZT(i,e,t){var n=t&&"value"in t,r=new Error((i[e]||qB)+" (code: "+e+(n?", value: "+t.value:"")+")");return r.code=e,r}function JT(i,e){var t=arguments.length===2?{value:e}:{};return ZT(ni,i,t)}function eS(i,e){var t=arguments.length===2?{value:e}:{};return ZT($l,i,t)}function oa(i){if(i!==0)throw JT(i)}var Ci={};kB.forEach(function(e){Ci[e[0]]=at.cwrap.apply(at,e)});var ws=16,aa=4,Ks=8,XB=8,El=Ci.sizeOfH3Index(),_h=Ci.sizeOfLatLng(),ZB=Ci.sizeOfCellBoundary(),JB=Ci.sizeOfGeoPolygon(),$o=Ci.sizeOfGeoLoop();Ci.sizeOfLinkedGeoPolygon();Ci.sizeOfCoordIJ();function e6(i){if(typeof i!="number"||i<0||i>15||Math.floor(i)!==i)throw JT(zT,i);return i}function t6(i){if(!i)throw eS(XT);return i}var i6=Math.pow(2,32)-1;function n6(i){if(i>i6)throw eS(qT,i);return i}var r6=/[^0-9a-fA-F]/;function tS(i){if(Array.isArray(i)&&i.length===2&&Number.isInteger(i[0])&&Number.isInteger(i[1]))return i;if(typeof i!="string"||r6.test(i))return[0,0];var e=parseInt(i.substring(0,i.length-8),ws),t=parseInt(i.substring(i.length-8),ws);return[t,e]}function Ay(i){if(i>=0)return i.toString(ws);i=i&2147483647;var e=iS(8,i.toString(ws)),t=(parseInt(e[0],ws)+8).toString(ws);return e=t+e.substring(1),e}function s6(i,e){return Ay(e)+iS(8,Ay(i))}function iS(i,e){for(var t=i-e.length,n="",r=0;r<t;r++)n+="0";return n=n+e,n}function ly(i,e,t){for(var n=i.length,r=at._calloc(n,_h),s=t?1:0,o=t?0:1,a=0;a<n*2;a+=2)at.HEAPF64.set([i[a/2][s],i[a/2][o]].map(rS),r/Ks+a);return at.HEAPU32.set([n,r],e/aa),e}function o6(i,e){var t=i.length-1,n=at._calloc(JB),r=0,s=r+$o,o=s+aa;ly(i[0],n+r,e);var a;if(t>0){a=at._calloc(t,$o);for(var c=0;c<t;c++)ly(i[c+1],a+$o*c,e)}return at.setValue(n+s,t,"i32"),at.setValue(n+o,a,"i32"),n}function a6(i){var e=0,t=e+$o,n=t+aa,r=aa;at._free(at.getValue(i+e+r,"i8*"));var s=at.getValue(i+t,"i32");if(s>0){for(var o=at.getValue(i+n,"i32"),a=0;a<s;a++)at._free(at.getValue(o+$o*a+r,"i8*"));at._free(o)}at._free(i)}function nS(i,e){e===void 0&&(e=0);var t=at.getValue(i+El*e,"i32"),n=at.getValue(i+El*e+aa,"i32");return n?s6(t,n):null}function A6(i){return Ci.readInt64AsDoubleFromPointer(i)}function l6(i,e){for(var t=[],n=0;n<e;n++){var r=nS(i,n);r!==null&&t.push(r)}return t}function Tl(i){return h6(at.getValue(i,"double"))}function u6(i){return[Tl(i),Tl(i+Ks)]}function f6(i){return[Tl(i+Ks),Tl(i)]}function c6(i,e,t){for(var n=at.getValue(i,"i32"),r=i+Ks,s=[],o=f6,a=0;a<n*2;a+=2)s.push(o(r+Ks*a));return s.push(s[0]),s}function YU(i,e,t){var n=at._malloc(_h);at.HEAPF64.set([i,e].map(rS),n/Ks);var r=at._malloc(El);try{return oa(Ci.latLngToCell(n,t,r)),t6(nS(r))}finally{at._free(r),at._free(n)}}function zU(i){var e=at._malloc(_h),t=tS(i),n=t[0],r=t[1];try{return oa(Ci.cellToLatLng(n,r,e)),u6(e)}finally{at._free(e)}}function qU(i,e){var t=at._malloc(ZB),n=tS(i),r=n[0],s=n[1];try{return oa(Ci.cellToBoundary(r,s,t)),c6(t,e,e)}finally{at._free(t)}}function XU(i,e,t){if(e6(e),t=!!t,i.length===0||i[0].length===0)return[];var n=typeof i[0][0]=="number"?[i]:i,r=o6(n,t),s=at._malloc(XB);try{oa(Ci.maxPolygonToCellsSize(r,e,0,s));var o=n6(A6(s)),a=at._calloc(o,El);try{return oa(Ci.polygonToCells(r,e,0,a)),l6(a,o)}finally{at._free(a)}}finally{at._free(s),a6(r)}}function rS(i){return i*Math.PI/180}function h6(i){return i*180/Math.PI}function ZU(i){return i=Math.max(0,Math.min(1,i)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+i*(1172.33-i*(10793.56-i*(33300.12-i*(38394.49-i*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+i*(557.33+i*(1225.33-i*(3574.96-i*(1073.77+i*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+i*(3211.1-i*(15327.97-i*(27814-i*(22569.18-i*6838.66)))))))+")"}function d6(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Aa(i,e){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Aa(i,e)}function g6(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,Aa(i,e)}function tc(i){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tc(i)}function p6(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function sS(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sS=function(){return!!i})()}function m6(i,e,t){if(sS())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&Aa(r,t.prototype),r}function ic(i){var e=typeof Map=="function"?new Map:void 0;return ic=function(n){if(n===null||!p6(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return m6(n,arguments,tc(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Aa(r,n)},ic(i)}var bn=(function(i){g6(e,i);function e(t){var n;return n=i.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,d6(n)}return e})(ic(Error));function L0(i){return Math.round(i*255)}function y6(i,e,t){return L0(i)+","+L0(e)+","+L0(t)}function Sl(i,e,t,n){if(n===void 0&&(n=y6),e===0)return n(t,t,t);var r=(i%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,o=s*(1-Math.abs(r%2-1)),a=0,c=0,h=0;r>=0&&r<1?(a=s,c=o):r>=1&&r<2?(a=o,c=s):r>=2&&r<3?(c=s,h=o):r>=3&&r<4?(c=o,h=s):r>=4&&r<5?(a=o,h=s):r>=5&&r<6&&(a=s,h=o);var d=t-s/2,p=a+d,y=c+d,T=h+d;return n(p,y,T)}var uy={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function v6(i){if(typeof i!="string")return i;var e=i.toLowerCase();return uy[e]?"#"+uy[e]:i}var E6=/^#[a-fA-F0-9]{6}$/,T6=/^#[a-fA-F0-9]{8}$/,S6=/^#[a-fA-F0-9]{3}$/,b6=/^#[a-fA-F0-9]{4}$/,R0=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,x6=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,_6=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,w6=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function la(i){if(typeof i!="string")throw new bn(3);var e=v6(i);if(e.match(E6))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(T6)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(S6))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(b6)){var n=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:n}}var r=R0.exec(e);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=x6.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=_6.exec(e);if(o){var a=parseInt(""+o[1],10),c=parseInt(""+o[2],10)/100,h=parseInt(""+o[3],10)/100,d="rgb("+Sl(a,c,h)+")",p=R0.exec(d);if(!p)throw new bn(4,e,d);return{red:parseInt(""+p[1],10),green:parseInt(""+p[2],10),blue:parseInt(""+p[3],10)}}var y=w6.exec(e.substring(0,50));if(y){var T=parseInt(""+y[1],10),b=parseInt(""+y[2],10)/100,_=parseInt(""+y[3],10)/100,w="rgb("+Sl(T,b,_)+")",L=R0.exec(w);if(!L)throw new bn(4,e,w);return{red:parseInt(""+L[1],10),green:parseInt(""+L[2],10),blue:parseInt(""+L[3],10),alpha:parseFloat(""+y[4])>1?parseFloat(""+y[4])/100:parseFloat(""+y[4])}}throw new bn(5)}function I6(i){var e=i.red/255,t=i.green/255,n=i.blue/255,r=Math.max(e,t,n),s=Math.min(e,t,n),o=(r+s)/2;if(r===s)return i.alpha!==void 0?{hue:0,saturation:0,lightness:o,alpha:i.alpha}:{hue:0,saturation:0,lightness:o};var a,c=r-s,h=o>.5?c/(2-r-s):c/(r+s);switch(r){case e:a=(t-n)/c+(t<n?6:0);break;case t:a=(n-e)/c+2;break;default:a=(e-t)/c+4;break}return a*=60,i.alpha!==void 0?{hue:a,saturation:h,lightness:o,alpha:i.alpha}:{hue:a,saturation:h,lightness:o}}function yr(i){return I6(la(i))}var L6=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},nc=L6;function Mr(i){var e=i.toString(16);return e.length===1?"0"+e:e}function D0(i){return Mr(Math.round(i*255))}function R6(i,e,t){return nc("#"+D0(i)+D0(e)+D0(t))}function oS(i,e,t){return Sl(i,e,t,R6)}function D6(i,e,t){if(typeof i=="object"&&e===void 0&&t===void 0)return oS(i.hue,i.saturation,i.lightness);throw new bn(1)}function C6(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?oS(i.hue,i.saturation,i.lightness):"rgba("+Sl(i.hue,i.saturation,i.lightness)+","+i.alpha+")";throw new bn(2)}function aS(i,e,t){if(typeof i=="number"&&typeof e=="number"&&typeof t=="number")return nc("#"+Mr(i)+Mr(e)+Mr(t));if(typeof i=="object"&&e===void 0&&t===void 0)return nc("#"+Mr(i.red)+Mr(i.green)+Mr(i.blue));throw new bn(6)}function Gl(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?aS(i.red,i.green,i.blue):"rgba("+i.red+","+i.green+","+i.blue+","+i.alpha+")";throw new bn(7)}var P6=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},k6=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},M6=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},O6=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function vr(i){if(typeof i!="object")throw new bn(8);if(k6(i))return Gl(i);if(P6(i))return aS(i);if(O6(i))return C6(i);if(M6(i))return D6(i);throw new bn(8)}function AS(i,e,t){return function(){var r=t.concat(Array.prototype.slice.call(arguments));return r.length>=e?i.apply(this,r):AS(i,e,r)}}function Gi(i){return AS(i,i.length,[])}function F6(i,e){if(e==="transparent")return e;var t=yr(e);return vr(Di({},t,{hue:t.hue+parseFloat(i)}))}Gi(F6);function qs(i,e,t){return Math.max(i,Math.min(e,t))}function B6(i,e){if(e==="transparent")return e;var t=yr(e);return vr(Di({},t,{lightness:qs(0,1,t.lightness-parseFloat(i))}))}Gi(B6);function N6(i,e){if(e==="transparent")return e;var t=yr(e);return vr(Di({},t,{saturation:qs(0,1,t.saturation-parseFloat(i))}))}Gi(N6);function U6(i,e){if(e==="transparent")return e;var t=yr(e);return vr(Di({},t,{lightness:qs(0,1,t.lightness+parseFloat(i))}))}Gi(U6);function $6(i,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(i===0)return t;var n=la(e),r=Di({},n,{alpha:typeof n.alpha=="number"?n.alpha:1}),s=la(t),o=Di({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),a=r.alpha-o.alpha,c=parseFloat(i)*2-1,h=c*a===-1?c:c+a,d=1+c*a,p=(h/d+1)/2,y=1-p,T={red:Math.floor(r.red*p+o.red*y),green:Math.floor(r.green*p+o.green*y),blue:Math.floor(r.blue*p+o.blue*y),alpha:r.alpha*parseFloat(i)+o.alpha*(1-parseFloat(i))};return Gl(T)}var G6=Gi($6),lS=G6;function V6(i,e){if(e==="transparent")return e;var t=la(e),n=typeof t.alpha=="number"?t.alpha:1,r=Di({},t,{alpha:qs(0,1,(n*100+parseFloat(i)*100)/100)});return Gl(r)}var H6=Gi(V6),JU=H6;function j6(i,e){if(e==="transparent")return e;var t=yr(e);return vr(Di({},t,{saturation:qs(0,1,t.saturation+parseFloat(i))}))}Gi(j6);function K6(i,e){return e==="transparent"?e:vr(Di({},yr(e),{hue:parseFloat(i)}))}Gi(K6);function Q6(i,e){return e==="transparent"?e:vr(Di({},yr(e),{lightness:parseFloat(i)}))}Gi(Q6);function W6(i,e){return e==="transparent"?e:vr(Di({},yr(e),{saturation:parseFloat(i)}))}Gi(W6);function Y6(i,e){return e==="transparent"?e:lS(parseFloat(i),"rgb(0, 0, 0)",e)}Gi(Y6);function z6(i,e){return e==="transparent"?e:lS(parseFloat(i),"rgb(255, 255, 255)",e)}Gi(z6);function q6(i,e){if(e==="transparent")return e;var t=la(e),n=typeof t.alpha=="number"?t.alpha:1,r=Di({},t,{alpha:qs(0,1,+(n*100-parseFloat(i)*100).toFixed(2)/100)});return Gl(r)}Gi(q6);var rc="http://www.w3.org/1999/xhtml";const fy={svg:"http://www.w3.org/2000/svg",xhtml:rc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function uS(i){var e=i+="",t=e.indexOf(":");return t>=0&&(e=i.slice(0,t))!=="xmlns"&&(i=i.slice(t+1)),fy.hasOwnProperty(e)?{space:fy[e],local:i}:i}function X6(i){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===rc&&e.documentElement.namespaceURI===rc?e.createElement(i):e.createElementNS(t,i)}}function Z6(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function fS(i){var e=uS(i);return(e.local?Z6:X6)(e)}function J6(){}function cS(i){return i==null?J6:function(){return this.querySelector(i)}}function e5(i){typeof i!="function"&&(i=cS(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],o=s.length,a=n[r]=new Array(o),c,h,d=0;d<o;++d)(c=s[d])&&(h=i.call(c,c.__data__,d,s))&&("__data__"in c&&(h.__data__=c.__data__),a[d]=h);return new en(n,this._parents)}function t5(i){return i==null?[]:Array.isArray(i)?i:Array.from(i)}function i5(){return[]}function n5(i){return i==null?i5:function(){return this.querySelectorAll(i)}}function r5(i){return function(){return t5(i.apply(this,arguments))}}function s5(i){typeof i=="function"?i=r5(i):i=n5(i);for(var e=this._groups,t=e.length,n=[],r=[],s=0;s<t;++s)for(var o=e[s],a=o.length,c,h=0;h<a;++h)(c=o[h])&&(n.push(i.call(c,c.__data__,h,o)),r.push(c));return new en(n,r)}function o5(i){return function(){return this.matches(i)}}function hS(i){return function(e){return e.matches(i)}}var a5=Array.prototype.find;function A5(i){return function(){return a5.call(this.children,i)}}function l5(){return this.firstElementChild}function u5(i){return this.select(i==null?l5:A5(typeof i=="function"?i:hS(i)))}var f5=Array.prototype.filter;function c5(){return Array.from(this.children)}function h5(i){return function(){return f5.call(this.children,i)}}function d5(i){return this.selectAll(i==null?c5:h5(typeof i=="function"?i:hS(i)))}function g5(i){typeof i!="function"&&(i=o5(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],o=s.length,a=n[r]=[],c,h=0;h<o;++h)(c=s[h])&&i.call(c,c.__data__,h,s)&&a.push(c);return new en(n,this._parents)}function dS(i){return new Array(i.length)}function p5(){return new en(this._enter||this._groups.map(dS),this._parents)}function bl(i,e){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=e}bl.prototype={constructor:bl,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,e){return this._parent.insertBefore(i,e)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function m5(i){return function(){return i}}function y5(i,e,t,n,r,s){for(var o=0,a,c=e.length,h=s.length;o<h;++o)(a=e[o])?(a.__data__=s[o],n[o]=a):t[o]=new bl(i,s[o]);for(;o<c;++o)(a=e[o])&&(r[o]=a)}function v5(i,e,t,n,r,s,o){var a,c,h=new Map,d=e.length,p=s.length,y=new Array(d),T;for(a=0;a<d;++a)(c=e[a])&&(y[a]=T=o.call(c,c.__data__,a,e)+"",h.has(T)?r[a]=c:h.set(T,c));for(a=0;a<p;++a)T=o.call(i,s[a],a,s)+"",(c=h.get(T))?(n[a]=c,c.__data__=s[a],h.delete(T)):t[a]=new bl(i,s[a]);for(a=0;a<d;++a)(c=e[a])&&h.get(y[a])===c&&(r[a]=c)}function E5(i){return i.__data__}function T5(i,e){if(!arguments.length)return Array.from(this,E5);var t=e?v5:y5,n=this._parents,r=this._groups;typeof i!="function"&&(i=m5(i));for(var s=r.length,o=new Array(s),a=new Array(s),c=new Array(s),h=0;h<s;++h){var d=n[h],p=r[h],y=p.length,T=S5(i.call(d,d&&d.__data__,h,n)),b=T.length,_=a[h]=new Array(b),w=o[h]=new Array(b),L=c[h]=new Array(y);t(d,p,_,w,L,T,e);for(var P=0,R=0,k,F;P<b;++P)if(k=_[P]){for(P>=R&&(R=P+1);!(F=w[R])&&++R<b;);k._next=F||null}}return o=new en(o,n),o._enter=a,o._exit=c,o}function S5(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function b5(){return new en(this._exit||this._groups.map(dS),this._parents)}function x5(i,e,t){var n=this.enter(),r=this,s=this.exit();return typeof i=="function"?(n=i(n),n&&(n=n.selection())):n=n.append(i+""),e!=null&&(r=e(r),r&&(r=r.selection())),t==null?s.remove():t(s),n&&r?n.merge(r).order():r}function _5(i){for(var e=i.selection?i.selection():i,t=this._groups,n=e._groups,r=t.length,s=n.length,o=Math.min(r,s),a=new Array(r),c=0;c<o;++c)for(var h=t[c],d=n[c],p=h.length,y=a[c]=new Array(p),T,b=0;b<p;++b)(T=h[b]||d[b])&&(y[b]=T);for(;c<r;++c)a[c]=t[c];return new en(a,this._parents)}function w5(){for(var i=this._groups,e=-1,t=i.length;++e<t;)for(var n=i[e],r=n.length-1,s=n[r],o;--r>=0;)(o=n[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function I5(i){i||(i=L5);function e(p,y){return p&&y?i(p.__data__,y.__data__):!p-!y}for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s){for(var o=t[s],a=o.length,c=r[s]=new Array(a),h,d=0;d<a;++d)(h=o[d])&&(c[d]=h);c.sort(e)}return new en(r,this._parents).order()}function L5(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}function R5(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function D5(){return Array.from(this)}function C5(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null}function P5(){let i=0;for(const e of this)++i;return i}function k5(){return!this.node()}function M5(i){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,o=r.length,a;s<o;++s)(a=r[s])&&i.call(a,a.__data__,s,r);return this}function O5(i){return function(){this.removeAttribute(i)}}function F5(i){return function(){this.removeAttributeNS(i.space,i.local)}}function B5(i,e){return function(){this.setAttribute(i,e)}}function N5(i,e){return function(){this.setAttributeNS(i.space,i.local,e)}}function U5(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(i):this.setAttribute(i,t)}}function $5(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function G5(i,e){var t=uS(i);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?F5:O5:typeof e=="function"?t.local?$5:U5:t.local?N5:B5)(t,e))}function gS(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function V5(i){return function(){this.style.removeProperty(i)}}function H5(i,e,t){return function(){this.style.setProperty(i,e,t)}}function j5(i,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(i):this.style.setProperty(i,n,t)}}function K5(i,e,t){return arguments.length>1?this.each((e==null?V5:typeof e=="function"?j5:H5)(i,e,t??"")):Q5(this.node(),i)}function Q5(i,e){return i.style.getPropertyValue(e)||gS(i).getComputedStyle(i,null).getPropertyValue(e)}function W5(i){return function(){delete this[i]}}function Y5(i,e){return function(){this[i]=e}}function z5(i,e){return function(){var t=e.apply(this,arguments);t==null?delete this[i]:this[i]=t}}function q5(i,e){return arguments.length>1?this.each((e==null?W5:typeof e=="function"?z5:Y5)(i,e)):this.node()[i]}function pS(i){return i.trim().split(/^|\s+/)}function wh(i){return i.classList||new mS(i)}function mS(i){this._node=i,this._names=pS(i.getAttribute("class")||"")}mS.prototype={add:function(i){var e=this._names.indexOf(i);e<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var e=this._names.indexOf(i);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function yS(i,e){for(var t=wh(i),n=-1,r=e.length;++n<r;)t.add(e[n])}function vS(i,e){for(var t=wh(i),n=-1,r=e.length;++n<r;)t.remove(e[n])}function X5(i){return function(){yS(this,i)}}function Z5(i){return function(){vS(this,i)}}function J5(i,e){return function(){(e.apply(this,arguments)?yS:vS)(this,i)}}function eN(i,e){var t=pS(i+"");if(arguments.length<2){for(var n=wh(this.node()),r=-1,s=t.length;++r<s;)if(!n.contains(t[r]))return!1;return!0}return this.each((typeof e=="function"?J5:e?X5:Z5)(t,e))}function tN(){this.textContent=""}function iN(i){return function(){this.textContent=i}}function nN(i){return function(){var e=i.apply(this,arguments);this.textContent=e??""}}function rN(i){return arguments.length?this.each(i==null?tN:(typeof i=="function"?nN:iN)(i)):this.node().textContent}function sN(){this.innerHTML=""}function oN(i){return function(){this.innerHTML=i}}function aN(i){return function(){var e=i.apply(this,arguments);this.innerHTML=e??""}}function AN(i){return arguments.length?this.each(i==null?sN:(typeof i=="function"?aN:oN)(i)):this.node().innerHTML}function lN(){this.nextSibling&&this.parentNode.appendChild(this)}function uN(){return this.each(lN)}function fN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cN(){return this.each(fN)}function hN(i){var e=typeof i=="function"?i:fS(i);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function dN(){return null}function gN(i,e){var t=typeof i=="function"?i:fS(i),n=e==null?dN:typeof e=="function"?e:cS(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function pN(){var i=this.parentNode;i&&i.removeChild(this)}function mN(){return this.each(pN)}function yN(){var i=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function vN(){var i=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function EN(i){return this.select(i?vN:yN)}function TN(i){return arguments.length?this.property("__data__",i):this.node().__data__}function SN(i){return function(e){i.call(this,e,this.__data__)}}function bN(i){return i.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function xN(i){return function(){var e=this.__on;if(e){for(var t=0,n=-1,r=e.length,s;t<r;++t)s=e[t],(!i.type||s.type===i.type)&&s.name===i.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function _N(i,e,t){return function(){var n=this.__on,r,s=SN(e);if(n){for(var o=0,a=n.length;o<a;++o)if((r=n[o]).type===i.type&&r.name===i.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=t),r.value=e;return}}this.addEventListener(i.type,s,t),r={type:i.type,name:i.name,value:e,listener:s,options:t},n?n.push(r):this.__on=[r]}}function wN(i,e,t){var n=bN(i+""),r,s=n.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,h=a.length,d;c<h;++c)for(r=0,d=a[c];r<s;++r)if((o=n[r]).type===d.type&&o.name===d.name)return d.value}return}for(a=e?_N:xN,r=0;r<s;++r)this.each(a(n[r],e,t));return this}function ES(i,e,t){var n=gS(i),r=n.CustomEvent;typeof r=="function"?r=new r(e,t):(r=n.document.createEvent("Event"),t?(r.initEvent(e,t.bubbles,t.cancelable),r.detail=t.detail):r.initEvent(e,!1,!1)),i.dispatchEvent(r)}function IN(i,e){return function(){return ES(this,i,e)}}function LN(i,e){return function(){return ES(this,i,e.apply(this,arguments))}}function RN(i,e){return this.each((typeof e=="function"?LN:IN)(i,e))}function*DN(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length,o;r<s;++r)(o=n[r])&&(yield o)}var CN=[null];function en(i,e){this._groups=i,this._parents=e}function PN(){return this}en.prototype={constructor:en,select:e5,selectAll:s5,selectChild:u5,selectChildren:d5,filter:g5,data:T5,enter:p5,exit:b5,join:x5,merge:_5,selection:PN,order:w5,sort:I5,call:R5,nodes:D5,node:C5,size:P5,empty:k5,each:M5,attr:G5,style:K5,property:q5,classed:eN,text:rN,html:AN,raise:uN,lower:cN,append:hN,insert:gN,remove:mN,clone:EN,datum:TN,on:wN,dispatch:RN,[Symbol.iterator]:DN};function kN(i){return typeof i=="string"?new en([[document.querySelector(i)]],[document.documentElement]):new en([[i]],CN)}function MN(i){let e;for(;e=i.sourceEvent;)i=e;return i}function ON(i,e){if(i=MN(i),e===void 0&&(e=i.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=i.clientX,n.y=i.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop]}}return[i.pageX,i.pageY]}function cy(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function FN(i){if(Array.isArray(i))return i}function BN(i,e,t){return(e=HN(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NN(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(c=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function UN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hy(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function $N(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hy(Object(t),!0).forEach(function(n){BN(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):hy(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function GN(i,e){return FN(i)||NN(i,e)||jN(i,e)||UN()}function VN(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function HN(i){var e=VN(i,"string");return typeof e=="symbol"?e:e+""}function xl(i){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xl(i)}function jN(i,e){if(i){if(typeof i=="string")return cy(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cy(i,e):void 0}}var sc=function(e){if(xl(e)!=="object")return e;var t=py(e);if(t.props){var n;t.props=$N({},t.props),t!=null&&(n=t.props)!==null&&n!==void 0&&n.children&&(t.props.children=Array.isArray(t.props.children)?t.props.children.map(sc):sc(t.props.children))}return t},KN=function(e){return Lx(py(e))},QN=function(e,t){delete t.__k,Rx(sc(e),t)};function WN(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var YN=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;WN(YN);var e7=eT({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.style,s=r===void 0?{}:r,o=!!e&&xl(e)==="object"&&!!e.node&&typeof e.node=="function",a=kN(o?e.node():e);a.style("position")==="static"&&a.style("position","relative"),t.tooltipEl=a.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(h){var d=GN(h,2),p=d[0],y=d[1];return t.tooltipEl.style(p,y)}),t.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));t.mouseInside=!1,a.on("mousemove.".concat(c),function(h){t.mouseInside=!0;var d=ON(h),p=a.node(),y=p.offsetWidth,T=p.offsetHeight,b=[t.offsetX===null||t.offsetX===void 0?"-".concat(d[0]/y*100,"%"):typeof t.offsetX=="number"?"calc(-50% + ".concat(t.offsetX,"px)"):t.offsetX,t.offsetY===null||t.offsetY===void 0?T>130&&T-d[1]<100?"calc(-100% - 6px)":"21px":typeof t.offsetY=="number"?t.offsetY<0?"calc(-100% - ".concat(Math.abs(t.offsetY),"px)"):"".concat(t.offsetY,"px"):t.offsetY];t.tooltipEl.style("left",d[0]+"px").style("top",d[1]+"px").style("transform","translate(".concat(b.join(","),")")),t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseover.".concat(c),function(){t.mouseInside=!0,t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseout.".concat(c),function(){t.mouseInside=!1,t.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):KN(e.content)?(e.tooltipEl.text(""),QN(e.content,e.tooltipEl.node())):e.tooltipEl.style("display","none"):e.tooltipEl.text("")}});function zN(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var qN=`.scene-container .clickable {
  cursor: pointer;
}`;zN(qN);function oc(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function XN(i){if(Array.isArray(i))return oc(i)}function Ea(i,e,t){return(e=nU(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ZN(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function JN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dy(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Or(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dy(Object(t),!0).forEach(function(n){Ea(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):dy(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function eU(i,e){if(i==null)return{};var t,n,r=tU(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function tU(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.indexOf(n)!==-1)continue;t[n]=i[n]}return t}function Vl(i){return XN(i)||ZN(i)||rU(i)||JN()}function iU(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function nU(i){var e=iU(i,"string");return typeof e=="symbol"?e:e+""}function rU(i,e){if(i){if(typeof i=="string")return oc(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?oc(i,e):void 0}}function TS(i,e){var t=new e;return t._destructor&&t._destructor(),{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[i][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[i],a=arguments.length,c=new Array(a>1?a-1:0),h=1;h<a;h++)c[h-1]=arguments[h];var d=o[r].apply(o,c);return d===o?this:d}}}}var sU=["rendererConfig","waitForGlobeReady"],Eo=Or(Or({},window.THREE?window.THREE:{AmbientLight:Mx,DirectionalLight:kx,Vector2:_l,REVISION:Px}),{},{CSS2DRenderer:Ox}),SS=TS("globe",vy),oU=Object.assign.apply(Object,Vl(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","globeCurvatureResolution","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(i){return Ea({},i,SS.linkProp(i))}))),aU=Object.assign.apply(Object,Vl(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map(function(i){return Ea({},i,SS.linkMethod(i))}))),bS=TS("renderObjs",Ey),AU=Object.assign.apply(Object,Vl(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(i){return Ea({},i,bS.linkProp(i))}))),lU=Object.assign.apply(Object,Vl(["lights","postProcessingComposer"].map(function(i){return Ea({},i,bS.linkMethod(i))}))),t7=eT({props:Or(Or({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},particleLabel:{default:"name",triggerUpdate:!1},onParticleClick:{triggerUpdate:!1},onParticleRightClick:{triggerUpdate:!1},onParticleHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){t.renderObjs.lineHoverPrecision(e),t.renderObjs.pointsHoverPrecision(e)}},globeOffset:{default:[0,0],triggerUpdate:!1,onChange:function(e,t){return Array.isArray(e)&&e.length===2&&t.renderObjs.viewOffset(e.map(function(n){return-n}))}}},oU),AU),methods:Or(Or({pauseAnimation:function(e){var t;return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),(t=e.globe)===null||t===void 0||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return e.animationFrameRequestId===null&&this._animationCycle(),(t=e.globe)===null||t===void 0||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=o();if(t.lat===void 0&&t.lng===void 0&&t.altitude===void 0)return r;var s=Object.assign({},r,t);if(["lat","lng","altitude"].forEach(function(c){return s[c]=+s[c]}),!n)a(s);else{for(;r.lng-s.lng>180;)r.lng-=360;for(;r.lng-s.lng<-180;)r.lng+=360;e.tweenGroup.add(new gO(r).to(s,n).easing(Ps.Cubic.InOut).onUpdate(a).start())}return this;function o(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function a(c){var h=c.lat,d=c.lng,p=c.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(h,d,p)),e.globe.setPointOfView(e.renderObjs.camera())}},getScreenCoords:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];var o=(t=e.globe).getCoords.apply(t,r);return e.renderObjs.getScreenCoords(o.x,o.y,o.z)},toGlobeCoords:function(e,t,n){var r=e.renderObjs.intersectingObjects(t,n).find(function(c){return(c.object.__globeObjType||c.object.parent.__globeObjType)==="globe"});if(!r)return null;var s=e.globe.toGeoCoords(r.point),o=s.lat,a=s.lng;return{lat:o,lng:a}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.particlesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},aU),lU),stateInit:function(e){var t=e.rendererConfig,n=e.waitForGlobeReady,r=n===void 0?!0:n,s=eU(e,sU),o=new vy(Or({waitForGlobeReady:r},s));return{globe:o,renderObjs:Ey({controlType:"orbit",rendererConfig:t,waitForLoadComplete:r,extraRenderers:[new Eo.CSS2DRenderer]}).skyRadius(o.getGlobeRadius()*500).showNavInfo(!1).objects([o]).lights([new Eo.AmbientLight(13421772,Math.PI),new Eo.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new tT}},init:function(e,t){var n=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var r=document.createElement("div");t.container.appendChild(r),t.renderObjs(r),t.globe.rendererSize(t.renderObjs.renderer().getSize(new Eo.Vector2)),this.pointOfView({altitude:2.5});var s=t.globe.getGlobeRadius(),o=t.renderObjs.controls();t.renderObjs.camera().near=.05,o.minDistance=s+Math.max(.001,t.renderObjs.camera().near*1.1),o.maxDistance=s*100,o.enablePan=!1,o.enableDamping=!0,o.dampingFactor=.1,o.rotateSpeed=.3,o.zoomSpeed=.3,o.zoomToCursor=!0,o.addEventListener("change",function(){o.target.setScalar(0);var h=n.pointOfView();o.rotateSpeed=h.altitude*.3,o.zoomSpeed=Math.sqrt(h.altitude)*.5,t.globe.setPointOfView(t.renderObjs.camera()),t.onZoom&&t.onZoom(h)});var a=function(d){for(var p=d;p&&!p.hasOwnProperty("__globeObjType");)p=p.parent;return p},c={point:function(d){return d},arc:function(d){return d},polygon:function(d){return d.data},path:function(d){return d},heatmap:function(d){return d},hexbin:function(d){return d},hexPolygon:function(d){return d},tile:function(d){return d},particles:function(d,p){return!p||!p.hasOwnProperty("index")||d.length<=p.index?d:d[p.index]},label:function(d){return d},object:function(d){return d},custom:function(d){return d}};Eo.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverFilter(function(h){var d=a(h);if(!d)return!1;var p=d.__globeObjType;if(p!=="globe"&&!c.hasOwnProperty(p))return!1;var y=c.hasOwnProperty(p)&&d.__data?c[p](d.__data):null;return["points","hexBinPoints"].some(function(T){return T===p})&&Array.isArray(y)?!1:t.pointerEventsFilter(d,y)}).tooltipContent(function(h,d){var p={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,particles:t.particleLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},y=a(h),T=y&&y.__globeObjType;return y&&T&&p.hasOwnProperty(T)&&c.hasOwnProperty(T)&&GT(p[T])(c[T](y.__data,d))||""}).onHover(function(h,d,p){var y={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,particles:t.onParticleHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},T={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},b=a(h);if(b&&!y.hasOwnProperty(b.__globeObjType)&&(b=null),b!==t.hoverObj){var _=t.hoverObj?t.hoverObj.__globeObjType:null,w=t.hoverData,L=b?b.__globeObjType:null,P=b?c[L](b.__data,p):null;_&&_!==L&&y[_]&&y[_](null,w||null),L&&y[L]&&y[L](P,_===L?w:null),t.renderObjs.renderer().domElement.classList[L&&T[L]?"add":"remove"]("clickable"),t.hoverObj=b,t.hoverData=P}}).onClick(function(h,d,p){if(h){var y={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},T=a(h),b=T.__globeObjType;if(T&&y.hasOwnProperty(b)&&y[b]){var _=[d],w=p!=null&&p.isVector3?p:p?.point;if(b==="globe"){var L=n.toGeoCoords(w),P=L.lat,R=L.lng;_.unshift({lat:P,lng:R})}else _.push(n.toGeoCoords(w));c.hasOwnProperty(b)&&_.unshift(c[b](T.__data,p)),y[b].apply(y,_)}}}).onRightClick(function(h,d,p){if(h){var y={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,particles:t.onParticleRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},T=a(h),b=T.__globeObjType;if(T&&y.hasOwnProperty(b)&&y[b]){var _=[d],w=p!=null&&p.isVector3?p:p?.point;if(b==="globe"){var L=n.toGeoCoords(w),P=L.lat,R=L.lng;_.unshift({lat:P,lng:R})}else _.push(n.toGeoCoords(w));c.hasOwnProperty(b)&&_.unshift(c[b](T.__data,p)),y[b].apply(y,_)}}}),this._animationCycle()}});export{ke as $,BU as A,QU as B,GU as C,ml as D,C as E,oT as F,NU as G,KU as H,MU as I,eT as J,tT as K,Ps as L,GT as M,jU as N,XU as O,wU as P,zU as Q,qU as R,kU as S,gO as T,O4 as U,WU as V,YU as W,UU as X,HU as Y,ea as Z,Di as _,_U as a,FU as a0,ZU as a1,OU as a2,la as a3,JU as a4,e7 as a5,yU as a6,SU as a7,CU as a8,IU as a9,DU as aa,bU as b,xU as c,i_ as d,a_ as e,_y as f,t7 as g,gU as h,hU as i,mU as j,vU as k,o_ as l,pU as m,FO as n,PU as o,M4 as p,R8 as q,cU as r,dU as s,VU as t,ac as u,ta as v,$U as w,EU as x,XA as y,aT as z};
